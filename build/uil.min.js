!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self).UIL={})}(this,(function(t){"use strict";var i=function(t){var i,s=Object.prototype,e=s.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},n=o.iterator||"@@iterator",h=o.asyncIterator||"@@asyncIterator",r=o.toStringTag||"@@toStringTag";function a(t,i,s){return Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}),t[i]}try{a({},"")}catch(t){a=function(t,i,s){return t[i]=s}}function l(t,i,s,e){var o=i&&i.prototype instanceof m?i:m,n=Object.create(o.prototype),h=new z(e||[]);return n._invoke=function(t,i,s){var e=u;return function(o,n){if(e===p)throw new Error("Generator is already running");if(e===f){if("throw"===o)throw n;return H()}for(s.method=o,s.arg=n;;){var h=s.delegate;if(h){var r=I(h,s);if(r){if(r===v)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(e===u)throw e=f,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);e=p;var a=c(t,i,s);if("normal"===a.type){if(e=s.done?f:d,a.arg===v)continue;return{value:a.arg,done:s.done}}"throw"===a.type&&(e=f,s.method="throw",s.arg=a.arg)}}}(t,s,h),n}function c(t,i,s){try{return{type:"normal",arg:t.call(i,s)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var u="suspendedStart",d="suspendedYield",p="executing",f="completed",v={};function m(){}function g(){}function x(){}var b={};b[n]=function(){return this};var w=Object.getPrototypeOf,y=w&&w(w(D([])));y&&y!==s&&e.call(y,n)&&(b=y);var k=x.prototype=m.prototype=Object.create(b);function C(t){["next","throw","return"].forEach((function(i){a(t,i,(function(t){return this._invoke(i,t)}))}))}function S(t,i){function s(o,n,h,r){var a=c(t[o],t,n);if("throw"!==a.type){var l=a.arg,u=l.value;return u&&"object"==typeof u&&e.call(u,"__await")?i.resolve(u.__await).then((function(t){s("next",t,h,r)}),(function(t){s("throw",t,h,r)})):i.resolve(u).then((function(t){l.value=t,h(l)}),(function(t){return s("throw",t,h,r)}))}r(a.arg)}var o;this._invoke=function(t,e){function n(){return new i((function(i,o){s(t,e,i,o)}))}return o=o?o.then(n,n):n()}}function I(t,s){var e=t.iterator[s.method];if(e===i){if(s.delegate=null,"throw"===s.method){if(t.iterator.return&&(s.method="return",s.arg=i,I(t,s),"throw"===s.method))return v;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=c(e,t.iterator,s.arg);if("throw"===o.type)return s.method="throw",s.arg=o.arg,s.delegate=null,v;var n=o.arg;return n?n.done?(s[t.resultName]=n.value,s.next=t.nextLoc,"return"!==s.method&&(s.method="next",s.arg=i),s.delegate=null,v):n:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,v)}function M(t){var i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),this.tryEntries.push(i)}function L(t){var i=t.completion||{};i.type="normal",delete i.arg,t.completion=i}function z(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function D(t){if(t){var s=t[n];if(s)return s.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,h=function s(){for(;++o<t.length;)if(e.call(t,o))return s.value=t[o],s.done=!1,s;return s.value=i,s.done=!0,s};return h.next=h}}return{next:H}}function H(){return{value:i,done:!0}}return g.prototype=k.constructor=x,x.constructor=g,g.displayName=a(x,r,"GeneratorFunction"),t.isGeneratorFunction=function(t){var i="function"==typeof t&&t.constructor;return!!i&&(i===g||"GeneratorFunction"===(i.displayName||i.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,a(t,r,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},C(S.prototype),S.prototype[h]=function(){return this},t.AsyncIterator=S,t.async=function(i,s,e,o,n){void 0===n&&(n=Promise);var h=new S(l(i,s,e,o),n);return t.isGeneratorFunction(s)?h:h.next().then((function(t){return t.done?t.value:h.next()}))},C(k),a(k,r,"Generator"),k[n]=function(){return this},k.toString=function(){return"[object Generator]"},t.keys=function(t){var i=[];for(var s in t)i.push(s);return i.reverse(),function s(){for(;i.length;){var e=i.pop();if(e in t)return s.value=e,s.done=!1,s}return s.done=!0,s}},t.values=D,z.prototype={constructor:z,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(L),!t)for(var s in this)"t"===s.charAt(0)&&e.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=i)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var s=this;function o(e,o){return r.type="throw",r.arg=t,s.next=e,o&&(s.method="next",s.arg=i),!!o}for(var n=this.tryEntries.length-1;n>=0;--n){var h=this.tryEntries[n],r=h.completion;if("root"===h.tryLoc)return o("end");if(h.tryLoc<=this.prev){var a=e.call(h,"catchLoc"),l=e.call(h,"finallyLoc");if(a&&l){if(this.prev<h.catchLoc)return o(h.catchLoc,!0);if(this.prev<h.finallyLoc)return o(h.finallyLoc)}else if(a){if(this.prev<h.catchLoc)return o(h.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<h.finallyLoc)return o(h.finallyLoc)}}}},abrupt:function(t,i){for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s];if(o.tryLoc<=this.prev&&e.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=i&&i<=n.finallyLoc&&(n=null);var h=n?n.completion:{};return h.type=t,h.arg=i,n?(this.method="next",this.next=n.finallyLoc,v):this.complete(h)},complete:function(t,i){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&i&&(this.next=i),v},finish:function(t){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.finallyLoc===t)return this.complete(s.completion,s.afterLoc),L(s),v}},catch:function(t){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.tryLoc===t){var e=s.completion;if("throw"===e.type){var o=e.arg;L(s)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,s,e){return this.delegate={iterator:D(t),resultName:s,nextLoc:e},"next"===this.method&&(this.arg=i),v}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=i}catch(t){Function("r","regeneratorRuntime = r")(i)}var s={frag:document.createDocumentFragment(),colorRing:null,joystick_0:null,joystick_1:null,circular:null,knob:null,svgns:"http://www.w3.org/2000/svg",links:"http://www.w3.org/1999/xlink",htmls:"http://www.w3.org/1999/xhtml",DOM_SIZE:["height","width","top","left","bottom","right","margin-left","margin-right","margin-top","margin-bottom"],SVG_TYPE_D:["pattern","defs","transform","stop","animate","radialGradient","linearGradient","animateMotion","use","filter","feColorMatrix"],SVG_TYPE_G:["svg","rect","circle","path","polygon","text","g","line","foreignObject"],PI:Math.PI,TwoPI:2*Math.PI,pi90:.5*Math.PI,pi60:Math.PI/3,torad:Math.PI/180,todeg:180/Math.PI,clamp:function(t,i,s){return t=(t=t<i?i:t)>s?s:t},size:{w:240,h:20,p:30,s:20},cloneColor:function(){return Object.assign({},s.colors)},cloneCss:function(){return Object.assign({},s.css)},colors:{text:"#C0C0C0",textOver:"#FFFFFF",txtselectbg:"none",background:"rgba(44,44,44,0.3)",backgroundOver:"rgba(11,11,11,0.5)",inputBorder:"#454545",inputHolder:"#808080",inputBorderSelect:"#005AAA",inputBg:"rgba(0,0,0,0.1)",inputOver:"rgba(0,0,0,0.2)",border:"#454545",borderOver:"#5050AA",borderSelect:"#308AFF",scrollback:"rgba(44,44,44,0.2)",scrollbackover:"rgba(44,44,44,0.2)",button:"#404040",boolbg:"#181818",boolon:"#C0C0C0",select:"#308AFF",moving:"#03afff",down:"#024699",over:"#024699",action:"#FF3300",stroke:"rgba(11,11,11,0.5)",scroll:"#333333",hide:"rgba(0,0,0,0)",groupBorder:"none",buttonBorder:"none"},css:{basic:"position:absolute; pointer-events:none; box-sizing:border-box; margin:0; padding:0; overflow:hidden; -o-user-select:none; -ms-user-select:none; -khtml-user-select:none; -webkit-user-select:none; -moz-user-select:none;",button:"display:flex; justify-content:center; align-items:center; text-align:center;"},svgs:{group:"M 7 7 L 7 8 8 8 8 7 7 7 M 5 7 L 5 8 6 8 6 7 5 7 M 3 7 L 3 8 4 8 4 7 3 7 M 7 5 L 7 6 8 6 8 5 7 5 M 6 6 L 6 5 5 5 5 6 6 6 M 7 3 L 7 4 8 4 8 3 7 3 M 6 4 L 6 3 5 3 5 4 6 4 M 3 5 L 3 6 4 6 4 5 3 5 M 3 3 L 3 4 4 4 4 3 3 3 Z",arrow:"M 3 8 L 8 5 3 2 3 8 Z",arrowDown:"M 5 8 L 8 3 2 3 5 8 Z",arrowUp:"M 5 2 L 2 7 8 7 5 2 Z",solid:"M 13 10 L 13 1 4 1 1 4 1 13 10 13 13 10 M 11 3 L 11 9 9 11 3 11 3 5 5 3 11 3 Z",body:"M 13 10 L 13 1 4 1 1 4 1 13 10 13 13 10 M 11 3 L 11 9 9 11 3 11 3 5 5 3 11 3 M 5 4 L 4 5 4 10 9 10 10 9 10 4 5 4 Z",vehicle:"M 13 6 L 11 1 3 1 1 6 1 13 3 13 3 11 11 11 11 13 13 13 13 6 M 2.4 6 L 4 2 10 2 11.6 6 2.4 6 M 12 8 L 12 10 10 10 10 8 12 8 M 4 8 L 4 10 2 10 2 8 4 8 Z",articulation:"M 13 9 L 12 9 9 2 9 1 5 1 5 2 2 9 1 9 1 13 5 13 5 9 4 9 6 5 8 5 10 9 9 9 9 13 13 13 13 9 Z",character:"M 13 4 L 12 3 9 4 5 4 2 3 1 4 5 6 5 8 4 13 6 13 7 9 8 13 10 13 9 8 9 6 13 4 M 6 1 L 6 3 8 3 8 1 6 1 Z",terrain:"M 13 8 L 12 7 Q 9.06 -3.67 5.95 4.85 4.04 3.27 2 7 L 1 8 7 13 13 8 M 3 8 Q 3.78 5.420 5.4 6.6 5.20 7.25 5 8 L 7 8 Q 8.39 -0.16 11 8 L 7 11 3 8 Z",joint:"M 7.7 7.7 Q 8 7.45 8 7 8 6.6 7.7 6.3 7.45 6 7 6 6.6 6 6.3 6.3 6 6.6 6 7 6 7.45 6.3 7.7 6.6 8 7 8 7.45 8 7.7 7.7 M 3.35 8.65 L 1 11 3 13 5.35 10.65 Q 6.1 11 7 11 8.28 11 9.25 10.25 L 7.8 8.8 Q 7.45 9 7 9 6.15 9 5.55 8.4 5 7.85 5 7 5 6.54 5.15 6.15 L 3.7 4.7 Q 3 5.712 3 7 3 7.9 3.35 8.65 M 10.25 9.25 Q 11 8.28 11 7 11 6.1 10.65 5.35 L 13 3 11 1 8.65 3.35 Q 7.9 3 7 3 5.7 3 4.7 3.7 L 6.15 5.15 Q 6.54 5 7 5 7.85 5 8.4 5.55 9 6.15 9 7 9 7.45 8.8 7.8 L 10.25 9.25 Z",ray:"M 9 11 L 5 11 5 12 9 12 9 11 M 12 5 L 11 5 11 9 12 9 12 5 M 11.5 10 Q 10.9 10 10.45 10.45 10 10.9 10 11.5 10 12.2 10.45 12.55 10.9 13 11.5 13 12.2 13 12.55 12.55 13 12.2 13 11.5 13 10.9 12.55 10.45 12.2 10 11.5 10 M 9 10 L 10 9 2 1 1 2 9 10 Z",collision:"M 11 12 L 13 10 10 7 13 4 11 2 7.5 5.5 9 7 7.5 8.5 11 12 M 3 2 L 1 4 4 7 1 10 3 12 8 7 3 2 Z",map:"M 13 1 L 1 1 1 13 13 13 13 1 M 12 2 L 12 7 7 7 7 12 2 12 2 7 7 7 7 2 12 2 Z",material:"M 13 1 L 1 1 1 13 13 13 13 1 M 12 2 L 12 7 7 7 7 12 2 12 2 7 7 7 7 2 12 2 Z",texture:"M 13 4 L 13 1 1 1 1 4 5 4 5 13 9 13 9 4 13 4 Z",object:"M 10 1 L 7 4 4 1 1 1 1 13 4 13 4 5 7 8 10 5 10 13 13 13 13 1 10 1 Z",none:"M 9 5 L 5 5 5 9 9 9 9 5 Z",cursor:"M 4 7 L 1 10 1 12 2 13 4 13 7 10 9 14 14 0 0 5 4 7 Z"},setText:function(t,i,e,o,n,h){t=t||13,i=i||"#CCC",e=e||"Consolas,monaco,monospace;",n=n||s.colors,h=h||s.css,n.text=i,h.txt=h.basic+"font-family:"+e+"; font-size:"+t+"px; color:"+i+"; padding:2px 10px; left:0; top:2px; height:16px; width:100px; overflow:hidden; white-space: nowrap;",o&&(h.txt+=" text-shadow:"+o+"; "),h.txtselect=h.txt+"display:flex; justify-content:left; align-items:center; text-align:left;padding:2px 5px; border:1px dashed "+n.border+"; background:"+n.txtselectbg+";",h.item=h.txt+"position:relative; background:rgba(0,0,0,0.2); margin-bottom:1px;"},clone:function(t){return t.cloneNode(!0)},setSvg:function(t,i,s,e,o){-1===e?t.setAttributeNS(null,i,s):void 0!==o?t.childNodes[e||0].childNodes[o||0].setAttributeNS(null,i,s):t.childNodes[e||0].setAttributeNS(null,i,s)},setCss:function(t,i){for(var e in i)-1!==s.DOM_SIZE.indexOf(e)?t.style[e]=i[e]+"px":t.style[e]=i[e]},set:function(t,i){for(var e in i)"txt"===e&&(t.textContent=i[e]),"link"===e?t.setAttributeNS(s.links,"xlink:href",i[e]):t.setAttributeNS(null,e,i[e])},get:function(t,i){if(void 0===i)return t;if(!isNaN(i))return t.childNodes[i];if(i instanceof Array){if(2===i.length)return t.childNodes[i[0]].childNodes[i[1]];if(3===i.length)return t.childNodes[i[0]].childNodes[i[1]].childNodes[i[2]]}},dom:function(t,i,e,o,n){return t=t||"div",-1!==s.SVG_TYPE_D.indexOf(t)||-1!==s.SVG_TYPE_G.indexOf(t)?"svg"===t?(o=document.createElementNS(s.svgns,"svg"),s.set(o,e)):(void 0===o&&(o=document.createElementNS(s.svgns,"svg")),s.addAttributes(o,t,e,n)):o=void 0===o?document.createElementNS(s.htmls,t):o.appendChild(document.createElementNS(s.htmls,t)),i&&(o.style.cssText=i),void 0===n?o:o.childNodes[n||0]},addAttributes:function(t,i,e,o){var n=document.createElementNS(s.svgns,i);return s.set(n,e),s.get(t,o).appendChild(n),-1!==s.SVG_TYPE_G.indexOf(i)&&(n.style.pointerEvents="none"),n},clear:function(t){for(s.purge(t);t.firstChild;)t.firstChild.firstChild&&s.clear(t.firstChild),t.removeChild(t.firstChild)},purge:function(t){var i,e,o=t.attributes;if(o)for(i=o.length;i--;)"function"==typeof t[e=o[i].name]&&(t[e]=null);if(o=t.childNodes)for(i=o.length;i--;)s.purge(t.childNodes[i])},ColorLuma:function(t,i){"n"===t&&(t="#000"),(t=String(t).replace(/[^0-9a-f]/gi,"")).length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),i=i||0;var s,e,o="#";for(e=0;e<3;e++)s=parseInt(t.substr(2*e,2),16),o+=("00"+(s=Math.round(Math.min(Math.max(0,s+s*i),255)).toString(16))).substr(s.length);return o},findDeepInver:function(t){return.3*t[0]+.59*t[1]+.11*t[2]<=.6},hexToHtml:function(t){return"#"+("000000"+(t=void 0===t?0:t).toString(16)).substr(-6)},htmlToHex:function(t){return t.toUpperCase().replace("#","0x")},u255:function(t,i){return parseInt(t.substring(i,i+2),16)/255},u16:function(t,i){return parseInt(t.substring(i,i+1),16)/15},unpack:function(t){return 7==t.length?[s.u255(t,1),s.u255(t,3),s.u255(t,5)]:4==t.length?[s.u16(t,1),s.u16(t,2),s.u16(t,3)]:void 0},htmlRgb:function(t){return"rgb("+Math.round(255*t[0])+","+Math.round(255*t[1])+","+Math.round(255*t[2])+")"},pad:function(t){return 1==t.length&&(t="0"+t),t},rgbToHex:function(t){var i=Math.round(255*t[0]).toString(16),e=Math.round(255*t[1]).toString(16),o=Math.round(255*t[2]).toString(16);return"#"+s.pad(i)+s.pad(e)+s.pad(o)},hueToRgb:function(t,i,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+6*(i-t)*s:s<.5?i:s<2/3?t+6*(i-t)*(2/3-s):t},rgbToHsl:function(t){var i=t[0],s=t[1],e=t[2],o=Math.min(i,s,e),n=Math.max(i,s,e),h=n-o,r=0,a=0,l=(o+n)/2;return l>0&&l<1&&(a=h/(l<.5?2*l:2-2*l)),h>0&&(n==i&&n!=s&&(r+=(s-e)/h),n==s&&n!=e&&(r+=2+(e-i)/h),n==e&&n!=i&&(r+=4+(i-s)/h),r/=6),[r,a,l]},hslToRgb:function(t){var i,e,o=t[0],n=t[1],h=t[2];return 0===n?[h,h,h]:(i=2*h-(e=h<=.5?h*(n+1):h+n-h*n),[s.hueToRgb(i,e,o+.33333),s.hueToRgb(i,e,o),s.hueToRgb(i,e,o-.33333)])},makeGradiant:function(t,i,e,o){s.dom(t,null,i,e,0);for(var n,h=e.childNodes[0].childNodes.length-1,r=0;r<o.length;r++)n=o[r],s.dom("stop",null,{offset:n[0]+"%","stop-color":n[1],"stop-opacity":n[2]},e,[0,h])},makeKnob:function(t){var i=128,e=s.dom("svg",s.css.basic,{viewBox:"0 0 128 "+i,width:i,height:i,preserveAspectRatio:"none"});s.dom("circle","",{cx:64,cy:64,r:34,fill:s.colors.button,stroke:"rgba(0,0,0,0.3)","stroke-width":8},e),s.dom("path","",{d:"",stroke:s.colors.text,"stroke-width":4,fill:"none","stroke-linecap":"round"},e),s.dom("circle","",{cx:64,cy:64,r:41,stroke:"rgba(0,0,0,0.1)","stroke-width":7,fill:"none"},e),s.dom("path","",{d:"",stroke:"rgba(255,255,255,0.3)","stroke-width":2,fill:"none","stroke-linecap":"round","stroke-opacity":.5},e),s.knob=e},makeCircular:function(t){var i=128,e=s.dom("svg",s.css.basic,{viewBox:"0 0 128 "+i,width:i,height:i,preserveAspectRatio:"none"});s.dom("circle","",{cx:64,cy:64,r:40,stroke:"rgba(0,0,0,0.1)","stroke-width":10,fill:"none"},e),s.dom("path","",{d:"",stroke:s.colors.text,"stroke-width":7,fill:"none","stroke-linecap":"butt"},e),s.circular=e},makeJoystick:function(t){var i,e=128,o=Math.floor(49),n=Math.floor(.6*o),h=s.dom("svg",s.css.basic,{viewBox:"0 0 128 "+e,width:e,height:e,preserveAspectRatio:"none"});if(s.dom("defs",null,{},h),s.dom("g",null,{},h),0===t){i=[[40,"rgb(0,0,0)",.3],[80,"rgb(0,0,0)",0],[90,"rgb(50,50,50)",.4],[100,"rgb(50,50,50)",0]],s.makeGradiant("radialGradient",{id:"grad",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},h,i),i=[[60,"rgb(0,0,0)",.5],[100,"rgb(0,0,0)",0]],s.makeGradiant("radialGradient",{id:"gradS",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},h,i);var r=["rgb(40,40,40)","rgb(48,48,48)","rgb(30,30,30)"],a=["rgb(1,90,197)","rgb(3,95,207)","rgb(0,65,167)"];i=[[30,r[0],1],[60,r[1],1],[80,r[1],1],[100,r[2],1]],s.makeGradiant("radialGradient",{id:"gradIn",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},h,i),i=[[30,a[0],1],[60,a[1],1],[80,a[1],1],[100,a[2],1]],s.makeGradiant("radialGradient",{id:"gradIn2",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},h,i),s.dom("circle","",{cx:64,cy:64,r:o,fill:"url(#grad)"},h),s.dom("circle","",{cx:69,cy:74,r:n+10,fill:"url(#gradS)"},h),s.dom("circle","",{cx:64,cy:64,r:n,fill:"url(#gradIn)"},h),s.joystick_0=h}else i=[[69,"rgb(0,0,0)",0],[70,"rgb(0,0,0)",.3],[100,"rgb(0,0,0)",0]],s.makeGradiant("radialGradient",{id:"gradX",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},h,i),s.dom("circle","",{cx:64,cy:64,r:o,fill:"none",stroke:"rgba(100,100,100,0.25)","stroke-width":"4"},h),s.dom("circle","",{cx:64,cy:64,r:n+14,fill:"url(#gradX)"},h),s.dom("circle","",{cx:64,cy:64,r:n,fill:"none",stroke:"rgb(100,100,100)","stroke-width":"4"},h),s.joystick_1=h},makeColorRing:function(){var t=256,i=s.dom("svg",s.css.basic,{viewBox:"0 0 256 "+t,width:t,height:t,preserveAspectRatio:"none"});s.dom("defs",null,{},i),s.dom("g",null,{},i);var e,o,n,h,r,a,l,c,u,d=128,p=8/113/24*Math.PI,f=0,v=[];for(a=0;a<=24;++a){if(e=.5*(f+(h=(n=a/24)*s.TwoPI)),o=1/Math.cos(.5*(h-f)),r=[Math.sin(f),-Math.cos(f),Math.sin(e)*o,-Math.cos(e)*o,Math.sin(h),-Math.cos(h)],v[1]=s.rgbToHex(s.hslToRgb([n,1,.5])),a>0){for(l=6;l--;)r[l]=(113*r[l]+d).toFixed(2);c=" M"+r[0]+" "+r[1]+" Q"+r[2]+" "+r[3]+" "+r[4]+" "+r[5],u=[[0,v[0],1],[100,v[1],1]],s.makeGradiant("linearGradient",{id:"G"+a,x1:r[0],y1:r[1],x2:r[4],y2:r[5],gradientUnits:"userSpaceOnUse"},i,u),s.dom("path","",{d:c,"stroke-width":30,stroke:"url(#G"+a+")","stroke-linecap":"butt"},i,1)}f=h-p,v[0]=v[1]}u=[[0,"#FFFFFF",1],[50,"#FFFFFF",0],[50,"#000000",0],[100,"#000000",1]],s.makeGradiant("linearGradient",{id:"GL0",x1:0,y1:d-84.9,x2:0,y2:212.9,gradientUnits:"userSpaceOnUse"},i,u),u=[[0,"#7f7f7f",1],[50,"#7f7f7f",.5],[100,"#7f7f7f",0]],s.makeGradiant("linearGradient",{id:"GL1",x1:78.95,y1:0,x2:226,y2:0,gradientUnits:"userSpaceOnUse"},i,u),s.dom("g",null,{"transform-origin":"128px 128px",transform:"rotate(0)"},i),s.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"red"},i,2),s.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"url(#GL1)","stroke-width":1,stroke:"url(#GL1)"},i,2),s.dom("polygon","",{points:"78.95 43.1 78.95 212.85 226 128",fill:"url(#GL0)","stroke-width":1,stroke:"url(#GL0)"},i,2),s.dom("path","",{d:"M 255.75 136.5 Q 256 132.3 256 128 256 123.7 255.75 119.5 L 241 128 255.75 136.5 Z",fill:"none","stroke-width":2,stroke:"#000"},i,2),s.dom("circle","",{cx:128,cy:128,r:6,"stroke-width":2,stroke:"#000",fill:"none"},i),s.colorRing=i},icon:function(t,i,e){e=e||40,i=i||"#DEDEDE";var o=["<svg xmlns='"+s.svgns+"' version='1.1' xmlns:xlink='"+s.htmls+"' style='pointer-events:none;' preserveAspectRatio='xMinYMax meet' x='0px' y='0px' width='"+e+"px' height='"+e+"px' viewBox='0 0 256 256'><g>"];switch(t){case"logo":o[1]="<path id='logoin' fill='"+i+"' stroke='none' d='"+s.logoFill_d+"'/>";break;case"save":o[1]="<path stroke='"+i+"' stroke-width='4' stroke-linejoin='round' stroke-linecap='round' fill='none' d='M 26.125 17 L 20 22.95 14.05 17 M 20 9.95 L 20 22.95'/><path stroke='"+i+"' stroke-width='2.5' stroke-linejoin='round' stroke-linecap='round' fill='none' d='M 32.6 23 L 32.6 25.5 Q 32.6 28.5 29.6 28.5 L 10.6 28.5 Q 7.6 28.5 7.6 25.5 L 7.6 23'/>"}return o[2]="</g></svg>",o.join("\n")},logoFill_d:["M 171 150.75 L 171 33.25 155.5 33.25 155.5 150.75 Q 155.5 162.2 147.45 170.2 139.45 178.25 128 178.25 116.6 178.25 108.55 170.2 100.5 162.2 100.5 150.75 ","L 100.5 33.25 85 33.25 85 150.75 Q 85 168.65 97.55 181.15 110.15 193.75 128 193.75 145.9 193.75 158.4 181.15 171 168.65 171 150.75 ","M 200 33.25 L 184 33.25 184 150.8 Q 184 174.1 167.6 190.4 151.3 206.8 128 206.8 104.75 206.8 88.3 190.4 72 174.1 72 150.8 L 72 33.25 56 33.25 56 150.75 ","Q 56 180.55 77.05 201.6 98.2 222.75 128 222.75 157.8 222.75 178.9 201.6 200 180.55 200 150.75 L 200 33.25 Z"].join("\n")};s.setText();var e=s,o={ui:[],ID:null,lock:!1,wlock:!1,current:-1,needReZone:!0,isEventsInit:!1,prevDefault:["contextmenu","mousedown","mousemove","mouseup"],xmlserializer:new XMLSerializer,tmpTime:null,tmpImage:null,oldCursor:"auto",input:null,parent:null,firstImput:!0,hiddenImput:null,hiddenSizer:null,hasFocus:!1,startInput:!1,inputRange:[0,0],cursorId:0,str:"",pos:0,startX:-1,moveX:-1,debugInput:!1,isLoop:!1,listens:[],e:{type:null,clientX:0,clientY:0,keyCode:NaN,key:null,delta:0},isMobile:!1,add:function(t){o.ui.push(t),o.getZone(t),o.isEventsInit||o.initEvents()},testMobile:function(){var t=navigator.userAgent;return!!(t.match(/Android/i)||t.match(/webOS/i)||t.match(/iPhone/i)||t.match(/iPad/i)||t.match(/iPod/i)||t.match(/BlackBerry/i)||t.match(/Windows Phone/i))},remove:function(t){var i=o.ui.indexOf(t);-1!==i&&(o.removeListen(t),o.ui.splice(i,1)),0===o.ui.length&&o.removeEvents()},initEvents:function(){if(!o.isEventsInit){var t=document.body;o.isMobile=o.testMobile(),o.isMobile?(t.addEventListener("touchstart",o,!1),t.addEventListener("touchend",o,!1),t.addEventListener("touchmove",o,!1)):(t.addEventListener("mousedown",o,!1),t.addEventListener("contextmenu",o,!1),t.addEventListener("wheel",o,!1),document.addEventListener("mousemove",o,!1),document.addEventListener("mouseup",o,!1)),window.addEventListener("keydown",o,!1),window.addEventListener("keyup",o,!1),window.addEventListener("resize",o.resize,!1),o.isEventsInit=!0}},removeEvents:function(){if(o.isEventsInit){var t=document.body;o.isMobile?(t.removeEventListener("touchstart",o,!1),t.removeEventListener("touchend",o,!1),t.removeEventListener("touchmove",o,!1)):(t.removeEventListener("mousedown",o,!1),t.removeEventListener("contextmenu",o,!1),t.removeEventListener("wheel",o,!1),document.removeEventListener("mousemove",o,!1),document.removeEventListener("mouseup",o,!1)),window.removeEventListener("keydown",o),window.removeEventListener("keyup",o),window.removeEventListener("resize",o.resize),o.isEventsInit=!1}},resize:function(){o.needReZone=!0;for(var t,i=o.ui.length;i--;)(t=o.ui[i]).isGui&&!t.isCanvasOnly&&t.autoResize&&t.setHeight()},handleEvent:function(t){if(-1!==t.type.indexOf(o.prevDefault)&&t.preventDefault(),"contextmenu"!==t.type){o.findZone();var i=o.e;"keydown"===t.type&&o.keydown(t),"keyup"===t.type&&o.keyup(t),"wheel"===t.type?i.delta=t.deltaY>0?1:-1:i.delta=0,i.clientX=t.clientX||0,i.clientY=t.clientY||0,i.type=t.type,o.isMobile&&(t.touches&&t.touches.length>0&&(i.clientX=t.touches[0].clientX||0,i.clientY=t.touches[0].clientY||0),"touchstart"===t.type&&(i.type="mousedown"),"touchend"===t.type&&(i.type="mouseup"),"touchmove"===t.type&&(i.type="mousemove")),"mousedown"===i.type&&(o.lock=!0),"mouseup"===i.type&&(o.lock=!1),o.isMobile&&"mousedown"===i.type&&o.findID(i),"mousemove"!==i.type||o.lock||o.findID(i),null!==o.ID&&(o.ID.isCanvasOnly&&(i.clientX=o.ID.mouse.x,i.clientY=o.ID.mouse.y),o.ID.handleEvent(i)),o.isMobile&&"mouseup"===i.type&&o.clearOldID()}},findID:function(t){for(var i,s,e,n=o.ui.length,h=-1;n--;)if((i=o.ui[n]).isCanvasOnly?(s=i.mouse.x,e=i.mouse.y):(s=t.clientX,e=t.clientY),o.onZone(i,s,e)){(h=n)!==o.current&&(o.clearOldID(),o.current=h,o.ID=i);break}-1===h&&o.clearOldID()},clearOldID:function(){o.ID&&(o.current=-1,o.ID.reset(),o.ID=null,o.cursor())},calcUis:function(t,i,s){var e,o,n=t.length,h=0,r=0;for(o=0;o<n;o++)(e=t[o]).zone.w=e.w,e.zone.h=e.h,e.autoWidth?(e.zone.x=i.x,e.zone.y=s,s+=e.h+1):(0===h&&(s+=e.h+1),e.zone.x=i.x+h,e.zone.y=0===h?s-e.h:r,r=e.zone.y,(h+=e.w)+e.w>i.w&&(h=0)),e.isGroup&&e.calcUis()},findTarget:function(t,i){for(var s=t.length;s--;)if(o.onZone(t[s],i.clientX,i.clientY))return s;return-1},findZone:function(t){if(o.needReZone||t){for(var i,s=o.ui.length;s--;)i=o.ui[s],o.getZone(i),i.isGui&&i.calcUis();o.needReZone=!1}},onZone:function(t,i,s){if(void 0===i||void 0===s)return!1;var e=t.zone,o=i-e.x,n=s-e.y,h=o>=0&&n>=0&&o<=e.w&&n<=e.h;return h?t.local.set(o,n):t.local.neg(),h},getZone:function(t){if(!t.isCanvasOnly){var i=t.getDom().getBoundingClientRect();t.zone={x:i.left,y:i.top,w:i.width,h:i.height}}},cursor:function(t){(t=t||"auto")!==o.oldCursor&&(document.body.style.cursor=t,o.oldCursor=t)},toCanvas:function(t,i,s,e){if(e&&null!==o.tmpTime&&(clearTimeout(o.tmpTime),o.tmpTime=null),null===o.tmpTime){o.lock&&(o.tmpTime=setTimeout((function(){o.tmpTime=null}),10));var n=!1;i===t.canvas.width&&s===t.canvas.height||(n=!0),null===o.tmpImage&&(o.tmpImage=new Image);var h=o.tmpImage,r=o.xmlserializer.serializeToString(t.content),a='<svg xmlns="http://www.w3.org/2000/svg" width="'+i+'" height="'+s+'"><foreignObject style="pointer-events: none; left:0;" width="100%" height="100%">'+r+"</foreignObject></svg>";h.onload=function(){var e=t.canvas.getContext("2d");n?(t.canvas.width=i,t.canvas.height=s):e.clearRect(0,0,i,s),e.drawImage(this,0,0),t.onDraw()},h.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a),h.crossOrigin=""}},setHidden:function(){if(null===o.hiddenImput){var t=o.debugInput?"":"opacity:0; zIndex:0;",i=o.parent.css.txt+"padding:0; width:auto; height:auto; text-shadow:none;";i+="left:10px; top:auto; border:none; color:#FFF; background:#000;"+t,o.hiddenImput=document.createElement("input"),o.hiddenImput.type="text",o.hiddenImput.style.cssText=i+"bottom:30px;"+(o.debugInput?"":"transform:scale(0);"),o.hiddenSizer=document.createElement("div"),o.hiddenSizer.style.cssText=i+"bottom:60px;",document.body.appendChild(o.hiddenImput),document.body.appendChild(o.hiddenSizer)}o.hiddenImput.style.width=o.input.clientWidth+"px",o.hiddenImput.value=o.str,o.hiddenSizer.innerHTML=o.str,o.hasFocus=!0},clearHidden:function(t){null!==o.hiddenImput&&(o.hasFocus=!1)},clickPos:function(t){for(var i=o.str.length,s=0,e=0;i--&&!((s+=o.textWidth(o.str[e]))>=t);)e++;return e},upInput:function(t,i){if(null===o.parent)return!1;var s=!1;if(i){var e=o.clickPos(t);if(o.moveX=e,-1===o.startX)o.startX=e,o.cursorId=e,o.inputRange=[o.startX,o.startX];else o.moveX!==o.startX&&(o.startX>o.moveX?o.inputRange=[o.moveX,o.startX]:o.inputRange=[o.startX,o.moveX]);s=!0}else-1!==o.startX&&(o.hasFocus=!0,o.hiddenImput.focus(),o.hiddenImput.selectionStart=o.inputRange[0],o.hiddenImput.selectionEnd=o.inputRange[1],o.startX=-1,s=!0);return s&&o.selectParent(),s},selectParent:function(){var t=o.textWidth(o.str.substring(0,o.cursorId)),i=o.textWidth(o.str.substring(0,o.inputRange[0])),s=o.textWidth(o.str.substring(o.inputRange[0],o.inputRange[1]));o.parent.select(t,i,s)},textWidth:function(t){return null===o.hiddenSizer?0:(t=t.replace(/ /g,"&nbsp;"),o.hiddenSizer.innerHTML=t,o.hiddenSizer.clientWidth)},clearInput:function(){null!==o.parent&&(o.firstImput||o.parent.validate(!0),o.clearHidden(),o.parent.unselect(),o.input.style.background=o.parent.colors.inputBg,o.input.style.borderColor=o.parent.colors.inputBorder,o.parent.isEdit=!1,o.input=null,o.parent=null,o.str="",o.firstImput=!0)},setInput:function(t,i){o.clearInput(),o.input=t,o.parent=i,o.input.style.background=o.parent.colors.inputOver,o.input.style.borderColor=o.parent.colors.inputBorderSelect,o.str=o.input.textContent,o.setHidden()},keydown:function(t){if(null!==o.parent){var i=t.which;t.shiftKey,o.firstImput=!1,o.hasFocus&&(window.focus(),o.hiddenImput.focus()),o.parent.isEdit=!0,13===i?o.clearInput():o.input.isNum?t.keyCode>47&&t.keyCode<58||t.keyCode>95&&t.keyCode<106||190===t.keyCode||110===t.keyCode||8===t.keyCode||109===t.keyCode?o.hiddenImput.readOnly=!1:o.hiddenImput.readOnly=!0:o.hiddenImput.readOnly=!1}},keyup:function(t){null!==o.parent&&(o.str=o.hiddenImput.value,o.parent.allEqual?o.parent.sameStr(o.str):o.input.textContent=o.str,o.cursorId=o.hiddenImput.selectionStart,o.inputRange=[o.hiddenImput.selectionStart,o.hiddenImput.selectionEnd],o.selectParent(),o.parent.validate())},loop:function(){o.isLoop&&requestAnimationFrame(o.loop),o.update()},update:function(){for(var t=o.listens.length;t--;)o.listens[t].listening()},removeListen:function(t){var i=o.listens.indexOf(t);-1!==i&&o.listens.splice(i,1),0===o.listens.length&&(o.isLoop=!1)},addListen:function(t){-1===o.listens.indexOf(t)&&(o.listens.push(t),o.isLoop||(o.isLoop=!0,o.loop()))}},n=o;function h(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,r(t,i)}function r(t,i){return(r=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}var a=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}var i=t.prototype;return i.set=function(t,i){return this.x=t,this.y=i,this},i.divide=function(t){return this.x/=t.x,this.y/=t.y,this},i.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},i.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},i.divideScalar=function(t){return this.multiplyScalar(1/t)},i.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.angle=function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},i.addScalar=function(t){return this.x+=t,this.y+=t,this},i.negate=function(){return this.x*=-1,this.y*=-1,this},i.neg=function(){return this.x=-1,this.y=-1,this},i.isZero=function(){return 0===this.x&&0===this.y},i.copy=function(t){return this.x=t.x,this.y=t.y,this},i.equals=function(t){return t.x===this.x&&t.y===this.y},i.nearEquals=function(t,i){return t.x.toFixed(i)===this.x.toFixed(i)&&t.y.toFixed(i)===this.y.toFixed(i)},i.lerp=function(t,i){return null===t?(this.x-=this.x*i,this.y-=this.y*i):(this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i),this},t}(),l=function(){function t(t){if(void 0===t&&(t={}),this.main=t.main||null,this.isUI=t.isUI||!1,this.parentGroup=null,this.css=this.main?this.main.css:e.css,this.colors=this.main?this.main.colors:e.colors,this.defaultBorderColor=this.colors.border,this.svgs=e.svgs,this.isEmpty=t.isEmpty||!1,this.zone={x:0,y:0,w:0,h:0},this.local=(new a).neg(),this.isCanvasOnly=!1,this.isSelect=!1,this.p=void 0!==t.p?t.p:e.size.p,this.w=this.isUI?this.main.size.w:e.size.w,void 0!==t.w&&(this.w=t.w),this.h=this.isUI?this.main.size.h:e.size.h,void 0!==t.h&&(this.h=t.h),this.isEmpty||(this.h=this.h<11?11:this.h),this.autoWidth=t.auto||!0,this.isOpen=!1,this.radius=t.radius||0,this.isNumber=!1,this.noNeg=t.noNeg||!1,this.allEqual=t.allEqual||!1,this.mono=!1,this.isEdit=!1,this.simple=t.simple||!1,this.simple&&(this.sa=0),this.setSize(this.w),void 0!==t.sa&&(this.sa=t.sa),void 0!==t.sb&&(this.sb=t.sb),this.simple&&(this.sb=this.w-this.sa),this.sc=void 0===t.sc?47:t.sc,this.objectLink=null,this.isSend=!1,this.val=null,this.bg=this.colors.background,this.bgOver=this.colors.backgroundOver,void 0!==t.bg&&(this.bg=t.bg,this.bgOver=t.bg),void 0!==t.bgOver&&(this.bgOver=t.bgOver),this.titleColor=t.titleColor||this.colors.text,this.fontColor=t.fontColor||this.colors.text,this.fontSelect=t.fontSelect||this.colors.textOver,void 0!==t.color&&(this.fontColor=t.color),this.colorPlus=e.ColorLuma(this.fontColor,.3),this.txt=t.name||"Proto",this.rename=t.rename||"",this.target=t.target||null,this.callback=void 0===t.callback?null:t.callback,this.endCallback=null,null===this.callback&&this.isUI&&null!==this.main.callback&&(this.callback=this.main.callback),this.c=[],this.s=[],this.c[0]=e.dom("div",this.css.basic+"position:relative; height:20px; float:left; overflow:hidden;"),this.s[0]=this.c[0].style,this.isUI&&(this.s[0].marginBottom="1px"),this.simple||(this.c[1]=e.dom("div",this.css.txt),this.s[1]=this.c[1].style,this.c[1].textContent=""===this.rename?this.txt:this.rename,this.s[1].color=this.titleColor),t.pos){for(var i in this.s[0].position="absolute",t.pos)this.s[0][i]=t.pos[i];this.mono=!0}t.css&&(this.s[0].cssText=t.css)}var i=t.prototype;return i.init=function(){this.zone.h=this.h;var t=this.s,i=this.c;t[0].height=this.h+"px",this.isUI&&(t[0].background=this.bg),this.isEmpty&&(t[0].background="none"),void 0!==i[1]&&this.autoWidth&&(t[1]=i[1].style,t[1].height=this.h-4+"px",t[1].lineHeight=this.h-8+"px");for(var s=e.frag,o=1,h=i.length;o!==h;o++)void 0!==i[o]&&(s.appendChild(i[o]),t[o]=i[o].style);null!==this.target?this.target.appendChild(i[0]):this.isUI?this.main.inner.appendChild(i[0]):document.body.appendChild(i[0]),i[0].appendChild(s),this.rSize(),this.isUI||(this.c[0].style.pointerEvents="auto",n.add(this))},i.dom=function(t,i,s,o,n){return e.dom(t,i,s,o,n)},i.setSvg=function(t,i,s,o,n){e.setSvg(t,i,s,o,n)},i.setCss=function(t,i){e.setCss(t,i)},i.clamp=function(t,i,s){return e.clamp(t,i,s)},i.getColorRing=function(){return e.colorRing||e.makeColorRing(),e.clone(e.colorRing)},i.getJoystick=function(t){return e["joystick_"+t]||e.makeJoystick(t),e.clone(e["joystick_"+t])},i.getCircular=function(t){return e.circular||e.makeCircular(t),e.clone(e.circular)},i.getKnob=function(t){return e.knob||e.makeKnob(t),e.clone(e.knob)},i.cursor=function(t){n.cursor(t)},i.update=function(){},i.reset=function(){},i.getDom=function(){return this.c[0]},i.uiout=function(){this.isEmpty||this.s&&(this.s[0].background=this.bg)},i.uiover=function(){this.isEmpty||this.s&&(this.s[0].background=this.bgOver)},i.rename=function(t){void 0!==this.c[1]&&(this.c[1].textContent=t)},i.listen=function(){return n.addListen(this),this},i.listening=function(){null!==this.objectLink&&(this.isSend||this.isEdit||this.setValue(this.objectLink[this.val]))},i.setValue=function(t){this.isNumber?this.value=this.numValue(t):this.value=t,this.update()},i.onChange=function(t){if(!this.isEmpty)return this.callback=t||null,this},i.onFinishChange=function(t){if(!this.isEmpty)return this.callback=null,this.endCallback=t,this},i.send=function(t){(t=t||this.value)instanceof Array&&1===t.length&&(t=t[0]),this.isSend=!0,null!==this.objectLink&&(this.objectLink[this.val]=t),this.callback&&this.callback(t,this.val),this.isSend=!1},i.sendEnd=function(t){(t=t||this.value)instanceof Array&&1===t.length&&(t=t[0]),this.endCallback&&this.endCallback(t),null!==this.objectLink&&(this.objectLink[this.val]=t)},i.clear=function(){e.clear(this.c[0]),null!==this.target?this.target.removeChild(this.c[0]):this.isUI?this.main.clearOne(this):document.body.removeChild(this.c[0]),this.isUI||n.remove(this),this.c=null,this.s=null,this.callback=null,this.target=null},i.setSize=function(t){if(this.autoWidth)if(this.w=t,this.simple)this.sb=this.w-this.sa;else{var i=this.w*(this.p/100);this.sa=Math.floor(i+10),this.sb=Math.floor(this.w-i-20)}},i.rSize=function(){this.autoWidth&&(this.s[0].width=this.w+"px",this.simple||(this.s[1].width=this.sa+"px"))},i.setTypeNumber=function(t){var i;switch(this.isNumber=!0,this.value=0,void 0!==t.value&&("string"==typeof t.value?this.value=1*t.value:this.value=t.value),this.min=void 0===t.min?-1/0:t.min,this.max=void 0===t.max?1/0:t.max,this.precision=void 0===t.precision?2:t.precision,this.precision){case 0:i=1;break;case 1:i=.1;break;case 2:i=.01;break;case 3:i=.001;break;case 4:i=1e-4;break;case 5:i=1e-5}this.step=void 0===t.step?i:t.step,this.range=this.max-this.min,this.value=this.numValue(this.value)},i.numValue=function(t){return this.noNeg&&(t=Math.abs(t)),1*Math.min(this.max,Math.max(this.min,t)).toFixed(this.precision)},i.handleEvent=function(t){if(!this.isEmpty)return this[t.type](t)},i.wheel=function(t){return!1},i.mousedown=function(t){return!1},i.mousemove=function(t){return!1},i.mouseup=function(t){return!1},i.keydown=function(t){return!1},i.keyup=function(t){return!1},i.setReferency=function(t,i){this.objectLink=t,this.val=i},i.display=function(t){t=t||!1,this.s[0].display=t?"block":"none"},i.open=function(){this.isOpen||(this.isOpen=!0)},i.close=function(){this.isOpen&&(this.isOpen=!1)},i.needZone=function(){n.needReZone=!0},i.rezone=function(){n.needReZone=!0},i.select=function(){},i.unselect=function(){},i.setInput=function(t){n.setInput(t,this)},i.upInput=function(t,i){return n.upInput(t,i)},i.selected=function(t){this.isSelect=t||!1},t}(),c=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).value=i.value||!1,s.buttonColor=i.bColor||s.colors.button,s.inh=i.inh||Math.floor(.8*s.h),s.inw=i.inw||36;var e=Math.floor(.5*s.h)-.5*(s.inh-2);return s.c[2]=s.dom("div",s.css.basic+"background:"+s.colors.boolbg+"; height:"+(s.inh-2)+"px; width:"+s.inw+"px; top:"+e+"px; border-radius:10px; border:2px solid "+s.boolbg),s.c[3]=s.dom("div",s.css.basic+"height:"+(s.inh-6)+"px; width:16px; top:"+(e+2)+"px; border-radius:10px; background:"+s.buttonColor+";"),s.init(),s.update(),s}h(i,t);var s=i.prototype;return s.mousemove=function(t){this.cursor("pointer")},s.mousedown=function(t){return this.value=!this.value,this.update(),this.send(),!0},s.update=function(){var t=this.s;this.value?(t[2].background=this.colors.boolon,t[2].borderColor=this.colors.boolon,t[3].marginLeft="17px"):(t[2].background=this.colors.boolbg,t[2].borderColor=this.colors.boolbg,t[3].marginLeft="2px")},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s,s=this.w-10-this.inw;i[2].left=s+"px",i[3].left=s+"px"},i}(l),u=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).value=!1,s.values=i.value||s.txt,"string"==typeof s.values&&(s.values=[s.values]),s.isDown=!1,s.cc=[s.colors.button,s.colors.select,s.colors.down],void 0!==i.cBg&&(s.cc[0]=i.cBg),void 0!==i.bColor&&(s.cc[0]=i.bColor),void 0!==i.cSelect&&(s.cc[1]=i.cSelect),void 0!==i.cDown&&(s.cc[2]=i.cDown),s.isLoadButton=i.loader||!1,s.isDragButton=i.drag||!1,s.isDragButton&&(s.isLoadButton=!0),s.lng=s.values.length,s.tmp=[],s.stat=[];for(var e=0;e<s.lng;e++)s.c[e+2]=s.dom("div",s.css.txt+s.css.button+"top:1px; background:"+s.cc[0]+"; height:"+(s.h-2)+"px; border:"+s.colors.buttonBorder+"; border-radius:"+s.radius+"px;"),s.c[e+2].style.color=s.fontColor,s.c[e+2].innerHTML=s.values[e],s.stat[e]=1;return void 0!==s.c[1]&&(s.c[1].textContent=""),s.isLoadButton&&s.initLoader(),s.isDragButton&&(s.lng++,s.initDrager()),s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";for(var s=this.lng,e=this.tmp;s--;)if(i.x>e[s][0]&&i.x<e[s][2])return s+2;return""},s.mouseup=function(t){return!!this.isDown&&(this.value=!1,this.isDown=!1,this.mousemove(t))},s.mousedown=function(t){var i=this.testZone(t);return!!i&&(this.isDown=!0,this.value=this.values[i-2],this.isLoadButton||this.send(),this.mousemove(t))},s.mousemove=function(t){var i=!1,s=this.testZone(t);return""!==s?(this.cursor("pointer"),i=this.modes(this.isDown?3:2,s)):i=this.reset(),i},s.modes=function(t,i){for(var s=!1,e=0;e<this.lng;e++)(e===i-2?this.mode(t,e+2):this.mode(1,e+2))&&(s=!0);return s},s.mode=function(t,i){var s=!1,e=i-2;if(this.stat[e]!==t){switch(t){case 1:this.stat[e]=1,this.s[e+2].color=this.fontColor,this.s[e+2].background=this.cc[0];break;case 2:this.stat[e]=2,this.s[e+2].color=this.fontSelect,this.s[e+2].background=this.cc[1];break;case 3:this.stat[e]=3,this.s[e+2].color=this.fontSelect,this.s[e+2].background=this.cc[2]}s=!0}return s},s.reset=function(){return this.cursor(),this.modes(1,2)},s.dragover=function(t){t.preventDefault(),this.s[4].borderColor=this.colors.select,this.s[4].color=this.colors.select},s.dragend=function(t){t.preventDefault(),this.s[4].borderColor=this.fontColor,this.s[4].color=this.fontColor},s.drop=function(t){t.preventDefault(),this.dragend(t),this.fileSelect(t.dataTransfer.files[0])},s.initDrager=function(){this.c[4]=this.dom("div",this.css.txt+" text-align:center; line-height:"+(this.h-8)+"px; border:1px dashed "+this.fontColor+"; top:2px;\theight:"+(this.h-4)+"px; border-radius:"+this.radius+"px; pointer-events:auto;"),this.c[4].textContent="DRAG",this.c[4].addEventListener("dragover",function(t){this.dragover(t)}.bind(this),!1),this.c[4].addEventListener("dragend",function(t){this.dragend(t)}.bind(this),!1),this.c[4].addEventListener("dragleave",function(t){this.dragend(t)}.bind(this),!1),this.c[4].addEventListener("drop",function(t){this.drop(t)}.bind(this),!1)},s.initLoader=function(){this.c[3]=this.dom("input",this.css.basic+"top:0px; opacity:0; height:"+this.h+"px; pointer-events:auto; cursor:pointer;"),this.c[3].name="loader",this.c[3].type="file",this.c[3].addEventListener("change",function(t){this.fileSelect(t.target.files[0])}.bind(this),!1)},s.fileSelect=function(t){if(void 0!==t){var i=new FileReader,s=t.name,e=s.substring(s.lastIndexOf(".")+1,s.length);-1!==["png","jpg","mp4","webm","ogg"].indexOf(e)?i.readAsDataURL(t):-1!==["sea","z","hex","bvh","BVH","glb"].indexOf(e)?i.readAsArrayBuffer(t):i.readAsText(t),i.onload=function(t){this.callback&&this.callback(t.target.result,s,e)}.bind(this)}},s.label=function(t,i){i=i||2,this.c[i].textContent=t},s.icon=function(t,i,s){s=s||2,this.s[s].padding=(i||0)+"px 0px",this.c[s].innerHTML=t},s.rSize=function(){t.prototype.rSize.call(this);for(var i=this.s,s=this.sb,e=this.sa,o=this.lng,n=Math.floor((s-3*(o-1))/o);o--;)this.tmp[o]=[Math.floor(e+n*o+3*o),n],this.tmp[o][2]=this.tmp[o][0]+this.tmp[o][1],i[o+2].left=this.tmp[o][0]+"px",i[o+2].width=this.tmp[o][1]+"px";this.isDragButton&&(i[4].left=e+n+3+"px",i[4].width=n+"px"),this.isLoadButton&&(i[3].left=e+"px",i[3].width=n+"px")},i}(l),d=function(t){function i(i){var s;return void 0===i&&(i={}),(s=t.call(this,i)||this).autoWidth=!1,s.buttonColor=s.colors.button,s.setTypeNumber(i),s.radius=.5*s.w,s.twoPi=2*Math.PI,s.pi90=.5*Math.PI,s.offset=new a,s.h=i.h||s.w+10,s.top=0,s.c[0].style.width=s.w+"px",void 0!==s.c[1]&&(s.c[1].style.width=s.w+"px",s.c[1].style.textAlign="center",s.top=10,s.h+=10),s.percent=0,s.cmode=0,s.c[2]=s.dom("div",s.css.txt+"text-align:center; top:"+(s.h-20)+"px; width:"+s.w+"px; color:"+s.fontColor),s.c[3]=s.getCircular(),s.setSvg(s.c[3],"d",s.makePath(),1),s.setSvg(s.c[3],"stroke",s.fontColor,1),s.setSvg(s.c[3],"viewBox","0 0 "+s.w+" "+s.w),s.setCss(s.c[3],{width:s.w,height:s.w,left:0,top:s.top}),s.init(),s.update(),s}h(i,t);var s=i.prototype;return s.mode=function(t){if(this.cmode===t)return!1;switch(t){case 0:this.s[2].color=this.fontColor,this.setSvg(this.c[3],"stroke","rgba(0,0,0,0.1)",0),this.setSvg(this.c[3],"stroke",this.fontColor,1);break;case 1:this.s[2].color=this.colorPlus,this.setSvg(this.c[3],"stroke","rgba(0,0,0,0.3)",0),this.setSvg(this.c[3],"stroke",this.colorPlus,1)}return this.cmode=t,!0},s.reset=function(){this.isDown=!1},s.mouseup=function(t){return this.isDown=!1,this.sendEnd(),this.mode(0)},s.mousedown=function(t){return this.isDown=!0,this.old=this.value,this.oldr=null,this.mousemove(t),this.mode(1)},s.mousemove=function(t){if(this.isDown){var i=this.offset;if(i.x=this.radius-(t.clientX-this.zone.x),i.y=this.radius-(t.clientY-this.zone.y-this.top),this.r=i.angle()-this.pi90,this.r=(this.r%this.twoPi+this.twoPi)%this.twoPi,null!==this.oldr){var s=this.r-this.oldr;this.r=Math.abs(s)>Math.PI?this.oldr:this.r,s>6&&(this.r=0),s<-6&&(this.r=this.twoPi)}var e=1/this.twoPi,o=this.r*e,n=this.range*o+this.min-this.old;(n>=this.step||n<=this.step)&&(n=~~(n/this.step),this.value=this.numValue(this.old+n*this.step),this.update(!0),this.old=this.value,this.oldr=this.r)}},s.makePath=function(){var t=40,i=this.percent*this.twoPi-.001,s=t+t*Math.sin(i)+24,e=t-t*Math.cos(i)+24;return"M 64,24 A 40,40 0 "+(i>Math.PI?1:0)+" 1 "+s+","+e},s.update=function(t){this.c[2].textContent=this.value,this.percent=(this.value-this.min)/this.range,this.setSvg(this.c[3],"d",this.makePath(),1),t&&this.send()},i}(l),p=function(t){function i(i){var s;return void 0===i&&(i={}),(s=t.call(this,i)||this).ctype=i.ctype||"hex",s.wfixe=s.sb>256?256:s.sb,null!=i.cw&&(s.wfixe=i.cw),s.side=i.side||"down",s.up="down"===s.side?0:1,s.baseH=s.h,s.offset=new a,s.decal=new a,s.p=new a,s.c[2]=s.dom("div",s.css.txt+"height:"+(s.h-4)+"px;border-radius:"+s.radius+"px; line-height:"+(s.h-8)+"px;"),s.s[2]=s.c[2].style,s.up&&(s.s[2].top="auto",s.s[2].bottom="2px"),s.c[3]=s.getColorRing(),s.c[3].style.visibility="hidden",s.hsl=null,s.value="#ffffff",void 0!==i.value&&(i.value instanceof Array?s.value=e.rgbToHex(i.value):isNaN(i.value)?s.value=i.value:s.value=e.hexToHtml(i.value)),s.bcolor=null,s.isDown=!1,s.fistDown=!1,s.tr=98,s.tsl=Math.sqrt(3)*s.tr,s.hue=0,s.d=256,s.setColor(s.value),s.init(),void 0!==i.open&&s.open(),s}h(i,t);var s=i.prototype;return s.testZone=function(t,i){var s=this.local;return-1===s.x&&-1===s.y?"":this.up&&this.isOpen?s.y>this.wfixe?"title":"color":s.y<this.baseH+2?"title":this.isOpen?"color":void 0},s.mouseup=function(t){this.isDown=!1,this.d=256},s.mousedown=function(t){var i=this.testZone(t.clientX,t.clientY);if("title"===i)return this.isOpen?this.close():this.open(),!0;"color"===i&&(this.isDown=!0,this.fistDown=!0,this.mousemove(t))},s.mousemove=function(t){var i,s,o,n,h,r,a,l,c,u=this.testZone(t.clientX,t.clientY),d=e;if("title"===u&&this.cursor("pointer"),"color"===u&&((i=this.offset).x=t.clientX-(this.zone.x+this.decal.x+this.mid),i.y=t.clientY-(this.zone.y+this.decal.y+this.mid),s=i.length()*this.ratio,(c=i.angle())<0&&(c+=2*d.PI),s<128?this.cursor("crosshair"):this.isDown||this.cursor(),this.isDown&&(this.fistDown&&(this.d=s,this.fistDown=!1),this.d<128)))if(this.d>this.tr)o=(c+d.pi90)/d.TwoPI,this.hue=(o+1)%1,this.setHSL([(o+1)%1,this.hsl[1],this.hsl[2]]);else{a=i.x*this.ratio,l=i.y*this.ratio;var p=this.hue*d.TwoPI+d.PI;p<0&&(p+=2*d.PI),(r=Math.atan2(-l,a))<0&&(r+=2*d.PI);var f=(r+d.pi90+d.TwoPI+p)%d.TwoPI,v=f%(2/3*d.PI)-d.pi60,m=.5*this.tr,g=Math.tan(v)*m,x=Math.sqrt(a*a+l*l),b=Math.sqrt(m*m+g*g);if(x>b){var w=Math.tan(v)*x,y=Math.atan(w/b);y>d.pi60?y=d.pi60:y<-d.pi60&&(y=-d.pi60),v=(f=((r+=y-v)+d.pi90+d.TwoPI+p)%d.TwoPI)%(2/3*d.PI)-d.pi60,g=Math.tan(v)*m,x=b=Math.sqrt(m*m+g*g)}h=Math.sin(f)*x/this.tsl+.5;var k=1-2*Math.abs(h-.5);n=(Math.cos(f)*x+this.tr/2)/(1.5*this.tr)/k,n=d.clamp(n,0,1),this.setHSL([this.hsl[0],n,h])}},s.setHeight=function(){this.h=this.isOpen?this.wfixe+this.baseH+5:this.baseH,this.s[0].height=this.h+"px",this.zone.h=this.h},s.parentHeight=function(t){null!==this.parentGroup?this.parentGroup.calc(t):this.isUI&&this.main.calc(t)},s.open=function(){t.prototype.open.call(this),this.setHeight(),this.up&&(this.zone.y-=this.wfixe+5);var i=this.h-this.baseH;this.s[3].visibility="visible",this.parentHeight(i)},s.close=function(){t.prototype.close.call(this),this.up&&(this.zone.y+=this.wfixe+5);var i=this.h-this.baseH;this.setHeight(),this.s[3].visibility="hidden",this.parentHeight(-i)},s.update=function(t){var i=e.rgbToHex(e.hslToRgb([this.hsl[0],1,.5]));this.moveMarkers(),this.value=this.bcolor,this.setSvg(this.c[3],"fill",i,2,0),this.s[2].background=this.bcolor,this.c[2].textContent=e.htmlToHex(this.bcolor),this.invert=e.findDeepInver(this.rgb),this.s[2].color=this.invert?"#fff":"#000",t&&("array"===this.ctype&&this.send(this.rgb),"rgb"===this.ctype&&this.send(e.htmlRgb(this.rgb)),"hex"===this.ctype&&this.send(e.htmlToHex(this.value)),"html"===this.ctype&&this.send())},s.setColor=function(t){var i=e.unpack(t);return this.bcolor!=t&&i&&(this.bcolor=t,this.rgb=i,this.hsl=e.rgbToHsl(this.rgb),this.hue=this.hsl[0],this.update()),this},s.setHSL=function(t){return this.hsl=t,this.rgb=e.hslToRgb(t),this.bcolor=e.rgbToHex(this.rgb),this.update(!0),this},s.moveMarkers=function(){var t=this.p,i=e;this.invert;var s=this.hsl[0]*i.TwoPI,o=2/3*i.PI,n=this.tr,h=this.hsl[0],r=this.hsl[1],a=this.hsl[2],l=(s-i.pi90)*i.todeg;h=-s+i.pi90;var c=Math.cos(h)*n,u=-Math.sin(h)*n,d=Math.cos(h-o)*n,p=-Math.sin(h-o)*n,f=Math.cos(h+o)*n,v=-Math.sin(h+o)*n,m=(p+v)/2,g=d+(f-d)*a+(c-(d+f)/2)*(s=(1-2*Math.abs(a-.5))*r),x=p+(v-p)*a+(u-m)*s;t.set(g,x).addScalar(128),this.setSvg(this.c[3],"transform","rotate("+l+" )",2),this.setSvg(this.c[3],"cx",t.x,3),this.setSvg(this.c[3],"cy",t.y,3),this.setSvg(this.c[3],"stroke",this.invert?"#fff":"#000",2,3),this.setSvg(this.c[3],"stroke",this.invert?"#fff":"#000",3),this.setSvg(this.c[3],"fill",this.bcolor,3)},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s;i[2].width=this.sb+"px",i[2].left=this.sa+"px",this.decal.x=Math.floor(.5*(this.w-this.wfixe)),this.decal.y="up"===this.side?2:this.baseH+2,this.mid=Math.floor(.5*this.wfixe),this.setSvg(this.c[3],"viewBox","0 0 "+this.wfixe+" "+this.wfixe),i[3].width=this.wfixe+"px",i[3].height=this.wfixe+"px",i[3].left=this.decal.x+"px",i[3].top=this.decal.y+"px",this.ratio=256/this.wfixe,this.square=1/(this.wfixe/256*60),this.setHeight()},i}(l),f=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).round=Math.round,s.autoHeight=!0,s.baseH=s.h,s.hplus=i.hplus||50,s.res=i.res||40,s.l=1,s.precision=i.precision||0,s.custom=i.custom||!1,s.names=i.names||["FPS","MS"];var e=i.cc||["90,90,90","255,255,0"];s.adding=i.adding||!1,s.range=i.range||[165,100,100],s.alpha=i.alpha||.25,s.values=[],s.points=[],s.textDisplay=[],s.custom||(s.now=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,s.startTime=0,s.prevTime=0,s.frames=0,s.ms=0,s.fps=0,s.mem=0,s.mm=0,s.isMem=!(!self.performance||!self.performance.memory),s.isMem&&(s.names.push("MEM"),e.push("0,255,255")),s.txt="FPS");var o=Math.floor(.5*s.h)-6;s.c[1].textContent=s.txt,s.c[0].style.cursor="pointer",s.c[0].style.pointerEvents="auto";var n="display:none; left:10px; top:"+s.h+"px; height:"+(s.hplus-8)+"px; box-sizing:border-box; background: rgba(0, 0, 0, 0.2); border:"+("none"!==s.colors.groupBorder?s.colors.groupBorder+";":"1px solid rgba(255, 255, 255, 0.2);");0!==s.radius&&(n+="border-radius:"+s.radius+"px;"),s.c[2]=s.dom("path",s.css.basic+n,{}),s.c[2].setAttribute("viewBox","0 0 "+s.res+" 50"),s.c[2].setAttribute("height","100%"),s.c[2].setAttribute("width","100%"),s.c[2].setAttribute("preserveAspectRatio","none"),s.c[3]=s.dom("path",s.css.basic+"position:absolute; width:10px; height:10px; left:4px; top:"+o+"px;",{d:s.svgs.arrow,fill:s.fontColor,stroke:"none"}),s.c[4]=s.dom("div",s.css.txt+"position:absolute; left:10px; top:"+(s.h+2)+"px; display:none; width:100%; text-align:center;"),i.bottomLine&&(s.c[4]=s.dom("div",s.css.basic+"width:100%; bottom:0px; height:1px; background: rgba(255, 255, 255, 0.2);")),s.isShow=!1;var h=s.s;h[1].marginLeft="10px",h[1].lineHeight=s.h-4,h[1].color=s.fontColor,h[1].fontWeight="bold",0!==s.radius&&(h[0].borderRadius=s.radius+"px"),h[0].border=s.colors.groupBorder;var r=0;for(r=0;r<s.names.length;r++){for(var a=[],l=s.res+1;l--;)a.push(50);s.range[r]=1/s.range[r]*49,s.points.push(a),s.values.push(0),s.textDisplay.push("<span style='color:rgb("+e[r]+")'> "+s.names[r]+" ")}for(r=s.names.length;r--;)s.dom("path",null,{fill:"rgba("+e[r]+","+s.alpha+")","stroke-width":1,stroke:"rgba("+e[r]+",1)","vector-effect":"non-scaling-stroke"},s.c[2]);return s.init(),s}h(i,t);var s=i.prototype;return s.mousedown=function(t){this.isShow?this.close():this.open()},s.tick=function(t){this.values=t,this.isShow&&(this.drawGraph(),this.upText())},s.makePath=function(t){var i="";i+="M -1 50";for(var s=0;s<this.res+1;s++)i+=" L "+s+" "+t[s];return i+=" L "+(this.res+1)+" 50"},s.upText=function(t){for(var i=t||this.values,s="",e=0,o=this.names.length;e<o;e++)s+=this.textDisplay[e]+i[e].toFixed(this.precision)+"</span>";this.c[4].innerHTML=s},s.drawGraph=function(){for(var t,i=this.c[2],s=this.names.length,e=0,o=0;s--;)t=this.adding?(this.values[o]+e)*this.range[o]:this.values[o]*this.range[o],this.points[o].shift(),this.points[o].push(50-t),this.setSvg(i,"d",this.makePath(this.points[o]),s+1),e+=this.values[o],o++},s.open=function(){t.prototype.open.call(this),this.h=this.hplus+this.baseH,this.setSvg(this.c[3],"d",this.svgs.arrowDown),null!==this.parentGroup?this.parentGroup.calc(this.hplus):this.isUI&&this.main.calc(this.hplus),this.s[0].height=this.h+"px",this.s[2].display="block",this.s[4].display="block",this.isShow=!0,this.custom||n.addListen(this)},s.close=function(){t.prototype.close.call(this),this.h=this.baseH,this.setSvg(this.c[3],"d",this.svgs.arrow),null!==this.parentGroup?this.parentGroup.calc(-this.hplus):this.isUI&&this.main.calc(-this.hplus),this.s[0].height=this.h+"px",this.s[2].display="none",this.s[4].display="none",this.isShow=!1,this.custom||n.removeListen(this),this.c[4].innerHTML=""},s.begin=function(){this.startTime=this.now()},s.end=function(){var t=this.now();if(this.ms=t-this.startTime,this.frames++,t>this.prevTime+1e3&&(this.fps=this.round(1e3*this.frames/(t-this.prevTime)),this.prevTime=t,this.frames=0,this.isMem)){var i=performance.memory.usedJSHeapSize,s=performance.memory.jsHeapSizeLimit;this.mem=this.round(954e-9*i),this.mm=i/s}return this.values=[this.fps,this.ms,this.mm],this.drawGraph(),this.upText([this.fps,this.ms,this.mem]),t},s.listening=function(){this.custom||(this.startTime=this.end())},s.rSize=function(){var t=this.s,i=this.w;t[0].width=i+"px",t[1].width=i+"px",t[2].left="10px",t[2].width=i-20+"px",t[4].width=i-20+"px"},i}(l),v=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).value=void 0!==i.value?i.value:[0,0,0],s.lng=s.value.length,s.precision=void 0!==i.precision?i.precision:2,s.multiplicator=i.multiplicator||1,s.neg=i.neg||!1,s.line=void 0===i.line||i.line,s.autoWidth=void 0===i.autoWidth||i.autoWidth,s.isNumber=!1,s.isDown=!1,s.h=i.h||138,s.rh=s.h-10,s.top=0,s.c[0].style.width=s.w+"px",void 0!==s.c[1]&&(s.c[1].style.width=s.w+"px",s.top=10,s.h+=10),s.gh=s.rh-28,s.gw=s.w-28,s.c[2]=s.dom("div",s.css.txt+"text-align:center; top:"+(s.h-20)+"px; width:"+s.w+"px; color:"+s.fontColor),s.c[2].textContent=s.value;var e=s.dom("svg",s.css.basic,{viewBox:"0 0 "+s.w+" "+s.rh,width:s.w,height:s.rh,preserveAspectRatio:"none"});s.setCss(e,{width:s.w,height:s.rh,left:0,top:s.top}),s.dom("path","",{d:"",stroke:s.colors.text,"stroke-width":2,fill:"none","stroke-linecap":"butt"},e),s.dom("rect","",{x:10,y:10,width:s.gw+8,height:s.gh+8,stroke:"rgba(0,0,0,0.3)","stroke-width":1,fill:"none"},e),s.iw=(s.gw-4*(s.lng-1))/s.lng;var o=[];s.cMode=[],s.v=[];for(var n=0;n<s.lng;n++)o[n]=[14+n*s.iw+4*n,s.iw],o[n][2]=o[n][0]+o[n][1],s.cMode[n]=0,s.neg?s.v[n]=.5*(1+s.value[n]/s.multiplicator):s.v[n]=s.value[n]/s.multiplicator,s.dom("rect","",{x:o[n][0],y:14,width:o[n][1],height:1,fill:s.fontColor,"fill-opacity":.3},e);return s.tmp=o,s.c[3]=e,s.init(),void 0!==s.c[1]&&(s.c[1].style.top="0px",s.c[1].style.height="20px",s.s[1].lineHeight="15px"),s.update(!1),s}h(i,t);var s=i.prototype;return s.updateSVG=function(){this.line&&this.setSvg(this.c[3],"d",this.makePath(),0);for(var t=0;t<this.lng;t++)this.setSvg(this.c[3],"height",this.v[t]*this.gh,t+2),this.setSvg(this.c[3],"y",this.gh-this.v[t]*this.gh+14,t+2),this.neg?this.value[t]=1*((2*this.v[t]-1)*this.multiplicator).toFixed(this.precision):this.value[t]=1*(this.v[t]*this.multiplicator).toFixed(this.precision);this.c[2].textContent=this.value},s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";var s=this.lng,e=this.tmp;if(i.y>this.top&&i.y<this.h-20)for(;s--;)if(i.x>e[s][0]&&i.x<e[s][2])return s;return""},s.mode=function(t,i){if(t===this.cMode[i])return!1;var s;switch(t){case 0:s=.3;break;case 1:s=.6;break;case 2:s=1}return this.reset(),this.setSvg(this.c[3],"fill-opacity",s,i+2),this.cMode[i]=t,!0},s.reset=function(){for(var t=!1,i=this.lng;i--;)0!==this.cMode[i]&&(this.cMode[i]=0,this.setSvg(this.c[3],"fill-opacity",.3,i+2),t=!0);return t},s.mouseup=function(t){if(this.isDown=!1,-1!==this.current)return this.reset()},s.mousedown=function(t){return this.isDown=!0,this.mousemove(t)},s.mousemove=function(t){var i=!1,s=this.testZone(t);return""===s?i=this.reset():(i=this.mode(this.isDown?2:1,s),this.isDown&&(this.v[s]=this.clamp(1-(t.clientY-this.zone.y-this.top-10)/this.gh,0,1),this.update(!0))),i},s.update=function(t){this.updateSVG(),t&&this.send()},s.makePath=function(){for(var t,i,s,e,o,n,h="",r=0;r<this.lng;r++)t=this.gh-this.v[r]*this.gh+14,e=(i=14+r*this.iw+4*r)+.5*this.iw,s=i+this.iw,h+=0===r?"M "+i+" "+t+" T "+e+" "+t:" C "+o+" "+n+","+i+" "+t+","+e+" "+t,r===this.lng-1&&(h+=" T "+s+" "+t),o=s,n=t;return h},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s;void 0!==this.c[1]&&(i[1].width=this.w+"px"),i[2].width=this.w+"px",i[3].width=this.w+"px";for(var s=(this.w-28-4*(this.lng-1))/this.lng,e=[],o=0;o<this.lng;o++)e[o]=[14+o*s+4*o,s],e[o][2]=e[o][0]+e[o][1];this.tmp=e},i}(l),m=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).ADD=i.add,s.uis=[],s.autoHeight=!0,s.current=-1,s.target=null,s.decal=0,s.baseH=s.h;var e=Math.floor(.5*s.h)-6;s.isLine=void 0!==i.line&&i.line,s.c[2]=s.dom("div",s.css.basic+"width:100%; left:0; height:auto; overflow:hidden; top:"+s.h+"px"),s.c[3]=s.dom("path",s.css.basic+"position:absolute; width:10px; height:10px; left:0; top:"+e+"px;",{d:s.svgs.group,fill:s.fontColor,stroke:"none"}),s.c[4]=s.dom("path",s.css.basic+"position:absolute; width:10px; height:10px; left:4px; top:"+e+"px;",{d:s.svgs.arrow,fill:s.fontColor,stroke:"none"}),s.isLine&&(s.c[5]=s.dom("div",s.css.basic+"background:rgba(255, 255, 255, 0.2); width:100%; left:0; height:1px; bottom:0px"));var o=s.s;return o[0].height=s.h+"px",o[1].height=s.h+"px",s.c[1].name="group",o[1].marginLeft="10px",o[1].lineHeight=s.h-4,o[1].color=s.fontColor,o[1].fontWeight="bold",0!==s.radius&&(o[0].borderRadius=s.radius+"px"),o[0].border=s.colors.groupBorder,s.init(),void 0!==i.bg&&s.setBG(i.bg),void 0!==i.open&&s.open(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";var s="";return i.y<this.baseH?s="title":this.isOpen&&(s="content"),s},s.clearTarget=function(){return-1!==this.current&&(this.target.uiout(),this.target.reset(),this.current=-1,this.target=null,this.cursor(),!0)},s.reset=function(){this.clearTarget()},s.handleEvent=function(t){var i=t.type,s=!1,e=!1,o=this.testZone(t);if(o){switch(o){case"content":this.cursor(),n.isMobile&&"mousedown"===i&&this.getNext(t,s),this.target&&(e=this.target.handleEvent(t)),n.lock||this.getNext(t,s);break;case"title":this.cursor("pointer"),"mousedown"===i&&(this.isOpen?this.close():this.open())}return this.isDown&&(s=!0),e&&(s=!0),s}},s.getNext=function(t,i){var s=n.findTarget(this.uis,t);s!==this.current&&(this.clearTarget(),this.current=s),-1!==s&&(this.target=this.uis[this.current],this.target.uiover())},s.calcH=function(){var t,i,s=this.uis.length,e=0,o=0,n=0;for(t=0;t<s;t++)(i=this.uis[t]).autoWidth?e+=i.h+1:(0===o?e+=i.h+1:n<i.h&&(e+=i.h-n),n=i.h,(o+=i.w)+i.w>this.w&&(o=0));return e},s.calcUis=function(){this.isOpen&&n.calcUis(this.uis,this.zone,this.zone.y+this.baseH)},s.setBG=function(t){this.s[0].background=t;for(var i=this.uis.length;i--;)this.uis[i].setBG(t)},s.add=function(){var t=arguments;"object"==typeof t[1]?(t[1].isUI=this.isUI,t[1].target=this.c[2],t[1].main=this.main):"string"==typeof arguments[1]&&(void 0===t[2]?[].push.call(t,{isUI:!0,target:this.c[2],main:this.main}):(t[2].isUI=!0,t[2].target=this.c[2],t[2].main=this.main));var i=this.ADD.apply(this,t);return this.uis.push(i),i.autoHeight&&(i.parentGroup=this),i},s.parentHeight=function(t){null!==this.parentGroup?this.parentGroup.calc(t):this.isUI&&this.main.calc(t)},s.open=function(){t.prototype.open.call(this),this.setSvg(this.c[4],"d",this.svgs.arrowDown),this.rSizeContent();var i=this.h-this.baseH;this.parentHeight(i)},s.close=function(){t.prototype.close.call(this);var i=this.h-this.baseH;this.setSvg(this.c[4],"d",this.svgs.arrow),this.h=this.baseH,this.s[0].height=this.h+"px",this.parentHeight(-i)},s.clear=function(){this.clearGroup(),this.isUI&&this.main.calc(-(this.h+1)),l.prototype.clear.call(this)},s.clearGroup=function(){this.close();for(var t=this.uis.length;t--;)this.uis[t].clear(),this.uis.pop();this.uis=[],this.h=this.baseH},s.calc=function(t){this.isOpen&&(void 0!==t?(this.h+=t,this.isUI&&this.main.calc(t)):this.h=this.calcH()+this.baseH,this.s[0].height=this.h+"px")},s.rSizeContent=function(){for(var t=this.uis.length;t--;)this.uis[t].setSize(this.w),this.uis[t].rSize();this.calc()},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s;i[3].left=this.sa+this.sb-17+"px",i[1].width=this.w+"px",i[2].width=this.w+"px",this.isOpen&&this.rSizeContent()},i}(l);m.prototype.isGroup=!0;var g=function(t){function i(i){var s;return void 0===i&&(i={}),(s=t.call(this,i)||this).autoWidth=!1,s.value=[0,0],s.joyType="analogique",s.model=void 0!==i.mode?i.mode:0,s.precision=i.precision||2,s.multiplicator=i.multiplicator||1,s.pos=new a,s.tmp=new a,s.interval=null,s.radius=.5*s.w,s.distance=.25*s.radius,s.h=i.h||s.w+10,s.top=0,s.c[0].style.width=s.w+"px",void 0!==s.c[1]&&(s.c[1].style.width=s.w+"px",s.c[1].style.textAlign="center",s.top=10,s.h+=10),s.c[2]=s.dom("div",s.css.txt+"text-align:center; top:"+(s.h-20)+"px; width:"+s.w+"px; color:"+s.fontColor),s.c[2].textContent=s.value,s.c[3]=s.getJoystick(s.model),s.setSvg(s.c[3],"viewBox","0 0 "+s.w+" "+s.w),s.setCss(s.c[3],{width:s.w,height:s.w,left:0,top:s.top}),s.ratio=128/s.w,s.init(),s.update(!1),s}h(i,t);var s=i.prototype;return s.mode=function(t){switch(t){case 0:0===this.model?(this.setSvg(this.c[3],"fill","url(#gradIn)",4),this.setSvg(this.c[3],"stroke","#000",4)):(this.setSvg(this.c[3],"stroke","rgba(100,100,100,0.25)",2),this.setSvg(this.c[3],"stroke","#666",4),this.setSvg(this.c[3],"fill","none",4));break;case 1:0===this.model?(this.setSvg(this.c[3],"fill","url(#gradIn2)",4),this.setSvg(this.c[3],"stroke","rgba(0,0,0,0)",4)):(this.setSvg(this.c[3],"stroke","rgba(48,138,255,0.25)",2),this.setSvg(this.c[3],"stroke",this.colors.select,4),this.setSvg(this.c[3],"fill","rgba(48,138,255,0.25)",4))}},s.addInterval=function(){null!==this.interval&&this.stopInterval(),this.pos.isZero()||(this.interval=setInterval(function(){this.update()}.bind(this),10))},s.stopInterval=function(){null!==this.interval&&(clearInterval(this.interval),this.interval=null)},s.reset=function(){this.addInterval(),this.mode(0)},s.mouseup=function(t){this.addInterval(),this.isDown=!1},s.mousedown=function(t){this.isDown=!0,this.mousemove(t),this.mode(2)},s.mousemove=function(t){if(this.mode(1),this.isDown){if(this.tmp.x=this.radius-(t.clientX-this.zone.x),this.tmp.y=this.radius-(t.clientY-this.zone.y-this.top),this.tmp.length()>this.distance){var i=Math.atan2(this.tmp.x,this.tmp.y);this.tmp.x=Math.sin(i)*this.distance,this.tmp.y=Math.cos(i)*this.distance}this.pos.copy(this.tmp).divideScalar(this.distance).negate(),this.update()}},s.setValue=function(t){void 0===t&&(t=[0,0]),this.pos.set(t[0]||0,t[1]||0),this.updateSVG()},s.update=function(t){void 0===t&&(t=!0),null!==this.interval&&(this.isDown||(this.pos.lerp(null,.3),this.pos.x=Math.abs(this.pos.x)<.01?0:this.pos.x,this.pos.y=Math.abs(this.pos.y)<.01?0:this.pos.y,this.isUI&&this.main.isCanvas&&this.main.draw())),this.updateSVG(),t&&this.send(),this.pos.isZero()&&this.stopInterval()},s.updateSVG=function(){var t=this.radius- -this.pos.x*this.distance,i=this.radius- -this.pos.y*this.distance;if(0===this.model){var s=t+5*this.pos.x+5,e=i+5*this.pos.y+10;this.setSvg(this.c[3],"cx",s*this.ratio,3),this.setSvg(this.c[3],"cy",e*this.ratio,3)}else this.setSvg(this.c[3],"cx",t*this.ratio,3),this.setSvg(this.c[3],"cy",i*this.ratio,3);this.setSvg(this.c[3],"cx",t*this.ratio,4),this.setSvg(this.c[3],"cy",i*this.ratio,4),this.value[0]=1*(this.pos.x*this.multiplicator).toFixed(this.precision),this.value[1]=1*(this.pos.y*this.multiplicator).toFixed(this.precision),this.c[2].textContent=this.value},s.clear=function(){this.stopInterval(),t.prototype.clear.call(this)},i}(l),x=function(t){function i(i){var s;return void 0===i&&(i={}),(s=t.call(this,i)||this).autoWidth=!1,s.buttonColor=s.colors.button,s.setTypeNumber(i),s.mPI=.8*Math.PI,s.toDeg=180/Math.PI,s.cirRange=2*s.mPI,s.offset=new a,s.radius=.5*s.w,s.h=i.h||s.w+10,s.top=0,s.c[0].style.width=s.w+"px",void 0!==s.c[1]&&(s.c[1].style.width=s.w+"px",s.c[1].style.textAlign="center",s.top=10,s.h+=10),s.percent=0,s.cmode=0,s.c[2]=s.dom("div",s.css.txt+"text-align:center; top:"+(s.h-20)+"px; width:"+s.w+"px; color:"+s.fontColor),s.c[3]=s.getKnob(),s.setSvg(s.c[3],"stroke",s.fontColor,1),s.setSvg(s.c[3],"stroke",s.fontColor,3),s.setSvg(s.c[3],"d",s.makeGrad(),3),s.setSvg(s.c[3],"viewBox","0 0 "+s.ww+" "+s.ww),s.setCss(s.c[3],{width:s.w,height:s.w,left:0,top:s.top}),s.r=0,s.init(),s.update(),s}h(i,t);var s=i.prototype;return s.mode=function(t){if(this.cmode===t)return!1;switch(t){case 0:this.s[2].color=this.fontColor,this.setSvg(this.c[3],"fill",this.colors.button,0),this.setSvg(this.c[3],"stroke",this.fontColor,1);break;case 1:this.s[2].color=this.colorPlus,this.setSvg(this.c[3],"fill",this.colors.select,0),this.setSvg(this.c[3],"stroke",this.colorPlus,1)}return this.cmode=t,!0},s.mousemove=function(t){if(this.isDown){var i=this.offset;i.x=this.radius-(t.clientX-this.zone.x),i.y=this.radius-(t.clientY-this.zone.y-this.top),this.r=-Math.atan2(i.x,i.y),null!==this.oldr&&(this.r=Math.abs(this.r-this.oldr)>Math.PI?this.oldr:this.r),this.r=this.r>this.mPI?this.mPI:this.r,this.r=this.r<-this.mPI?-this.mPI:this.r;var s=1/this.cirRange,e=(this.r+this.mPI)*s,o=this.range*e+this.min-this.old;(o>=this.step||o<=this.step)&&(o=Math.floor(o/this.step),this.value=this.numValue(this.old+o*this.step),this.update(!0),this.old=this.value,this.oldr=this.r)}},s.makeGrad=function(){var t,i,s,e="",o=64,n=Math.PI+this.mPI,h=Math.PI-this.mPI;this.step>5?t=(n-h)/(i=this.range/this.step):(t=(n-h)/o*2,i=32);for(var r=0;r<=i;++r)s=n-t*r,e+="M"+(o+44*Math.sin(s))+" "+(o+44*Math.cos(s))+" L"+(o+40*Math.sin(s))+" "+(o+40*Math.cos(s))+" ";return e},s.update=function(t){this.c[2].textContent=this.value,this.percent=(this.value-this.min)/this.range;var i=this.percent*this.cirRange-this.mPI,s=Math.sin(i),e=Math.cos(i),o=25*s+64,n=-25*e+64,h=20*s+64,r=-20*e+64;this.setSvg(this.c[3],"d","M "+o+" "+n+" L "+h+" "+r,1),t&&this.send()},i}(d),b=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).path=i.path||"",s.format=i.format||"",s.imageSize=i.imageSize||[20,20],s.isWithImage=""!==s.path,s.preLoadComplete=!1,s.tmpImage={},s.tmpUrl=[],s.autoHeight=!1;var e=i.align||"center";s.sMode=0,s.tMode=0,s.listOnly=i.listOnly||!1,s.buttonColor=i.bColor||s.colors.button;var o=Math.floor(.5*s.h)-5;return s.c[2]=s.dom("div",s.css.basic+"top:0; display:none;"),s.c[3]=s.dom("div",s.css.txt+"text-align:"+e+"; line-height:"+(s.h-4)+"px; top:1px; background:"+s.buttonColor+"; height:"+(s.h-2)+"px; border-radius:"+s.radius+"px;"),s.c[4]=s.dom("path",s.css.basic+"position:absolute; width:10px; height:10px; top:"+o+"px;",{d:s.svgs.arrow,fill:s.fontColor,stroke:"none"}),s.scroller=s.dom("div",s.css.basic+"right:5px;\twidth:10px; background:#666; display:none;"),s.c[3].style.color=s.fontColor,s.list=i.list||[],s.items=[],s.prevName="",s.baseH=s.h,s.itemHeight=i.itemHeight||s.h-3,s.full=i.full||!1,s.py=0,s.ww=s.sb,s.scroll=!1,s.isDown=!1,s.current=null,s.side=i.side||"down",s.up="down"===s.side?0:1,s.up?(s.c[2].style.top="auto",s.c[3].style.top="auto",s.c[4].style.top="auto",s.c[2].style.bottom=s.h-2+"px",s.c[3].style.bottom="1px",s.c[4].style.bottom=o+"px"):s.c[2].style.top=s.baseH+"px",s.listIn=s.dom("div",s.css.basic+"left:0; top:0; width:100%; background:rgba(0,0,0,0.2);"),s.listIn.name="list",s.topList=0,s.c[2].appendChild(s.listIn),s.c[2].appendChild(s.scroller),void 0!==i.value?isNaN(i.value)?s.value=i.value:s.value=s.list[i.value]:s.value=s.list[0],s.isOpenOnStart=i.open||!1,s.listOnly&&(s.baseH=5,s.c[3].style.display="none",s.c[4].style.display="none",s.c[2].style.top=s.baseH+"px",s.isOpenOnStart=!0),s.isWithImage&&s.preloadImage(),s.setList(s.list),s.init(),s.isOpenOnStart&&s.open(!0),s}h(i,t);var s=i.prototype;return s.preloadImage=function(){this.preLoadComplete=!1,this.tmpImage={};for(var t=0;t<this.list.length;t++)this.tmpUrl.push(this.list[t]);this.loadOne()},s.nextImg=function(){this.tmpUrl.shift(),0===this.tmpUrl.length?(this.preLoadComplete=!0,this.addImages()):this.loadOne()},s.loadOne=function(){var t=this,i=this.tmpUrl[0],s=document.createElement("img");s.style.cssText="position:absolute; width:"+t.imageSize[0]+"px; height:"+t.imageSize[1]+"px",s.setAttribute("src",this.path+i+this.format),s.addEventListener("load",(function(){t.imageSize[2]=s.width,t.imageSize[3]=s.height,t.tmpImage[i]=s,t.nextImg()}))},s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";if(this.up&&this.isOpen){if(i.y>this.h-this.baseH)return"title";if(this.scroll&&i.x>this.sa+this.sb-20)return"scroll";if(i.x>this.sa)return this.testItems(i.y-this.baseH)}else{if(i.y<this.baseH+2)return"title";if(this.isOpen){if(this.scroll&&i.x>this.sa+this.sb-20)return"scroll";if(i.x>this.sa)return this.testItems(i.y-this.baseH)}}return""},s.testItems=function(t){for(var i,s,e,o="",n=this.items.length;n--;)if(s=(i=this.items[n]).posy+this.topList,e=i.posy+this.itemHeight+1+this.topList,t>=s&&t<=e)return o="item"+n,this.unSelected(),this.current=i,this.selected(),o;return o},s.unSelected=function(){this.current&&(this.current.style.background="rgba(0,0,0,0.2)",this.current.style.color=this.fontColor,this.current=null)},s.selected=function(){this.current.style.background=this.colors.select,this.current.style.color="#FFF"},s.mouseup=function(t){this.isDown=!1},s.mousedown=function(t){var i=this.testZone(t);return!!i&&("scroll"===i?(this.isDown=!0,this.mousemove(t)):"title"===i?(this.modeTitle(2),this.listOnly||(this.isOpen?this.close():this.open())):this.current&&(this.value=this.list[this.current.id],this.send(),this.listOnly||(this.close(),this.setTopItem())),!0)},s.mousemove=function(t){var i=!1,s=this.testZone(t);if(!s)return i;if("title"===s)this.unSelected(),this.modeTitle(1),this.cursor("pointer");else if("scroll"===s){if(this.cursor("s-resize"),this.modeScroll(1),this.isDown){this.modeScroll(2);var e=this.zone.y+this.baseH-2;this.update(t.clientY-e-.5*this.sh)}}else this.modeTitle(0),this.modeScroll(0),this.cursor("pointer");return s!==this.prevName&&(i=!0),this.prevName=s,i},s.wheel=function(t){return"title"!==this.testZone(t)&&(this.py+=10*t.delta,this.update(this.py),!0)},s.reset=function(){this.prevName="",this.unSelected(),this.modeTitle(0),this.modeScroll(0)},s.modeScroll=function(t){if(t!==this.sMode){switch(t){case 0:this.scroller.style.background=this.buttonColor;break;case 1:this.scroller.style.background=this.colors.select;break;case 2:this.scroller.style.background=this.colors.down}this.sMode=t}},s.modeTitle=function(t){if(t!==this.tMode){var i=this.s;switch(t){case 0:i[3].color=this.fontColor,i[3].background=this.buttonColor;break;case 1:i[3].color="#FFF",i[3].background=this.colors.select;break;case 2:i[3].color=this.fontColor,i[3].background=this.colors.down}this.tMode=t}},s.clearList=function(){for(;this.listIn.children.length;)this.listIn.removeChild(this.listIn.lastChild);this.items=[]},s.setList=function(t){var i,s;this.clearList(),this.list=t,this.length=this.list.length,this.maxItem=this.full?this.length:5,this.maxItem=this.length<this.maxItem?this.length:this.maxItem,this.maxHeight=this.maxItem*(this.itemHeight+1)+2,this.max=this.length*(this.itemHeight+1)+2,this.ratio=this.maxHeight/this.max,this.sh=this.maxHeight*this.ratio,this.range=this.maxHeight-this.sh,this.c[2].style.height=this.maxHeight+"px",this.scroller.style.height=this.sh+"px",this.max>this.maxHeight&&(this.ww=this.sb-20,this.scroll=!0);for(var e=0;e<this.length;e++)s=this.list[e],(i=this.dom("div",this.css.item+"width:"+this.ww+"px; height:"+this.itemHeight+"px; line-height:"+(this.itemHeight-5)+"px; color:"+this.fontColor+";")).name="item"+e,i.id=e,i.posy=(this.itemHeight+1)*e,this.listIn.appendChild(i),this.items.push(i),this.isWithImage||(i.textContent=s);this.setTopItem()},s.addImages=function(){for(var t=this.list.length,i=0;i<t;i++)this.items[i].appendChild(this.tmpImage[this.list[i]]);this.setTopItem()},s.setTopItem=function(){if(this.isWithImage){if(!this.preLoadComplete)return;this.c[3].children.length||(this.canvas=document.createElement("canvas"),this.canvas.width=this.imageSize[0],this.canvas.height=this.imageSize[1],this.canvas.style.cssText="position:absolute; top:0px; left:0px;",this.ctx=this.canvas.getContext("2d"),this.c[3].appendChild(this.canvas)),this.tmpImage[this.value],this.ctx.drawImage(this.tmpImage[this.value],0,0,this.imageSize[2],this.imageSize[3],0,0,this.imageSize[0],this.imageSize[1])}else this.c[3].textContent=this.value},s.update=function(t){this.scroll&&(t=(t=t<0?0:t)>this.range?this.range:t,this.topList=-Math.floor(t/this.ratio),this.listIn.style.top=this.topList+"px",this.scroller.style.top=Math.floor(t)+"px",this.py=t)},s.parentHeight=function(t){null!==this.parentGroup?this.parentGroup.calc(t):this.isUI&&this.main.calc(t)},s.open=function(i){t.prototype.open.call(this),this.update(0),this.h=this.maxHeight+this.baseH+5,this.scroll?this.scroller.style.display="block":(this.topList=0,this.h=this.baseH+5+this.max,this.scroller.style.display="none"),this.s[0].height=this.h+"px",this.s[2].display="block",this.up?(this.zone.y-=this.h-(this.baseH-10),this.setSvg(this.c[4],"d",this.svgs.arrowUp)):this.setSvg(this.c[4],"d",this.svgs.arrowDown),this.rSizeContent();var s=this.h-this.baseH;this.zone.h=this.h,i||this.parentHeight(s)},s.close=function(){t.prototype.close.call(this),this.up&&(this.zone.y+=this.h-(this.baseH-10));var i=this.h-this.baseH;this.h=this.baseH,this.s[0].height=this.h+"px",this.s[2].display="none",this.setSvg(this.c[4],"d",this.svgs.arrow),this.zone.h=this.h,this.parentHeight(-i)},s.text=function(t){this.c[3].textContent=t},s.rSizeContent=function(){for(var t=this.length;t--;)this.listIn.children[t].style.width=this.ww+"px"},s.rSize=function(){l.prototype.rSize.call(this);var t=this.s,i=this.sb,s=this.sa;void 0!==t[2]&&(t[2].width=i+"px",t[2].left=s+"px",t[3].width=i+"px",t[3].left=s+"px",t[4].left=s+i-17+"px",this.ww=i,this.max>this.maxHeight&&(this.ww=i-20),this.isOpen&&this.rSizeContent())},i}(l),w=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).setTypeNumber(i),s.allway=i.allway||!1,s.isDown=!1,s.value=[0],s.multy=1,s.invmulty=1,s.isSingle=!0,s.isAngle=!1,s.isVector=!1,i.isAngle&&(s.isAngle=!0,s.multy=e.torad,s.invmulty=e.todeg),s.isDrag=i.drag||!1,void 0!==i.value&&(isNaN(i.value)?i.value instanceof Array?(s.value=i.value,s.isSingle=!1):i.value instanceof Object&&(s.value=[],void 0!==i.value.x&&(s.value[0]=i.value.x),void 0!==i.value.y&&(s.value[1]=i.value.y),void 0!==i.value.z&&(s.value[2]=i.value.z),void 0!==i.value.w&&(s.value[3]=i.value.w),s.isVector=!0,s.isSingle=!1):s.value=[i.value]),s.lng=s.value.length,s.tmp=[],s.current=-1,s.prev={x:0,y:0,d:0,v:0},s.c[2]=s.dom("div",s.css.basic+" background:"+s.colors.select+"; top:4px; width:0px; height:"+(s.h-8)+"px;"),s.cMode=[];for(var o=s.lng;o--;)s.isAngle&&(s.value[o]=(180*s.value[o]/Math.PI).toFixed(s.precision)),s.c[3+o]=s.dom("div",s.css.txtselect+" height:"+(s.h-4)+"px; background:"+s.colors.inputBg+"; borderColor:"+s.colors.inputBorder+"; border-radius:"+s.radius+"px;"),i.center&&(s.c[2+o].style.textAlign="center"),s.c[3+o].textContent=s.value[o],s.c[3+o].style.color=s.fontColor,s.c[3+o].isNum=!0,s.cMode[o]=0;return s.cursorId=3+s.lng,s.c[s.cursorId]=s.dom("div",s.css.basic+"top:4px; height:"+(s.h-8)+"px; width:0px; background:"+s.fontColor+";"),s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";for(var s=this.lng,e=this.tmp;s--;)if(i.x>e[s][0]&&i.x<e[s][2])return s;return""},s.mousedown=function(t){var i=this.testZone(t);return!this.isDown&&(this.isDown=!0,""!==i&&(this.current=i,this.prev={x:t.clientX,y:t.clientY,d:0,v:this.isSingle?parseFloat(this.value):parseFloat(this.value[this.current])},this.setInput(this.c[3+this.current])),this.mousemove(t))},s.mouseup=function(t){return!!this.isDown&&(this.isDown=!1,this.prev={x:0,y:0,d:0,v:0},this.mousemove(t))},s.mousemove=function(t){var i=!1,s=0;if(""===this.testZone(t)?this.cursor():this.isDrag?this.cursor(-1!==this.current?"move":"pointer"):this.cursor("text"),!this.isDrag)return this.isDown&&(s=t.clientX-this.zone.x-3),-1!==this.current&&(s-=this.tmp[this.current][0]),this.upInput(s,this.isDown);if(-1!==this.current){this.prev.d+=t.clientX-this.prev.x-(t.clientY-this.prev.y);var e=this.prev.v+this.prev.d*this.step;this.value[this.current]=this.numValue(e),this.c[3+this.current].textContent=this.value[this.current],this.validate(),this.prev.x=t.clientX,this.prev.y=t.clientY,i=!0}return i},s.reset=function(){return!1},s.setValue=function(t){this.isVector?(void 0!==t.x&&(this.value[0]=t.x),void 0!==t.y&&(this.value[1]=t.y),void 0!==t.z&&(this.value[2]=t.z),void 0!==t.w&&(this.value[3]=t.w)):this.value=t,this.update()},s.sameStr=function(t){for(var i=this.value.length;i--;)this.c[3+i].textContent=t},s.update=function(t){for(var i=this.value.length;i--;)this.value[i]=this.numValue(this.value[i]*this.invmulty),this.c[3+i].textContent=this.value[i];t&&this.send()},s.send=function(t){t=t||this.value,this.isSend=!0,null!==this.objectLink&&(this.isVector?this.objectLink[this.val].fromArray(t):this.objectLink[this.val]=t),this.callback&&this.callback(t,this.val),this.isSend=!1},s.select=function(t,i,s){var e=this.s,o=-1!==this.current?this.tmp[this.current][0]+5:0;e[this.cursorId].width="1px",e[this.cursorId].left=o+t+"px",e[2].left=o+i+"px",e[2].width=s+"px"},s.unselect=function(){var t=this.s;t&&(t[2].width="0px",t[this.cursorId].width="0px")},s.validate=function(t){var i=[],s=this.lng;for(this.allway&&(t=!0);s--;){if(isNaN(this.c[3+s].textContent))this.c[3+s].textContent=this.value[s];else{var e=this.numValue(this.c[3+s].textContent);this.c[3+s].textContent=e,this.value[s]=e}i[s]=this.value[s]*this.multy}t&&(this.isSingle?this.send(i[0]):this.send(i))},s.rSize=function(){t.prototype.rSize.call(this);for(var i=Math.floor((this.sb+5)/this.lng)-5,s=this.s,e=this.lng;e--;)this.tmp[e]=[Math.floor(this.sa+i*e+5*e),i],this.tmp[e][2]=this.tmp[e][0]+this.tmp[e][1],s[3+e].left=this.tmp[e][0]+"px",s[3+e].width=this.tmp[e][1]+"px"},i}(l),y=function(t){function i(i){var s;if(void 0===i&&(i={}),(s=t.call(this,i)||this).setTypeNumber(i),s.model=i.stype||0,void 0!==i.mode&&(s.model=i.mode),s.buttonColor=i.bColor||s.colors.button,s.defaultBorderColor=s.colors.hide,s.isDown=!1,s.isOver=!1,s.allway=i.allway||!1,s.isDeg=i.isDeg||!1,s.firstImput=!1,s.c[2]=s.dom("div",s.css.txtselect+"border:none; width:47px; color:"+s.fontColor),s.c[3]=s.dom("div",s.css.basic+" top:0; height:"+s.h+"px;"),s.c[4]=s.dom("div",s.css.basic+"background:"+s.colors.scrollback+"; top:2px; height:"+(s.h-4)+"px;"),s.c[5]=s.dom("div",s.css.basic+"left:4px; top:5px; height:"+(s.h-10)+"px; background:"+s.fontColor+";"),s.c[2].isNum=!0,s.c[2].style.height=s.h-2+"px",s.c[2].style.lineHeight=s.h-10+"px",0!==s.model){var e=4,o=8,n=s.h-4,h=20;2===s.model&&(e=4,o=8,h=2,n=.5*(s.h-4)),3===s.model&&(s.c[5].style.visible="none"),s.c[4].style.borderRadius=e+"px",s.c[4].style.height=o+"px",s.c[4].style.top=.5*s.h-e+"px",s.c[5].style.borderRadius=.5*e+"px",s.c[5].style.height=e+"px",s.c[5].style.top=.5*s.h-.5*e+"px",s.c[6]=s.dom("div",s.css.basic+"border-radius:"+h+"px; margin-left:"+.5*-n+"px; border:1px solid "+s.colors.border+"; background:"+s.buttonColor+"; left:4px; top:2px; height:"+(s.h-4)+"px; width:"+n+"px;")}return s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;return-1===i.x&&-1===i.y?"":i.x>=this.txl?"text":i.x>=this.sa?"scroll":""},s.mouseup=function(t){this.isDown&&(this.isDown=!1)},s.mousedown=function(t){var i=this.testZone(t);return!!i&&("scroll"===i&&(this.isDown=!0,this.old=this.value,this.mousemove(t)),!0)},s.mousemove=function(t){var i=!1;if("scroll"===this.testZone(t)?(this.mode(1),this.cursor("w-resize")):this.cursor(),this.isDown){var s=(t.clientX-(this.zone.x+this.sa)-3)/this.ww*this.range+this.min-this.old;(s>=this.step||s<=this.step)&&(s=Math.floor(s/this.step),this.value=this.numValue(this.old+s*this.step),this.update(!0),this.old=this.value),i=!0}return i},s.validate=function(){var t=this.c[2].textContent;isNaN(t)?this.c[2].textContent=this.value+(this.isDeg?"":""):(this.value=this.numValue(t),this.update(!0))},s.reset=function(){this.isDown=!1,this.mode(0)},s.mode=function(t){var i=this.s;switch(t){case 0:i[2].color=this.fontColor,i[4].background=this.colors.scrollback,i[5].background=this.fontColor;break;case 1:i[2].color=this.colorPlus,i[4].background=this.colors.scrollbackover,i[5].background=this.colorPlus}},s.update=function(t){var i=Math.floor(this.ww*((this.value-this.min)/this.range));3!==this.model&&(this.s[5].width=i+"px"),this.s[6]&&(this.s[6].left=this.sa+i+3+"px"),this.c[2].textContent=this.value+(this.isDeg?"":""),t&&this.send()},s.rSize=function(){t.prototype.rSize.call(this);var i=this.sb-this.sc;this.ww=i-6;var s=this.sc;!this.isUI&&this.simple||(s=this.sc+10),this.txl=this.w-s+2;var e=this.s;e[2].width=this.sc-6+"px",e[2].left=this.txl+4+"px",e[3].left=this.sa+"px",e[3].width=i+"px",e[4].left=this.sa+"px",e[4].width=i+"px",e[5].left=this.sa+3+"px",this.update()},i}(l),k=function(t){function i(i){var s;return void 0===i&&(i={}),(s=t.call(this,i)||this).cmode=0,s.value=i.value||"",s.placeHolder=i.placeHolder||"",s.allway=i.allway||!1,s.editable=void 0===i.edit||i.edit,s.isDown=!1,s.c[2]=s.dom("div",s.css.basic+" background:"+s.colors.select+"; top:4px; width:0px; height:"+(s.h-8)+"px;"),s.c[3]=s.dom("div",s.css.txtselect+"height:"+(s.h-4)+"px; background:"+s.colors.inputBg+"; borderColor:"+s.colors.inputBorder+"; border-radius:"+s.radius+"px;"),s.c[3].textContent=s.value,s.c[4]=s.dom("div",s.css.basic+"top:4px; height:"+(s.h-8)+"px; width:0px; background:"+s.fontColor+";"),s.c[5]=s.dom("div",s.css.txtselect+"height:"+(s.h-4)+"px; justify-content: center; font-style: italic; color:"+s.colors.inputHolder+";"),""===s.value&&(s.c[5].textContent=s.placeHolder),s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;return-1===i.x&&-1===i.y?"":i.x>=this.sa?"text":""},s.mouseup=function(t){if(this.editable)return!!this.isDown&&(this.isDown=!1,this.mousemove(t))},s.mousedown=function(t){if(this.editable){var i=this.testZone(t);return!this.isDown&&(this.isDown=!0,"text"===i&&this.setInput(this.c[3]),this.mousemove(t))}},s.mousemove=function(t){if(this.editable){var i=0;return"text"===this.testZone(t)?this.cursor("text"):this.cursor(),this.isDown&&(i=t.clientX-this.zone.x),this.upInput(i-this.sa-3,this.isDown)}},s.render=function(t,i,s){this.s[4].width="1px",this.s[4].left=this.sa+t+5+"px",this.s[2].left=this.sa+i+5+"px",this.s[2].width=s+"px"},s.reset=function(){this.cursor()},s.select=function(t,i,s){var e=this.s,o=this.sa+5;e[4].width="1px",e[4].left=o+t+"px",e[2].left=o+i+"px",e[2].width=s+"px"},s.unselect=function(){var t=this.s;t&&(t[2].width="0px",t[4].width="0px")},s.validate=function(t){this.allway&&(t=!0),this.value=this.c[3].textContent,""!==this.value?this.c[5].textContent="":this.c[5].textContent=this.placeHolder,t&&this.send()},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s;i[3].left=this.sa+"px",i[3].width=this.sb+"px",i[5].left=this.sa+"px",i[5].width=this.sb+"px"},i}(l),C=function(t){function i(i){var s;void 0===i&&(i={}),s=t.call(this,i)||this;var e=i.prefix||"";return s.c[2]=s.dom("div",s.css.txt+"text-align:right; width:60px; line-height:"+(s.h-8)+"px; color:"+s.fontColor),31===s.h&&(s.s[0].height=s.h+"px",s.s[1].top="8px",s.c[2].style.top="8px"),s.c[1].textContent=s.txt.substring(0,1).toUpperCase()+s.txt.substring(1).replace("-"," "),s.c[2].textContent=e,s.init(),s}h(i,t);var s=i.prototype;return s.text=function(t){this.c[1].textContent=t},s.text2=function(t){this.c[2].textContent=t},s.rSize=function(){t.prototype.rSize.call(this),this.s[1].width=this.w-50+"px",this.s[2].left=this.w-76+"px"},i}(l),S=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).value=i.value||"",s.isDown=!1,s.onActif=i.onActif||function(){},s.buttonColor=i.bColor||s.colors.button,s.buttonOver=i.bOver||s.colors.over,s.buttonDown=i.bDown||s.colors.select,s.buttonAction=i.bAction||s.colors.action,i.prefix,s.c[2]=s.dom("div",s.css.txt+s.css.button+" top:1px; background:"+s.buttonColor+"; height:"+(s.h-2)+"px; border:"+s.colors.buttonBorder+"; border-radius:15px; width:30px; left:10px;"),s.c[2].style.color=s.fontColor,s.c[3]=s.dom("div",s.css.txtselect+"height:"+(s.h-4)+"px; background:"+s.colors.inputBg+"; borderColor:"+s.colors.inputBorder+"; border-radius:"+s.radius+"px;"),s.c[3].textContent=s.value;var e=Math.floor(.5*s.h)-7;return s.c[4]=s.dom("path",s.css.basic+"position:absolute; width:14px; height:14px; left:5px; top:"+e+"px;",{d:s.svgs.cursor,fill:s.fontColor,stroke:"none"}),s.stat=1,s.isActif=!1,s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;return-1===i.x&&-1===i.y?"":i.x>this.sa&&i.x<this.sa+30?"over":"0"},s.mouseup=function(t){return!!this.isDown&&(this.isDown=!1,this.mousemove(t))},s.mousedown=function(t){return!!this.testZone(t)&&(this.isDown=!0,this.mousemove(t))},s.mousemove=function(t){var i=!1;return"over"===this.testZone(t)?(this.cursor("pointer"),i=this.mode(this.isDown?3:2)):i=this.reset(),i},s.apply=function(t){(t=t||"")!==this.value&&(this.value=t,this.c[3].textContent=this.value,this.send()),this.mode(1)},s.update=function(){this.mode(3)},s.mode=function(t){var i=!1;if(this.stat!==t){switch(1===t&&(this.isActif=!1),3===t&&(this.isActif?this.isActif=!1:(this.isActif=!0,t=4,this.onActif(this))),2===t&&this.isActif&&(t=4),t){case 1:this.stat=1,this.s[2].color=this.fontColor,this.s[2].background=this.buttonColor;break;case 2:this.stat=2,this.s[2].color=this.fontSelect,this.s[2].background=this.buttonOver;break;case 3:this.stat=3,this.s[2].color=this.fontSelect,this.s[2].background=this.buttonDown;break;case 4:this.stat=4,this.s[2].color=this.fontSelect,this.s[2].background=this.buttonAction}i=!0}return i},s.reset=function(){return this.cursor(),this.mode(this.isActif?4:1)},s.text=function(t){this.c[3].textContent=t},s.rSize=function(){t.prototype.rSize.call(this);var i=this.s;i[2].left=this.sa+"px",i[3].left=this.sa+40+"px",i[3].width=this.sb-40+"px",i[4].left=this.sa+8+"px"},i}(l),I=function(t){function i(i){var s,e;void 0===i&&(i={}),(s=t.call(this,i)||this).values=i.values,"string"==typeof s.values&&(s.values=[s.values]),s.value=i.value||s.values[0],s.isDown=!1,s.buttonColor=i.bColor||s.colors.button,s.buttonOver=i.bOver||s.colors.over,s.buttonDown=i.bDown||s.colors.select,s.lng=s.values.length,s.tmp=[],s.stat=[];for(var o=0;o<s.lng;o++)e=!1,s.values[o]===s.value&&(e=!0),s.c[o+2]=s.dom("div",s.css.txt+s.css.button+" top:1px; background:"+(e?s.buttonDown:s.buttonColor)+"; height:"+(s.h-2)+"px; border:"+s.colors.buttonBorder+"; border-radius:"+s.radius+"px;"),s.c[o+2].style.color=e?s.fontSelect:s.fontColor,s.c[o+2].innerHTML=s.values[o],s.stat[o]=e?3:1;return s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";for(var s=this.lng,e=this.tmp;s--;)if(i.x>e[s][0]&&i.x<e[s][2])return s+2;return""},s.mouseup=function(t){return!!this.isDown&&(this.isDown=!1,this.mousemove(t))},s.mousedown=function(t){var i=this.testZone(t);return!!i&&(this.isDown=!0,this.value=this.values[i-2],this.send(),this.mousemove(t))},s.mousemove=function(t){var i=!1,s=this.testZone(t);return""!==s?(this.cursor("pointer"),i=this.modes(this.isDown?3:2,s)):i=this.reset(),i},s.modes=function(t,i){for(var s=!1,e=0;e<this.lng;e++)(e===i-2&&this.values[e]!==this.value?this.mode(t,e+2):this.values[e]===this.value?this.mode(3,e+2):this.mode(1,e+2))&&(s=!0);return s},s.mode=function(t,i){var s=!1,e=i-2;if(this.stat[e]!==t){switch(t){case 1:this.stat[e]=1,this.s[e+2].color=this.fontColor,this.s[e+2].background=this.buttonColor;break;case 2:this.stat[e]=2,this.s[e+2].color=this.fontSelect,this.s[e+2].background=this.buttonOver;break;case 3:this.stat[e]=3,this.s[e+2].color=this.fontSelect,this.s[e+2].background=this.buttonDown}s=!0}return s},s.reset=function(){this.cursor();for(var t=!1,i=0;i<this.lng;i++)(this.values[i]===this.value?this.mode(3,i+2):this.mode(1,i+2))&&(t=!0);return t},s.label=function(t,i){i=i||2,this.c[i].textContent=t},s.icon=function(t,i,s){s=s||2,this.s[s].padding=(i||0)+"px 0px",this.c[s].innerHTML=t},s.rSize=function(){t.prototype.rSize.call(this);for(var i=this.s,s=this.sb,e=this.sa,o=this.lng,n=Math.floor((s-3*(o-1))/o);o--;)this.tmp[o]=[Math.floor(e+n*o+3*o),n],this.tmp[o][2]=this.tmp[o][0]+this.tmp[o][1],i[o+2].left=this.tmp[o][0]+"px",i[o+2].width=this.tmp[o][1]+"px"},i}(l),M=function(t){function i(i){var s;return void 0===i&&(i={}),i.simple=!0,i.isEmpty=!0,(s=t.call(this,i)||this).init(),s}return h(i,t),i}(l),L=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).p=100,s.value=s.txt,s.status=1,s.itype=i.itype||"none",s.val=s.itype,s.graph=s.svgs[s.itype];var e=Math.floor(.5*s.h)-7;return s.c[2]=s.dom("path",s.css.basic+"position:absolute; width:14px; height:14px; left:5px; top:"+e+"px;",{d:s.graph,fill:s.fontColor,stroke:"none"}),s.s[1].marginLeft="20px",s.init(),s}h(i,t);var s=i.prototype;return s.mousemove=function(t){this.cursor("pointer")},s.mousedown=function(t){return this.isUI&&this.main.resetItem(),this.selected(!0),this.send(),!0},s.uiout=function(){this.isSelect?this.mode(3):this.mode(1)},s.uiover=function(){this.isSelect?this.mode(4):this.mode(2)},s.update=function(){},s.mode=function(t){var i=!1;if(this.status!==t){switch(this.status=t,t){case 1:this.status=1,this.s[1].color=this.fontColor,this.s[0].background="none";break;case 2:this.status=2,this.s[1].color=this.fontColor,this.s[0].background=this.bgOver;break;case 3:this.status=3,this.s[1].color="#FFF",this.s[0].background=this.colors.select;break;case 4:this.status=4,this.s[1].color="#FFF",this.s[0].background=this.colors.down}i=!0}return i},s.reset=function(){this.cursor()},s.selected=function(t){this.isSelect&&this.mode(1),this.isSelect=t||!1,this.isSelect&&this.mode(3)},i}(l),z=function(t){function i(i){var s;void 0===i&&(i={}),(s=t.call(this,i)||this).value=!1,s.values=i.values||[],"string"==typeof s.values&&(s.values=[s.values]),s.isDown=!1,s.buttonColor=i.bColor||s.colors.button,s.buttonOver=i.bOver||s.colors.over,s.buttonDown=i.bDown||s.colors.select,s.spaces=i.spaces||[10,3],s.bsize=i.bsize||[90,20],s.lng=s.values.length,s.tmp=[],s.stat=[],s.grid=[2,Math.round(.5*s.lng)],s.h=Math.round(.5*s.lng)*(s.bsize[1]+s.spaces[1])+s.spaces[1],s.c[1].textContent="",s.c[2]=s.dom("table",s.css.basic+"width:100%; top:"+(s.spaces[1]-2)+"px; height:auto; border-collapse:separate; border:none; border-spacing: "+(s.spaces[0]-2)+"px "+(s.spaces[1]-2)+"px;");var e,o,n,h=0;s.buttons=[],s.stat=[],s.tmpX=[],s.tmpY=[];for(var r=0;r<s.grid[1];r++){(n=s.c[2].insertRow()).style.cssText="pointer-events:none;";for(var a=0;a<s.grid[0];a++)(o=n.insertCell()).style.cssText="pointer-events:none;",s.values[h]?((e=document.createElement("div")).style.cssText=s.css.txt+s.css.button+"position:static; width:"+s.bsize[0]+"px; height:"+s.bsize[1]+"px; border:"+s.colors.buttonBorder+"; left:auto; right:auto; background:"+s.buttonColor+";\tborder-radius:"+s.radius+"px;",e.innerHTML=s.values[h],o.appendChild(e),s.buttons.push(e),s.stat.push(1)):((e=document.createElement("div")).style.cssText=s.css.txt+"position:static; width:"+s.bsize[0]+"px; height:"+s.bsize[1]+"px; text-align:center;\tleft:auto; right:auto; background:none;",o.appendChild(e)),e.style.cssText+=0===a?"float:right;":"float:left;",h++}return s.init(),s}h(i,t);var s=i.prototype;return s.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return-1;for(var s=this.tmpX,e=this.tmpY,o=-1,n=-1,h=-1,r=this.grid[0];r--;)i.x>s[r][0]&&i.x<s[r][1]&&(n=r);for(r=this.grid[1];r--;)i.y>e[r][0]&&i.y<e[r][1]&&(h=r);return-1!==n&&-1!==h&&(o=n+2*h)>this.lng-1&&(o=-1),o},s.mouseup=function(t){return!!this.isDown&&(this.value=!1,this.isDown=!1,this.mousemove(t))},s.mousedown=function(t){var i=this.testZone(t);return!(i<0)&&(this.isDown=!0,this.value=this.values[i],this.send(),this.mousemove(t))},s.mousemove=function(t){var i=!1,s=this.testZone(t);return-1!==s?(this.cursor("pointer"),i=this.modes(this.isDown?3:2,s)):i=this.reset(),i},s.modes=function(t,i){for(var s=!1,e=0;e<this.lng;e++)(e===i?this.mode(t,e):this.mode(1,e))&&(s=!0);return s},s.mode=function(t,i){var s=!1,e=i;if(this.stat[e]!==t){switch(t){case 1:this.stat[e]=1,this.buttons[e].style.color=this.fontColor,this.buttons[e].style.background=this.buttonColor;break;case 2:this.stat[e]=2,this.buttons[e].style.color=this.fontSelect,this.buttons[e].style.background=this.buttonOver;break;case 3:this.stat[e]=3,this.buttons[e].style.color=this.fontSelect,this.buttons[e].style.background=this.buttonDown}s=!0}return s},s.reset=function(){return this.cursor(),this.modes(1,0)},s.label=function(t,i){this.buttons[i].textContent=t},s.icon=function(t,i,s){this.buttons[s].style.padding=(i||0)+"px 0px",this.buttons[s].innerHTML=t},s.rSize=function(){var i;t.prototype.rSize.call(this),this.tmpX=[],this.tmpY=[];for(var s=0;s<this.grid[0];s++)0===s?(i=.5*this.w-.5*this.spaces[0],this.tmpX.push([i-this.bsize[0],i])):(i=.5*this.w+.5*this.spaces[0],this.tmpX.push([i,i+this.bsize[0]]));i=this.spaces[1];for(var e=0;e<this.grid[1];e++)this.tmpY.push([i,i+this.bsize[1]]),i+=this.bsize[1]+this.spaces[1]},i}(l),D=function t(){var i,s,e=arguments,o=!1,n=null;"string"==typeof e[0]?(i=e[0],s=e[1]||{}):"object"==typeof e[0]&&(o=!0,void 0===e[2]&&[].push.call(e,{}),i=e[2].type?e[2].type:"slide",(s=e[2]).name=e[1],s.value=e[0][e[1]]);var h=i.toLowerCase();switch("group"===h&&(s.add=t),h){case"bool":n=new c(s);break;case"button":n=new u(s);break;case"circular":n=new d(s);break;case"color":n=new p(s);break;case"fps":n=new f(s);break;case"graph":n=new v(s);break;case"group":n=new m(s);break;case"joystick":n=new g(s);break;case"knob":n=new x(s);break;case"list":n=new b(s);break;case"numeric":case"number":n=new w(s);break;case"slide":n=new y(s);break;case"textInput":case"string":n=new k(s);break;case"title":n=new C(s);break;case"select":n=new S(s);break;case"selector":n=new I(s);break;case"empty":case"space":n=new M(s);break;case"item":n=new L(s);break;case"grid":n=new z(s)}if(null!==n)return o&&n.setReferency(e[0],e[1]),n},H=function(){function t(t){void 0===t&&(t={}),this.canvas=null,this.colors=e.cloneColor(),this.css=e.cloneCss(),t.config&&this.setConfig(t.config),this.bg=t.bg||this.colors.background,void 0!==t.transparent&&(this.colors.background="none",this.colors.backgroundOver="none"),this.isReset=!0,this.tmpAdd=null,this.tmpH=0,this.isCanvas=t.isCanvas||!1,this.isCanvasOnly=!1,this.cssGui=void 0!==t.css?t.css:"",this.callback=void 0===t.callback?null:t.callback,this.forceHeight=t.maxHeight||0,this.lockHeight=t.lockHeight||!1,this.isItemMode=void 0!==t.itemMode&&t.itemMode,this.cn="",this.size=e.size,void 0!==t.p&&(this.size.p=t.p),void 0!==t.w&&(this.size.w=t.w),void 0!==t.h&&(this.size.h=t.h),void 0!==t.s&&(this.size.s=t.s),this.size.h=this.size.h<11?11:this.size.h,this.local=(new a).neg(),this.zone={x:0,y:0,w:this.size.w,h:0},this.mouse=(new a).neg(),this.h=0,this.prevY=-1,this.sw=0,this.isWithClose=void 0===t.close||t.close,this.bh=this.isWithClose?this.size.h:0,this.autoResize=void 0===t.autoResize||t.autoResize,this.isCenter=t.center||!1,this.isOpen=!0,this.isDown=!1,this.isScroll=!1,this.uis=[],this.current=-1,this.target=null,this.decal=0,this.ratio=1,this.oy=0,this.isNewTarget=!1,this.content=e.dom("div",this.css.basic+" width:0px; height:auto; top:0px; "+this.cssGui),this.innerContent=e.dom("div",this.css.basic+"width:100%; top:0; left:0; height:auto; overflow:hidden;"),this.content.appendChild(this.innerContent),this.inner=e.dom("div",this.css.basic+"width:100%; left:0; "),this.innerContent.appendChild(this.inner),this.scrollBG=e.dom("div",this.css.basic+"right:0; top:0; width:"+(this.size.s-1)+"px; height:10px; display:none; background:"+this.bg+";"),this.content.appendChild(this.scrollBG),this.scroll=e.dom("div",this.css.basic+"background:"+this.colors.scroll+"; right:2px; top:0; width:"+(this.size.s-4)+"px; height:10px;"),this.scrollBG.appendChild(this.scroll),this.bottom=e.dom("div",this.css.txt+"width:100%; top:auto; bottom:0; left:0; border-bottom-right-radius:10px;\tborder-bottom-left-radius:10px; text-align:center; height:"+this.bh+"px; line-height:"+(this.bh-5)+"px; border-top:1px solid "+e.colors.stroke+";"),this.content.appendChild(this.bottom),this.bottom.textContent="close",this.bottom.style.background=this.bg,this.parent=void 0!==t.parent?t.parent:null,null!==this.parent||this.isCanvas||(this.parent=document.body,this.isCenter||(this.content.style.right="10px")),null!==this.parent&&this.parent.appendChild(this.content),this.isCanvas&&null===this.parent&&(this.isCanvasOnly=!0),this.isCanvasOnly||(this.content.style.pointerEvents="auto"),this.setWidth(),this.isCanvas&&this.makeCanvas(),n.add(this)}var i=t.prototype;return i.setTop=function(t,i){this.content.style.top=t+"px",void 0!==i&&(this.forceHeight=i),this.setHeight(),n.needReZone=!0},i.dispose=function(){this.clear(),null!==this.parent&&this.parent.removeChild(this.content),n.remove(this)},i.onDraw=function(){},i.makeCanvas=function(){this.canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.canvas.width=this.zone.w,this.canvas.height=this.forceHeight?this.forceHeight:this.zone.h},i.draw=function(t){if(null!==this.canvas){var i=this.zone.w,s=this.forceHeight?this.forceHeight:this.zone.h;n.toCanvas(this,i,s,t)}},i.getDom=function(){return this.content},i.setMouse=function(t){this.mouse.set(t.x,t.y)},i.setConfig=function(t){this.setColors(t),this.setText(t.fontSize,t.text,t.font,t.shadow)},i.setColors=function(t){for(var i in t)this.colors[i]&&(this.colors[i]=t[i])},i.setText=function(t,i,s,o){e.setText(t,i,s,o,this.colors,this.css)},i.hide=function(t){this.content.style.display=t?"none":"block"},i.onChange=function(t){return this.callback=t||null,this},i.mode=function(t){var i=!1;if(t!==this.cn){switch(this.cn=t,t){case"def":this.scroll.style.background=this.colors.scroll,this.bottom.style.background=this.colors.background,this.bottom.style.color=this.colors.text;break;case"scrollOver":this.scroll.style.background=this.colors.select;break;case"scrollDown":this.scroll.style.background=this.colors.down;break;case"bottomOver":this.bottom.style.background=this.colors.backgroundOver,this.bottom.style.color="#FFF"}i=!0}return i},i.clearTarget=function(){return-1!==this.current&&(this.target.uiout(),this.target.reset(),this.target=null,this.current=-1,n.cursor(),!0)},i.testZone=function(t){var i=this.local;if(-1===i.x&&-1===i.y)return"";this.isReset=!1;var s=this.isScroll?this.zone.w-this.size.s:this.zone.w;return i.y>this.zone.h-this.bh&&i.y<this.zone.h?"bottom":i.x>s?"scroll":"content"},i.handleEvent=function(t){var i=t.type,s=!1,e=!1,o=this.testZone(t);if("mouseup"===i&&this.isDown&&(this.isDown=!1),"mousedown"!==i||this.isDown||(this.isDown=!0),this.isDown&&this.isNewTarget&&(n.clearInput(),this.isNewTarget=!1),o){switch(o){case"content":t.clientY=this.isScroll?t.clientY+this.decal:t.clientY,n.isMobile&&"mousedown"===i&&this.getNext(t,s),this.target&&(e=this.target.handleEvent(t)),"mousemove"===i&&(s=this.mode("def")),"wheel"===i&&!e&&this.isScroll&&(s=this.onWheel(t)),n.lock||this.getNext(t,s);break;case"bottom":this.clearTarget(),"mousemove"===i&&(s=this.mode("bottomOver")),"mousedown"===i&&(this.isOpen=!this.isOpen,this.bottom.textContent=this.isOpen?"close":"open",this.setHeight(),this.mode("def"),s=!0);break;case"scroll":this.clearTarget(),"mousemove"===i&&(s=this.mode("scrollOver")),"mousedown"===i&&(s=this.mode("scrollDown")),"wheel"===i&&(s=this.onWheel(t)),this.isDown&&this.update(t.clientY-this.zone.y-.5*this.sh)}this.isDown&&(s=!0),e&&(s=!0),"keyup"===i&&(s=!0),"keydown"===i&&(s=!0),s&&this.draw()}},i.getNext=function(t,i){var s=n.findTarget(this.uis,t);s!==this.current&&(this.clearTarget(),this.current=s,this.isNewTarget=!0),-1!==s&&(this.target=this.uis[this.current],this.target.uiover())},i.onWheel=function(t){return this.oy+=20*t.delta,this.update(this.oy),!0},i.reset=function(t){if(!this.isReset){this.mouse.neg(),this.isDown=!1;var i=this.mode("def"),s=this.clearTarget();(i||s)&&this.draw(!0),this.isReset=!0}},i.add=function(){var t=arguments;"object"==typeof t[1]?(t[1].isUI=!0,t[1].main=this):"string"==typeof t[1]&&(void 0===t[2]?[].push.call(t,{isUI:!0,main:this}):(t[2].isUI=!0,t[2].main=this));var i=D.apply(this,t);if(null!==i){if(this.uis.push(i),i.autoWidth)this.prevY=0,this.calc(i.h+1);else{var s=i.c[0].getBoundingClientRect().top;this.prevY!==s&&(this.calc(i.h+1),this.prevY=s)}return i}},i.applyCalc=function(){this.calc(this.tmpH),this.tmpAdd=null},i.calcUis=function(){n.calcUis(this.uis,this.zone,this.zone.y)},i.remove=function(t){var i=this.uis.indexOf(t);-1!==i&&this.uis[i].clear()},i.clearOne=function(t){var i=this.uis.indexOf(t);-1!==i&&(this.inner.removeChild(this.uis[i].c[0]),this.uis.splice(i,1))},i.clear=function(){for(var t=this.uis.length;t--;)this.uis[t].clear();this.uis=[],n.listens=[],this.calc(-this.h)},i.resetItem=function(){if(this.isItemMode)for(var t=this.uis.length;t--;)this.uis[t].selected()},i.setItem=function(t){if(this.isItemMode)if(t=t||"",this.resetItem(),t)for(var i=this.uis.length;i--;)this.uis[i].value===t&&(this.uis[i].selected(!0),this.isScroll&&this.update(i*(this.uis[i].h+1)*this.ratio));else this.update(0)},i.upScroll=function(t){this.sw=t?this.size.s:0,this.oy=t?this.oy:0,this.scrollBG.style.display=t?"block":"none",t&&(this.total=this.h,this.maxView=this.maxHeight,this.ratio=this.maxView/this.total,this.sh=this.maxView*this.ratio,this.range=this.maxView-this.sh,this.oy=e.clamp(this.oy,0,this.range),this.scrollBG.style.height=this.maxView+"px",this.scroll.style.height=this.sh+"px"),this.setItemWidth(this.zone.w-this.sw),this.update(this.oy)},i.update=function(t){t=e.clamp(t,0,this.range),this.decal=Math.floor(t/this.ratio),this.inner.style.top=-this.decal+"px",this.scroll.style.top=Math.floor(t)+"px",this.oy=t},i.calc=function(t){this.h+=t,clearTimeout(this.tmp),this.tmp=setTimeout(this.setHeight.bind(this),10)},i.setHeight=function(){if(this.tmp&&clearTimeout(this.tmp),this.zone.h=this.bh,this.isScroll=!1,this.isOpen){var t=this.forceHeight?this.forceHeight+this.zone.y:window.innerHeight;this.maxHeight=t-this.zone.y-this.bh,this.h-this.maxHeight>1?(this.isScroll=!0,this.zone.h=this.maxHeight+this.bh):this.zone.h=this.h+this.bh}this.upScroll(this.isScroll),this.innerContent.style.height=this.zone.h-this.bh+"px",this.content.style.height=this.zone.h+"px",this.bottom.style.top=this.zone.h-this.bh+"px",this.forceHeight&&this.lockHeight&&(this.content.style.height=this.forceHeight+"px"),this.isOpen&&this.calcUis(),this.isCanvas&&this.draw(!0)},i.rezone=function(){n.needReZone=!0},i.setWidth=function(t){t&&(this.zone.w=t),this.content.style.width=this.zone.w+"px",this.isCenter&&(this.content.style.marginLeft=-Math.floor(.5*this.zone.w)+"px"),this.setItemWidth(this.zone.w-this.sw),this.setHeight(),this.isCanvasOnly||(n.needReZone=!0)},i.setItemWidth=function(t){for(var i=this.uis.length;i--;)this.uis[i].setSize(t),this.uis[i].rSize()},t}();H.prototype.isGui=!0;t.Bool=c,t.Button=u,t.Circular=d,t.Color=p,t.Fps=f,t.Group=m,t.Gui=H,t.Joystick=g,t.Knob=x,t.List=b,t.Numeric=w,t.Proto=l,t.REVISION="2.8",t.Slide=y,t.TextInput=k,t.Title=C,t.Tools=e,t.add=D,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidWlsLm1pbi5qcyIsInNvdXJjZXMiOlsiLi4vbm9kZV9tb2R1bGVzL3JlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyIsIi4uL3NyYy9jb3JlL1Rvb2xzLmpzIiwiLi4vc3JjL2NvcmUvUm9vdHMuanMiLCIuLi9zcmMvY29yZS9WMi5qcyIsIi4uL3NyYy9jb3JlL1Byb3RvLmpzIiwiLi4vc3JjL3Byb3RvL0Jvb2wuanMiLCIuLi9zcmMvcHJvdG8vQnV0dG9uLmpzIiwiLi4vc3JjL3Byb3RvL0NpcmN1bGFyLmpzIiwiLi4vc3JjL3Byb3RvL0NvbG9yLmpzIiwiLi4vc3JjL3Byb3RvL0Zwcy5qcyIsIi4uL3NyYy9wcm90by9HcmFwaC5qcyIsIi4uL3NyYy9wcm90by9Hcm91cC5qcyIsIi4uL3NyYy9wcm90by9Kb3lzdGljay5qcyIsIi4uL3NyYy9wcm90by9Lbm9iLmpzIiwiLi4vc3JjL3Byb3RvL0xpc3QuanMiLCIuLi9zcmMvcHJvdG8vTnVtZXJpYy5qcyIsIi4uL3NyYy9wcm90by9TbGlkZS5qcyIsIi4uL3NyYy9wcm90by9UZXh0SW5wdXQuanMiLCIuLi9zcmMvcHJvdG8vVGl0bGUuanMiLCIuLi9zcmMvcHJvdG8vU2VsZWN0LmpzIiwiLi4vc3JjL3Byb3RvL1NlbGVjdG9yLmpzIiwiLi4vc3JjL3Byb3RvL0VtcHR5LmpzIiwiLi4vc3JjL3Byb3RvL0l0ZW0uanMiLCIuLi9zcmMvcHJvdG8vR3JpZC5qcyIsIi4uL3NyYy9jb3JlL2FkZC5qcyIsIi4uL3NyYy9jb3JlL0d1aS5qcyIsIi4uL3NyYy9VaWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG52YXIgcnVudGltZSA9IChmdW5jdGlvbiAoZXhwb3J0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgT3AgPSBPYmplY3QucHJvdG90eXBlO1xuICB2YXIgaGFzT3duID0gT3AuaGFzT3duUHJvcGVydHk7XG4gIHZhciB1bmRlZmluZWQ7IC8vIE1vcmUgY29tcHJlc3NpYmxlIHRoYW4gdm9pZCAwLlxuICB2YXIgJFN5bWJvbCA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiA/IFN5bWJvbCA6IHt9O1xuICB2YXIgaXRlcmF0b3JTeW1ib2wgPSAkU3ltYm9sLml0ZXJhdG9yIHx8IFwiQEBpdGVyYXRvclwiO1xuICB2YXIgYXN5bmNJdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuYXN5bmNJdGVyYXRvciB8fCBcIkBAYXN5bmNJdGVyYXRvclwiO1xuICB2YXIgdG9TdHJpbmdUYWdTeW1ib2wgPSAkU3ltYm9sLnRvU3RyaW5nVGFnIHx8IFwiQEB0b1N0cmluZ1RhZ1wiO1xuXG4gIGZ1bmN0aW9uIGRlZmluZShvYmosIGtleSwgdmFsdWUpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBvYmpba2V5XTtcbiAgfVxuICB0cnkge1xuICAgIC8vIElFIDggaGFzIGEgYnJva2VuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSB0aGF0IG9ubHkgd29ya3Mgb24gRE9NIG9iamVjdHMuXG4gICAgZGVmaW5lKHt9LCBcIlwiKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgZGVmaW5lID0gZnVuY3Rpb24ob2JqLCBrZXksIHZhbHVlKSB7XG4gICAgICByZXR1cm4gb2JqW2tleV0gPSB2YWx1ZTtcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCkge1xuICAgIC8vIElmIG91dGVyRm4gcHJvdmlkZWQgYW5kIG91dGVyRm4ucHJvdG90eXBlIGlzIGEgR2VuZXJhdG9yLCB0aGVuIG91dGVyRm4ucHJvdG90eXBlIGluc3RhbmNlb2YgR2VuZXJhdG9yLlxuICAgIHZhciBwcm90b0dlbmVyYXRvciA9IG91dGVyRm4gJiYgb3V0ZXJGbi5wcm90b3R5cGUgaW5zdGFuY2VvZiBHZW5lcmF0b3IgPyBvdXRlckZuIDogR2VuZXJhdG9yO1xuICAgIHZhciBnZW5lcmF0b3IgPSBPYmplY3QuY3JlYXRlKHByb3RvR2VuZXJhdG9yLnByb3RvdHlwZSk7XG4gICAgdmFyIGNvbnRleHQgPSBuZXcgQ29udGV4dCh0cnlMb2NzTGlzdCB8fCBbXSk7XG5cbiAgICAvLyBUaGUgLl9pbnZva2UgbWV0aG9kIHVuaWZpZXMgdGhlIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgLm5leHQsXG4gICAgLy8gLnRocm93LCBhbmQgLnJldHVybiBtZXRob2RzLlxuICAgIGdlbmVyYXRvci5faW52b2tlID0gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTtcblxuICAgIHJldHVybiBnZW5lcmF0b3I7XG4gIH1cbiAgZXhwb3J0cy53cmFwID0gd3JhcDtcblxuICAvLyBUcnkvY2F0Y2ggaGVscGVyIHRvIG1pbmltaXplIGRlb3B0aW1pemF0aW9ucy4gUmV0dXJucyBhIGNvbXBsZXRpb25cbiAgLy8gcmVjb3JkIGxpa2UgY29udGV4dC50cnlFbnRyaWVzW2ldLmNvbXBsZXRpb24uIFRoaXMgaW50ZXJmYWNlIGNvdWxkXG4gIC8vIGhhdmUgYmVlbiAoYW5kIHdhcyBwcmV2aW91c2x5KSBkZXNpZ25lZCB0byB0YWtlIGEgY2xvc3VyZSB0byBiZVxuICAvLyBpbnZva2VkIHdpdGhvdXQgYXJndW1lbnRzLCBidXQgaW4gYWxsIHRoZSBjYXNlcyB3ZSBjYXJlIGFib3V0IHdlXG4gIC8vIGFscmVhZHkgaGF2ZSBhbiBleGlzdGluZyBtZXRob2Qgd2Ugd2FudCB0byBjYWxsLCBzbyB0aGVyZSdzIG5vIG5lZWRcbiAgLy8gdG8gY3JlYXRlIGEgbmV3IGZ1bmN0aW9uIG9iamVjdC4gV2UgY2FuIGV2ZW4gZ2V0IGF3YXkgd2l0aCBhc3N1bWluZ1xuICAvLyB0aGUgbWV0aG9kIHRha2VzIGV4YWN0bHkgb25lIGFyZ3VtZW50LCBzaW5jZSB0aGF0IGhhcHBlbnMgdG8gYmUgdHJ1ZVxuICAvLyBpbiBldmVyeSBjYXNlLCBzbyB3ZSBkb24ndCBoYXZlIHRvIHRvdWNoIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBUaGVcbiAgLy8gb25seSBhZGRpdGlvbmFsIGFsbG9jYXRpb24gcmVxdWlyZWQgaXMgdGhlIGNvbXBsZXRpb24gcmVjb3JkLCB3aGljaFxuICAvLyBoYXMgYSBzdGFibGUgc2hhcGUgYW5kIHNvIGhvcGVmdWxseSBzaG91bGQgYmUgY2hlYXAgdG8gYWxsb2NhdGUuXG4gIGZ1bmN0aW9uIHRyeUNhdGNoKGZuLCBvYmosIGFyZykge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcIm5vcm1hbFwiLCBhcmc6IGZuLmNhbGwob2JqLCBhcmcpIH07XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcInRocm93XCIsIGFyZzogZXJyIH07XG4gICAgfVxuICB9XG5cbiAgdmFyIEdlblN0YXRlU3VzcGVuZGVkU3RhcnQgPSBcInN1c3BlbmRlZFN0YXJ0XCI7XG4gIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkID0gXCJzdXNwZW5kZWRZaWVsZFwiO1xuICB2YXIgR2VuU3RhdGVFeGVjdXRpbmcgPSBcImV4ZWN1dGluZ1wiO1xuICB2YXIgR2VuU3RhdGVDb21wbGV0ZWQgPSBcImNvbXBsZXRlZFwiO1xuXG4gIC8vIFJldHVybmluZyB0aGlzIG9iamVjdCBmcm9tIHRoZSBpbm5lckZuIGhhcyB0aGUgc2FtZSBlZmZlY3QgYXNcbiAgLy8gYnJlYWtpbmcgb3V0IG9mIHRoZSBkaXNwYXRjaCBzd2l0Y2ggc3RhdGVtZW50LlxuICB2YXIgQ29udGludWVTZW50aW5lbCA9IHt9O1xuXG4gIC8vIER1bW15IGNvbnN0cnVjdG9yIGZ1bmN0aW9ucyB0aGF0IHdlIHVzZSBhcyB0aGUgLmNvbnN0cnVjdG9yIGFuZFxuICAvLyAuY29uc3RydWN0b3IucHJvdG90eXBlIHByb3BlcnRpZXMgZm9yIGZ1bmN0aW9ucyB0aGF0IHJldHVybiBHZW5lcmF0b3JcbiAgLy8gb2JqZWN0cy4gRm9yIGZ1bGwgc3BlYyBjb21wbGlhbmNlLCB5b3UgbWF5IHdpc2ggdG8gY29uZmlndXJlIHlvdXJcbiAgLy8gbWluaWZpZXIgbm90IHRvIG1hbmdsZSB0aGUgbmFtZXMgb2YgdGhlc2UgdHdvIGZ1bmN0aW9ucy5cbiAgZnVuY3Rpb24gR2VuZXJhdG9yKCkge31cbiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb24oKSB7fVxuICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSgpIHt9XG5cbiAgLy8gVGhpcyBpcyBhIHBvbHlmaWxsIGZvciAlSXRlcmF0b3JQcm90b3R5cGUlIGZvciBlbnZpcm9ubWVudHMgdGhhdFxuICAvLyBkb24ndCBuYXRpdmVseSBzdXBwb3J0IGl0LlxuICB2YXIgSXRlcmF0b3JQcm90b3R5cGUgPSB7fTtcbiAgSXRlcmF0b3JQcm90b3R5cGVbaXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIHZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZjtcbiAgdmFyIE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlID0gZ2V0UHJvdG8gJiYgZ2V0UHJvdG8oZ2V0UHJvdG8odmFsdWVzKFtdKSkpO1xuICBpZiAoTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgJiZcbiAgICAgIE5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlICE9PSBPcCAmJlxuICAgICAgaGFzT3duLmNhbGwoTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUsIGl0ZXJhdG9yU3ltYm9sKSkge1xuICAgIC8vIFRoaXMgZW52aXJvbm1lbnQgaGFzIGEgbmF0aXZlICVJdGVyYXRvclByb3RvdHlwZSU7IHVzZSBpdCBpbnN0ZWFkXG4gICAgLy8gb2YgdGhlIHBvbHlmaWxsLlxuICAgIEl0ZXJhdG9yUHJvdG90eXBlID0gTmF0aXZlSXRlcmF0b3JQcm90b3R5cGU7XG4gIH1cblxuICB2YXIgR3AgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZS5wcm90b3R5cGUgPVxuICAgIEdlbmVyYXRvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEl0ZXJhdG9yUHJvdG90eXBlKTtcbiAgR2VuZXJhdG9yRnVuY3Rpb24ucHJvdG90eXBlID0gR3AuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZTtcbiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvbjtcbiAgR2VuZXJhdG9yRnVuY3Rpb24uZGlzcGxheU5hbWUgPSBkZWZpbmUoXG4gICAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUsXG4gICAgdG9TdHJpbmdUYWdTeW1ib2wsXG4gICAgXCJHZW5lcmF0b3JGdW5jdGlvblwiXG4gICk7XG5cbiAgLy8gSGVscGVyIGZvciBkZWZpbmluZyB0aGUgLm5leHQsIC50aHJvdywgYW5kIC5yZXR1cm4gbWV0aG9kcyBvZiB0aGVcbiAgLy8gSXRlcmF0b3IgaW50ZXJmYWNlIGluIHRlcm1zIG9mIGEgc2luZ2xlIC5faW52b2tlIG1ldGhvZC5cbiAgZnVuY3Rpb24gZGVmaW5lSXRlcmF0b3JNZXRob2RzKHByb3RvdHlwZSkge1xuICAgIFtcIm5leHRcIiwgXCJ0aHJvd1wiLCBcInJldHVyblwiXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICAgICAgZGVmaW5lKHByb3RvdHlwZSwgbWV0aG9kLCBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludm9rZShtZXRob2QsIGFyZyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGV4cG9ydHMuaXNHZW5lcmF0b3JGdW5jdGlvbiA9IGZ1bmN0aW9uKGdlbkZ1bikge1xuICAgIHZhciBjdG9yID0gdHlwZW9mIGdlbkZ1biA9PT0gXCJmdW5jdGlvblwiICYmIGdlbkZ1bi5jb25zdHJ1Y3RvcjtcbiAgICByZXR1cm4gY3RvclxuICAgICAgPyBjdG9yID09PSBHZW5lcmF0b3JGdW5jdGlvbiB8fFxuICAgICAgICAvLyBGb3IgdGhlIG5hdGl2ZSBHZW5lcmF0b3JGdW5jdGlvbiBjb25zdHJ1Y3RvciwgdGhlIGJlc3Qgd2UgY2FuXG4gICAgICAgIC8vIGRvIGlzIHRvIGNoZWNrIGl0cyAubmFtZSBwcm9wZXJ0eS5cbiAgICAgICAgKGN0b3IuZGlzcGxheU5hbWUgfHwgY3Rvci5uYW1lKSA9PT0gXCJHZW5lcmF0b3JGdW5jdGlvblwiXG4gICAgICA6IGZhbHNlO1xuICB9O1xuXG4gIGV4cG9ydHMubWFyayA9IGZ1bmN0aW9uKGdlbkZ1bikge1xuICAgIGlmIChPYmplY3Quc2V0UHJvdG90eXBlT2YpIHtcbiAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihnZW5GdW4sIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZ2VuRnVuLl9fcHJvdG9fXyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlO1xuICAgICAgZGVmaW5lKGdlbkZ1biwgdG9TdHJpbmdUYWdTeW1ib2wsIFwiR2VuZXJhdG9yRnVuY3Rpb25cIik7XG4gICAgfVxuICAgIGdlbkZ1bi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdwKTtcbiAgICByZXR1cm4gZ2VuRnVuO1xuICB9O1xuXG4gIC8vIFdpdGhpbiB0aGUgYm9keSBvZiBhbnkgYXN5bmMgZnVuY3Rpb24sIGBhd2FpdCB4YCBpcyB0cmFuc2Zvcm1lZCB0b1xuICAvLyBgeWllbGQgcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKHgpYCwgc28gdGhhdCB0aGUgcnVudGltZSBjYW4gdGVzdFxuICAvLyBgaGFzT3duLmNhbGwodmFsdWUsIFwiX19hd2FpdFwiKWAgdG8gZGV0ZXJtaW5lIGlmIHRoZSB5aWVsZGVkIHZhbHVlIGlzXG4gIC8vIG1lYW50IHRvIGJlIGF3YWl0ZWQuXG4gIGV4cG9ydHMuYXdyYXAgPSBmdW5jdGlvbihhcmcpIHtcbiAgICByZXR1cm4geyBfX2F3YWl0OiBhcmcgfTtcbiAgfTtcblxuICBmdW5jdGlvbiBBc3luY0l0ZXJhdG9yKGdlbmVyYXRvciwgUHJvbWlzZUltcGwpIHtcbiAgICBmdW5jdGlvbiBpbnZva2UobWV0aG9kLCBhcmcsIHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGdlbmVyYXRvclttZXRob2RdLCBnZW5lcmF0b3IsIGFyZyk7XG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICByZWplY3QocmVjb3JkLmFyZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcmVzdWx0ID0gcmVjb3JkLmFyZztcbiAgICAgICAgdmFyIHZhbHVlID0gcmVzdWx0LnZhbHVlO1xuICAgICAgICBpZiAodmFsdWUgJiZcbiAgICAgICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJlxuICAgICAgICAgICAgaGFzT3duLmNhbGwodmFsdWUsIFwiX19hd2FpdFwiKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlSW1wbC5yZXNvbHZlKHZhbHVlLl9fYXdhaXQpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIGludm9rZShcIm5leHRcIiwgdmFsdWUsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBpbnZva2UoXCJ0aHJvd1wiLCBlcnIsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gUHJvbWlzZUltcGwucmVzb2x2ZSh2YWx1ZSkudGhlbihmdW5jdGlvbih1bndyYXBwZWQpIHtcbiAgICAgICAgICAvLyBXaGVuIGEgeWllbGRlZCBQcm9taXNlIGlzIHJlc29sdmVkLCBpdHMgZmluYWwgdmFsdWUgYmVjb21lc1xuICAgICAgICAgIC8vIHRoZSAudmFsdWUgb2YgdGhlIFByb21pc2U8e3ZhbHVlLGRvbmV9PiByZXN1bHQgZm9yIHRoZVxuICAgICAgICAgIC8vIGN1cnJlbnQgaXRlcmF0aW9uLlxuICAgICAgICAgIHJlc3VsdC52YWx1ZSA9IHVud3JhcHBlZDtcbiAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgLy8gSWYgYSByZWplY3RlZCBQcm9taXNlIHdhcyB5aWVsZGVkLCB0aHJvdyB0aGUgcmVqZWN0aW9uIGJhY2tcbiAgICAgICAgICAvLyBpbnRvIHRoZSBhc3luYyBnZW5lcmF0b3IgZnVuY3Rpb24gc28gaXQgY2FuIGJlIGhhbmRsZWQgdGhlcmUuXG4gICAgICAgICAgcmV0dXJuIGludm9rZShcInRocm93XCIsIGVycm9yLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgcHJldmlvdXNQcm9taXNlO1xuXG4gICAgZnVuY3Rpb24gZW5xdWV1ZShtZXRob2QsIGFyZykge1xuICAgICAgZnVuY3Rpb24gY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZUltcGwoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXZpb3VzUHJvbWlzZSA9XG4gICAgICAgIC8vIElmIGVucXVldWUgaGFzIGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiB3ZSB3YW50IHRvIHdhaXQgdW50aWxcbiAgICAgICAgLy8gYWxsIHByZXZpb3VzIFByb21pc2VzIGhhdmUgYmVlbiByZXNvbHZlZCBiZWZvcmUgY2FsbGluZyBpbnZva2UsXG4gICAgICAgIC8vIHNvIHRoYXQgcmVzdWx0cyBhcmUgYWx3YXlzIGRlbGl2ZXJlZCBpbiB0aGUgY29ycmVjdCBvcmRlci4gSWZcbiAgICAgICAgLy8gZW5xdWV1ZSBoYXMgbm90IGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiBpdCBpcyBpbXBvcnRhbnQgdG9cbiAgICAgICAgLy8gY2FsbCBpbnZva2UgaW1tZWRpYXRlbHksIHdpdGhvdXQgd2FpdGluZyBvbiBhIGNhbGxiYWNrIHRvIGZpcmUsXG4gICAgICAgIC8vIHNvIHRoYXQgdGhlIGFzeW5jIGdlbmVyYXRvciBmdW5jdGlvbiBoYXMgdGhlIG9wcG9ydHVuaXR5IHRvIGRvXG4gICAgICAgIC8vIGFueSBuZWNlc3Nhcnkgc2V0dXAgaW4gYSBwcmVkaWN0YWJsZSB3YXkuIFRoaXMgcHJlZGljdGFiaWxpdHlcbiAgICAgICAgLy8gaXMgd2h5IHRoZSBQcm9taXNlIGNvbnN0cnVjdG9yIHN5bmNocm9ub3VzbHkgaW52b2tlcyBpdHNcbiAgICAgICAgLy8gZXhlY3V0b3IgY2FsbGJhY2ssIGFuZCB3aHkgYXN5bmMgZnVuY3Rpb25zIHN5bmNocm9ub3VzbHlcbiAgICAgICAgLy8gZXhlY3V0ZSBjb2RlIGJlZm9yZSB0aGUgZmlyc3QgYXdhaXQuIFNpbmNlIHdlIGltcGxlbWVudCBzaW1wbGVcbiAgICAgICAgLy8gYXN5bmMgZnVuY3Rpb25zIGluIHRlcm1zIG9mIGFzeW5jIGdlbmVyYXRvcnMsIGl0IGlzIGVzcGVjaWFsbHlcbiAgICAgICAgLy8gaW1wb3J0YW50IHRvIGdldCB0aGlzIHJpZ2h0LCBldmVuIHRob3VnaCBpdCByZXF1aXJlcyBjYXJlLlxuICAgICAgICBwcmV2aW91c1Byb21pc2UgPyBwcmV2aW91c1Byb21pc2UudGhlbihcbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZyxcbiAgICAgICAgICAvLyBBdm9pZCBwcm9wYWdhdGluZyBmYWlsdXJlcyB0byBQcm9taXNlcyByZXR1cm5lZCBieSBsYXRlclxuICAgICAgICAgIC8vIGludm9jYXRpb25zIG9mIHRoZSBpdGVyYXRvci5cbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZ1xuICAgICAgICApIDogY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKTtcbiAgICB9XG5cbiAgICAvLyBEZWZpbmUgdGhlIHVuaWZpZWQgaGVscGVyIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gaW1wbGVtZW50IC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gKHNlZSBkZWZpbmVJdGVyYXRvck1ldGhvZHMpLlxuICAgIHRoaXMuX2ludm9rZSA9IGVucXVldWU7XG4gIH1cblxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpO1xuICBBc3luY0l0ZXJhdG9yLnByb3RvdHlwZVthc3luY0l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgZXhwb3J0cy5Bc3luY0l0ZXJhdG9yID0gQXN5bmNJdGVyYXRvcjtcblxuICAvLyBOb3RlIHRoYXQgc2ltcGxlIGFzeW5jIGZ1bmN0aW9ucyBhcmUgaW1wbGVtZW50ZWQgb24gdG9wIG9mXG4gIC8vIEFzeW5jSXRlcmF0b3Igb2JqZWN0czsgdGhleSBqdXN0IHJldHVybiBhIFByb21pc2UgZm9yIHRoZSB2YWx1ZSBvZlxuICAvLyB0aGUgZmluYWwgcmVzdWx0IHByb2R1Y2VkIGJ5IHRoZSBpdGVyYXRvci5cbiAgZXhwb3J0cy5hc3luYyA9IGZ1bmN0aW9uKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0LCBQcm9taXNlSW1wbCkge1xuICAgIGlmIChQcm9taXNlSW1wbCA9PT0gdm9pZCAwKSBQcm9taXNlSW1wbCA9IFByb21pc2U7XG5cbiAgICB2YXIgaXRlciA9IG5ldyBBc3luY0l0ZXJhdG9yKFxuICAgICAgd3JhcChpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCksXG4gICAgICBQcm9taXNlSW1wbFxuICAgICk7XG5cbiAgICByZXR1cm4gZXhwb3J0cy5pc0dlbmVyYXRvckZ1bmN0aW9uKG91dGVyRm4pXG4gICAgICA/IGl0ZXIgLy8gSWYgb3V0ZXJGbiBpcyBhIGdlbmVyYXRvciwgcmV0dXJuIHRoZSBmdWxsIGl0ZXJhdG9yLlxuICAgICAgOiBpdGVyLm5leHQoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgIHJldHVybiByZXN1bHQuZG9uZSA/IHJlc3VsdC52YWx1ZSA6IGl0ZXIubmV4dCgpO1xuICAgICAgICB9KTtcbiAgfTtcblxuICBmdW5jdGlvbiBtYWtlSW52b2tlTWV0aG9kKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpIHtcbiAgICB2YXIgc3RhdGUgPSBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZykge1xuICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZUV4ZWN1dGluZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBydW5uaW5nXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlQ29tcGxldGVkKSB7XG4gICAgICAgIGlmIChtZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIHRocm93IGFyZztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJlIGZvcmdpdmluZywgcGVyIDI1LjMuMy4zLjMgb2YgdGhlIHNwZWM6XG4gICAgICAgIC8vIGh0dHBzOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy1nZW5lcmF0b3JyZXN1bWVcbiAgICAgICAgcmV0dXJuIGRvbmVSZXN1bHQoKTtcbiAgICAgIH1cblxuICAgICAgY29udGV4dC5tZXRob2QgPSBtZXRob2Q7XG4gICAgICBjb250ZXh0LmFyZyA9IGFyZztcblxuICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIGRlbGVnYXRlID0gY29udGV4dC5kZWxlZ2F0ZTtcbiAgICAgICAgaWYgKGRlbGVnYXRlKSB7XG4gICAgICAgICAgdmFyIGRlbGVnYXRlUmVzdWx0ID0gbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCk7XG4gICAgICAgICAgaWYgKGRlbGVnYXRlUmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAoZGVsZWdhdGVSZXN1bHQgPT09IENvbnRpbnVlU2VudGluZWwpIGNvbnRpbnVlO1xuICAgICAgICAgICAgcmV0dXJuIGRlbGVnYXRlUmVzdWx0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb250ZXh0Lm1ldGhvZCA9PT0gXCJuZXh0XCIpIHtcbiAgICAgICAgICAvLyBTZXR0aW5nIGNvbnRleHQuX3NlbnQgZm9yIGxlZ2FjeSBzdXBwb3J0IG9mIEJhYmVsJ3NcbiAgICAgICAgICAvLyBmdW5jdGlvbi5zZW50IGltcGxlbWVudGF0aW9uLlxuICAgICAgICAgIGNvbnRleHQuc2VudCA9IGNvbnRleHQuX3NlbnQgPSBjb250ZXh0LmFyZztcblxuICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQpIHtcbiAgICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgICB0aHJvdyBjb250ZXh0LmFyZztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb250ZXh0LmRpc3BhdGNoRXhjZXB0aW9uKGNvbnRleHQuYXJnKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInJldHVyblwiKSB7XG4gICAgICAgICAgY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgY29udGV4dC5hcmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUV4ZWN1dGluZztcblxuICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goaW5uZXJGbiwgc2VsZiwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIikge1xuICAgICAgICAgIC8vIElmIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gZnJvbSBpbm5lckZuLCB3ZSBsZWF2ZSBzdGF0ZSA9PT1cbiAgICAgICAgICAvLyBHZW5TdGF0ZUV4ZWN1dGluZyBhbmQgbG9vcCBiYWNrIGZvciBhbm90aGVyIGludm9jYXRpb24uXG4gICAgICAgICAgc3RhdGUgPSBjb250ZXh0LmRvbmVcbiAgICAgICAgICAgID8gR2VuU3RhdGVDb21wbGV0ZWRcbiAgICAgICAgICAgIDogR2VuU3RhdGVTdXNwZW5kZWRZaWVsZDtcblxuICAgICAgICAgIGlmIChyZWNvcmQuYXJnID09PSBDb250aW51ZVNlbnRpbmVsKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHJlY29yZC5hcmcsXG4gICAgICAgICAgICBkb25lOiBjb250ZXh0LmRvbmVcbiAgICAgICAgICB9O1xuXG4gICAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7XG4gICAgICAgICAgLy8gRGlzcGF0Y2ggdGhlIGV4Y2VwdGlvbiBieSBsb29waW5nIGJhY2sgYXJvdW5kIHRvIHRoZVxuICAgICAgICAgIC8vIGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oY29udGV4dC5hcmcpIGNhbGwgYWJvdmUuXG4gICAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSByZWNvcmQuYXJnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8vIENhbGwgZGVsZWdhdGUuaXRlcmF0b3JbY29udGV4dC5tZXRob2RdKGNvbnRleHQuYXJnKSBhbmQgaGFuZGxlIHRoZVxuICAvLyByZXN1bHQsIGVpdGhlciBieSByZXR1cm5pbmcgYSB7IHZhbHVlLCBkb25lIH0gcmVzdWx0IGZyb20gdGhlXG4gIC8vIGRlbGVnYXRlIGl0ZXJhdG9yLCBvciBieSBtb2RpZnlpbmcgY29udGV4dC5tZXRob2QgYW5kIGNvbnRleHQuYXJnLFxuICAvLyBzZXR0aW5nIGNvbnRleHQuZGVsZWdhdGUgdG8gbnVsbCwgYW5kIHJldHVybmluZyB0aGUgQ29udGludWVTZW50aW5lbC5cbiAgZnVuY3Rpb24gbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCkge1xuICAgIHZhciBtZXRob2QgPSBkZWxlZ2F0ZS5pdGVyYXRvcltjb250ZXh0Lm1ldGhvZF07XG4gICAgaWYgKG1ldGhvZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyBBIC50aHJvdyBvciAucmV0dXJuIHdoZW4gdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBubyAudGhyb3dcbiAgICAgIC8vIG1ldGhvZCBhbHdheXMgdGVybWluYXRlcyB0aGUgeWllbGQqIGxvb3AuXG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcblxuICAgICAgaWYgKGNvbnRleHQubWV0aG9kID09PSBcInRocm93XCIpIHtcbiAgICAgICAgLy8gTm90ZTogW1wicmV0dXJuXCJdIG11c3QgYmUgdXNlZCBmb3IgRVMzIHBhcnNpbmcgY29tcGF0aWJpbGl0eS5cbiAgICAgICAgaWYgKGRlbGVnYXRlLml0ZXJhdG9yW1wicmV0dXJuXCJdKSB7XG4gICAgICAgICAgLy8gSWYgdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBhIHJldHVybiBtZXRob2QsIGdpdmUgaXQgYVxuICAgICAgICAgIC8vIGNoYW5jZSB0byBjbGVhbiB1cC5cbiAgICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwicmV0dXJuXCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCk7XG5cbiAgICAgICAgICBpZiAoY29udGV4dC5tZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgLy8gSWYgbWF5YmVJbnZva2VEZWxlZ2F0ZShjb250ZXh0KSBjaGFuZ2VkIGNvbnRleHQubWV0aG9kIGZyb21cbiAgICAgICAgICAgIC8vIFwicmV0dXJuXCIgdG8gXCJ0aHJvd1wiLCBsZXQgdGhhdCBvdmVycmlkZSB0aGUgVHlwZUVycm9yIGJlbG93LlxuICAgICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgIGNvbnRleHQuYXJnID0gbmV3IFR5cGVFcnJvcihcbiAgICAgICAgICBcIlRoZSBpdGVyYXRvciBkb2VzIG5vdCBwcm92aWRlIGEgJ3Rocm93JyBtZXRob2RcIik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChtZXRob2QsIGRlbGVnYXRlLml0ZXJhdG9yLCBjb250ZXh0LmFyZyk7XG5cbiAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICBjb250ZXh0LmFyZyA9IHJlY29yZC5hcmc7XG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIHZhciBpbmZvID0gcmVjb3JkLmFyZztcblxuICAgIGlmICghIGluZm8pIHtcbiAgICAgIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgY29udGV4dC5hcmcgPSBuZXcgVHlwZUVycm9yKFwiaXRlcmF0b3IgcmVzdWx0IGlzIG5vdCBhbiBvYmplY3RcIik7XG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIGlmIChpbmZvLmRvbmUpIHtcbiAgICAgIC8vIEFzc2lnbiB0aGUgcmVzdWx0IG9mIHRoZSBmaW5pc2hlZCBkZWxlZ2F0ZSB0byB0aGUgdGVtcG9yYXJ5XG4gICAgICAvLyB2YXJpYWJsZSBzcGVjaWZpZWQgYnkgZGVsZWdhdGUucmVzdWx0TmFtZSAoc2VlIGRlbGVnYXRlWWllbGQpLlxuICAgICAgY29udGV4dFtkZWxlZ2F0ZS5yZXN1bHROYW1lXSA9IGluZm8udmFsdWU7XG5cbiAgICAgIC8vIFJlc3VtZSBleGVjdXRpb24gYXQgdGhlIGRlc2lyZWQgbG9jYXRpb24gKHNlZSBkZWxlZ2F0ZVlpZWxkKS5cbiAgICAgIGNvbnRleHQubmV4dCA9IGRlbGVnYXRlLm5leHRMb2M7XG5cbiAgICAgIC8vIElmIGNvbnRleHQubWV0aG9kIHdhcyBcInRocm93XCIgYnV0IHRoZSBkZWxlZ2F0ZSBoYW5kbGVkIHRoZVxuICAgICAgLy8gZXhjZXB0aW9uLCBsZXQgdGhlIG91dGVyIGdlbmVyYXRvciBwcm9jZWVkIG5vcm1hbGx5LiBJZlxuICAgICAgLy8gY29udGV4dC5tZXRob2Qgd2FzIFwibmV4dFwiLCBmb3JnZXQgY29udGV4dC5hcmcgc2luY2UgaXQgaGFzIGJlZW5cbiAgICAgIC8vIFwiY29uc3VtZWRcIiBieSB0aGUgZGVsZWdhdGUgaXRlcmF0b3IuIElmIGNvbnRleHQubWV0aG9kIHdhc1xuICAgICAgLy8gXCJyZXR1cm5cIiwgYWxsb3cgdGhlIG9yaWdpbmFsIC5yZXR1cm4gY2FsbCB0byBjb250aW51ZSBpbiB0aGVcbiAgICAgIC8vIG91dGVyIGdlbmVyYXRvci5cbiAgICAgIGlmIChjb250ZXh0Lm1ldGhvZCAhPT0gXCJyZXR1cm5cIikge1xuICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZS15aWVsZCB0aGUgcmVzdWx0IHJldHVybmVkIGJ5IHRoZSBkZWxlZ2F0ZSBtZXRob2QuXG4gICAgICByZXR1cm4gaW5mbztcbiAgICB9XG5cbiAgICAvLyBUaGUgZGVsZWdhdGUgaXRlcmF0b3IgaXMgZmluaXNoZWQsIHNvIGZvcmdldCBpdCBhbmQgY29udGludWUgd2l0aFxuICAgIC8vIHRoZSBvdXRlciBnZW5lcmF0b3IuXG4gICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gIH1cblxuICAvLyBEZWZpbmUgR2VuZXJhdG9yLnByb3RvdHlwZS57bmV4dCx0aHJvdyxyZXR1cm59IGluIHRlcm1zIG9mIHRoZVxuICAvLyB1bmlmaWVkIC5faW52b2tlIGhlbHBlciBtZXRob2QuXG4gIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhHcCk7XG5cbiAgZGVmaW5lKEdwLCB0b1N0cmluZ1RhZ1N5bWJvbCwgXCJHZW5lcmF0b3JcIik7XG5cbiAgLy8gQSBHZW5lcmF0b3Igc2hvdWxkIGFsd2F5cyByZXR1cm4gaXRzZWxmIGFzIHRoZSBpdGVyYXRvciBvYmplY3Qgd2hlbiB0aGVcbiAgLy8gQEBpdGVyYXRvciBmdW5jdGlvbiBpcyBjYWxsZWQgb24gaXQuIFNvbWUgYnJvd3NlcnMnIGltcGxlbWVudGF0aW9ucyBvZiB0aGVcbiAgLy8gaXRlcmF0b3IgcHJvdG90eXBlIGNoYWluIGluY29ycmVjdGx5IGltcGxlbWVudCB0aGlzLCBjYXVzaW5nIHRoZSBHZW5lcmF0b3JcbiAgLy8gb2JqZWN0IHRvIG5vdCBiZSByZXR1cm5lZCBmcm9tIHRoaXMgY2FsbC4gVGhpcyBlbnN1cmVzIHRoYXQgZG9lc24ndCBoYXBwZW4uXG4gIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVnZW5lcmF0b3IvaXNzdWVzLzI3NCBmb3IgbW9yZSBkZXRhaWxzLlxuICBHcFtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBHcC50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBcIltvYmplY3QgR2VuZXJhdG9yXVwiO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHB1c2hUcnlFbnRyeShsb2NzKSB7XG4gICAgdmFyIGVudHJ5ID0geyB0cnlMb2M6IGxvY3NbMF0gfTtcblxuICAgIGlmICgxIGluIGxvY3MpIHtcbiAgICAgIGVudHJ5LmNhdGNoTG9jID0gbG9jc1sxXTtcbiAgICB9XG5cbiAgICBpZiAoMiBpbiBsb2NzKSB7XG4gICAgICBlbnRyeS5maW5hbGx5TG9jID0gbG9jc1syXTtcbiAgICAgIGVudHJ5LmFmdGVyTG9jID0gbG9jc1szXTtcbiAgICB9XG5cbiAgICB0aGlzLnRyeUVudHJpZXMucHVzaChlbnRyeSk7XG4gIH1cblxuICBmdW5jdGlvbiByZXNldFRyeUVudHJ5KGVudHJ5KSB7XG4gICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb24gfHwge307XG4gICAgcmVjb3JkLnR5cGUgPSBcIm5vcm1hbFwiO1xuICAgIGRlbGV0ZSByZWNvcmQuYXJnO1xuICAgIGVudHJ5LmNvbXBsZXRpb24gPSByZWNvcmQ7XG4gIH1cblxuICBmdW5jdGlvbiBDb250ZXh0KHRyeUxvY3NMaXN0KSB7XG4gICAgLy8gVGhlIHJvb3QgZW50cnkgb2JqZWN0IChlZmZlY3RpdmVseSBhIHRyeSBzdGF0ZW1lbnQgd2l0aG91dCBhIGNhdGNoXG4gICAgLy8gb3IgYSBmaW5hbGx5IGJsb2NrKSBnaXZlcyB1cyBhIHBsYWNlIHRvIHN0b3JlIHZhbHVlcyB0aHJvd24gZnJvbVxuICAgIC8vIGxvY2F0aW9ucyB3aGVyZSB0aGVyZSBpcyBubyBlbmNsb3NpbmcgdHJ5IHN0YXRlbWVudC5cbiAgICB0aGlzLnRyeUVudHJpZXMgPSBbeyB0cnlMb2M6IFwicm9vdFwiIH1dO1xuICAgIHRyeUxvY3NMaXN0LmZvckVhY2gocHVzaFRyeUVudHJ5LCB0aGlzKTtcbiAgICB0aGlzLnJlc2V0KHRydWUpO1xuICB9XG5cbiAgZXhwb3J0cy5rZXlzID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgdmFyIGtleXMgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICB9XG4gICAga2V5cy5yZXZlcnNlKCk7XG5cbiAgICAvLyBSYXRoZXIgdGhhbiByZXR1cm5pbmcgYW4gb2JqZWN0IHdpdGggYSBuZXh0IG1ldGhvZCwgd2Uga2VlcFxuICAgIC8vIHRoaW5ncyBzaW1wbGUgYW5kIHJldHVybiB0aGUgbmV4dCBmdW5jdGlvbiBpdHNlbGYuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICB3aGlsZSAoa2V5cy5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXMucG9wKCk7XG4gICAgICAgIGlmIChrZXkgaW4gb2JqZWN0KSB7XG4gICAgICAgICAgbmV4dC52YWx1ZSA9IGtleTtcbiAgICAgICAgICBuZXh0LmRvbmUgPSBmYWxzZTtcbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUbyBhdm9pZCBjcmVhdGluZyBhbiBhZGRpdGlvbmFsIG9iamVjdCwgd2UganVzdCBoYW5nIHRoZSAudmFsdWVcbiAgICAgIC8vIGFuZCAuZG9uZSBwcm9wZXJ0aWVzIG9mZiB0aGUgbmV4dCBmdW5jdGlvbiBvYmplY3QgaXRzZWxmLiBUaGlzXG4gICAgICAvLyBhbHNvIGVuc3VyZXMgdGhhdCB0aGUgbWluaWZpZXIgd2lsbCBub3QgYW5vbnltaXplIHRoZSBmdW5jdGlvbi5cbiAgICAgIG5leHQuZG9uZSA9IHRydWU7XG4gICAgICByZXR1cm4gbmV4dDtcbiAgICB9O1xuICB9O1xuXG4gIGZ1bmN0aW9uIHZhbHVlcyhpdGVyYWJsZSkge1xuICAgIGlmIChpdGVyYWJsZSkge1xuICAgICAgdmFyIGl0ZXJhdG9yTWV0aG9kID0gaXRlcmFibGVbaXRlcmF0b3JTeW1ib2xdO1xuICAgICAgaWYgKGl0ZXJhdG9yTWV0aG9kKSB7XG4gICAgICAgIHJldHVybiBpdGVyYXRvck1ldGhvZC5jYWxsKGl0ZXJhYmxlKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBpdGVyYWJsZS5uZXh0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhYmxlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWlzTmFOKGl0ZXJhYmxlLmxlbmd0aCkpIHtcbiAgICAgICAgdmFyIGkgPSAtMSwgbmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7XG4gICAgICAgICAgd2hpbGUgKCsraSA8IGl0ZXJhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGhhc093bi5jYWxsKGl0ZXJhYmxlLCBpKSkge1xuICAgICAgICAgICAgICBuZXh0LnZhbHVlID0gaXRlcmFibGVbaV07XG4gICAgICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBuZXh0LnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgIG5leHQuZG9uZSA9IHRydWU7XG5cbiAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gbmV4dC5uZXh0ID0gbmV4dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gYW4gaXRlcmF0b3Igd2l0aCBubyB2YWx1ZXMuXG4gICAgcmV0dXJuIHsgbmV4dDogZG9uZVJlc3VsdCB9O1xuICB9XG4gIGV4cG9ydHMudmFsdWVzID0gdmFsdWVzO1xuXG4gIGZ1bmN0aW9uIGRvbmVSZXN1bHQoKSB7XG4gICAgcmV0dXJuIHsgdmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZSB9O1xuICB9XG5cbiAgQ29udGV4dC5wcm90b3R5cGUgPSB7XG4gICAgY29uc3RydWN0b3I6IENvbnRleHQsXG5cbiAgICByZXNldDogZnVuY3Rpb24oc2tpcFRlbXBSZXNldCkge1xuICAgICAgdGhpcy5wcmV2ID0gMDtcbiAgICAgIHRoaXMubmV4dCA9IDA7XG4gICAgICAvLyBSZXNldHRpbmcgY29udGV4dC5fc2VudCBmb3IgbGVnYWN5IHN1cHBvcnQgb2YgQmFiZWwnc1xuICAgICAgLy8gZnVuY3Rpb24uc2VudCBpbXBsZW1lbnRhdGlvbi5cbiAgICAgIHRoaXMuc2VudCA9IHRoaXMuX3NlbnQgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICB0aGlzLm1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgdGhpcy5hcmcgPSB1bmRlZmluZWQ7XG5cbiAgICAgIHRoaXMudHJ5RW50cmllcy5mb3JFYWNoKHJlc2V0VHJ5RW50cnkpO1xuXG4gICAgICBpZiAoIXNraXBUZW1wUmVzZXQpIHtcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzKSB7XG4gICAgICAgICAgLy8gTm90IHN1cmUgYWJvdXQgdGhlIG9wdGltYWwgb3JkZXIgb2YgdGhlc2UgY29uZGl0aW9uczpcbiAgICAgICAgICBpZiAobmFtZS5jaGFyQXQoMCkgPT09IFwidFwiICYmXG4gICAgICAgICAgICAgIGhhc093bi5jYWxsKHRoaXMsIG5hbWUpICYmXG4gICAgICAgICAgICAgICFpc05hTigrbmFtZS5zbGljZSgxKSkpIHtcbiAgICAgICAgICAgIHRoaXNbbmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIHN0b3A6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcblxuICAgICAgdmFyIHJvb3RFbnRyeSA9IHRoaXMudHJ5RW50cmllc1swXTtcbiAgICAgIHZhciByb290UmVjb3JkID0gcm9vdEVudHJ5LmNvbXBsZXRpb247XG4gICAgICBpZiAocm9vdFJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgdGhyb3cgcm9vdFJlY29yZC5hcmc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnJ2YWw7XG4gICAgfSxcblxuICAgIGRpc3BhdGNoRXhjZXB0aW9uOiBmdW5jdGlvbihleGNlcHRpb24pIHtcbiAgICAgIGlmICh0aGlzLmRvbmUpIHtcbiAgICAgICAgdGhyb3cgZXhjZXB0aW9uO1xuICAgICAgfVxuXG4gICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG4gICAgICBmdW5jdGlvbiBoYW5kbGUobG9jLCBjYXVnaHQpIHtcbiAgICAgICAgcmVjb3JkLnR5cGUgPSBcInRocm93XCI7XG4gICAgICAgIHJlY29yZC5hcmcgPSBleGNlcHRpb247XG4gICAgICAgIGNvbnRleHQubmV4dCA9IGxvYztcblxuICAgICAgICBpZiAoY2F1Z2h0KSB7XG4gICAgICAgICAgLy8gSWYgdGhlIGRpc3BhdGNoZWQgZXhjZXB0aW9uIHdhcyBjYXVnaHQgYnkgYSBjYXRjaCBibG9jayxcbiAgICAgICAgICAvLyB0aGVuIGxldCB0aGF0IGNhdGNoIGJsb2NrIGhhbmRsZSB0aGUgZXhjZXB0aW9uIG5vcm1hbGx5LlxuICAgICAgICAgIGNvbnRleHQubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gISEgY2F1Z2h0O1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gXCJyb290XCIpIHtcbiAgICAgICAgICAvLyBFeGNlcHRpb24gdGhyb3duIG91dHNpZGUgb2YgYW55IHRyeSBibG9jayB0aGF0IGNvdWxkIGhhbmRsZVxuICAgICAgICAgIC8vIGl0LCBzbyBzZXQgdGhlIGNvbXBsZXRpb24gdmFsdWUgb2YgdGhlIGVudGlyZSBmdW5jdGlvbiB0b1xuICAgICAgICAgIC8vIHRocm93IHRoZSBleGNlcHRpb24uXG4gICAgICAgICAgcmV0dXJuIGhhbmRsZShcImVuZFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2KSB7XG4gICAgICAgICAgdmFyIGhhc0NhdGNoID0gaGFzT3duLmNhbGwoZW50cnksIFwiY2F0Y2hMb2NcIik7XG4gICAgICAgICAgdmFyIGhhc0ZpbmFsbHkgPSBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpO1xuXG4gICAgICAgICAgaWYgKGhhc0NhdGNoICYmIGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmZpbmFsbHlMb2MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSBlbHNlIGlmIChoYXNDYXRjaCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuY2F0Y2hMb2MsIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSBlbHNlIGlmIChoYXNGaW5hbGx5KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmZpbmFsbHlMb2MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRyeSBzdGF0ZW1lbnQgd2l0aG91dCBjYXRjaCBvciBmaW5hbGx5XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBhYnJ1cHQ6IGZ1bmN0aW9uKHR5cGUsIGFyZykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS50cnlMb2MgPD0gdGhpcy5wcmV2ICYmXG4gICAgICAgICAgICBoYXNPd24uY2FsbChlbnRyeSwgXCJmaW5hbGx5TG9jXCIpICYmXG4gICAgICAgICAgICB0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgdmFyIGZpbmFsbHlFbnRyeSA9IGVudHJ5O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChmaW5hbGx5RW50cnkgJiZcbiAgICAgICAgICAodHlwZSA9PT0gXCJicmVha1wiIHx8XG4gICAgICAgICAgIHR5cGUgPT09IFwiY29udGludWVcIikgJiZcbiAgICAgICAgICBmaW5hbGx5RW50cnkudHJ5TG9jIDw9IGFyZyAmJlxuICAgICAgICAgIGFyZyA8PSBmaW5hbGx5RW50cnkuZmluYWxseUxvYykge1xuICAgICAgICAvLyBJZ25vcmUgdGhlIGZpbmFsbHkgZW50cnkgaWYgY29udHJvbCBpcyBub3QganVtcGluZyB0byBhXG4gICAgICAgIC8vIGxvY2F0aW9uIG91dHNpZGUgdGhlIHRyeS9jYXRjaCBibG9jay5cbiAgICAgICAgZmluYWxseUVudHJ5ID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgdmFyIHJlY29yZCA9IGZpbmFsbHlFbnRyeSA/IGZpbmFsbHlFbnRyeS5jb21wbGV0aW9uIDoge307XG4gICAgICByZWNvcmQudHlwZSA9IHR5cGU7XG4gICAgICByZWNvcmQuYXJnID0gYXJnO1xuXG4gICAgICBpZiAoZmluYWxseUVudHJ5KSB7XG4gICAgICAgIHRoaXMubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICAgIHRoaXMubmV4dCA9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jO1xuICAgICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuY29tcGxldGUocmVjb3JkKTtcbiAgICB9LFxuXG4gICAgY29tcGxldGU6IGZ1bmN0aW9uKHJlY29yZCwgYWZ0ZXJMb2MpIHtcbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgIHRocm93IHJlY29yZC5hcmc7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gXCJicmVha1wiIHx8XG4gICAgICAgICAgcmVjb3JkLnR5cGUgPT09IFwiY29udGludWVcIikge1xuICAgICAgICB0aGlzLm5leHQgPSByZWNvcmQuYXJnO1xuICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJyZXR1cm5cIikge1xuICAgICAgICB0aGlzLnJ2YWwgPSB0aGlzLmFyZyA9IHJlY29yZC5hcmc7XG4gICAgICAgIHRoaXMubWV0aG9kID0gXCJyZXR1cm5cIjtcbiAgICAgICAgdGhpcy5uZXh0ID0gXCJlbmRcIjtcbiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09IFwibm9ybWFsXCIgJiYgYWZ0ZXJMb2MpIHtcbiAgICAgICAgdGhpcy5uZXh0ID0gYWZ0ZXJMb2M7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH0sXG5cbiAgICBmaW5pc2g6IGZ1bmN0aW9uKGZpbmFsbHlMb2MpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkuZmluYWxseUxvYyA9PT0gZmluYWxseUxvYykge1xuICAgICAgICAgIHRoaXMuY29tcGxldGUoZW50cnkuY29tcGxldGlvbiwgZW50cnkuYWZ0ZXJMb2MpO1xuICAgICAgICAgIHJlc2V0VHJ5RW50cnkoZW50cnkpO1xuICAgICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIFwiY2F0Y2hcIjogZnVuY3Rpb24odHJ5TG9jKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gdHJ5TG9jKSB7XG4gICAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247XG4gICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgICAgIHZhciB0aHJvd24gPSByZWNvcmQuYXJnO1xuICAgICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aHJvd247XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVGhlIGNvbnRleHQuY2F0Y2ggbWV0aG9kIG11c3Qgb25seSBiZSBjYWxsZWQgd2l0aCBhIGxvY2F0aW9uXG4gICAgICAvLyBhcmd1bWVudCB0aGF0IGNvcnJlc3BvbmRzIHRvIGEga25vd24gY2F0Y2ggYmxvY2suXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbGxlZ2FsIGNhdGNoIGF0dGVtcHRcIik7XG4gICAgfSxcblxuICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uKGl0ZXJhYmxlLCByZXN1bHROYW1lLCBuZXh0TG9jKSB7XG4gICAgICB0aGlzLmRlbGVnYXRlID0ge1xuICAgICAgICBpdGVyYXRvcjogdmFsdWVzKGl0ZXJhYmxlKSxcbiAgICAgICAgcmVzdWx0TmFtZTogcmVzdWx0TmFtZSxcbiAgICAgICAgbmV4dExvYzogbmV4dExvY1xuICAgICAgfTtcblxuICAgICAgaWYgKHRoaXMubWV0aG9kID09PSBcIm5leHRcIikge1xuICAgICAgICAvLyBEZWxpYmVyYXRlbHkgZm9yZ2V0IHRoZSBsYXN0IHNlbnQgdmFsdWUgc28gdGhhdCB3ZSBkb24ndFxuICAgICAgICAvLyBhY2NpZGVudGFsbHkgcGFzcyBpdCBvbiB0byB0aGUgZGVsZWdhdGUuXG4gICAgICAgIHRoaXMuYXJnID0gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gQ29udGludWVTZW50aW5lbDtcbiAgICB9XG4gIH07XG5cbiAgLy8gUmVnYXJkbGVzcyBvZiB3aGV0aGVyIHRoaXMgc2NyaXB0IGlzIGV4ZWN1dGluZyBhcyBhIENvbW1vbkpTIG1vZHVsZVxuICAvLyBvciBub3QsIHJldHVybiB0aGUgcnVudGltZSBvYmplY3Qgc28gdGhhdCB3ZSBjYW4gZGVjbGFyZSB0aGUgdmFyaWFibGVcbiAgLy8gcmVnZW5lcmF0b3JSdW50aW1lIGluIHRoZSBvdXRlciBzY29wZSwgd2hpY2ggYWxsb3dzIHRoaXMgbW9kdWxlIHRvIGJlXG4gIC8vIGluamVjdGVkIGVhc2lseSBieSBgYmluL3JlZ2VuZXJhdG9yIC0taW5jbHVkZS1ydW50aW1lIHNjcmlwdC5qc2AuXG4gIHJldHVybiBleHBvcnRzO1xuXG59KFxuICAvLyBJZiB0aGlzIHNjcmlwdCBpcyBleGVjdXRpbmcgYXMgYSBDb21tb25KUyBtb2R1bGUsIHVzZSBtb2R1bGUuZXhwb3J0c1xuICAvLyBhcyB0aGUgcmVnZW5lcmF0b3JSdW50aW1lIG5hbWVzcGFjZS4gT3RoZXJ3aXNlIGNyZWF0ZSBhIG5ldyBlbXB0eVxuICAvLyBvYmplY3QuIEVpdGhlciB3YXksIHRoZSByZXN1bHRpbmcgb2JqZWN0IHdpbGwgYmUgdXNlZCB0byBpbml0aWFsaXplXG4gIC8vIHRoZSByZWdlbmVyYXRvclJ1bnRpbWUgdmFyaWFibGUgYXQgdGhlIHRvcCBvZiB0aGlzIGZpbGUuXG4gIHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIgPyBtb2R1bGUuZXhwb3J0cyA6IHt9XG4pKTtcblxudHJ5IHtcbiAgcmVnZW5lcmF0b3JSdW50aW1lID0gcnVudGltZTtcbn0gY2F0Y2ggKGFjY2lkZW50YWxTdHJpY3RNb2RlKSB7XG4gIC8vIFRoaXMgbW9kdWxlIHNob3VsZCBub3QgYmUgcnVubmluZyBpbiBzdHJpY3QgbW9kZSwgc28gdGhlIGFib3ZlXG4gIC8vIGFzc2lnbm1lbnQgc2hvdWxkIGFsd2F5cyB3b3JrIHVubGVzcyBzb21ldGhpbmcgaXMgbWlzY29uZmlndXJlZC4gSnVzdFxuICAvLyBpbiBjYXNlIHJ1bnRpbWUuanMgYWNjaWRlbnRhbGx5IHJ1bnMgaW4gc3RyaWN0IG1vZGUsIHdlIGNhbiBlc2NhcGVcbiAgLy8gc3RyaWN0IG1vZGUgdXNpbmcgYSBnbG9iYWwgRnVuY3Rpb24gY2FsbC4gVGhpcyBjb3VsZCBjb25jZWl2YWJseSBmYWlsXG4gIC8vIGlmIGEgQ29udGVudCBTZWN1cml0eSBQb2xpY3kgZm9yYmlkcyB1c2luZyBGdW5jdGlvbiwgYnV0IGluIHRoYXQgY2FzZVxuICAvLyB0aGUgcHJvcGVyIHNvbHV0aW9uIGlzIHRvIGZpeCB0aGUgYWNjaWRlbnRhbCBzdHJpY3QgbW9kZSBwcm9ibGVtLiBJZlxuICAvLyB5b3UndmUgbWlzY29uZmlndXJlZCB5b3VyIGJ1bmRsZXIgdG8gZm9yY2Ugc3RyaWN0IG1vZGUgYW5kIGFwcGxpZWQgYVxuICAvLyBDU1AgdG8gZm9yYmlkIEZ1bmN0aW9uLCBhbmQgeW91J3JlIG5vdCB3aWxsaW5nIHRvIGZpeCBlaXRoZXIgb2YgdGhvc2VcbiAgLy8gcHJvYmxlbXMsIHBsZWFzZSBkZXRhaWwgeW91ciB1bmlxdWUgcHJlZGljYW1lbnQgaW4gYSBHaXRIdWIgaXNzdWUuXG4gIEZ1bmN0aW9uKFwiclwiLCBcInJlZ2VuZXJhdG9yUnVudGltZSA9IHJcIikocnVudGltZSk7XG59XG4iLCIvKipcclxuICogQGF1dGhvciBsdGggLyBodHRwczovL2dpdGh1Yi5jb20vbG8tdGhcclxuICovXHJcblxyXG5jb25zdCBUID0ge1xyXG5cclxuICAgIGZyYWc6IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxcclxuXHJcbiAgICBjb2xvclJpbmc6IG51bGwsXHJcbiAgICBqb3lzdGlja18wOiBudWxsLFxyXG4gICAgam95c3RpY2tfMTogbnVsbCxcclxuICAgIGNpcmN1bGFyOiBudWxsLFxyXG4gICAga25vYjogbnVsbCxcclxuXHJcbiAgICBzdmduczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLFxyXG4gICAgbGlua3M6IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiLFxyXG4gICAgaHRtbHM6IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwiLFxyXG5cclxuICAgIERPTV9TSVpFOiBbICdoZWlnaHQnLCAnd2lkdGgnLCAndG9wJywgJ2xlZnQnLCAnYm90dG9tJywgJ3JpZ2h0JywgJ21hcmdpbi1sZWZ0JywgJ21hcmdpbi1yaWdodCcsICdtYXJnaW4tdG9wJywgJ21hcmdpbi1ib3R0b20nXSxcclxuICAgIFNWR19UWVBFX0Q6IFsgJ3BhdHRlcm4nLCAnZGVmcycsICd0cmFuc2Zvcm0nLCAnc3RvcCcsICdhbmltYXRlJywgJ3JhZGlhbEdyYWRpZW50JywgJ2xpbmVhckdyYWRpZW50JywgJ2FuaW1hdGVNb3Rpb24nLCAndXNlJywgJ2ZpbHRlcicsICdmZUNvbG9yTWF0cml4JyBdLFxyXG4gICAgU1ZHX1RZUEVfRzogWyAnc3ZnJywgJ3JlY3QnLCAnY2lyY2xlJywgJ3BhdGgnLCAncG9seWdvbicsICd0ZXh0JywgJ2cnLCAnbGluZScsICdmb3JlaWduT2JqZWN0JyBdLFxyXG5cclxuICAgIFBJOiBNYXRoLlBJLFxyXG4gICAgVHdvUEk6IE1hdGguUEkqMixcclxuICAgIHBpOTA6IE1hdGguUEkgKiAwLjUsXHJcbiAgICBwaTYwOiBNYXRoLlBJLzMsXHJcbiAgICBcclxuICAgIHRvcmFkOiBNYXRoLlBJIC8gMTgwLFxyXG4gICAgdG9kZWc6IDE4MCAvIE1hdGguUEksXHJcblxyXG4gICAgY2xhbXA6IGZ1bmN0aW9uICh2LCBtaW4sIG1heCkge1xyXG5cclxuICAgICAgICB2ID0gdiA8IG1pbiA/IG1pbiA6IHY7XHJcbiAgICAgICAgdiA9IHYgPiBtYXggPyBtYXggOiB2O1xyXG4gICAgICAgIHJldHVybiB2O1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc2l6ZTogeyAgdzogMjQwLCBoOiAyMCwgcDogMzAsIHM6IDIwIH0sXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBDT0xPUlxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGNsb25lQ29sb3I6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgbGV0IGNjID0gT2JqZWN0LmFzc2lnbih7fSwgVC5jb2xvcnMgKTtcclxuICAgICAgICByZXR1cm4gY2M7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBjbG9uZUNzczogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICBsZXQgY2MgPSBPYmplY3QuYXNzaWduKHt9LCBULmNzcyApO1xyXG4gICAgICAgIHJldHVybiBjYztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNvbG9yczoge1xyXG5cclxuICAgICAgICB0ZXh0IDogJyNDMEMwQzAnLFxyXG4gICAgICAgIHRleHRPdmVyIDogJyNGRkZGRkYnLFxyXG4gICAgICAgIHR4dHNlbGVjdGJnIDogJ25vbmUnLFxyXG5cclxuICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSg0NCw0NCw0NCwwLjMpJyxcclxuICAgICAgICBiYWNrZ3JvdW5kT3ZlcjogJ3JnYmEoMTEsMTEsMTEsMC41KScsXHJcblxyXG4gICAgICAgIC8vaW5wdXQ6ICcjMDA1QUFBJyxcclxuXHJcbiAgICAgICAgaW5wdXRCb3JkZXI6ICcjNDU0NTQ1JyxcclxuICAgICAgICBpbnB1dEhvbGRlcjogJyM4MDgwODAnLFxyXG4gICAgICAgIGlucHV0Qm9yZGVyU2VsZWN0OiAnIzAwNUFBQScsXHJcbiAgICAgICAgaW5wdXRCZzogJ3JnYmEoMCwwLDAsMC4xKScsXHJcbiAgICAgICAgaW5wdXRPdmVyOiAncmdiYSgwLDAsMCwwLjIpJyxcclxuXHJcbiAgICAgICAgYm9yZGVyIDogJyM0NTQ1NDUnLFxyXG4gICAgICAgIGJvcmRlck92ZXIgOiAnIzUwNTBBQScsXHJcbiAgICAgICAgYm9yZGVyU2VsZWN0IDogJyMzMDhBRkYnLFxyXG5cclxuICAgICAgICBzY3JvbGxiYWNrOidyZ2JhKDQ0LDQ0LDQ0LDAuMiknLFxyXG4gICAgICAgIHNjcm9sbGJhY2tvdmVyOidyZ2JhKDQ0LDQ0LDQ0LDAuMiknLFxyXG5cclxuICAgICAgICBidXR0b24gOiAnIzQwNDA0MCcsXHJcbiAgICAgICAgYm9vbGJnIDogJyMxODE4MTgnLFxyXG4gICAgICAgIGJvb2xvbiA6ICcjQzBDMEMwJyxcclxuXHJcbiAgICAgICAgc2VsZWN0IDogJyMzMDhBRkYnLFxyXG4gICAgICAgIG1vdmluZyA6ICcjMDNhZmZmJyxcclxuICAgICAgICBkb3duIDogJyMwMjQ2OTknLFxyXG4gICAgICAgIG92ZXIgOiAnIzAyNDY5OScsXHJcbiAgICAgICAgYWN0aW9uOiAnI0ZGMzMwMCcsXHJcblxyXG4gICAgICAgIHN0cm9rZTogJ3JnYmEoMTEsMTEsMTEsMC41KScsXHJcbiAgICAgICAgc2Nyb2xsOiAnIzMzMzMzMycsXHJcblxyXG4gICAgICAgIGhpZGU6ICdyZ2JhKDAsMCwwLDApJyxcclxuXHJcbiAgICAgICAgZ3JvdXBCb3JkZXI6ICdub25lJyxcclxuICAgICAgICBidXR0b25Cb3JkZXI6ICdub25lJyxcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHN0eWxlIGNzc1xyXG5cclxuICAgIGNzcyA6IHtcclxuICAgICAgICAvL3Vuc2VsZWN0OiAnLW8tdXNlci1zZWxlY3Q6bm9uZTsgLW1zLXVzZXItc2VsZWN0Om5vbmU7IC1raHRtbC11c2VyLXNlbGVjdDpub25lOyAtd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7IC1tb3otdXNlci1zZWxlY3Q6bm9uZTsnLCBcclxuICAgICAgICBiYXNpYzogJ3Bvc2l0aW9uOmFic29sdXRlOyBwb2ludGVyLWV2ZW50czpub25lOyBib3gtc2l6aW5nOmJvcmRlci1ib3g7IG1hcmdpbjowOyBwYWRkaW5nOjA7IG92ZXJmbG93OmhpZGRlbjsgJyArICctby11c2VyLXNlbGVjdDpub25lOyAtbXMtdXNlci1zZWxlY3Q6bm9uZTsgLWtodG1sLXVzZXItc2VsZWN0Om5vbmU7IC13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsgLW1vei11c2VyLXNlbGVjdDpub25lOycsXHJcbiAgICAgICAgYnV0dG9uOidkaXNwbGF5OmZsZXg7IGp1c3RpZnktY29udGVudDpjZW50ZXI7IGFsaWduLWl0ZW1zOmNlbnRlcjsgdGV4dC1hbGlnbjpjZW50ZXI7JyxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gc3ZnIHBhdGhcclxuXHJcbiAgICBzdmdzOiB7XHJcblxyXG4gICAgICAgIGdyb3VwOidNIDcgNyBMIDcgOCA4IDggOCA3IDcgNyBNIDUgNyBMIDUgOCA2IDggNiA3IDUgNyBNIDMgNyBMIDMgOCA0IDggNCA3IDMgNyBNIDcgNSBMIDcgNiA4IDYgOCA1IDcgNSBNIDYgNiBMIDYgNSA1IDUgNSA2IDYgNiBNIDcgMyBMIDcgNCA4IDQgOCAzIDcgMyBNIDYgNCBMIDYgMyA1IDMgNSA0IDYgNCBNIDMgNSBMIDMgNiA0IDYgNCA1IDMgNSBNIDMgMyBMIDMgNCA0IDQgNCAzIDMgMyBaJyxcclxuICAgICAgICBhcnJvdzonTSAzIDggTCA4IDUgMyAyIDMgOCBaJyxcclxuICAgICAgICBhcnJvd0Rvd246J00gNSA4IEwgOCAzIDIgMyA1IDggWicsXHJcbiAgICAgICAgYXJyb3dVcDonTSA1IDIgTCAyIDcgOCA3IDUgMiBaJyxcclxuXHJcbiAgICAgICAgc29saWQ6J00gMTMgMTAgTCAxMyAxIDQgMSAxIDQgMSAxMyAxMCAxMyAxMyAxMCBNIDExIDMgTCAxMSA5IDkgMTEgMyAxMSAzIDUgNSAzIDExIDMgWicsXHJcbiAgICAgICAgYm9keTonTSAxMyAxMCBMIDEzIDEgNCAxIDEgNCAxIDEzIDEwIDEzIDEzIDEwIE0gMTEgMyBMIDExIDkgOSAxMSAzIDExIDMgNSA1IDMgMTEgMyBNIDUgNCBMIDQgNSA0IDEwIDkgMTAgMTAgOSAxMCA0IDUgNCBaJyxcclxuICAgICAgICB2ZWhpY2xlOidNIDEzIDYgTCAxMSAxIDMgMSAxIDYgMSAxMyAzIDEzIDMgMTEgMTEgMTEgMTEgMTMgMTMgMTMgMTMgNiBNIDIuNCA2IEwgNCAyIDEwIDIgMTEuNiA2IDIuNCA2IE0gMTIgOCBMIDEyIDEwIDEwIDEwIDEwIDggMTIgOCBNIDQgOCBMIDQgMTAgMiAxMCAyIDggNCA4IFonLFxyXG4gICAgICAgIGFydGljdWxhdGlvbjonTSAxMyA5IEwgMTIgOSA5IDIgOSAxIDUgMSA1IDIgMiA5IDEgOSAxIDEzIDUgMTMgNSA5IDQgOSA2IDUgOCA1IDEwIDkgOSA5IDkgMTMgMTMgMTMgMTMgOSBaJyxcclxuICAgICAgICBjaGFyYWN0ZXI6J00gMTMgNCBMIDEyIDMgOSA0IDUgNCAyIDMgMSA0IDUgNiA1IDggNCAxMyA2IDEzIDcgOSA4IDEzIDEwIDEzIDkgOCA5IDYgMTMgNCBNIDYgMSBMIDYgMyA4IDMgOCAxIDYgMSBaJyxcclxuICAgICAgICB0ZXJyYWluOidNIDEzIDggTCAxMiA3IFEgOS4wNiAtMy42NyA1Ljk1IDQuODUgNC4wNCAzLjI3IDIgNyBMIDEgOCA3IDEzIDEzIDggTSAzIDggUSAzLjc4IDUuNDIwIDUuNCA2LjYgNS4yMCA3LjI1IDUgOCBMIDcgOCBRIDguMzkgLTAuMTYgMTEgOCBMIDcgMTEgMyA4IFonLFxyXG4gICAgICAgIGpvaW50OidNIDcuNyA3LjcgUSA4IDcuNDUgOCA3IDggNi42IDcuNyA2LjMgNy40NSA2IDcgNiA2LjYgNiA2LjMgNi4zIDYgNi42IDYgNyA2IDcuNDUgNi4zIDcuNyA2LjYgOCA3IDggNy40NSA4IDcuNyA3LjcgTSAzLjM1IDguNjUgTCAxIDExIDMgMTMgNS4zNSAxMC42NSBRIDYuMSAxMSA3IDExIDguMjggMTEgOS4yNSAxMC4yNSBMIDcuOCA4LjggUSA3LjQ1IDkgNyA5IDYuMTUgOSA1LjU1IDguNCA1IDcuODUgNSA3IDUgNi41NCA1LjE1IDYuMTUgTCAzLjcgNC43IFEgMyA1LjcxMiAzIDcgMyA3LjkgMy4zNSA4LjY1IE0gMTAuMjUgOS4yNSBRIDExIDguMjggMTEgNyAxMSA2LjEgMTAuNjUgNS4zNSBMIDEzIDMgMTEgMSA4LjY1IDMuMzUgUSA3LjkgMyA3IDMgNS43IDMgNC43IDMuNyBMIDYuMTUgNS4xNSBRIDYuNTQgNSA3IDUgNy44NSA1IDguNCA1LjU1IDkgNi4xNSA5IDcgOSA3LjQ1IDguOCA3LjggTCAxMC4yNSA5LjI1IFonLFxyXG4gICAgICAgIHJheTonTSA5IDExIEwgNSAxMSA1IDEyIDkgMTIgOSAxMSBNIDEyIDUgTCAxMSA1IDExIDkgMTIgOSAxMiA1IE0gMTEuNSAxMCBRIDEwLjkgMTAgMTAuNDUgMTAuNDUgMTAgMTAuOSAxMCAxMS41IDEwIDEyLjIgMTAuNDUgMTIuNTUgMTAuOSAxMyAxMS41IDEzIDEyLjIgMTMgMTIuNTUgMTIuNTUgMTMgMTIuMiAxMyAxMS41IDEzIDEwLjkgMTIuNTUgMTAuNDUgMTIuMiAxMCAxMS41IDEwIE0gOSAxMCBMIDEwIDkgMiAxIDEgMiA5IDEwIFonLFxyXG4gICAgICAgIGNvbGxpc2lvbjonTSAxMSAxMiBMIDEzIDEwIDEwIDcgMTMgNCAxMSAyIDcuNSA1LjUgOSA3IDcuNSA4LjUgMTEgMTIgTSAzIDIgTCAxIDQgNCA3IDEgMTAgMyAxMiA4IDcgMyAyIFonLFxyXG4gICAgICAgIG1hcDonTSAxMyAxIEwgMSAxIDEgMTMgMTMgMTMgMTMgMSBNIDEyIDIgTCAxMiA3IDcgNyA3IDEyIDIgMTIgMiA3IDcgNyA3IDIgMTIgMiBaJyxcclxuICAgICAgICBtYXRlcmlhbDonTSAxMyAxIEwgMSAxIDEgMTMgMTMgMTMgMTMgMSBNIDEyIDIgTCAxMiA3IDcgNyA3IDEyIDIgMTIgMiA3IDcgNyA3IDIgMTIgMiBaJyxcclxuICAgICAgICB0ZXh0dXJlOidNIDEzIDQgTCAxMyAxIDEgMSAxIDQgNSA0IDUgMTMgOSAxMyA5IDQgMTMgNCBaJyxcclxuICAgICAgICBvYmplY3Q6J00gMTAgMSBMIDcgNCA0IDEgMSAxIDEgMTMgNCAxMyA0IDUgNyA4IDEwIDUgMTAgMTMgMTMgMTMgMTMgMSAxMCAxIFonLFxyXG4gICAgICAgIG5vbmU6J00gOSA1IEwgNSA1IDUgOSA5IDkgOSA1IFonLFxyXG4gICAgICAgIGN1cnNvcjonTSA0IDcgTCAxIDEwIDEgMTIgMiAxMyA0IDEzIDcgMTAgOSAxNCAxNCAwIDAgNSA0IDcgWicsXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBjdXN0b20gdGV4dFxyXG5cclxuICAgIHNldFRleHQgOiBmdW5jdGlvbiggc2l6ZSwgY29sb3IsIGZvbnQsIHNoYWRvdywgY29sb3JzLCBjc3MgKXtcclxuXHJcbiAgICAgICAgc2l6ZSA9IHNpemUgfHwgMTM7XHJcbiAgICAgICAgY29sb3IgPSBjb2xvciB8fCAnI0NDQyc7XHJcbiAgICAgICAgZm9udCA9IGZvbnQgfHwgJ0NvbnNvbGFzLG1vbmFjbyxtb25vc3BhY2U7JzsvLydNb25vc3BhY2UnOy8vJ1wiQ29uc29sYXNcIiwgXCJMdWNpZGEgQ29uc29sZVwiLCBNb25hY28sIG1vbm9zcGFjZSc7XHJcblxyXG4gICAgICAgIGNvbG9ycyA9IGNvbG9ycyB8fCBULmNvbG9ycztcclxuICAgICAgICBjc3MgPSBjc3MgfHwgVC5jc3M7XHJcblxyXG4gICAgICAgIGNvbG9ycy50ZXh0ID0gY29sb3I7XHJcbiAgICAgICAgY3NzLnR4dCA9IGNzcy5iYXNpYyArICdmb250LWZhbWlseTonK2ZvbnQrJzsgZm9udC1zaXplOicrc2l6ZSsncHg7IGNvbG9yOicrY29sb3IrJzsgcGFkZGluZzoycHggMTBweDsgbGVmdDowOyB0b3A6MnB4OyBoZWlnaHQ6MTZweDsgd2lkdGg6MTAwcHg7IG92ZXJmbG93OmhpZGRlbjsgd2hpdGUtc3BhY2U6IG5vd3JhcDsnO1xyXG4gICAgICAgIGlmKCBzaGFkb3cgKSBjc3MudHh0ICs9ICcgdGV4dC1zaGFkb3c6Jysgc2hhZG93ICsgJzsgJzsgLy9cIjFweCAxcHggMXB4ICNmZjAwMDBcIjtcclxuICAgICAgICBjc3MudHh0c2VsZWN0ID0gY3NzLnR4dCArICdkaXNwbGF5OmZsZXg7IGp1c3RpZnktY29udGVudDpsZWZ0OyBhbGlnbi1pdGVtczpjZW50ZXI7IHRleHQtYWxpZ246bGVmdDsnICsncGFkZGluZzoycHggNXB4OyBib3JkZXI6MXB4IGRhc2hlZCAnICsgY29sb3JzLmJvcmRlciArICc7IGJhY2tncm91bmQ6JysgY29sb3JzLnR4dHNlbGVjdGJnKyc7JztcclxuICAgICAgICBjc3MuaXRlbSA9IGNzcy50eHQgKyAncG9zaXRpb246cmVsYXRpdmU7IGJhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjIpOyBtYXJnaW4tYm90dG9tOjFweDsnO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2xvbmU6IGZ1bmN0aW9uICggbyApIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIG8uY2xvbmVOb2RlKCB0cnVlICk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzZXRTdmc6IGZ1bmN0aW9uKCBkb20sIHR5cGUsIHZhbHVlLCBpZCwgaWQyICl7XHJcblxyXG4gICAgICAgIGlmKCBpZCA9PT0gLTEgKSBkb20uc2V0QXR0cmlidXRlTlMoIG51bGwsIHR5cGUsIHZhbHVlICk7XHJcbiAgICAgICAgZWxzZSBpZiggaWQyICE9PSB1bmRlZmluZWQgKSBkb20uY2hpbGROb2Rlc1sgaWQgfHwgMCBdLmNoaWxkTm9kZXNbIGlkMiB8fCAwIF0uc2V0QXR0cmlidXRlTlMoIG51bGwsIHR5cGUsIHZhbHVlICk7XHJcbiAgICAgICAgZWxzZSBkb20uY2hpbGROb2Rlc1sgaWQgfHwgMCBdLnNldEF0dHJpYnV0ZU5TKCBudWxsLCB0eXBlLCB2YWx1ZSApO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc2V0Q3NzOiBmdW5jdGlvbiggZG9tLCBjc3MgKXtcclxuXHJcbiAgICAgICAgZm9yKCBsZXQgciBpbiBjc3MgKXtcclxuICAgICAgICAgICAgaWYoIFQuRE9NX1NJWkUuaW5kZXhPZihyKSAhPT0gLTEgKSBkb20uc3R5bGVbcl0gPSBjc3Nbcl0gKyAncHgnO1xyXG4gICAgICAgICAgICBlbHNlIGRvbS5zdHlsZVtyXSA9IGNzc1tyXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzZXQ6IGZ1bmN0aW9uKCBnLCBvICl7XHJcblxyXG4gICAgICAgIGZvciggbGV0IGF0dCBpbiBvICl7XHJcbiAgICAgICAgICAgIGlmKCBhdHQgPT09ICd0eHQnICkgZy50ZXh0Q29udGVudCA9IG9bIGF0dCBdO1xyXG4gICAgICAgICAgICBpZiggYXR0ID09PSAnbGluaycgKSBnLnNldEF0dHJpYnV0ZU5TKCBULmxpbmtzLCAneGxpbms6aHJlZicsIG9bIGF0dCBdICk7XHJcbiAgICAgICAgICAgIGVsc2UgZy5zZXRBdHRyaWJ1dGVOUyggbnVsbCwgYXR0LCBvWyBhdHQgXSApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0OiBmdW5jdGlvbiggZG9tLCBpZCApe1xyXG5cclxuICAgICAgICBpZiggaWQgPT09IHVuZGVmaW5lZCApIHJldHVybiBkb207IC8vIHJvb3RcclxuICAgICAgICBlbHNlIGlmKCAhaXNOYU4oIGlkICkgKSByZXR1cm4gZG9tLmNoaWxkTm9kZXNbIGlkIF07IC8vIGZpcnN0IGNoaWxkXHJcbiAgICAgICAgZWxzZSBpZiggaWQgaW5zdGFuY2VvZiBBcnJheSApe1xyXG4gICAgICAgICAgICBpZihpZC5sZW5ndGggPT09IDIpIHJldHVybiBkb20uY2hpbGROb2Rlc1sgaWRbMF0gXS5jaGlsZE5vZGVzWyBpZFsxXSBdO1xyXG4gICAgICAgICAgICBpZihpZC5sZW5ndGggPT09IDMpIHJldHVybiBkb20uY2hpbGROb2Rlc1sgaWRbMF0gXS5jaGlsZE5vZGVzWyBpZFsxXSBdLmNoaWxkTm9kZXNbIGlkWzJdIF07XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZG9tIDogZnVuY3Rpb24gKCB0eXBlLCBjc3MsIG9iaiwgZG9tLCBpZCApIHtcclxuXHJcbiAgICAgICAgdHlwZSA9IHR5cGUgfHwgJ2Rpdic7XHJcblxyXG4gICAgICAgIGlmKCBULlNWR19UWVBFX0QuaW5kZXhPZih0eXBlKSAhPT0gLTEgfHwgVC5TVkdfVFlQRV9HLmluZGV4T2YodHlwZSkgIT09IC0xICl7IC8vIGlzIHN2ZyBlbGVtZW50XHJcblxyXG4gICAgICAgICAgICBpZiggdHlwZSA9PT0nc3ZnJyApe1xyXG5cclxuICAgICAgICAgICAgICAgIGRvbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyggVC5zdmducywgJ3N2ZycgKTtcclxuICAgICAgICAgICAgICAgIFQuc2V0KCBkb20sIG9iaiApO1xyXG5cclxuICAgICAgICAgIC8qICB9IGVsc2UgaWYgKCB0eXBlID09PSAndXNlJyApIHtcclxuXHJcbiAgICAgICAgICAgICAgICBkb20gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoIFQuc3ZnbnMsICd1c2UnICk7XHJcbiAgICAgICAgICAgICAgICBULnNldCggZG9tLCBvYmogKTtcclxuKi9cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgc3ZnIGlmIG5vdCBkZWZcclxuICAgICAgICAgICAgICAgIGlmKCBkb20gPT09IHVuZGVmaW5lZCApIGRvbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyggVC5zdmducywgJ3N2ZycgKTtcclxuICAgICAgICAgICAgICAgIFQuYWRkQXR0cmlidXRlcyggZG9tLCB0eXBlLCBvYmosIGlkICk7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0gZWxzZSB7IC8vIGlzIGh0bWwgZWxlbWVudFxyXG5cclxuICAgICAgICAgICAgaWYoIGRvbSA9PT0gdW5kZWZpbmVkICkgZG9tID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCBULmh0bWxzLCB0eXBlICk7XHJcbiAgICAgICAgICAgIGVsc2UgZG9tID0gZG9tLmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoIFQuaHRtbHMsIHR5cGUgKSApO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCBjc3MgKSBkb20uc3R5bGUuY3NzVGV4dCA9IGNzczsgXHJcblxyXG4gICAgICAgIGlmKCBpZCA9PT0gdW5kZWZpbmVkICkgcmV0dXJuIGRvbTtcclxuICAgICAgICBlbHNlIHJldHVybiBkb20uY2hpbGROb2Rlc1sgaWQgfHwgMCBdO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgYWRkQXR0cmlidXRlcyA6IGZ1bmN0aW9uKCBkb20sIHR5cGUsIG8sIGlkICl7XHJcblxyXG4gICAgICAgIGxldCBnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCBULnN2Z25zLCB0eXBlICk7XHJcbiAgICAgICAgVC5zZXQoIGcsIG8gKTtcclxuICAgICAgICBULmdldCggZG9tLCBpZCApLmFwcGVuZENoaWxkKCBnICk7XHJcbiAgICAgICAgaWYoIFQuU1ZHX1RZUEVfRy5pbmRleE9mKHR5cGUpICE9PSAtMSApIGcuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJztcclxuICAgICAgICByZXR1cm4gZztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNsZWFyIDogZnVuY3Rpb24oIGRvbSApe1xyXG5cclxuICAgICAgICBULnB1cmdlKCBkb20gKTtcclxuICAgICAgICB3aGlsZSAoZG9tLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgaWYgKCBkb20uZmlyc3RDaGlsZC5maXJzdENoaWxkICkgVC5jbGVhciggZG9tLmZpcnN0Q2hpbGQgKTtcclxuICAgICAgICAgICAgZG9tLnJlbW92ZUNoaWxkKCBkb20uZmlyc3RDaGlsZCApOyBcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBwdXJnZSA6IGZ1bmN0aW9uICggZG9tICkge1xyXG5cclxuICAgICAgICBsZXQgYSA9IGRvbS5hdHRyaWJ1dGVzLCBpLCBuO1xyXG4gICAgICAgIGlmIChhKSB7XHJcbiAgICAgICAgICAgIGkgPSBhLmxlbmd0aDtcclxuICAgICAgICAgICAgd2hpbGUoaS0tKXtcclxuICAgICAgICAgICAgICAgIG4gPSBhW2ldLm5hbWU7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRvbVtuXSA9PT0gJ2Z1bmN0aW9uJykgZG9tW25dID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBhID0gZG9tLmNoaWxkTm9kZXM7XHJcbiAgICAgICAgaWYgKGEpIHtcclxuICAgICAgICAgICAgaSA9IGEubGVuZ3RoO1xyXG4gICAgICAgICAgICB3aGlsZShpLS0peyBcclxuICAgICAgICAgICAgICAgIFQucHVyZ2UoIGRvbS5jaGlsZE5vZGVzW2ldICk7IFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBDb2xvciBmdW5jdGlvblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIENvbG9yTHVtYSA6IGZ1bmN0aW9uICggaGV4LCBsICkge1xyXG5cclxuICAgICAgICBpZiggaGV4ID09PSAnbicgKSBoZXggPSAnIzAwMCc7XHJcblxyXG4gICAgICAgIC8vIHZhbGlkYXRlIGhleCBzdHJpbmdcclxuICAgICAgICBoZXggPSBTdHJpbmcoaGV4KS5yZXBsYWNlKC9bXjAtOWEtZl0vZ2ksICcnKTtcclxuICAgICAgICBpZiAoaGV4Lmxlbmd0aCA8IDYpIHtcclxuICAgICAgICAgICAgaGV4ID0gaGV4WzBdK2hleFswXStoZXhbMV0raGV4WzFdK2hleFsyXStoZXhbMl07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGwgPSBsIHx8IDA7XHJcblxyXG4gICAgICAgIC8vIGNvbnZlcnQgdG8gZGVjaW1hbCBhbmQgY2hhbmdlIGx1bWlub3NpdHlcclxuICAgICAgICBsZXQgcmdiID0gXCIjXCIsIGMsIGk7XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykge1xyXG4gICAgICAgICAgICBjID0gcGFyc2VJbnQoaGV4LnN1YnN0cihpKjIsMiksIDE2KTtcclxuICAgICAgICAgICAgYyA9IE1hdGgucm91bmQoTWF0aC5taW4oTWF0aC5tYXgoMCwgYyArIChjICogbCkpLCAyNTUpKS50b1N0cmluZygxNik7XHJcbiAgICAgICAgICAgIHJnYiArPSAoXCIwMFwiK2MpLnN1YnN0cihjLmxlbmd0aCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmdiO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZmluZERlZXBJbnZlcjogZnVuY3Rpb24gKCBjICkgeyBcclxuXHJcbiAgICAgICAgcmV0dXJuIChjWzBdICogMC4zICsgY1sxXSAqIC41OSArIGNbMl0gKiAuMTEpIDw9IDAuNjtcclxuICAgICAgICBcclxuICAgIH0sXHJcblxyXG5cclxuICAgIGhleFRvSHRtbDogZnVuY3Rpb24gKCB2ICkgeyBcclxuICAgICAgICB2ID0gdiA9PT0gdW5kZWZpbmVkID8gMHgwMDAwMDAgOiB2O1xyXG4gICAgICAgIHJldHVybiBcIiNcIiArIChcIjAwMDAwMFwiICsgdi50b1N0cmluZygxNikpLnN1YnN0cigtNik7XHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG5cclxuICAgIGh0bWxUb0hleDogZnVuY3Rpb24gKCB2ICkgeyBcclxuXHJcbiAgICAgICAgcmV0dXJuIHYudG9VcHBlckNhc2UoKS5yZXBsYWNlKFwiI1wiLCBcIjB4XCIpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdTI1NTogZnVuY3Rpb24gKGMsIGkpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KGMuc3Vic3RyaW5nKGksIGkgKyAyKSwgMTYpIC8gMjU1O1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdTE2OiBmdW5jdGlvbiAoIGMsIGkgKSB7XHJcblxyXG4gICAgICAgIHJldHVybiBwYXJzZUludChjLnN1YnN0cmluZyhpLCBpICsgMSksIDE2KSAvIDE1O1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdW5wYWNrOiBmdW5jdGlvbiggYyApe1xyXG5cclxuICAgICAgICBpZiAoYy5sZW5ndGggPT0gNykgcmV0dXJuIFsgVC51MjU1KGMsIDEpLCBULnUyNTUoYywgMyksIFQudTI1NShjLCA1KSBdO1xyXG4gICAgICAgIGVsc2UgaWYgKGMubGVuZ3RoID09IDQpIHJldHVybiBbIFQudTE2KGMsMSksIFQudTE2KGMsMiksIFQudTE2KGMsMykgXTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGh0bWxSZ2I6IGZ1bmN0aW9uKCBjICl7XHJcblxyXG4gICAgICAgIHJldHVybiAncmdiKCcgKyBNYXRoLnJvdW5kKGNbMF0gKiAyNTUpICsgJywnKyBNYXRoLnJvdW5kKGNbMV0gKiAyNTUpICsgJywnKyBNYXRoLnJvdW5kKGNbMl0gKiAyNTUpICsgJyknO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcGFkOiBmdW5jdGlvbiggbiApe1xyXG4gICAgICAgIGlmKG4ubGVuZ3RoID09IDEpbiA9ICcwJyArIG47XHJcbiAgICAgICAgcmV0dXJuIG47XHJcbiAgICB9LFxyXG5cclxuICAgIHJnYlRvSGV4IDogZnVuY3Rpb24oIGMgKXtcclxuXHJcbiAgICAgICAgbGV0IHIgPSBNYXRoLnJvdW5kKGNbMF0gKiAyNTUpLnRvU3RyaW5nKDE2KTtcclxuICAgICAgICBsZXQgZyA9IE1hdGgucm91bmQoY1sxXSAqIDI1NSkudG9TdHJpbmcoMTYpO1xyXG4gICAgICAgIGxldCBiID0gTWF0aC5yb3VuZChjWzJdICogMjU1KS50b1N0cmluZygxNik7XHJcbiAgICAgICAgcmV0dXJuICcjJyArIFQucGFkKHIpICsgVC5wYWQoZykgKyBULnBhZChiKTtcclxuXHJcbiAgICAgICAvLyByZXR1cm4gJyMnICsgKCAnMDAwMDAwJyArICggKCBjWzBdICogMjU1ICkgPDwgMTYgXiAoIGNbMV0gKiAyNTUgKSA8PCA4IF4gKCBjWzJdICogMjU1ICkgPDwgMCApLnRvU3RyaW5nKCAxNiApICkuc2xpY2UoIC0gNiApO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgaHVlVG9SZ2I6IGZ1bmN0aW9uKCBwLCBxLCB0ICl7XHJcblxyXG4gICAgICAgIGlmICggdCA8IDAgKSB0ICs9IDE7XHJcbiAgICAgICAgaWYgKCB0ID4gMSApIHQgLT0gMTtcclxuICAgICAgICBpZiAoIHQgPCAxIC8gNiApIHJldHVybiBwICsgKCBxIC0gcCApICogNiAqIHQ7XHJcbiAgICAgICAgaWYgKCB0IDwgMSAvIDIgKSByZXR1cm4gcTtcclxuICAgICAgICBpZiAoIHQgPCAyIC8gMyApIHJldHVybiBwICsgKCBxIC0gcCApICogNiAqICggMiAvIDMgLSB0ICk7XHJcbiAgICAgICAgcmV0dXJuIHA7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICByZ2JUb0hzbDogZnVuY3Rpb24gKCBjICkge1xyXG5cclxuICAgICAgICBsZXQgciA9IGNbMF0sIGcgPSBjWzFdLCBiID0gY1syXSwgbWluID0gTWF0aC5taW4ociwgZywgYiksIG1heCA9IE1hdGgubWF4KHIsIGcsIGIpLCBkZWx0YSA9IG1heCAtIG1pbiwgaCA9IDAsIHMgPSAwLCBsID0gKG1pbiArIG1heCkgLyAyO1xyXG4gICAgICAgIGlmIChsID4gMCAmJiBsIDwgMSkgcyA9IGRlbHRhIC8gKGwgPCAwLjUgPyAoMiAqIGwpIDogKDIgLSAyICogbCkpO1xyXG4gICAgICAgIGlmIChkZWx0YSA+IDApIHtcclxuICAgICAgICAgICAgaWYgKG1heCA9PSByICYmIG1heCAhPSBnKSBoICs9IChnIC0gYikgLyBkZWx0YTtcclxuICAgICAgICAgICAgaWYgKG1heCA9PSBnICYmIG1heCAhPSBiKSBoICs9ICgyICsgKGIgLSByKSAvIGRlbHRhKTtcclxuICAgICAgICAgICAgaWYgKG1heCA9PSBiICYmIG1heCAhPSByKSBoICs9ICg0ICsgKHIgLSBnKSAvIGRlbHRhKTtcclxuICAgICAgICAgICAgaCAvPSA2O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gWyBoLCBzLCBsIF07XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBoc2xUb1JnYjogZnVuY3Rpb24gKCBjICkge1xyXG5cclxuICAgICAgICBsZXQgcCwgcSwgaCA9IGNbMF0sIHMgPSBjWzFdLCBsID0gY1syXTtcclxuXHJcbiAgICAgICAgaWYgKCBzID09PSAwICkgcmV0dXJuIFsgbCwgbCwgbCBdO1xyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBxID0gbCA8PSAwLjUgPyBsICogKHMgKyAxKSA6IGwgKyBzIC0gKCBsICogcyApO1xyXG4gICAgICAgICAgICBwID0gbCAqIDIgLSBxO1xyXG4gICAgICAgICAgICByZXR1cm4gWyBULmh1ZVRvUmdiKHAsIHEsIGggKyAwLjMzMzMzKSwgVC5odWVUb1JnYihwLCBxLCBoKSwgVC5odWVUb1JnYihwLCBxLCBoIC0gMC4zMzMzMykgXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIFNWRyBNT0RFTFxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1ha2VHcmFkaWFudDogZnVuY3Rpb24gKCB0eXBlLCBzZXR0aW5ncywgcGFyZW50LCBjb2xvcnMgKSB7XHJcblxyXG4gICAgICAgIFQuZG9tKCB0eXBlLCBudWxsLCBzZXR0aW5ncywgcGFyZW50LCAwICk7XHJcblxyXG4gICAgICAgIGxldCBuID0gcGFyZW50LmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlcy5sZW5ndGggLSAxLCBjO1xyXG5cclxuICAgICAgICBmb3IoIGxldCBpID0gMDsgaSA8IGNvbG9ycy5sZW5ndGg7IGkrKyApe1xyXG5cclxuICAgICAgICAgICAgYyA9IGNvbG9yc1tpXTtcclxuICAgICAgICAgICAgLy9ULmRvbSggJ3N0b3AnLCBudWxsLCB7IG9mZnNldDpjWzBdKyclJywgc3R5bGU6J3N0b3AtY29sb3I6JytjWzFdKyc7IHN0b3Atb3BhY2l0eTonK2NbMl0rJzsnIH0sIHBhcmVudCwgWzAsbl0gKTtcclxuICAgICAgICAgICAgVC5kb20oICdzdG9wJywgbnVsbCwgeyBvZmZzZXQ6Y1swXSsnJScsICdzdG9wLWNvbG9yJzpjWzFdLCAgJ3N0b3Atb3BhY2l0eSc6Y1syXSB9LCBwYXJlbnQsIFswLG5dICk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8qbWFrZUdyYXBoOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGxldCB3ID0gMTI4O1xyXG4gICAgICAgIGxldCByYWRpdXMgPSAzNDtcclxuICAgICAgICBsZXQgc3ZnID0gVC5kb20oICdzdmcnLCBULmNzcy5iYXNpYyAsIHsgdmlld0JveDonMCAwICcrdysnICcrdywgd2lkdGg6dywgaGVpZ2h0OncsIHByZXNlcnZlQXNwZWN0UmF0aW86J25vbmUnIH0gKTtcclxuICAgICAgICBULmRvbSggJ3BhdGgnLCAnJywgeyBkOicnLCBzdHJva2U6VC5jb2xvcnMudGV4dCwgJ3N0cm9rZS13aWR0aCc6NCwgZmlsbDonbm9uZScsICdzdHJva2UtbGluZWNhcCc6J2J1dHQnIH0sIHN2ZyApOy8vMFxyXG4gICAgICAgIC8vVC5kb20oICdyZWN0JywgJycsIHsgeDoxMCwgeToxMCwgd2lkdGg6MTA4LCBoZWlnaHQ6MTA4LCBzdHJva2U6J3JnYmEoMCwwLDAsMC4zKScsICdzdHJva2Utd2lkdGgnOjIgLCBmaWxsOidub25lJ30sIHN2ZyApOy8vMVxyXG4gICAgICAgIC8vVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDo2NCwgY3k6NjQsIHI6cmFkaXVzLCBmaWxsOlQuY29sb3JzLmJ1dHRvbiwgc3Ryb2tlOidyZ2JhKDAsMCwwLDAuMyknLCAnc3Ryb2tlLXdpZHRoJzo4IH0sIHN2ZyApOy8vMFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDo2NCwgY3k6NjQsIHI6cmFkaXVzKzcsIHN0cm9rZToncmdiYSgwLDAsMCwwLjMpJywgJ3N0cm9rZS13aWR0aCc6NyAsIGZpbGw6J25vbmUnfSwgc3ZnICk7Ly8yXHJcbiAgICAgICAgLy9ULmRvbSggJ3BhdGgnLCAnJywgeyBkOicnLCBzdHJva2U6J3JnYmEoMjU1LDI1NSwyNTUsMC4zKScsICdzdHJva2Utd2lkdGgnOjIsIGZpbGw6J25vbmUnLCAnc3Ryb2tlLWxpbmVjYXAnOidyb3VuZCcsICdzdHJva2Utb3BhY2l0eSc6MC41IH0sIHN2ZyApOy8vM1xyXG4gICAgICAgIFQuZ3JhcGggPSBzdmc7XHJcblxyXG4gICAgfSwqL1xyXG5cclxuICAgIG1ha2VLbm9iOiBmdW5jdGlvbiAoIG1vZGVsICkge1xyXG5cclxuICAgICAgICBsZXQgdyA9IDEyODtcclxuICAgICAgICBsZXQgcmFkaXVzID0gMzQ7XHJcbiAgICAgICAgbGV0IHN2ZyA9IFQuZG9tKCAnc3ZnJywgVC5jc3MuYmFzaWMgLCB7IHZpZXdCb3g6JzAgMCAnK3crJyAnK3csIHdpZHRoOncsIGhlaWdodDp3LCBwcmVzZXJ2ZUFzcGVjdFJhdGlvOidub25lJyB9ICk7XHJcbiAgICAgICAgVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDo2NCwgY3k6NjQsIHI6cmFkaXVzLCBmaWxsOlQuY29sb3JzLmJ1dHRvbiwgc3Ryb2tlOidyZ2JhKDAsMCwwLDAuMyknLCAnc3Ryb2tlLXdpZHRoJzo4IH0sIHN2ZyApOy8vMFxyXG4gICAgICAgIFQuZG9tKCAncGF0aCcsICcnLCB7IGQ6JycsIHN0cm9rZTpULmNvbG9ycy50ZXh0LCAnc3Ryb2tlLXdpZHRoJzo0LCBmaWxsOidub25lJywgJ3N0cm9rZS1saW5lY2FwJzoncm91bmQnIH0sIHN2ZyApOy8vMVxyXG4gICAgICAgIFQuZG9tKCAnY2lyY2xlJywgJycsIHsgY3g6NjQsIGN5OjY0LCByOnJhZGl1cys3LCBzdHJva2U6J3JnYmEoMCwwLDAsMC4xKScsICdzdHJva2Utd2lkdGgnOjcgLCBmaWxsOidub25lJ30sIHN2ZyApOy8vMlxyXG4gICAgICAgIFQuZG9tKCAncGF0aCcsICcnLCB7IGQ6JycsIHN0cm9rZToncmdiYSgyNTUsMjU1LDI1NSwwLjMpJywgJ3N0cm9rZS13aWR0aCc6MiwgZmlsbDonbm9uZScsICdzdHJva2UtbGluZWNhcCc6J3JvdW5kJywgJ3N0cm9rZS1vcGFjaXR5JzowLjUgfSwgc3ZnICk7Ly8zXHJcbiAgICAgICAgVC5rbm9iID0gc3ZnO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgbWFrZUNpcmN1bGFyOiBmdW5jdGlvbiAoIG1vZGVsICkge1xyXG5cclxuICAgICAgICBsZXQgdyA9IDEyODtcclxuICAgICAgICBsZXQgcmFkaXVzID0gNDA7XHJcbiAgICAgICAgbGV0IHN2ZyA9IFQuZG9tKCAnc3ZnJywgVC5jc3MuYmFzaWMgLCB7IHZpZXdCb3g6JzAgMCAnK3crJyAnK3csIHdpZHRoOncsIGhlaWdodDp3LCBwcmVzZXJ2ZUFzcGVjdFJhdGlvOidub25lJyB9ICk7XHJcbiAgICAgICAgVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDo2NCwgY3k6NjQsIHI6cmFkaXVzLCBzdHJva2U6J3JnYmEoMCwwLDAsMC4xKScsICdzdHJva2Utd2lkdGgnOjEwLCBmaWxsOidub25lJyB9LCBzdmcgKTsvLzBcclxuICAgICAgICBULmRvbSggJ3BhdGgnLCAnJywgeyBkOicnLCBzdHJva2U6VC5jb2xvcnMudGV4dCwgJ3N0cm9rZS13aWR0aCc6NywgZmlsbDonbm9uZScsICdzdHJva2UtbGluZWNhcCc6J2J1dHQnIH0sIHN2ZyApOy8vMVxyXG4gICAgICAgIFQuY2lyY3VsYXIgPSBzdmc7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBtYWtlSm95c3RpY2s6IGZ1bmN0aW9uICggbW9kZWwgKSB7XHJcblxyXG4gICAgICAgIC8vKycgYmFja2dyb3VuZDojZjAwOydcclxuXHJcbiAgICAgICAgbGV0IHcgPSAxMjgsIGNjYztcclxuICAgICAgICBsZXQgcmFkaXVzID0gTWF0aC5mbG9vcigody0zMCkqMC41KTtcclxuICAgICAgICBsZXQgaW5uZXJSYWRpdXMgPSBNYXRoLmZsb29yKHJhZGl1cyowLjYpO1xyXG4gICAgICAgIGxldCBzdmcgPSBULmRvbSggJ3N2ZycsIFQuY3NzLmJhc2ljICwgeyB2aWV3Qm94OicwIDAgJyt3KycgJyt3LCB3aWR0aDp3LCBoZWlnaHQ6dywgcHJlc2VydmVBc3BlY3RSYXRpbzonbm9uZScgfSApO1xyXG4gICAgICAgIFQuZG9tKCAnZGVmcycsIG51bGwsIHt9LCBzdmcgKTtcclxuICAgICAgICBULmRvbSggJ2cnLCBudWxsLCB7fSwgc3ZnICk7XHJcblxyXG4gICAgICAgIGlmKCBtb2RlbCA9PT0gMCApe1xyXG5cclxuICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIC8vIGdyYWRpYW4gYmFja2dyb3VuZFxyXG4gICAgICAgICAgICBjY2MgPSBbIFs0MCwgJ3JnYigwLDAsMCknLCAwLjNdLCBbODAsICdyZ2IoMCwwLDApJywgMF0sIFs5MCwgJ3JnYig1MCw1MCw1MCknLCAwLjRdLCBbMTAwLCAncmdiKDUwLDUwLDUwKScsIDBdIF07XHJcbiAgICAgICAgICAgIFQubWFrZUdyYWRpYW50KCAncmFkaWFsR3JhZGllbnQnLCB7IGlkOidncmFkJywgY3g6JzUwJScsIGN5Oic1MCUnLCByOic1MCUnLCBmeDonNTAlJywgZnk6JzUwJScgfSwgc3ZnLCBjY2MgKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGdyYWRpYW4gc2hhZG93XHJcbiAgICAgICAgICAgIGNjYyA9IFsgWzYwLCAncmdiKDAsMCwwKScsIDAuNV0sIFsxMDAsICdyZ2IoMCwwLDApJywgMF0gXTtcclxuICAgICAgICAgICAgVC5tYWtlR3JhZGlhbnQoICdyYWRpYWxHcmFkaWVudCcsIHsgaWQ6J2dyYWRTJywgY3g6JzUwJScsIGN5Oic1MCUnLCByOic1MCUnLCBmeDonNTAlJywgZnk6JzUwJScgfSwgc3ZnLCBjY2MgKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGdyYWRpYW4gc3RpY2tcclxuICAgICAgICAgICAgbGV0IGNjMCA9IFsncmdiKDQwLDQwLDQwKScsICdyZ2IoNDgsNDgsNDgpJywgJ3JnYigzMCwzMCwzMCknXTtcclxuICAgICAgICAgICAgbGV0IGNjMSA9IFsncmdiKDEsOTAsMTk3KScsICdyZ2IoMyw5NSwyMDcpJywgJ3JnYigwLDY1LDE2NyknXTtcclxuXHJcbiAgICAgICAgICAgIGNjYyA9IFsgWzMwLCBjYzBbMF0sIDFdLCBbNjAsIGNjMFsxXSwgMV0sIFs4MCwgY2MwWzFdLCAxXSwgWzEwMCwgY2MwWzJdLCAxXSBdO1xyXG4gICAgICAgICAgICBULm1ha2VHcmFkaWFudCggJ3JhZGlhbEdyYWRpZW50JywgeyBpZDonZ3JhZEluJywgY3g6JzUwJScsIGN5Oic1MCUnLCByOic1MCUnLCBmeDonNTAlJywgZnk6JzUwJScgfSwgc3ZnLCBjY2MgKTtcclxuXHJcbiAgICAgICAgICAgIGNjYyA9IFsgWzMwLCBjYzFbMF0sIDFdLCBbNjAsIGNjMVsxXSwgMV0sIFs4MCwgY2MxWzFdLCAxXSwgWzEwMCwgY2MxWzJdLCAxXSBdO1xyXG4gICAgICAgICAgICBULm1ha2VHcmFkaWFudCggJ3JhZGlhbEdyYWRpZW50JywgeyBpZDonZ3JhZEluMicsIGN4Oic1MCUnLCBjeTonNTAlJywgcjonNTAlJywgZng6JzUwJScsIGZ5Oic1MCUnIH0sIHN2ZywgY2NjICk7XHJcblxyXG4gICAgICAgICAgICAvLyBncmFwaFxyXG5cclxuICAgICAgICAgICAgVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDo2NCwgY3k6NjQsIHI6cmFkaXVzLCBmaWxsOid1cmwoI2dyYWQpJyB9LCBzdmcgKTsvLzJcclxuICAgICAgICAgICAgVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDo2NCs1LCBjeTo2NCsxMCwgcjppbm5lclJhZGl1cysxMCwgZmlsbDondXJsKCNncmFkUyknIH0sIHN2ZyApOy8vM1xyXG4gICAgICAgICAgICBULmRvbSggJ2NpcmNsZScsICcnLCB7IGN4OjY0LCBjeTo2NCwgcjppbm5lclJhZGl1cywgZmlsbDondXJsKCNncmFkSW4pJyB9LCBzdmcgKTsvLzRcclxuXHJcbiAgICAgICAgICAgIFQuam95c3RpY2tfMCA9IHN2ZztcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgIC8vIGdyYWRpYW4gc2hhZG93XHJcbiAgICAgICAgICAgIGNjYyA9IFsgWzY5LCAncmdiKDAsMCwwKScsIDBdLFs3MCwgJ3JnYigwLDAsMCknLCAwLjNdLCBbMTAwLCAncmdiKDAsMCwwKScsIDBdIF07XHJcbiAgICAgICAgICAgIFQubWFrZUdyYWRpYW50KCAncmFkaWFsR3JhZGllbnQnLCB7IGlkOidncmFkWCcsIGN4Oic1MCUnLCBjeTonNTAlJywgcjonNTAlJywgZng6JzUwJScsIGZ5Oic1MCUnIH0sIHN2ZywgY2NjICk7XHJcblxyXG4gICAgICAgICAgICBULmRvbSggJ2NpcmNsZScsICcnLCB7IGN4OjY0LCBjeTo2NCwgcjpyYWRpdXMsIGZpbGw6J25vbmUnLCBzdHJva2U6J3JnYmEoMTAwLDEwMCwxMDAsMC4yNSknLCAnc3Ryb2tlLXdpZHRoJzonNCcgfSwgc3ZnICk7Ly8yXHJcbiAgICAgICAgICAgIFQuZG9tKCAnY2lyY2xlJywgJycsIHsgY3g6NjQsIGN5OjY0LCByOmlubmVyUmFkaXVzKzE0LCBmaWxsOid1cmwoI2dyYWRYKScgfSwgc3ZnICk7Ly8zXHJcbiAgICAgICAgICAgIFQuZG9tKCAnY2lyY2xlJywgJycsIHsgY3g6NjQsIGN5OjY0LCByOmlubmVyUmFkaXVzLCBmaWxsOidub25lJywgc3Ryb2tlOidyZ2IoMTAwLDEwMCwxMDApJywgJ3N0cm9rZS13aWR0aCc6JzQnIH0sIHN2ZyApOy8vNFxyXG5cclxuICAgICAgICAgICAgVC5qb3lzdGlja18xID0gc3ZnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBtYWtlQ29sb3JSaW5nOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGxldCB3ID0gMjU2O1xyXG4gICAgICAgIGxldCBzdmcgPSBULmRvbSggJ3N2ZycsIFQuY3NzLmJhc2ljICwgeyB2aWV3Qm94OicwIDAgJyt3KycgJyt3LCB3aWR0aDp3LCBoZWlnaHQ6dywgcHJlc2VydmVBc3BlY3RSYXRpbzonbm9uZScgfSApO1xyXG4gICAgICAgIFQuZG9tKCAnZGVmcycsIG51bGwsIHt9LCBzdmcgKTtcclxuICAgICAgICBULmRvbSggJ2cnLCBudWxsLCB7fSwgc3ZnICk7XHJcblxyXG4gICAgICAgIGxldCBzID0gMzA7Ly9zdHJva2VcclxuICAgICAgICBsZXQgciA9KCB3LXMgKSowLjU7XHJcbiAgICAgICAgbGV0IG1pZCA9IHcqMC41O1xyXG4gICAgICAgIGxldCBuID0gMjQsIG51ZGdlID0gOCAvIHIgLyBuICogTWF0aC5QSSwgYTEgPSAwLCBkMTtcclxuICAgICAgICBsZXQgYW0sIHRhbiwgZDIsIGEyLCBhciwgaSwgaiwgcGF0aCwgY2NjO1xyXG4gICAgICAgIGxldCBjb2xvciA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAoIGkgPSAwOyBpIDw9IG47ICsraSkge1xyXG5cclxuICAgICAgICAgICAgZDIgPSBpIC8gbjtcclxuICAgICAgICAgICAgYTIgPSBkMiAqIFQuVHdvUEk7XHJcbiAgICAgICAgICAgIGFtID0gKGExICsgYTIpICogMC41O1xyXG4gICAgICAgICAgICB0YW4gPSAxIC8gTWF0aC5jb3MoKGEyIC0gYTEpICogMC41KTtcclxuXHJcbiAgICAgICAgICAgIGFyID0gW1xyXG4gICAgICAgICAgICAgICAgTWF0aC5zaW4oYTEpLCAtTWF0aC5jb3MoYTEpLCBcclxuICAgICAgICAgICAgICAgIE1hdGguc2luKGFtKSAqIHRhbiwgLU1hdGguY29zKGFtKSAqIHRhbiwgXHJcbiAgICAgICAgICAgICAgICBNYXRoLnNpbihhMiksIC1NYXRoLmNvcyhhMilcclxuICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbG9yWzFdID0gVC5yZ2JUb0hleCggVC5oc2xUb1JnYihbZDIsIDEsIDAuNV0pICk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaSA+IDApIHtcclxuXHJcbiAgICAgICAgICAgICAgICBqID0gNjtcclxuICAgICAgICAgICAgICAgIHdoaWxlKGotLSl7XHJcbiAgICAgICAgICAgICAgICAgICBhcltqXSA9ICgoYXJbal0qcikrbWlkKS50b0ZpeGVkKDIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHBhdGggPSAnIE0nICsgYXJbMF0gKyAnICcgKyBhclsxXSArICcgUScgKyBhclsyXSArICcgJyArIGFyWzNdICsgJyAnICsgYXJbNF0gKyAnICcgKyBhcls1XTtcclxuXHJcbiAgICAgICAgICAgICAgICBjY2MgPSBbIFswLGNvbG9yWzBdLDFdLCBbMTAwLGNvbG9yWzFdLDFdIF07XHJcbiAgICAgICAgICAgICAgICBULm1ha2VHcmFkaWFudCggJ2xpbmVhckdyYWRpZW50JywgeyBpZDonRycraSwgeDE6YXJbMF0sIHkxOmFyWzFdLCB4Mjphcls0XSwgeTI6YXJbNV0sIGdyYWRpZW50VW5pdHM6XCJ1c2VyU3BhY2VPblVzZVwiIH0sIHN2ZywgY2NjICk7XHJcblxyXG4gICAgICAgICAgICAgICAgVC5kb20oICdwYXRoJywgJycsIHsgZDpwYXRoLCAnc3Ryb2tlLXdpZHRoJzpzLCBzdHJva2U6J3VybCgjRycraSsnKScsICdzdHJva2UtbGluZWNhcCc6XCJidXR0XCIgfSwgc3ZnLCAxICk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhMSA9IGEyIC0gbnVkZ2U7IFxyXG4gICAgICAgICAgICBjb2xvclswXSA9IGNvbG9yWzFdO1xyXG4gICAgICAgICAgICBkMSA9IGQyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGJyID0gKDEyOCAtIHMgKSArIDI7XHJcbiAgICAgICAgbGV0IGJ3ID0gNjA7XHJcblxyXG4gICAgICAgIGxldCB0dyA9IDg0LjkwO1xyXG5cclxuICAgICAgICAvLyBibGFjayAvIHdoaXRlXHJcbiAgICAgICAgY2NjID0gWyBbMCwgJyNGRkZGRkYnLCAxXSwgWzUwLCAnI0ZGRkZGRicsIDBdLCBbNTAsICcjMDAwMDAwJywgMF0sIFsxMDAsICcjMDAwMDAwJywgMV0gXTtcclxuICAgICAgICBULm1ha2VHcmFkaWFudCggJ2xpbmVhckdyYWRpZW50JywgeyBpZDonR0wwJywgeDE6MCwgeTE6bWlkLXR3LCB4MjowLCB5MjptaWQrdHcsIGdyYWRpZW50VW5pdHM6XCJ1c2VyU3BhY2VPblVzZVwiIH0sIHN2ZywgY2NjICk7XHJcblxyXG4gICAgICAgIGNjYyA9IFsgWzAsICcjN2Y3ZjdmJywgMV0sIFs1MCwgJyM3ZjdmN2YnLCAwLjVdLCBbMTAwLCAnIzdmN2Y3ZicsIDBdIF07XHJcbiAgICAgICAgVC5tYWtlR3JhZGlhbnQoICdsaW5lYXJHcmFkaWVudCcsIHsgaWQ6J0dMMScsIHgxOm1pZC00OS4wNSwgeTE6MCwgeDI6bWlkKzk4LCB5MjowLCBncmFkaWVudFVuaXRzOlwidXNlclNwYWNlT25Vc2VcIiB9LCBzdmcsIGNjYyApO1xyXG5cclxuICAgICAgICBULmRvbSggJ2cnLCBudWxsLCB7ICd0cmFuc2Zvcm0tb3JpZ2luJzogJzEyOHB4IDEyOHB4JywgJ3RyYW5zZm9ybSc6J3JvdGF0ZSgwKScgfSwgc3ZnICk7Ly8yXHJcbiAgICAgICAgVC5kb20oICdwb2x5Z29uJywgJycsIHsgcG9pbnRzOic3OC45NSA0My4xIDc4Ljk1IDIxMi44NSAyMjYgMTI4JywgIGZpbGw6J3JlZCcgIH0sIHN2ZywgMiApOy8vIDIsMFxyXG4gICAgICAgIFQuZG9tKCAncG9seWdvbicsICcnLCB7IHBvaW50czonNzguOTUgNDMuMSA3OC45NSAyMTIuODUgMjI2IDEyOCcsICBmaWxsOid1cmwoI0dMMSknLCdzdHJva2Utd2lkdGgnOjEsIHN0cm9rZTondXJsKCNHTDEpJyAgfSwgc3ZnLCAyICk7Ly8yLDFcclxuICAgICAgICBULmRvbSggJ3BvbHlnb24nLCAnJywgeyBwb2ludHM6Jzc4Ljk1IDQzLjEgNzguOTUgMjEyLjg1IDIyNiAxMjgnLCAgZmlsbDondXJsKCNHTDApJywnc3Ryb2tlLXdpZHRoJzoxLCBzdHJva2U6J3VybCgjR0wwKScgIH0sIHN2ZywgMiApOy8vMiwyXHJcbiAgICAgICAgVC5kb20oICdwYXRoJywgJycsIHsgZDonTSAyNTUuNzUgMTM2LjUgUSAyNTYgMTMyLjMgMjU2IDEyOCAyNTYgMTIzLjcgMjU1Ljc1IDExOS41IEwgMjQxIDEyOCAyNTUuNzUgMTM2LjUgWicsICBmaWxsOidub25lJywnc3Ryb2tlLXdpZHRoJzoyLCBzdHJva2U6JyMwMDAnICB9LCBzdmcsIDIgKTsvLzIsM1xyXG4gICAgICAgIC8vVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDoxMjgrMTEzLCBjeToxMjgsIHI6NiwgJ3N0cm9rZS13aWR0aCc6Mywgc3Ryb2tlOicjMDAwJywgZmlsbDonbm9uZScgfSwgc3ZnLCAyICk7Ly8yLjNcclxuXHJcbiAgICAgICAgVC5kb20oICdjaXJjbGUnLCAnJywgeyBjeDoxMjgsIGN5OjEyOCwgcjo2LCAnc3Ryb2tlLXdpZHRoJzoyLCBzdHJva2U6JyMwMDAnLCBmaWxsOidub25lJyB9LCBzdmcgKTsvLzNcclxuXHJcbiAgICAgICAgVC5jb2xvclJpbmcgPSBzdmc7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBpY29uOiBmdW5jdGlvbiAoIHR5cGUsIGNvbG9yLCB3ICl7XHJcblxyXG4gICAgICAgIHcgPSB3IHx8IDQwO1xyXG4gICAgICAgIGNvbG9yID0gY29sb3IgfHwgJyNERURFREUnO1xyXG4gICAgICAgIGxldCB2aWV3Qm94ID0gJzAgMCAyNTYgMjU2JztcclxuICAgICAgICBsZXQgdCA9IFtcIjxzdmcgeG1sbnM9J1wiK1Quc3ZnbnMrXCInIHZlcnNpb249JzEuMScgeG1sbnM6eGxpbms9J1wiK1QuaHRtbHMrXCInIHN0eWxlPSdwb2ludGVyLWV2ZW50czpub25lOycgcHJlc2VydmVBc3BlY3RSYXRpbz0neE1pbllNYXggbWVldCcgeD0nMHB4JyB5PScwcHgnIHdpZHRoPSdcIit3K1wicHgnIGhlaWdodD0nXCIrdytcInB4JyB2aWV3Qm94PSdcIit2aWV3Qm94K1wiJz48Zz5cIl07XHJcbiAgICAgICAgc3dpdGNoKHR5cGUpe1xyXG4gICAgICAgICAgICBjYXNlICdsb2dvJzpcclxuICAgICAgICAgICAgLy90WzFdPVwiPHBhdGggaWQ9J2xvZ29pbicgc3Ryb2tlPSdcIitjb2xvcitcIicgc3Ryb2tlLXdpZHRoPScxNicgc3Ryb2tlLWxpbmVqb2luPSdyb3VuZCcgc3Ryb2tlLWxpbmVjYXA9J3NxdWFyZScgZmlsbD0nbm9uZScgZD0nTSAxOTIgNDQgTCAxOTIgMTQ4IFEgMTkyIDE3NC41IDE3My4zIDE5My4yNSAxNTQuNTUgMjEyIDEyOCAyMTIgMTAxLjUgMjEyIDgyLjc1IDE5My4yNSA2NCAxNzQuNSA2NCAxNDggTCA2NCA0NCBNIDE2MCA0NCBMIDE2MCAxNDggUSAxNjAgMTYxLjI1IDE1MC42NSAxNzAuNjUgMTQxLjI1IDE4MCAxMjggMTgwIDExNC43NSAxODAgMTA1LjM1IDE3MC42NSA5NiAxNjEuMjUgOTYgMTQ4IEwgOTYgNDQnLz5cIjtcclxuICAgICAgICAgICAgdFsxXT1cIjxwYXRoIGlkPSdsb2dvaW4nIGZpbGw9J1wiK2NvbG9yK1wiJyBzdHJva2U9J25vbmUnIGQ9J1wiK1QubG9nb0ZpbGxfZCtcIicvPlwiO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3NhdmUnOlxyXG4gICAgICAgICAgICB0WzFdPVwiPHBhdGggc3Ryb2tlPSdcIitjb2xvcitcIicgc3Ryb2tlLXdpZHRoPSc0JyBzdHJva2UtbGluZWpvaW49J3JvdW5kJyBzdHJva2UtbGluZWNhcD0ncm91bmQnIGZpbGw9J25vbmUnIGQ9J00gMjYuMTI1IDE3IEwgMjAgMjIuOTUgMTQuMDUgMTcgTSAyMCA5Ljk1IEwgMjAgMjIuOTUnLz48cGF0aCBzdHJva2U9J1wiK2NvbG9yK1wiJyBzdHJva2Utd2lkdGg9JzIuNScgc3Ryb2tlLWxpbmVqb2luPSdyb3VuZCcgc3Ryb2tlLWxpbmVjYXA9J3JvdW5kJyBmaWxsPSdub25lJyBkPSdNIDMyLjYgMjMgTCAzMi42IDI1LjUgUSAzMi42IDI4LjUgMjkuNiAyOC41IEwgMTAuNiAyOC41IFEgNy42IDI4LjUgNy42IDI1LjUgTCA3LjYgMjMnLz5cIjtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRbMl0gPSBcIjwvZz48L3N2Zz5cIjtcclxuICAgICAgICByZXR1cm4gdC5qb2luKFwiXFxuXCIpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgbG9nb0ZpbGxfZDogW1xyXG4gICAgXCJNIDE3MSAxNTAuNzUgTCAxNzEgMzMuMjUgMTU1LjUgMzMuMjUgMTU1LjUgMTUwLjc1IFEgMTU1LjUgMTYyLjIgMTQ3LjQ1IDE3MC4yIDEzOS40NSAxNzguMjUgMTI4IDE3OC4yNSAxMTYuNiAxNzguMjUgMTA4LjU1IDE3MC4yIDEwMC41IDE2Mi4yIDEwMC41IDE1MC43NSBcIixcclxuICAgIFwiTCAxMDAuNSAzMy4yNSA4NSAzMy4yNSA4NSAxNTAuNzUgUSA4NSAxNjguNjUgOTcuNTUgMTgxLjE1IDExMC4xNSAxOTMuNzUgMTI4IDE5My43NSAxNDUuOSAxOTMuNzUgMTU4LjQgMTgxLjE1IDE3MSAxNjguNjUgMTcxIDE1MC43NSBcIixcclxuICAgIFwiTSAyMDAgMzMuMjUgTCAxODQgMzMuMjUgMTg0IDE1MC44IFEgMTg0IDE3NC4xIDE2Ny42IDE5MC40IDE1MS4zIDIwNi44IDEyOCAyMDYuOCAxMDQuNzUgMjA2LjggODguMyAxOTAuNCA3MiAxNzQuMSA3MiAxNTAuOCBMIDcyIDMzLjI1IDU2IDMzLjI1IDU2IDE1MC43NSBcIixcclxuICAgIFwiUSA1NiAxODAuNTUgNzcuMDUgMjAxLjYgOTguMiAyMjIuNzUgMTI4IDIyMi43NSAxNTcuOCAyMjIuNzUgMTc4LjkgMjAxLjYgMjAwIDE4MC41NSAyMDAgMTUwLjc1IEwgMjAwIDMzLjI1IFpcIixcclxuICAgIF0uam9pbignXFxuJyksXHJcblxyXG59XHJcblxyXG5ULnNldFRleHQoKTtcclxuXHJcbmV4cG9ydCBjb25zdCBUb29scyA9IFQ7IiwiXHJcbi8qKlxyXG4gKiBAYXV0aG9yIGx0aCAvIGh0dHBzOi8vZ2l0aHViLmNvbS9sby10aFxyXG4gKi9cclxuXHJcbi8vIElOVEVOQUwgRlVOQ1RJT05cclxuXHJcbmNvbnN0IFIgPSB7XHJcblxyXG5cdHVpOiBbXSxcclxuXHJcblx0SUQ6IG51bGwsXHJcbiAgICBsb2NrOmZhbHNlLFxyXG4gICAgd2xvY2s6ZmFsc2UsXHJcbiAgICBjdXJyZW50Oi0xLFxyXG5cclxuXHRuZWVkUmVab25lOiB0cnVlLFxyXG5cdGlzRXZlbnRzSW5pdDogZmFsc2UsXHJcblxyXG4gICAgcHJldkRlZmF1bHQ6IFsnY29udGV4dG1lbnUnLCAnbW91c2Vkb3duJywgJ21vdXNlbW92ZScsICdtb3VzZXVwJ10sXHJcblxyXG5cdHhtbHNlcmlhbGl6ZXI6IG5ldyBYTUxTZXJpYWxpemVyKCksXHJcblx0dG1wVGltZTogbnVsbCxcclxuICAgIHRtcEltYWdlOiBudWxsLFxyXG5cclxuICAgIG9sZEN1cnNvcjonYXV0bycsXHJcblxyXG4gICAgaW5wdXQ6IG51bGwsXHJcbiAgICBwYXJlbnQ6IG51bGwsXHJcbiAgICBmaXJzdEltcHV0OiB0cnVlLFxyXG4gICAgLy9jYWxsYmFja0ltcHV0OiBudWxsLFxyXG4gICAgaGlkZGVuSW1wdXQ6bnVsbCxcclxuICAgIGhpZGRlblNpemVyOm51bGwsXHJcbiAgICBoYXNGb2N1czpmYWxzZSxcclxuICAgIHN0YXJ0SW5wdXQ6ZmFsc2UsXHJcbiAgICBpbnB1dFJhbmdlIDogWzAsMF0sXHJcbiAgICBjdXJzb3JJZCA6IDAsXHJcbiAgICBzdHI6JycsXHJcbiAgICBwb3M6MCxcclxuICAgIHN0YXJ0WDotMSxcclxuICAgIG1vdmVYOi0xLFxyXG5cclxuICAgIGRlYnVnSW5wdXQ6ZmFsc2UsXHJcblxyXG4gICAgaXNMb29wOiBmYWxzZSxcclxuICAgIGxpc3RlbnM6IFtdLFxyXG5cclxuICAgIGU6e1xyXG4gICAgICAgIHR5cGU6bnVsbCxcclxuICAgICAgICBjbGllbnRYOjAsXHJcbiAgICAgICAgY2xpZW50WTowLFxyXG4gICAgICAgIGtleUNvZGU6TmFOLFxyXG4gICAgICAgIGtleTpudWxsLFxyXG4gICAgICAgIGRlbHRhOjAsXHJcbiAgICB9LFxyXG5cclxuICAgIGlzTW9iaWxlOiBmYWxzZSxcclxuXHJcbiAgICBcclxuXHJcblx0YWRkOiBmdW5jdGlvbiAoIG8gKSB7XHJcblxyXG4gICAgICAgIFIudWkucHVzaCggbyApO1xyXG4gICAgICAgIFIuZ2V0Wm9uZSggbyApO1xyXG5cclxuICAgICAgICBpZiggIVIuaXNFdmVudHNJbml0ICkgUi5pbml0RXZlbnRzKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB0ZXN0TW9iaWxlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGxldCBuID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcclxuICAgICAgICBpZiAobi5tYXRjaCgvQW5kcm9pZC9pKSB8fCBuLm1hdGNoKC93ZWJPUy9pKSB8fCBuLm1hdGNoKC9pUGhvbmUvaSkgfHwgbi5tYXRjaCgvaVBhZC9pKSB8fCBuLm1hdGNoKC9pUG9kL2kpIHx8IG4ubWF0Y2goL0JsYWNrQmVycnkvaSkgfHwgbi5tYXRjaCgvV2luZG93cyBQaG9uZS9pKSkgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgZWxzZSByZXR1cm4gZmFsc2U7ICBcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHJlbW92ZTogZnVuY3Rpb24gKCBvICkge1xyXG5cclxuICAgICAgICBsZXQgaSA9IFIudWkuaW5kZXhPZiggbyApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICggaSAhPT0gLTEgKSB7XHJcbiAgICAgICAgICAgIFIucmVtb3ZlTGlzdGVuKCBvICk7XHJcbiAgICAgICAgICAgIFIudWkuc3BsaWNlKCBpLCAxICk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIFIudWkubGVuZ3RoID09PSAwICl7XHJcbiAgICAgICAgICAgIFIucmVtb3ZlRXZlbnRzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBpbml0RXZlbnRzOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGlmKCBSLmlzRXZlbnRzSW5pdCApIHJldHVybjtcclxuXHJcbiAgICAgICAgbGV0IGRvbSA9IGRvY3VtZW50LmJvZHk7XHJcblxyXG4gICAgICAgIFIuaXNNb2JpbGUgPSBSLnRlc3RNb2JpbGUoKTtcclxuXHJcbiAgICAgICAgaWYoIFIuaXNNb2JpbGUgKXtcclxuICAgICAgICAgICAgZG9tLmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaHN0YXJ0JywgUiwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9tLmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaGVuZCcsIFIsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGRvbS5hZGRFdmVudExpc3RlbmVyKCAndG91Y2htb3ZlJywgUiwgZmFsc2UgKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgZG9tLmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZWRvd24nLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb20uYWRkRXZlbnRMaXN0ZW5lciggJ2NvbnRleHRtZW51JywgUiwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9tLmFkZEV2ZW50TGlzdGVuZXIoICd3aGVlbCcsIFIsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZW1vdmUnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIFIsIGZhbHNlICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCBSLCBmYWxzZSApO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5dXAnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAncmVzaXplJywgUi5yZXNpemUgLCBmYWxzZSApO1xyXG4gICAgICAgIC8vd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZWRvd24nLCBSLCBmYWxzZSApO1xyXG5cclxuICAgICAgICBSLmlzRXZlbnRzSW5pdCA9IHRydWU7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICByZW1vdmVFdmVudHM6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgaWYoICFSLmlzRXZlbnRzSW5pdCApIHJldHVybjtcclxuXHJcbiAgICAgICAgbGV0IGRvbSA9IGRvY3VtZW50LmJvZHk7XHJcblxyXG4gICAgICAgIGlmKCBSLmlzTW9iaWxlICl7XHJcbiAgICAgICAgICAgIGRvbS5yZW1vdmVFdmVudExpc3RlbmVyKCAndG91Y2hzdGFydCcsIFIsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGRvbS5yZW1vdmVFdmVudExpc3RlbmVyKCAndG91Y2hlbmQnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb20ucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3RvdWNobW92ZScsIFIsIGZhbHNlICk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGRvbS5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2Vkb3duJywgUiwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9tLnJlbW92ZUV2ZW50TGlzdGVuZXIoICdjb250ZXh0bWVudScsIFIsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGRvbS5yZW1vdmVFdmVudExpc3RlbmVyKCAnd2hlZWwnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgUiwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNldXAnLCBSLCBmYWxzZSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdrZXlkb3duJywgUiApO1xyXG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCAna2V5dXAnLCBSICk7XHJcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdyZXNpemUnLCBSLnJlc2l6ZSAgKTtcclxuXHJcbiAgICAgICAgUi5pc0V2ZW50c0luaXQgPSBmYWxzZTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHJlc2l6ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICBSLm5lZWRSZVpvbmUgPSB0cnVlO1xyXG5cclxuICAgICAgICBsZXQgaSA9IFIudWkubGVuZ3RoLCB1O1xyXG4gICAgICAgIFxyXG4gICAgICAgIHdoaWxlKCBpLS0gKXtcclxuXHJcbiAgICAgICAgICAgIHUgPSBSLnVpW2ldO1xyXG4gICAgICAgICAgICBpZiggdS5pc0d1aSAmJiAhdS5pc0NhbnZhc09ubHkgJiYgdS5hdXRvUmVzaXplICkgdS5zZXRIZWlnaHQoKTtcclxuICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEhBTkRMRSBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIFxyXG5cclxuICAgIGhhbmRsZUV2ZW50OiBmdW5jdGlvbiAoIGV2ZW50ICkge1xyXG5cclxuICAgICAgICAvL2lmKCFldmVudC50eXBlKSByZXR1cm47XHJcblxyXG4gICAgICAvLyAgY29uc29sZS5sb2coIGV2ZW50LnR5cGUgKVxyXG5cclxuICAgICAgICBpZiggZXZlbnQudHlwZS5pbmRleE9mKCBSLnByZXZEZWZhdWx0ICkgIT09IC0xICkgZXZlbnQucHJldmVudERlZmF1bHQoKTsgXHJcblxyXG4gICAgICAgIGlmKCBldmVudC50eXBlID09PSAnY29udGV4dG1lbnUnICkgcmV0dXJuOyBcclxuXHJcbiAgICAgICAgLy9pZiggZXZlbnQudHlwZSA9PT0gJ2tleWRvd24nKXsgUi5lZGl0VGV4dCggZXZlbnQgKTsgcmV0dXJuO31cclxuXHJcbiAgICAgICAgLy9pZiggZXZlbnQudHlwZSAhPT0gJ2tleWRvd24nICYmIGV2ZW50LnR5cGUgIT09ICd3aGVlbCcgKSBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIC8vZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgIFIuZmluZFpvbmUoKTtcclxuICAgICAgIFxyXG4gICAgICAgIGxldCBlID0gUi5lO1xyXG5cclxuICAgICAgICBpZiggZXZlbnQudHlwZSA9PT0gJ2tleWRvd24nKSBSLmtleWRvd24oIGV2ZW50ICk7XHJcbiAgICAgICAgaWYoIGV2ZW50LnR5cGUgPT09ICdrZXl1cCcpIFIua2V5dXAoIGV2ZW50ICk7XHJcblxyXG4gICAgICAgIGlmKCBldmVudC50eXBlID09PSAnd2hlZWwnICkgZS5kZWx0YSA9IGV2ZW50LmRlbHRhWSA+IDAgPyAxIDogLTE7XHJcbiAgICAgICAgZWxzZSBlLmRlbHRhID0gMDtcclxuICAgICAgICBcclxuICAgICAgICBlLmNsaWVudFggPSBldmVudC5jbGllbnRYIHx8IDA7XHJcbiAgICAgICAgZS5jbGllbnRZID0gZXZlbnQuY2xpZW50WSB8fCAwO1xyXG4gICAgICAgIGUudHlwZSA9IGV2ZW50LnR5cGU7XHJcblxyXG4gICAgICAgIC8vIG1vYmlsZVxyXG5cclxuICAgICAgICBpZiggUi5pc01vYmlsZSApe1xyXG5cclxuICAgICAgICAgICAgaWYoIGV2ZW50LnRvdWNoZXMgJiYgZXZlbnQudG91Y2hlcy5sZW5ndGggPiAwICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBlLmNsaWVudFggPSBldmVudC50b3VjaGVzWyAwIF0uY2xpZW50WCB8fCAwO1xyXG4gICAgICAgICAgICAgICAgZS5jbGllbnRZID0gZXZlbnQudG91Y2hlc1sgMCBdLmNsaWVudFkgfHwgMDtcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKCBldmVudC50eXBlID09PSAndG91Y2hzdGFydCcpIGUudHlwZSA9ICdtb3VzZWRvd24nO1xyXG4gICAgICAgICAgICBpZiggZXZlbnQudHlwZSA9PT0gJ3RvdWNoZW5kJykgZS50eXBlID0gJ21vdXNldXAnXHJcbiAgICAgICAgICAgIGlmKCBldmVudC50eXBlID09PSAndG91Y2htb3ZlJykgZS50eXBlID0gJ21vdXNlbW92ZSc7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICAvKlxyXG4gICAgICAgIGlmKCBldmVudC50eXBlID09PSAndG91Y2hzdGFydCcpeyBlLnR5cGUgPSAnbW91c2Vkb3duJzsgUi5maW5kSUQoIGUgKTsgfVxyXG4gICAgICAgIGlmKCBldmVudC50eXBlID09PSAndG91Y2hlbmQnKXsgZS50eXBlID0gJ21vdXNldXAnOyAgaWYoIFIuSUQgIT09IG51bGwgKSBSLklELmhhbmRsZUV2ZW50KCBlICk7IFIuY2xlYXJPbGRJRCgpOyB9XHJcbiAgICAgICAgaWYoIGV2ZW50LnR5cGUgPT09ICd0b3VjaG1vdmUnKXsgZS50eXBlID0gJ21vdXNlbW92ZSc7ICB9XHJcbiAgICAgICAgKi9cclxuXHJcblxyXG4gICAgICAgIGlmKCBlLnR5cGUgPT09ICdtb3VzZWRvd24nICkgUi5sb2NrID0gdHJ1ZTtcclxuICAgICAgICBpZiggZS50eXBlID09PSAnbW91c2V1cCcgKSBSLmxvY2sgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYoIFIuaXNNb2JpbGUgJiYgZS50eXBlID09PSAnbW91c2Vkb3duJyApIFIuZmluZElEKCBlICk7XHJcbiAgICAgICAgaWYoIGUudHlwZSA9PT0gJ21vdXNlbW92ZScgJiYgIVIubG9jayApIFIuZmluZElEKCBlICk7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIGlmKCBSLklEICE9PSBudWxsICl7XHJcblxyXG4gICAgICAgICAgICBpZiggUi5JRC5pc0NhbnZhc09ubHkgKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgZS5jbGllbnRYID0gUi5JRC5tb3VzZS54O1xyXG4gICAgICAgICAgICAgICAgZS5jbGllbnRZID0gUi5JRC5tb3VzZS55O1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgUi5JRC5oYW5kbGVFdmVudCggZSApO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCBSLmlzTW9iaWxlICYmIGUudHlwZSA9PT0gJ21vdXNldXAnICkgUi5jbGVhck9sZElEKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIElEXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgZmluZElEOiBmdW5jdGlvbiAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBpID0gUi51aS5sZW5ndGgsIG5leHQgPSAtMSwgdSwgeCwgeTtcclxuXHJcbiAgICAgICAgd2hpbGUoIGktLSApe1xyXG5cclxuICAgICAgICAgICAgdSA9IFIudWlbaV07XHJcblxyXG4gICAgICAgICAgICBpZiggdS5pc0NhbnZhc09ubHkgKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgeCA9IHUubW91c2UueDtcclxuICAgICAgICAgICAgICAgIHkgPSB1Lm1vdXNlLnk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIHggPSBlLmNsaWVudFg7XHJcbiAgICAgICAgICAgICAgICB5ID0gZS5jbGllbnRZO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoIFIub25ab25lKCB1LCB4LCB5ICkgKXsgXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIG5leHQgPSBpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZiggbmV4dCAhPT0gUi5jdXJyZW50ICl7XHJcbiAgICAgICAgICAgICAgICAgICAgUi5jbGVhck9sZElEKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgUi5jdXJyZW50ID0gbmV4dDtcclxuICAgICAgICAgICAgICAgICAgICBSLklEID0gdTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCBuZXh0ID09PSAtMSApIFIuY2xlYXJPbGRJRCgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2xlYXJPbGRJRDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICBpZiggIVIuSUQgKSByZXR1cm47XHJcbiAgICAgICAgUi5jdXJyZW50ID0gLTE7XHJcbiAgICAgICAgUi5JRC5yZXNldCgpO1xyXG4gICAgICAgIFIuSUQgPSBudWxsO1xyXG4gICAgICAgIFIuY3Vyc29yKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEdVSSAvIEdST1VQIEZVTkNUSU9OXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgY2FsY1VpczogZnVuY3Rpb24gKCB1aXMsIHpvbmUsIHB5ICkge1xyXG5cclxuICAgICAgICBsZXQgbG5nID0gdWlzLmxlbmd0aCwgdSwgaSwgcHggPSAwLCBteSA9IDA7XHJcblxyXG4gICAgICAgIGZvciggaSA9IDA7IGkgPCBsbmc7IGkrKyApe1xyXG5cclxuICAgICAgICAgICAgdSA9IHVpc1tpXTtcclxuXHJcbiAgICAgICAgICAgIHUuem9uZS53ID0gdS53O1xyXG4gICAgICAgICAgICB1LnpvbmUuaCA9IHUuaDtcclxuXHJcbiAgICAgICAgICAgIGlmKCAhdS5hdXRvV2lkdGggKXtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiggcHggPT09IDAgKSBweSArPSB1LmggKyAxO1xyXG5cclxuICAgICAgICAgICAgICAgIHUuem9uZS54ID0gem9uZS54ICsgcHg7XHJcbiAgICAgICAgICAgICAgICB1LnpvbmUueSA9IHB4ID09PSAwID8gcHkgLSB1LmggOiBteTtcclxuXHJcbiAgICAgICAgICAgICAgICBteSA9IHUuem9uZS55O1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBweCArPSB1Lnc7XHJcbiAgICAgICAgICAgICAgICBpZiggcHggKyB1LncgPiB6b25lLncgKSBweCA9IDA7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIHUuem9uZS54ID0gem9uZS54O1xyXG4gICAgICAgICAgICAgICAgdS56b25lLnkgPSBweTtcclxuICAgICAgICAgICAgICAgIHB5ICs9IHUuaCArIDE7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiggdS5pc0dyb3VwICkgdS5jYWxjVWlzKCk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuXHJcblx0ZmluZFRhcmdldDogZnVuY3Rpb24gKCB1aXMsIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBpID0gdWlzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgd2hpbGUoIGktLSApe1xyXG4gICAgICAgICAgICBpZiggUi5vblpvbmUoIHVpc1tpXSwgZS5jbGllbnRYLCBlLmNsaWVudFkgKSApIHJldHVybiBpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBaT05FXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgZmluZFpvbmU6IGZ1bmN0aW9uICggZm9yY2UgKSB7XHJcblxyXG4gICAgICAgIGlmKCAhUi5uZWVkUmVab25lICYmICFmb3JjZSApIHJldHVybjtcclxuXHJcbiAgICAgICAgdmFyIGkgPSBSLnVpLmxlbmd0aCwgdTtcclxuXHJcbiAgICAgICAgd2hpbGUoIGktLSApeyBcclxuXHJcbiAgICAgICAgICAgIHUgPSBSLnVpW2ldO1xyXG4gICAgICAgICAgICBSLmdldFpvbmUoIHUgKTtcclxuICAgICAgICAgICAgaWYoIHUuaXNHdWkgKSB1LmNhbGNVaXMoKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBSLm5lZWRSZVpvbmUgPSBmYWxzZTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIG9uWm9uZTogZnVuY3Rpb24gKCBvLCB4LCB5ICkge1xyXG5cclxuICAgICAgICBpZiggeCA9PT0gdW5kZWZpbmVkIHx8IHkgPT09IHVuZGVmaW5lZCApIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IHogPSBvLnpvbmU7XHJcbiAgICAgICAgbGV0IG14ID0geCAtIHoueDtcclxuICAgICAgICBsZXQgbXkgPSB5IC0gei55O1xyXG5cclxuICAgICAgICBsZXQgb3ZlciA9ICggbXggPj0gMCApICYmICggbXkgPj0gMCApICYmICggbXggPD0gei53ICkgJiYgKCBteSA8PSB6LmggKTtcclxuXHJcbiAgICAgICAgaWYoIG92ZXIgKSBvLmxvY2FsLnNldCggbXgsIG15ICk7XHJcbiAgICAgICAgZWxzZSBvLmxvY2FsLm5lZygpO1xyXG5cclxuICAgICAgICByZXR1cm4gb3ZlcjtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGdldFpvbmU6IGZ1bmN0aW9uICggbyApIHtcclxuXHJcbiAgICAgICAgaWYoIG8uaXNDYW52YXNPbmx5ICkgcmV0dXJuO1xyXG4gICAgICAgIGxldCByID0gby5nZXREb20oKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBvLnpvbmUgPSB7IHg6ci5sZWZ0LCB5OnIudG9wLCB3OnIud2lkdGgsIGg6ci5oZWlnaHQgfTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgQ1VSU09SXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgY3Vyc29yOiBmdW5jdGlvbiAoIG5hbWUgKSB7XHJcblxyXG4gICAgICAgIG5hbWUgPSBuYW1lID8gbmFtZSA6ICdhdXRvJztcclxuICAgICAgICBpZiggbmFtZSAhPT0gUi5vbGRDdXJzb3IgKXtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSBuYW1lO1xyXG4gICAgICAgICAgICBSLm9sZEN1cnNvciA9IG5hbWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBDQU5WQVNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICB0b0NhbnZhczogZnVuY3Rpb24gKCBvLCB3LCBoLCBmb3JjZSApIHtcclxuXHJcbiAgICAgICAgLy8gcHJldmVudCBleGVzaXZlIHJlZHJhd1xyXG5cclxuICAgICAgICBpZiggZm9yY2UgJiYgUi50bXBUaW1lICE9PSBudWxsICkgeyBjbGVhclRpbWVvdXQoUi50bXBUaW1lKTsgUi50bXBUaW1lID0gbnVsbDsgIH1cclxuXHJcbiAgICAgICAgaWYoIFIudG1wVGltZSAhPT0gbnVsbCApIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYoIFIubG9jayApIFIudG1wVGltZSA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7IFIudG1wVGltZSA9IG51bGw7IH0sIDEwICk7XHJcblxyXG4gICAgICAgIC8vL1xyXG5cclxuICAgICAgICBsZXQgaXNOZXdTaXplID0gZmFsc2U7XHJcbiAgICAgICAgaWYoIHcgIT09IG8uY2FudmFzLndpZHRoIHx8IGggIT09IG8uY2FudmFzLmhlaWdodCApIGlzTmV3U2l6ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIGlmKCBSLnRtcEltYWdlID09PSBudWxsICkgUi50bXBJbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG5cclxuICAgICAgICBsZXQgaW1nID0gUi50bXBJbWFnZTsgLy9uZXcgSW1hZ2UoKTtcclxuXHJcbiAgICAgICAgbGV0IGh0bWxTdHJpbmcgPSBSLnhtbHNlcmlhbGl6ZXIuc2VyaWFsaXplVG9TdHJpbmcoIG8uY29udGVudCApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBzdmcgPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCInK3crJ1wiIGhlaWdodD1cIicraCsnXCI+PGZvcmVpZ25PYmplY3Qgc3R5bGU9XCJwb2ludGVyLWV2ZW50czogbm9uZTsgbGVmdDowO1wiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIj4nKyBodG1sU3RyaW5nICsnPC9mb3JlaWduT2JqZWN0Pjwvc3ZnPic7XHJcblxyXG4gICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgIGxldCBjdHggPSBvLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcblxyXG4gICAgICAgICAgICBpZiggaXNOZXdTaXplICl7IFxyXG4gICAgICAgICAgICAgICAgby5jYW52YXMud2lkdGggPSB3O1xyXG4gICAgICAgICAgICAgICAgby5jYW52YXMuaGVpZ2h0ID0gaFxyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGN0eC5jbGVhclJlY3QoIDAsIDAsIHcsIGggKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjdHguZHJhd0ltYWdlKCB0aGlzLCAwLCAwICk7XHJcblxyXG4gICAgICAgICAgICBvLm9uRHJhdygpO1xyXG5cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpbWcuc3JjID0gXCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD11dGYtOCxcIiArIGVuY29kZVVSSUNvbXBvbmVudChzdmcpO1xyXG4gICAgICAgIC8vaW1nLnNyYyA9ICdkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LCcrIHdpbmRvdy5idG9hKCBzdmcgKTtcclxuICAgICAgICBpbWcuY3Jvc3NPcmlnaW4gPSAnJztcclxuXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIElOUFVUXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgc2V0SGlkZGVuOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGlmKCBSLmhpZGRlbkltcHV0ID09PSBudWxsICl7XHJcblxyXG4gICAgICAgICAgICBsZXQgaGlkZSA9IFIuZGVidWdJbnB1dCA/ICcnIDogJ29wYWNpdHk6MDsgekluZGV4OjA7JztcclxuXHJcbiAgICAgICAgICAgIGxldCBjc3MgPSBSLnBhcmVudC5jc3MudHh0ICsgJ3BhZGRpbmc6MDsgd2lkdGg6YXV0bzsgaGVpZ2h0OmF1dG87IHRleHQtc2hhZG93Om5vbmU7J1xyXG4gICAgICAgICAgICBjc3MgKz0gJ2xlZnQ6MTBweDsgdG9wOmF1dG87IGJvcmRlcjpub25lOyBjb2xvcjojRkZGOyBiYWNrZ3JvdW5kOiMwMDA7JyArIGhpZGU7XHJcblxyXG4gICAgICAgICAgICBSLmhpZGRlbkltcHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuICAgICAgICAgICAgUi5oaWRkZW5JbXB1dC50eXBlID0gJ3RleHQnO1xyXG4gICAgICAgICAgICBSLmhpZGRlbkltcHV0LnN0eWxlLmNzc1RleHQgPSBjc3MgKyAnYm90dG9tOjMwcHg7JyArIChSLmRlYnVnSW5wdXQgPyAnJyA6ICd0cmFuc2Zvcm06c2NhbGUoMCk7Jyk7O1xyXG5cclxuICAgICAgICAgICAgUi5oaWRkZW5TaXplciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICBSLmhpZGRlblNpemVyLnN0eWxlLmNzc1RleHQgPSBjc3MgKyAnYm90dG9tOjYwcHg7JztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoIFIuaGlkZGVuSW1wdXQgKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggUi5oaWRkZW5TaXplciApO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFIuaGlkZGVuSW1wdXQuc3R5bGUud2lkdGggPSBSLmlucHV0LmNsaWVudFdpZHRoICsgJ3B4JztcclxuICAgICAgICBSLmhpZGRlbkltcHV0LnZhbHVlID0gUi5zdHI7XHJcbiAgICAgICAgUi5oaWRkZW5TaXplci5pbm5lckhUTUwgPSBSLnN0cjtcclxuXHJcbiAgICAgICAgUi5oYXNGb2N1cyA9IHRydWU7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBjbGVhckhpZGRlbjogZnVuY3Rpb24gKCBwICkge1xyXG5cclxuICAgICAgICBpZiggUi5oaWRkZW5JbXB1dCA9PT0gbnVsbCApIHJldHVybjtcclxuICAgICAgICBSLmhhc0ZvY3VzID0gZmFsc2U7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja1BvczogZnVuY3Rpb24oIHggKXtcclxuXHJcbiAgICAgICAgbGV0IGkgPSBSLnN0ci5sZW5ndGgsIGwgPSAwLCBuID0gMDtcclxuICAgICAgICB3aGlsZSggaS0tICl7XHJcbiAgICAgICAgICAgIGwgKz0gUi50ZXh0V2lkdGgoIFIuc3RyW25dICk7XHJcbiAgICAgICAgICAgIGlmKCBsID49IHggKSBicmVhaztcclxuICAgICAgICAgICAgbisrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbjtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHVwSW5wdXQ6IGZ1bmN0aW9uICggeCwgZG93biApIHtcclxuXHJcbiAgICAgICAgaWYoIFIucGFyZW50ID09PSBudWxsICkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgdXAgPSBmYWxzZTtcclxuICAgICBcclxuICAgICAgICBpZiggZG93biApe1xyXG5cclxuICAgICAgICAgICAgbGV0IGlkID0gUi5jbGlja1BvcyggeCApO1xyXG5cclxuICAgICAgICAgICAgUi5tb3ZlWCA9IGlkO1xyXG5cclxuICAgICAgICAgICAgaWYoIFIuc3RhcnRYID09PSAtMSApeyBcclxuXHJcbiAgICAgICAgICAgICAgICBSLnN0YXJ0WCA9IGlkO1xyXG4gICAgICAgICAgICAgICAgUi5jdXJzb3JJZCA9IGlkO1xyXG4gICAgICAgICAgICAgICAgUi5pbnB1dFJhbmdlID0gWyBSLnN0YXJ0WCwgUi5zdGFydFggXTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgbGV0IGlzU2VsZWN0aW9uID0gUi5tb3ZlWCAhPT0gUi5zdGFydFg7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIGlzU2VsZWN0aW9uICl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIFIuc3RhcnRYID4gUi5tb3ZlWCApIFIuaW5wdXRSYW5nZSA9IFsgUi5tb3ZlWCwgUi5zdGFydFggXTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlIFIuaW5wdXRSYW5nZSA9IFsgUi5zdGFydFgsIFIubW92ZVggXTsgICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHVwID0gdHJ1ZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgIGlmKCBSLnN0YXJ0WCAhPT0gLTEgKXtcclxuXHJcbiAgICAgICAgICAgICAgICBSLmhhc0ZvY3VzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIFIuaGlkZGVuSW1wdXQuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIFIuaGlkZGVuSW1wdXQuc2VsZWN0aW9uU3RhcnQgPSBSLmlucHV0UmFuZ2VbMF07XHJcbiAgICAgICAgICAgICAgICBSLmhpZGRlbkltcHV0LnNlbGVjdGlvbkVuZCA9IFIuaW5wdXRSYW5nZVsxXTtcclxuICAgICAgICAgICAgICAgIFIuc3RhcnRYID0gLTE7XHJcblxyXG4gICAgICAgICAgICAgICAgdXAgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCB1cCApIFIuc2VsZWN0UGFyZW50KCk7XHJcblxyXG4gICAgICAgIHJldHVybiB1cDtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNlbGVjdFBhcmVudDogZnVuY3Rpb24gKCl7XHJcblxyXG4gICAgICAgIHZhciBjID0gUi50ZXh0V2lkdGgoIFIuc3RyLnN1YnN0cmluZyggMCwgUi5jdXJzb3JJZCApKTtcclxuICAgICAgICB2YXIgZSA9IFIudGV4dFdpZHRoKCBSLnN0ci5zdWJzdHJpbmcoIDAsIFIuaW5wdXRSYW5nZVswXSApKTtcclxuICAgICAgICB2YXIgcyA9IFIudGV4dFdpZHRoKCBSLnN0ci5zdWJzdHJpbmcoIFIuaW5wdXRSYW5nZVswXSwgIFIuaW5wdXRSYW5nZVsxXSApKTtcclxuXHJcbiAgICAgICAgUi5wYXJlbnQuc2VsZWN0KCBjLCBlLCBzICk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB0ZXh0V2lkdGg6IGZ1bmN0aW9uICggdGV4dCApe1xyXG5cclxuICAgICAgICBpZiggUi5oaWRkZW5TaXplciA9PT0gbnVsbCApIHJldHVybiAwO1xyXG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoLyAvZywgJyZuYnNwOycpO1xyXG4gICAgICAgIFIuaGlkZGVuU2l6ZXIuaW5uZXJIVE1MID0gdGV4dDtcclxuICAgICAgICByZXR1cm4gUi5oaWRkZW5TaXplci5jbGllbnRXaWR0aDtcclxuXHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBjbGVhcklucHV0OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGlmKCBSLnBhcmVudCA9PT0gbnVsbCApIHJldHVybjtcclxuICAgICAgICBpZiggIVIuZmlyc3RJbXB1dCApIFIucGFyZW50LnZhbGlkYXRlKCB0cnVlICk7XHJcblxyXG4gICAgICAgIFIuY2xlYXJIaWRkZW4oKTtcclxuICAgICAgICBSLnBhcmVudC51bnNlbGVjdCgpO1xyXG5cclxuICAgICAgICAvL1IuaW5wdXQuc3R5bGUuYmFja2dyb3VuZCA9ICdub25lJztcclxuICAgICAgICBSLmlucHV0LnN0eWxlLmJhY2tncm91bmQgPSBSLnBhcmVudC5jb2xvcnMuaW5wdXRCZztcclxuICAgICAgICBSLmlucHV0LnN0eWxlLmJvcmRlckNvbG9yID0gUi5wYXJlbnQuY29sb3JzLmlucHV0Qm9yZGVyO1xyXG4gICAgICAgIFIucGFyZW50LmlzRWRpdCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBSLmlucHV0ID0gbnVsbDtcclxuICAgICAgICBSLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgUi5zdHIgPSAnJyxcclxuICAgICAgICBSLmZpcnN0SW1wdXQgPSB0cnVlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc2V0SW5wdXQ6IGZ1bmN0aW9uICggSW5wdXQsIHBhcmVudCApIHtcclxuXHJcbiAgICAgICAgUi5jbGVhcklucHV0KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgUi5pbnB1dCA9IElucHV0O1xyXG4gICAgICAgIFIucGFyZW50ID0gcGFyZW50O1xyXG5cclxuICAgICAgICBSLmlucHV0LnN0eWxlLmJhY2tncm91bmQgPSBSLnBhcmVudC5jb2xvcnMuaW5wdXRPdmVyO1xyXG4gICAgICAgIFIuaW5wdXQuc3R5bGUuYm9yZGVyQ29sb3IgPSBSLnBhcmVudC5jb2xvcnMuaW5wdXRCb3JkZXJTZWxlY3Q7XHJcbiAgICAgICAgUi5zdHIgPSBSLmlucHV0LnRleHRDb250ZW50O1xyXG5cclxuICAgICAgICBSLnNldEhpZGRlbigpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLypzZWxlY3Q6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoIFwic2VsZWN0YWxsXCIsIG51bGwsIGZhbHNlICk7XHJcblxyXG4gICAgfSwqL1xyXG5cclxuICAgIGtleWRvd246IGZ1bmN0aW9uICggZSApIHtcclxuXHJcbiAgICAgICAgaWYoIFIucGFyZW50ID09PSBudWxsICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQga2V5Q29kZSA9IGUud2hpY2gsIGlzU2hpZnQgPSBlLnNoaWZ0S2V5O1xyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKCBrZXlDb2RlIClcclxuXHJcbiAgICAgICAgUi5maXJzdEltcHV0ID0gZmFsc2U7XHJcblxyXG5cclxuICAgICAgICBpZiAoUi5oYXNGb2N1cykge1xyXG4gICAgICAgICAgICAvLyBoYWNrIHRvIGZpeCB0b3VjaCBldmVudCBidWcgaW4gaU9TIFNhZmFyaVxyXG4gICAgICAgICAgICB3aW5kb3cuZm9jdXMoKTtcclxuICAgICAgICAgICAgUi5oaWRkZW5JbXB1dC5mb2N1cygpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBSLnBhcmVudC5pc0VkaXQgPSB0cnVlO1xyXG5cclxuICAgICAgIC8vIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgLy8gYWRkIHN1cHBvcnQgZm9yIEN0cmwvQ21kK0Egc2VsZWN0aW9uXHJcbiAgICAgICAgLy9pZiAoIGtleUNvZGUgPT09IDY1ICYmIChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5ICkpIHtcclxuICAgICAgICAgICAgLy9SLnNlbGVjdFRleHQoKTtcclxuICAgICAgICAgICAgLy9lLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIC8vcmV0dXJuIHNlbGYucmVuZGVyKCk7XHJcbiAgICAgICAgLy99XHJcblxyXG4gICAgICAgIGlmKCBrZXlDb2RlID09PSAxMyApeyAvL2VudGVyXHJcblxyXG4gICAgICAgICAgICBSLmNsZWFySW5wdXQoKTtcclxuXHJcbiAgICAgICAgLy99IGVsc2UgaWYoIGtleUNvZGUgPT09IDkgKXsgLy90YWIga2V5XHJcblxyXG4gICAgICAgICAgIC8vIFIuaW5wdXQudGV4dENvbnRlbnQgPSAnJztcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgIGlmKCBSLmlucHV0LmlzTnVtICl7XHJcbiAgICAgICAgICAgICAgICBpZiAoICgoZS5rZXlDb2RlID4gNDcpICYmIChlLmtleUNvZGUgPCA1OCkpIHx8ICgoZS5rZXlDb2RlID4gOTUpICYmIChlLmtleUNvZGUgPCAxMDYpKSB8fCBlLmtleUNvZGUgPT09IDE5MCB8fCBlLmtleUNvZGUgPT09IDExMCB8fCBlLmtleUNvZGUgPT09IDggfHwgZS5rZXlDb2RlID09PSAxMDkgKXtcclxuICAgICAgICAgICAgICAgICAgICBSLmhpZGRlbkltcHV0LnJlYWRPbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIFIuaGlkZGVuSW1wdXQucmVhZE9ubHkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgUi5oaWRkZW5JbXB1dC5yZWFkT25seSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGtleXVwOiBmdW5jdGlvbiAoIGUgKSB7XHJcblxyXG4gICAgICAgIGlmKCBSLnBhcmVudCA9PT0gbnVsbCApIHJldHVybjtcclxuXHJcbiAgICAgICAgUi5zdHIgPSBSLmhpZGRlbkltcHV0LnZhbHVlO1xyXG5cclxuICAgICAgICBpZiggUi5wYXJlbnQuYWxsRXF1YWwgKSBSLnBhcmVudC5zYW1lU3RyKCBSLnN0ciApOy8vIG51bWVyaWMgc2Ftw7llIHZhbHVlXHJcbiAgICAgICAgZWxzZSBSLmlucHV0LnRleHRDb250ZW50ID0gUi5zdHI7XHJcblxyXG4gICAgICAgIFIuY3Vyc29ySWQgPSBSLmhpZGRlbkltcHV0LnNlbGVjdGlvblN0YXJ0O1xyXG4gICAgICAgIFIuaW5wdXRSYW5nZSA9IFsgUi5oaWRkZW5JbXB1dC5zZWxlY3Rpb25TdGFydCwgUi5oaWRkZW5JbXB1dC5zZWxlY3Rpb25FbmQgXTtcclxuXHJcbiAgICAgICAgUi5zZWxlY3RQYXJlbnQoKTtcclxuXHJcbiAgICAgICAgLy9pZiggUi5wYXJlbnQuYWxsd2F5ICkgXHJcbiAgICAgICAgUi5wYXJlbnQudmFsaWRhdGUoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vXHJcbiAgICAvLyAgIExJU1RFTklOR1xyXG4gICAgLy9cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBsb29wOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIGlmKCBSLmlzTG9vcCApIHJlcXVlc3RBbmltYXRpb25GcmFtZSggUi5sb29wICk7XHJcbiAgICAgICAgUi51cGRhdGUoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICBsZXQgaSA9IFIubGlzdGVucy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUoIGktLSApIFIubGlzdGVuc1tpXS5saXN0ZW5pbmcoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHJlbW92ZUxpc3RlbjogZnVuY3Rpb24gKCBwcm90byApIHtcclxuXHJcbiAgICAgICAgbGV0IGlkID0gUi5saXN0ZW5zLmluZGV4T2YoIHByb3RvICk7XHJcbiAgICAgICAgaWYoIGlkICE9PSAtMSApIFIubGlzdGVucy5zcGxpY2UoaWQsIDEpO1xyXG4gICAgICAgIGlmKCBSLmxpc3RlbnMubGVuZ3RoID09PSAwICkgUi5pc0xvb3AgPSBmYWxzZTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGFkZExpc3RlbjogZnVuY3Rpb24gKCBwcm90byApIHtcclxuXHJcbiAgICAgICAgbGV0IGlkID0gUi5saXN0ZW5zLmluZGV4T2YoIHByb3RvICk7XHJcblxyXG4gICAgICAgIGlmKCBpZCAhPT0gLTEgKSByZXR1cm47IFxyXG5cclxuICAgICAgICBSLmxpc3RlbnMucHVzaCggcHJvdG8gKTtcclxuXHJcbiAgICAgICAgaWYoICFSLmlzTG9vcCApe1xyXG4gICAgICAgICAgICBSLmlzTG9vcCA9IHRydWU7XHJcbiAgICAgICAgICAgIFIubG9vcCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IFJvb3RzID0gUjsiLCJleHBvcnQgY2xhc3MgVjIge1xyXG5cclxuXHRjb25zdHJ1Y3RvciggeCA9IDAsIHkgPSAwICkge1xyXG5cclxuXHRcdHRoaXMueCA9IHg7XHJcblx0XHR0aGlzLnkgPSB5O1xyXG5cclxuXHR9XHJcblxyXG5cdHNldCAoIHgsIHkgKSB7XHJcblxyXG5cdFx0dGhpcy54ID0geDtcclxuXHRcdHRoaXMueSA9IHk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHJcblx0fVxyXG5cclxuXHRkaXZpZGUgKCB2ICkge1xyXG5cclxuXHRcdHRoaXMueCAvPSB2Lng7XHJcblx0XHR0aGlzLnkgLz0gdi55O1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcblx0bXVsdGlwbHkgKCB2ICkge1xyXG5cclxuXHRcdHRoaXMueCAqPSB2Lng7XHJcblx0XHR0aGlzLnkgKj0gdi55O1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcblx0bXVsdGlwbHlTY2FsYXIgKCBzY2FsYXIgKSB7XHJcblxyXG5cdFx0dGhpcy54ICo9IHNjYWxhcjtcclxuXHRcdHRoaXMueSAqPSBzY2FsYXI7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHJcblx0fVxyXG5cclxuXHRkaXZpZGVTY2FsYXIgKCBzY2FsYXIgKSB7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMubXVsdGlwbHlTY2FsYXIoIDEgLyBzY2FsYXIgKTtcclxuXHJcblx0fVxyXG5cclxuXHRsZW5ndGggKCkge1xyXG5cclxuXHRcdHJldHVybiBNYXRoLnNxcnQoIHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSApO1xyXG5cclxuXHR9XHJcblxyXG5cdGFuZ2xlICgpIHtcclxuXHJcblx0XHQvLyBjb21wdXRlcyB0aGUgYW5nbGUgaW4gcmFkaWFucyB3aXRoIHJlc3BlY3QgdG8gdGhlIHBvc2l0aXZlIHgtYXhpc1xyXG5cclxuXHRcdHZhciBhbmdsZSA9IE1hdGguYXRhbjIoIHRoaXMueSwgdGhpcy54ICk7XHJcblxyXG5cdFx0aWYgKCBhbmdsZSA8IDAgKSBhbmdsZSArPSAyICogTWF0aC5QSTtcclxuXHJcblx0XHRyZXR1cm4gYW5nbGU7XHJcblxyXG5cdH1cclxuXHJcblx0YWRkU2NhbGFyICggcyApIHtcclxuXHJcblx0XHR0aGlzLnggKz0gcztcclxuXHRcdHRoaXMueSArPSBzO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcblx0bmVnYXRlICgpIHtcclxuXHJcblx0XHR0aGlzLnggKj0gLTE7XHJcblx0XHR0aGlzLnkgKj0gLTE7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHJcblx0fVxyXG5cclxuXHRuZWcgKCkge1xyXG5cclxuXHRcdHRoaXMueCA9IC0xO1xyXG5cdFx0dGhpcy55ID0gLTE7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHJcblx0fVxyXG5cclxuXHRpc1plcm8gKCkge1xyXG5cclxuXHRcdHJldHVybiAoIHRoaXMueCA9PT0gMCAmJiB0aGlzLnkgPT09IDAgKTtcclxuXHJcblx0fVxyXG5cclxuXHRjb3B5ICggdiApIHtcclxuXHJcblx0XHR0aGlzLnggPSB2Lng7XHJcblx0XHR0aGlzLnkgPSB2Lnk7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcblx0ZXF1YWxzICggdiApIHtcclxuXHJcblx0XHRyZXR1cm4gKCAoIHYueCA9PT0gdGhpcy54ICkgJiYgKCB2LnkgPT09IHRoaXMueSApICk7XHJcblxyXG5cdH1cclxuXHJcblx0bmVhckVxdWFscyAoIHYsIG4gKSB7XHJcblxyXG5cdFx0cmV0dXJuICggKCB2LngudG9GaXhlZChuKSA9PT0gdGhpcy54LnRvRml4ZWQobikgKSAmJiAoIHYueS50b0ZpeGVkKG4pID09PSB0aGlzLnkudG9GaXhlZChuKSApICk7XHJcblxyXG5cdH1cclxuXHJcblx0bGVycCAoIHYsIGFscGhhICkge1xyXG5cclxuXHRcdGlmKCB2ID09PSBudWxsICl7XHJcblx0XHRcdHRoaXMueCAtPSB0aGlzLnggKiBhbHBoYTtcclxuXHRcdCAgICB0aGlzLnkgLT0gdGhpcy55ICogYWxwaGE7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLnggKz0gKCB2LnggLSB0aGlzLnggKSAqIGFscGhhO1xyXG5cdFx0ICAgIHRoaXMueSArPSAoIHYueSAtIHRoaXMueSApICogYWxwaGE7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcbn0iLCJcclxuaW1wb3J0IHsgUm9vdHMgfSBmcm9tICcuL1Jvb3RzJztcclxuaW1wb3J0IHsgVG9vbHMgfSBmcm9tICcuL1Rvb2xzJztcclxuaW1wb3J0IHsgVjIgfSBmcm9tICcuL1YyJztcclxuXHJcbi8qKlxyXG4gKiBAYXV0aG9yIGx0aCAvIGh0dHBzOi8vZ2l0aHViLmNvbS9sby10aFxyXG4gKi9cclxuXHJcbmNsYXNzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICAvLyBpZiBpcyBvbiBndWkgb3IgZ3JvdXBcclxuICAgICAgICB0aGlzLm1haW4gPSBvLm1haW4gfHwgbnVsbDtcclxuICAgICAgICB0aGlzLmlzVUkgPSBvLmlzVUkgfHwgZmFsc2U7XHJcbiAgICAgICAgdGhpcy5wYXJlbnRHcm91cCA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuY3NzID0gdGhpcy5tYWluID8gdGhpcy5tYWluLmNzcyA6IFRvb2xzLmNzcztcclxuICAgICAgICB0aGlzLmNvbG9ycyA9IHRoaXMubWFpbiA/IHRoaXMubWFpbi5jb2xvcnMgOiBUb29scy5jb2xvcnM7XHJcblxyXG4gICAgICAgIHRoaXMuZGVmYXVsdEJvcmRlckNvbG9yID0gdGhpcy5jb2xvcnMuYm9yZGVyO1xyXG4gICAgICAgIHRoaXMuc3ZncyA9IFRvb2xzLnN2Z3M7XHJcblxyXG4gICAgICAgIC8vIG9ubHkgc3BhY2UgXHJcbiAgICAgICAgdGhpcy5pc0VtcHR5ID0gby5pc0VtcHR5IHx8IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnpvbmUgPSB7IHg6MCwgeTowLCB3OjAsIGg6MCB9O1xyXG4gICAgICAgIHRoaXMubG9jYWwgPSBuZXcgVjIoKS5uZWcoKTtcclxuXHJcbiAgICAgICAgdGhpcy5pc0NhbnZhc09ubHkgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1NlbGVjdCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBwZXJjZW50IG9mIHRpdGxlXHJcbiAgICAgICAgdGhpcy5wID0gby5wICE9PSB1bmRlZmluZWQgPyBvLnAgOiBUb29scy5zaXplLnA7XHJcblxyXG4gICAgICAgIHRoaXMudyA9IHRoaXMuaXNVSSA/IHRoaXMubWFpbi5zaXplLncgOiBUb29scy5zaXplLnc7XHJcbiAgICAgICAgaWYoIG8udyAhPT0gdW5kZWZpbmVkICkgdGhpcy53ID0gby53O1xyXG5cclxuICAgICAgICB0aGlzLmggPSB0aGlzLmlzVUkgPyB0aGlzLm1haW4uc2l6ZS5oIDogVG9vbHMuc2l6ZS5oO1xyXG4gICAgICAgIGlmKCBvLmggIT09IHVuZGVmaW5lZCApIHRoaXMuaCA9IG8uaDtcclxuICAgICAgICBpZighdGhpcy5pc0VtcHR5KSB0aGlzLmggPSB0aGlzLmggPCAxMSA/IDExIDogdGhpcy5oO1xyXG5cclxuICAgICAgICAvLyBpZiBuZWVkIHJlc2l6ZSB3aWR0aFxyXG4gICAgICAgIHRoaXMuYXV0b1dpZHRoID0gby5hdXRvIHx8IHRydWU7XHJcblxyXG4gICAgICAgIC8vIG9wZW4gc3RhdHVcclxuICAgICAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyByYWRpdXMgZm9yIHRvb2xib3hcclxuICAgICAgICB0aGlzLnJhZGl1cyA9IG8ucmFkaXVzIHx8IDA7XHJcblxyXG4gICAgICAgIC8vIG9ubHkgZm9yIG51bWJlclxyXG4gICAgICAgIHRoaXMuaXNOdW1iZXIgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5vTmVnID0gby5ub05lZyB8fCBmYWxzZTtcclxuICAgICAgICB0aGlzLmFsbEVxdWFsID0gby5hbGxFcXVhbCB8fCBmYWxzZTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBvbmx5IG1vc3Qgc2ltcGxlIFxyXG4gICAgICAgIHRoaXMubW9ubyA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBzdG9wIGxpc3RlbmluZyBmb3IgZWRpdCBzbGlkZSB0ZXh0XHJcbiAgICAgICAgdGhpcy5pc0VkaXQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLy8gbm8gdGl0bGUgXHJcbiAgICAgICAgdGhpcy5zaW1wbGUgPSBvLnNpbXBsZSB8fCBmYWxzZTtcclxuICAgICAgICBpZiggdGhpcy5zaW1wbGUgKSB0aGlzLnNhID0gMDtcclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIC8vIGRlZmluZSBvYmogc2l6ZVxyXG4gICAgICAgIHRoaXMuc2V0U2l6ZSggdGhpcy53ICk7XHJcblxyXG4gICAgICAgIC8vIHRpdGxlIHNpemVcclxuICAgICAgICBpZihvLnNhICE9PSB1bmRlZmluZWQgKSB0aGlzLnNhID0gby5zYTtcclxuICAgICAgICBpZihvLnNiICE9PSB1bmRlZmluZWQgKSB0aGlzLnNiID0gby5zYjtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuc2ltcGxlICkgdGhpcy5zYiA9IHRoaXMudyAtIHRoaXMuc2E7XHJcblxyXG4gICAgICAgIC8vIGxhc3QgbnVtYmVyIHNpemUgZm9yIHNsaWRlXHJcbiAgICAgICAgdGhpcy5zYyA9IG8uc2MgPT09IHVuZGVmaW5lZCA/IDQ3IDogby5zYztcclxuXHJcbiAgICAgICAgLy8gZm9yIGxpc3RlbmluZyBvYmplY3RcclxuICAgICAgICB0aGlzLm9iamVjdExpbmsgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNTZW5kID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy52YWwgPSBudWxsO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEJhY2tncm91bmRcclxuICAgICAgICB0aGlzLmJnID0gdGhpcy5jb2xvcnMuYmFja2dyb3VuZDsvL3RoaXMuaXNVSSA/IHRoaXMubWFpbi5iZyA6IFRvb2xzLmNvbG9ycy5iYWNrZ3JvdW5kO1xyXG4gICAgICAgIHRoaXMuYmdPdmVyID0gdGhpcy5jb2xvcnMuYmFja2dyb3VuZE92ZXI7XHJcbiAgICAgICAgaWYoIG8uYmcgIT09IHVuZGVmaW5lZCApeyB0aGlzLmJnID0gby5iZzsgdGhpcy5iZ092ZXIgPSBvLmJnOyB9XHJcbiAgICAgICAgaWYoIG8uYmdPdmVyICE9PSB1bmRlZmluZWQgKXsgdGhpcy5iZ092ZXIgPSBvLmJnT3ZlcjsgfVxyXG5cclxuICAgICAgICAvLyBGb250IENvbG9yO1xyXG4gICAgICAgIHRoaXMudGl0bGVDb2xvciA9IG8udGl0bGVDb2xvciB8fCB0aGlzLmNvbG9ycy50ZXh0O1xyXG4gICAgICAgIHRoaXMuZm9udENvbG9yID0gby5mb250Q29sb3IgfHwgdGhpcy5jb2xvcnMudGV4dDtcclxuICAgICAgICB0aGlzLmZvbnRTZWxlY3QgPSBvLmZvbnRTZWxlY3QgfHwgdGhpcy5jb2xvcnMudGV4dE92ZXI7XHJcblxyXG4gICAgICAgIGlmKCBvLmNvbG9yICE9PSB1bmRlZmluZWQgKSB0aGlzLmZvbnRDb2xvciA9IG8uY29sb3I7XHJcbiAgICAgICAgICAgIC8qeyBcclxuXHJcbiAgICAgICAgICAgIGlmKG8uY29sb3IgPT09ICduJykgby5jb2xvciA9ICcjZmYwMDAwJztcclxuXHJcbiAgICAgICAgICAgIGlmKCBvLmNvbG9yICE9PSAnbm8nICkge1xyXG4gICAgICAgICAgICAgICAgaWYoICFpc05hTihvLmNvbG9yKSApIHRoaXMuZm9udENvbG9yID0gVG9vbHMuaGV4VG9IdG1sKG8uY29sb3IpO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLmZvbnRDb2xvciA9IG8uY29sb3I7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpdGxlQ29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9Ki9cclxuICAgICAgICBcclxuICAgICAgICAvKmlmKCBvLmNvbG9yICE9PSB1bmRlZmluZWQgKXsgXHJcbiAgICAgICAgICAgIGlmKCAhaXNOYU4oby5jb2xvcikgKSB0aGlzLmZvbnRDb2xvciA9IFRvb2xzLmhleFRvSHRtbChvLmNvbG9yKTtcclxuICAgICAgICAgICAgZWxzZSB0aGlzLmZvbnRDb2xvciA9IG8uY29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMudGl0bGVDb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICB0aGlzLmNvbG9yUGx1cyA9IFRvb2xzLkNvbG9yTHVtYSggdGhpcy5mb250Q29sb3IsIDAuMyApO1xyXG5cclxuICAgICAgICB0aGlzLnR4dCA9IG8ubmFtZSB8fCAnUHJvdG8nO1xyXG4gICAgICAgIHRoaXMucmVuYW1lID0gby5yZW5hbWUgfHwgJyc7XHJcbiAgICAgICAgdGhpcy50YXJnZXQgPSBvLnRhcmdldCB8fCBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gby5jYWxsYmFjayA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IG8uY2FsbGJhY2s7XHJcbiAgICAgICAgdGhpcy5lbmRDYWxsYmFjayA9IG51bGw7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmNhbGxiYWNrID09PSBudWxsICYmIHRoaXMuaXNVSSAmJiB0aGlzLm1haW4uY2FsbGJhY2sgIT09IG51bGwgKSB0aGlzLmNhbGxiYWNrID0gdGhpcy5tYWluLmNhbGxiYWNrO1xyXG5cclxuICAgICAgICAvLyBlbGVtZW50c1xyXG4gICAgICAgIHRoaXMuYyA9IFtdO1xyXG5cclxuICAgICAgICAvLyBzdHlsZSBcclxuICAgICAgICB0aGlzLnMgPSBbXTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuY1swXSA9IFRvb2xzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ3Bvc2l0aW9uOnJlbGF0aXZlOyBoZWlnaHQ6MjBweDsgZmxvYXQ6bGVmdDsgb3ZlcmZsb3c6aGlkZGVuOycpO1xyXG4gICAgICAgIHRoaXMuc1swXSA9IHRoaXMuY1swXS5zdHlsZTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNVSSApIHRoaXMuc1swXS5tYXJnaW5Cb3R0b20gPSAnMXB4JztcclxuICAgICAgICBcclxuICAgICAgICAvLyB3aXRoIHRpdGxlXHJcbiAgICAgICAgaWYoICF0aGlzLnNpbXBsZSApeyBcclxuICAgICAgICAgICAgdGhpcy5jWzFdID0gVG9vbHMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0ICk7XHJcbiAgICAgICAgICAgIHRoaXMuc1sxXSA9IHRoaXMuY1sxXS5zdHlsZTtcclxuICAgICAgICAgICAgdGhpcy5jWzFdLnRleHRDb250ZW50ID0gdGhpcy5yZW5hbWUgPT09ICcnID8gdGhpcy50eHQgOiB0aGlzLnJlbmFtZTtcclxuICAgICAgICAgICAgdGhpcy5zWzFdLmNvbG9yID0gdGhpcy50aXRsZUNvbG9yO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIG8ucG9zICl7XHJcbiAgICAgICAgICAgIHRoaXMuc1swXS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XHJcbiAgICAgICAgICAgIGZvcihsZXQgcCBpbiBvLnBvcyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNbMF1bcF0gPSBvLnBvc1twXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm1vbm8gPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIG8uY3NzICkgdGhpcy5zWzBdLmNzc1RleHQgPSBvLmNzczsgXHJcbiAgICAgICAgXHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIG1ha2UgdGhlIG5vZGVcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIFxyXG4gICAgaW5pdCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuem9uZS5oID0gdGhpcy5oO1xyXG5cclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7IC8vIHN0eWxlIGNhY2hlXHJcbiAgICAgICAgbGV0IGMgPSB0aGlzLmM7IC8vIGRpdiBjYWNoXHJcblxyXG4gICAgICAgIHNbMF0uaGVpZ2h0ID0gdGhpcy5oICsgJ3B4JztcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNVSSAgKSBzWzBdLmJhY2tncm91bmQgPSB0aGlzLmJnO1xyXG4gICAgICAgIGlmKCB0aGlzLmlzRW1wdHkgICkgc1swXS5iYWNrZ3JvdW5kID0gJ25vbmUnO1xyXG5cclxuICAgICAgICAvL2lmKCB0aGlzLmF1dG9IZWlnaHQgKSBzWzBdLnRyYW5zaXRpb24gPSAnaGVpZ2h0IDAuMDFzIGVhc2Utb3V0JztcclxuICAgICAgICBpZiggY1sxXSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuYXV0b1dpZHRoICl7XHJcbiAgICAgICAgICAgIHNbMV0gPSBjWzFdLnN0eWxlO1xyXG4gICAgICAgICAgICBzWzFdLmhlaWdodCA9ICh0aGlzLmgtNCkgKyAncHgnO1xyXG4gICAgICAgICAgICBzWzFdLmxpbmVIZWlnaHQgPSAodGhpcy5oLTgpICsgJ3B4JztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBmcmFnID0gVG9vbHMuZnJhZztcclxuXHJcbiAgICAgICAgZm9yKCBsZXQgaSA9IDEsIGxuZyA9IGMubGVuZ3RoOyBpICE9PSBsbmc7IGkrKyApe1xyXG4gICAgICAgICAgICBpZiggY1tpXSAhPT0gdW5kZWZpbmVkICkge1xyXG4gICAgICAgICAgICAgICAgZnJhZy5hcHBlbmRDaGlsZCggY1tpXSApO1xyXG4gICAgICAgICAgICAgICAgc1tpXSA9IGNbaV0uc3R5bGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnRhcmdldCAhPT0gbnVsbCApeyBcclxuICAgICAgICAgICAgdGhpcy50YXJnZXQuYXBwZW5kQ2hpbGQoIGNbMF0gKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiggdGhpcy5pc1VJICkgdGhpcy5tYWluLmlubmVyLmFwcGVuZENoaWxkKCBjWzBdICk7XHJcbiAgICAgICAgICAgIGVsc2UgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggY1swXSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY1swXS5hcHBlbmRDaGlsZCggZnJhZyApO1xyXG5cclxuICAgICAgICB0aGlzLnJTaXplKCk7XHJcblxyXG4gICAgICAgIC8vICEgc29sbyBwcm90b1xyXG4gICAgICAgIGlmKCAhdGhpcy5pc1VJICl7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNbMF0uc3R5bGUucG9pbnRlckV2ZW50cyA9ICdhdXRvJztcclxuICAgICAgICAgICAgUm9vdHMuYWRkKCB0aGlzICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gZnJvbSBUb29sc1xyXG5cclxuICAgIGRvbSAoIHR5cGUsIGNzcywgb2JqLCBkb20sIGlkICkge1xyXG5cclxuICAgICAgICByZXR1cm4gVG9vbHMuZG9tKCB0eXBlLCBjc3MsIG9iaiwgZG9tLCBpZCApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRTdmcgKCBkb20sIHR5cGUsIHZhbHVlLCBpZCwgaWQyICkge1xyXG5cclxuICAgICAgICBUb29scy5zZXRTdmcoIGRvbSwgdHlwZSwgdmFsdWUsIGlkLCBpZDIgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0Q3NzICggZG9tLCBjc3MgKSB7XHJcblxyXG4gICAgICAgIFRvb2xzLnNldENzcyggZG9tLCBjc3MgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgY2xhbXAgKCB2YWx1ZSwgbWluLCBtYXggKSB7XHJcblxyXG4gICAgICAgIHJldHVybiBUb29scy5jbGFtcCggdmFsdWUsIG1pbiwgbWF4ICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldENvbG9yUmluZyAoKSB7XHJcblxyXG4gICAgICAgIGlmKCAhVG9vbHMuY29sb3JSaW5nICkgVG9vbHMubWFrZUNvbG9yUmluZygpO1xyXG4gICAgICAgIHJldHVybiBUb29scy5jbG9uZSggVG9vbHMuY29sb3JSaW5nICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldEpveXN0aWNrICggbW9kZWwgKSB7XHJcblxyXG4gICAgICAgIGlmKCAhVG9vbHNbICdqb3lzdGlja18nKyBtb2RlbCBdICkgVG9vbHMubWFrZUpveXN0aWNrKCBtb2RlbCApO1xyXG4gICAgICAgIHJldHVybiBUb29scy5jbG9uZSggVG9vbHNbICdqb3lzdGlja18nKyBtb2RlbCBdICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldENpcmN1bGFyICggbW9kZWwgKSB7XHJcblxyXG4gICAgICAgIGlmKCAhVG9vbHMuY2lyY3VsYXIgKSBUb29scy5tYWtlQ2lyY3VsYXIoIG1vZGVsICk7XHJcbiAgICAgICAgcmV0dXJuIFRvb2xzLmNsb25lKCBUb29scy5jaXJjdWxhciApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBnZXRLbm9iICggbW9kZWwgKSB7XHJcblxyXG4gICAgICAgIGlmKCAhVG9vbHMua25vYiApIFRvb2xzLm1ha2VLbm9iKCBtb2RlbCApO1xyXG4gICAgICAgIHJldHVybiBUb29scy5jbG9uZSggVG9vbHMua25vYiApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyBmcm9tIFJvb3RzXHJcblxyXG4gICAgY3Vyc29yICggbmFtZSApIHtcclxuXHJcbiAgICAgICAgIFJvb3RzLmN1cnNvciggbmFtZSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBcclxuXHJcbiAgICAvLy8vLy8vLy9cclxuXHJcbiAgICB1cGRhdGUgKCkge31cclxuXHJcbiAgICByZXNldCAoKSB7fVxyXG5cclxuICAgIC8vLy8vLy8vL1xyXG5cclxuICAgIGdldERvbSAoKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmNbMF07XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVpb3V0ICgpIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNFbXB0eSApIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYodGhpcy5zKSB0aGlzLnNbMF0uYmFja2dyb3VuZCA9IHRoaXMuYmc7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVpb3ZlciAoKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzRW1wdHkgKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmKHRoaXMucykgdGhpcy5zWzBdLmJhY2tncm91bmQgPSB0aGlzLmJnT3ZlcjtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmVuYW1lICggcyApIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuY1sxXSAhPT0gdW5kZWZpbmVkKSB0aGlzLmNbMV0udGV4dENvbnRlbnQgPSBzO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBsaXN0ZW4gKCkge1xyXG5cclxuICAgICAgICBSb290cy5hZGRMaXN0ZW4oIHRoaXMgKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbGlzdGVuaW5nICgpIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMub2JqZWN0TGluayA9PT0gbnVsbCApIHJldHVybjtcclxuICAgICAgICBpZiggdGhpcy5pc1NlbmQgKSByZXR1cm47XHJcbiAgICAgICAgaWYoIHRoaXMuaXNFZGl0ICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLnNldFZhbHVlKCB0aGlzLm9iamVjdExpbmtbIHRoaXMudmFsIF0gKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0VmFsdWUgKCB2ICkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc051bWJlciApIHRoaXMudmFsdWUgPSB0aGlzLm51bVZhbHVlKCB2ICk7XHJcbiAgICAgICAgLy9lbHNlIGlmKCB2IGluc3RhbmNlb2YgQXJyYXkgJiYgdi5sZW5ndGggPT09IDEgKSB2ID0gdlswXTtcclxuICAgICAgICBlbHNlIHRoaXMudmFsdWUgPSB2O1xyXG4gICAgICAgIHRoaXMudXBkYXRlKCk7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyB1cGRhdGUgZXZlcnkgY2hhbmdlXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgb25DaGFuZ2UgKCBmICkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc0VtcHR5ICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gZiB8fCBudWxsO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyB1cGRhdGUgb25seSBvbiBlbmRcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBvbkZpbmlzaENoYW5nZSAoIGYgKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzRW1wdHkgKSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZW5kQ2FsbGJhY2sgPSBmO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZW5kICggdiApIHtcclxuXHJcbiAgICAgICAgdiA9IHYgfHwgdGhpcy52YWx1ZTtcclxuICAgICAgICBpZiggdiBpbnN0YW5jZW9mIEFycmF5ICYmIHYubGVuZ3RoID09PSAxICkgdiA9IHZbMF07XHJcblxyXG4gICAgICAgIHRoaXMuaXNTZW5kID0gdHJ1ZTtcclxuICAgICAgICBpZiggdGhpcy5vYmplY3RMaW5rICE9PSBudWxsICkgdGhpcy5vYmplY3RMaW5rWyB0aGlzLnZhbCBdID0gdjtcclxuICAgICAgICBpZiggdGhpcy5jYWxsYmFjayApIHRoaXMuY2FsbGJhY2soIHYsIHRoaXMudmFsICk7XHJcbiAgICAgICAgdGhpcy5pc1NlbmQgPSBmYWxzZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2VuZEVuZCAoIHYgKSB7XHJcblxyXG4gICAgICAgIHYgPSB2IHx8IHRoaXMudmFsdWU7XHJcbiAgICAgICAgaWYoIHYgaW5zdGFuY2VvZiBBcnJheSAmJiB2Lmxlbmd0aCA9PT0gMSApIHYgPSB2WzBdO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5lbmRDYWxsYmFjayApIHRoaXMuZW5kQ2FsbGJhY2soIHYgKTtcclxuICAgICAgICBpZiggdGhpcy5vYmplY3RMaW5rICE9PSBudWxsICkgdGhpcy5vYmplY3RMaW5rWyB0aGlzLnZhbCBdID0gdjtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gY2xlYXIgbm9kZVxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgXHJcbiAgICBjbGVhciAoKSB7XHJcblxyXG4gICAgICAgIFRvb2xzLmNsZWFyKCB0aGlzLmNbMF0gKTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMudGFyZ2V0ICE9PSBudWxsICl7IFxyXG4gICAgICAgICAgICB0aGlzLnRhcmdldC5yZW1vdmVDaGlsZCggdGhpcy5jWzBdICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYoIHRoaXMuaXNVSSApIHRoaXMubWFpbi5jbGVhck9uZSggdGhpcyApO1xyXG4gICAgICAgICAgICBlbHNlIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoIHRoaXMuY1swXSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzVUkgKSBSb290cy5yZW1vdmUoIHRoaXMgKTtcclxuXHJcbiAgICAgICAgdGhpcy5jID0gbnVsbDtcclxuICAgICAgICB0aGlzLnMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gY2hhbmdlIHNpemUgXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgc2V0U2l6ZSAoIHN4ICkge1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuYXV0b1dpZHRoICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLncgPSBzeDtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuc2ltcGxlICl7XHJcbiAgICAgICAgICAgIHRoaXMuc2IgPSB0aGlzLncgLSB0aGlzLnNhO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCBwcCA9IHRoaXMudyAqICggdGhpcy5wIC8gMTAwICk7XHJcbiAgICAgICAgICAgIHRoaXMuc2EgPSBNYXRoLmZsb29yKCBwcCArIDEwICk7XHJcbiAgICAgICAgICAgIHRoaXMuc2IgPSBNYXRoLmZsb29yKCB0aGlzLncgLSBwcCAtIDIwICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICByU2l6ZSAoKSB7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5hdXRvV2lkdGggKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5zWzBdLndpZHRoID0gdGhpcy53ICsgJ3B4JztcclxuICAgICAgICBpZiggIXRoaXMuc2ltcGxlICkgdGhpcy5zWzFdLndpZHRoID0gdGhpcy5zYSArICdweCc7XHJcbiAgICBcclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBmb3IgbnVtZXJpYyB2YWx1ZVxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHNldFR5cGVOdW1iZXIgKCBvICkge1xyXG5cclxuICAgICAgICB0aGlzLmlzTnVtYmVyID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IDA7XHJcbiAgICAgICAgaWYoby52YWx1ZSAhPT0gdW5kZWZpbmVkKXtcclxuICAgICAgICAgICAgaWYoIHR5cGVvZiBvLnZhbHVlID09PSAnc3RyaW5nJyApIHRoaXMudmFsdWUgPSBvLnZhbHVlICogMTtcclxuICAgICAgICAgICAgZWxzZSB0aGlzLnZhbHVlID0gby52YWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubWluID0gby5taW4gPT09IHVuZGVmaW5lZCA/IC1JbmZpbml0eSA6IG8ubWluO1xyXG4gICAgICAgIHRoaXMubWF4ID0gby5tYXggPT09IHVuZGVmaW5lZCA/ICBJbmZpbml0eSA6IG8ubWF4O1xyXG4gICAgICAgIHRoaXMucHJlY2lzaW9uID0gby5wcmVjaXNpb24gPT09IHVuZGVmaW5lZCA/IDIgOiBvLnByZWNpc2lvbjtcclxuXHJcbiAgICAgICAgbGV0IHM7XHJcblxyXG4gICAgICAgIHN3aXRjaCh0aGlzLnByZWNpc2lvbil7XHJcbiAgICAgICAgICAgIGNhc2UgMDogcyA9IDE7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDE6IHMgPSAwLjE7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDI6IHMgPSAwLjAxOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAzOiBzID0gMC4wMDE7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDQ6IHMgPSAwLjAwMDE7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDU6IHMgPSAwLjAwMDAxOyBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc3RlcCA9IG8uc3RlcCA9PT0gdW5kZWZpbmVkID8gIHMgOiBvLnN0ZXA7XHJcbiAgICAgICAgdGhpcy5yYW5nZSA9IHRoaXMubWF4IC0gdGhpcy5taW47XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMubnVtVmFsdWUoIHRoaXMudmFsdWUgKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBudW1WYWx1ZSAoIG4gKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLm5vTmVnICkgbiA9IE1hdGguYWJzKCBuICk7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgubWluKCB0aGlzLm1heCwgTWF0aC5tYXgoIHRoaXMubWluLCBuICkgKS50b0ZpeGVkKCB0aGlzLnByZWNpc2lvbiApICogMTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTIERFRkFVTFRcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBoYW5kbGVFdmVudCAoIGUgKXtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNFbXB0eSApIHJldHVybjtcclxuICAgICAgICByZXR1cm4gdGhpc1tlLnR5cGVdKGUpO1xyXG4gICAgXHJcbiAgICB9XHJcblxyXG4gICAgd2hlZWwgKCBlICkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkgeyByZXR1cm4gZmFsc2U7IH1cclxuXHJcbiAgICBtb3VzZXVwICggZSApIHsgcmV0dXJuIGZhbHNlOyB9XHJcblxyXG4gICAga2V5ZG93biAoIGUgKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cclxuICAgIGtleXVwICggZSApIHsgcmV0dXJuIGZhbHNlOyB9XHJcblxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIG9iamVjdCByZWZlcmVuY3lcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBzZXRSZWZlcmVuY3kgKCBvYmosIHZhbCApIHtcclxuXHJcbiAgICAgICAgdGhpcy5vYmplY3RMaW5rID0gb2JqO1xyXG4gICAgICAgIHRoaXMudmFsID0gdmFsO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5ICggdiApIHtcclxuICAgICAgICBcclxuICAgICAgICB2ID0gdiB8fCBmYWxzZTtcclxuICAgICAgICB0aGlzLnNbMF0uZGlzcGxheSA9IHYgPyAnYmxvY2snIDogJ25vbmUnO1xyXG4gICAgICAgIC8vdGhpcy5pc1JlYWR5ID0gdiA/IGZhbHNlIDogdHJ1ZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gcmVzaXplIGhlaWdodCBcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBvcGVuICgpIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNPcGVuICkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UgKCkge1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuaXNPcGVuICkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5lZWRab25lICgpIHtcclxuXHJcbiAgICAgICAgUm9vdHMubmVlZFJlWm9uZSA9IHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlem9uZSAoKSB7XHJcblxyXG4gICAgICAgIFJvb3RzLm5lZWRSZVpvbmUgPSB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgSU5QVVRcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBzZWxlY3QgKCkge1xyXG4gICAgXHJcbiAgICB9XHJcblxyXG4gICAgdW5zZWxlY3QgKCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRJbnB1dCAoIElucHV0ICkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIFJvb3RzLnNldElucHV0KCBJbnB1dCwgdGhpcyApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1cElucHV0ICggeCwgZG93biApIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIFJvb3RzLnVwSW5wdXQoIHgsIGRvd24gKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gc3BlY2lhbCBpdGVtIFxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHNlbGVjdGVkICggYiApe1xyXG5cclxuICAgICAgICB0aGlzLmlzU2VsZWN0ID0gYiB8fCBmYWxzZTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCB7IFByb3RvIH07IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcbmV4cG9ydCBjbGFzcyBCb29sIGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IG8udmFsdWUgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuYnV0dG9uQ29sb3IgPSBvLmJDb2xvciB8fCB0aGlzLmNvbG9ycy5idXR0b247XHJcblxyXG4gICAgICAgIHRoaXMuaW5oID0gby5pbmggfHwgTWF0aC5mbG9vciggdGhpcy5oKjAuOCApO1xyXG4gICAgICAgIHRoaXMuaW53ID0gby5pbncgfHwgMzY7XHJcblxyXG4gICAgICAgIGxldCB0ID0gTWF0aC5mbG9vcih0aGlzLmgqMC41KS0oKHRoaXMuaW5oLTIpKjAuNSk7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnYmFja2dyb3VuZDonKyB0aGlzLmNvbG9ycy5ib29sYmcgKyc7IGhlaWdodDonKyh0aGlzLmluaC0yKSsncHg7IHdpZHRoOicrdGhpcy5pbncrJ3B4OyB0b3A6Jyt0KydweDsgYm9yZGVyLXJhZGl1czoxMHB4OyBib3JkZXI6MnB4IHNvbGlkICcrdGhpcy5ib29sYmcgKTtcclxuICAgICAgICB0aGlzLmNbM10gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ2hlaWdodDonKyh0aGlzLmluaC02KSsncHg7IHdpZHRoOjE2cHg7IHRvcDonKyh0KzIpKydweDsgYm9yZGVyLXJhZGl1czoxMHB4OyBiYWNrZ3JvdW5kOicrdGhpcy5idXR0b25Db2xvcisnOycgKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICB0aGlzLmN1cnNvcigncG9pbnRlcicpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZSA/IGZhbHNlIDogdHJ1ZTtcclxuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuc2VuZCgpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgdXBkYXRlICgpIHtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnZhbHVlICl7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBzWzJdLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5ib29sb247XHJcbiAgICAgICAgICAgIHNbMl0uYm9yZGVyQ29sb3IgPSB0aGlzLmNvbG9ycy5ib29sb247XHJcbiAgICAgICAgICAgIHNbM10ubWFyZ2luTGVmdCA9ICcxN3B4JztcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHNbMl0uYmFja2dyb3VuZCA9IHRoaXMuY29sb3JzLmJvb2xiZztcclxuICAgICAgICAgICAgc1syXS5ib3JkZXJDb2xvciA9IHRoaXMuY29sb3JzLmJvb2xiZztcclxuICAgICAgICAgICAgc1szXS5tYXJnaW5MZWZ0ID0gJzJweCc7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgclNpemUgKCkge1xyXG5cclxuICAgICAgICBzdXBlci5yU2l6ZSgpO1xyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG4gICAgICAgIGxldCB3ID0gKHRoaXMudyAtIDEwICkgLSB0aGlzLmludztcclxuICAgICAgICBzWzJdLmxlZnQgPSB3ICsgJ3B4JztcclxuICAgICAgICBzWzNdLmxlZnQgPSB3ICsgJ3B4JztcclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgQnV0dG9uIGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcblxyXG4gICAgICAgIHRoaXMudmFsdWUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBvLnZhbHVlIHx8IHRoaXMudHh0O1xyXG5cclxuICAgICAgICBpZiggdHlwZW9mIHRoaXMudmFsdWVzID09PSAnc3RyaW5nJyApIHRoaXMudmFsdWVzID0gW3RoaXMudmFsdWVzXTtcclxuXHJcbiAgICAgICAgLy90aGlzLnNlbGVjdGVkID0gbnVsbDtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBjdXN0b20gY29sb3JcclxuICAgICAgICB0aGlzLmNjID0gWyB0aGlzLmNvbG9ycy5idXR0b24sIHRoaXMuY29sb3JzLnNlbGVjdCwgdGhpcy5jb2xvcnMuZG93biBdO1xyXG5cclxuICAgICAgICBpZiggby5jQmcgIT09IHVuZGVmaW5lZCApIHRoaXMuY2NbMF0gPSBvLmNCZztcclxuICAgICAgICBpZiggby5iQ29sb3IgIT09IHVuZGVmaW5lZCApIHRoaXMuY2NbMF0gPSBvLmJDb2xvcjtcclxuICAgICAgICBpZiggby5jU2VsZWN0ICE9PSB1bmRlZmluZWQgKSB0aGlzLmNjWzFdID0gby5jU2VsZWN0O1xyXG4gICAgICAgIGlmKCBvLmNEb3duICE9PSB1bmRlZmluZWQgKSB0aGlzLmNjWzJdID0gby5jRG93bjtcclxuXHJcbiAgICAgICAgdGhpcy5pc0xvYWRCdXR0b24gPSBvLmxvYWRlciB8fCBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzRHJhZ0J1dHRvbiA9IG8uZHJhZyB8fCBmYWxzZTtcclxuICAgICAgICBcclxuICAgICAgICBpZiggdGhpcy5pc0RyYWdCdXR0b24gKSB0aGlzLmlzTG9hZEJ1dHRvbiA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMubG5nID0gdGhpcy52YWx1ZXMubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMudG1wID0gW107XHJcbiAgICAgICAgdGhpcy5zdGF0ID0gW107XHJcblxyXG4gICAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy5sbmc7IGkrKyApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jW2krMl0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dCArIHRoaXMuY3NzLmJ1dHRvbiArICd0b3A6MXB4OyBiYWNrZ3JvdW5kOicrdGhpcy5jY1swXSsnOyBoZWlnaHQ6JysodGhpcy5oLTIpKydweDsgYm9yZGVyOicrdGhpcy5jb2xvcnMuYnV0dG9uQm9yZGVyKyc7IGJvcmRlci1yYWRpdXM6Jyt0aGlzLnJhZGl1cysncHg7JyApO1xyXG4gICAgICAgICAgICB0aGlzLmNbaSsyXS5zdHlsZS5jb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgICAgICB0aGlzLmNbaSsyXS5pbm5lckhUTUwgPSB0aGlzLnZhbHVlc1tpXTtcclxuICAgICAgICAgICAgdGhpcy5zdGF0W2ldID0gMTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggdGhpcy5jWzFdICE9PSB1bmRlZmluZWQgKSB0aGlzLmNbMV0udGV4dENvbnRlbnQgPSAnJztcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNMb2FkQnV0dG9uICkgdGhpcy5pbml0TG9hZGVyKCk7XHJcbiAgICAgICAgaWYoIHRoaXMuaXNEcmFnQnV0dG9uICl7IFxyXG4gICAgICAgICAgICB0aGlzLmxuZyArKztcclxuICAgICAgICAgICAgdGhpcy5pbml0RHJhZ2VyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdGVzdFpvbmUgKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbCA9IHRoaXMubG9jYWw7XHJcbiAgICAgICAgaWYoIGwueCA9PT0gLTEgJiYgbC55ID09PSAtMSApIHJldHVybiAnJztcclxuXHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLmxuZztcclxuICAgICAgICBsZXQgdCA9IHRoaXMudG1wO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHdoaWxlKCBpLS0gKXtcclxuICAgICAgICBcdGlmKCBsLng+dFtpXVswXSAmJiBsLng8dFtpXVsyXSApIHJldHVybiBpKzI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gJydcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb3VzZXVwICggZSApIHtcclxuICAgIFxyXG4gICAgICAgIGlmKCB0aGlzLmlzRG93biApe1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5zZW5kKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgIFx0bGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCAhbmFtZSApIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICBcdHRoaXMuaXNEb3duID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZXNbbmFtZS0yXVxyXG4gICAgICAgIGlmKCAhdGhpcy5pc0xvYWRCdXR0b24gKSB0aGlzLnNlbmQoKTtcclxuICAgICAgICAvL2Vsc2UgdGhpcy5maWxlU2VsZWN0KCBlLnRhcmdldC5maWxlc1swXSApO1xyXG4gICAgXHRyZXR1cm4gdGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuIFxyXG4gICAgICAgIC8vIHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCB1cCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAvLyBjb25zb2xlLmxvZyhuYW1lKVxyXG5cclxuICAgICAgICBpZiggbmFtZSAhPT0gJycgKXtcclxuICAgICAgICAgICAgdGhpcy5jdXJzb3IoJ3BvaW50ZXInKTtcclxuICAgICAgICAgICAgdXAgPSB0aGlzLm1vZGVzKCB0aGlzLmlzRG93biA/IDMgOiAyLCBuYW1lICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICBcdHVwID0gdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh1cClcclxuXHJcbiAgICAgICAgcmV0dXJuIHVwO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW9kZXMgKCBuLCBuYW1lICkge1xyXG5cclxuICAgICAgICBsZXQgdiwgciA9IGZhbHNlO1xyXG5cclxuICAgICAgICBmb3IoIGxldCBpID0gMDsgaSA8IHRoaXMubG5nOyBpKysgKXtcclxuXHJcbiAgICAgICAgICAgIGlmKCBpID09PSBuYW1lLTIgKSB2ID0gdGhpcy5tb2RlKCBuLCBpKzIgKTtcclxuICAgICAgICAgICAgZWxzZSB2ID0gdGhpcy5tb2RlKCAxLCBpKzIgKTtcclxuXHJcbiAgICAgICAgICAgIGlmKHYpIHIgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByO1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgbW9kZSAoIG4sIG5hbWUgKSB7XHJcblxyXG4gICAgICAgIGxldCBjaGFuZ2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IGkgPSBuYW1lIC0gMjtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuc3RhdFtpXSAhPT0gbiApe1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBzd2l0Y2goIG4gKXtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6IHRoaXMuc3RhdFtpXSA9IDE7IHRoaXMuc1sgaSsyIF0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjsgdGhpcy5zWyBpKzIgXS5iYWNrZ3JvdW5kID0gdGhpcy5jY1swXTsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDI6IHRoaXMuc3RhdFtpXSA9IDI7IHRoaXMuc1sgaSsyIF0uY29sb3IgPSB0aGlzLmZvbnRTZWxlY3Q7IHRoaXMuc1sgaSsyIF0uYmFja2dyb3VuZCA9IHRoaXMuY2NbMV07IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOiB0aGlzLnN0YXRbaV0gPSAzOyB0aGlzLnNbIGkrMiBdLmNvbG9yID0gdGhpcy5mb250U2VsZWN0OyB0aGlzLnNbIGkrMiBdLmJhY2tncm91bmQgPSB0aGlzLmNjWzJdOyBicmVhaztcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNoYW5nZSA9IHRydWU7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuXHJcbiAgICAgICAgcmV0dXJuIGNoYW5nZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJzb3IoKTtcclxuXHJcbiAgICAgICAgLypsZXQgdiwgciA9IGZhbHNlO1xyXG5cclxuICAgICAgICBmb3IoIGxldCBpID0gMDsgaSA8IHRoaXMubG5nOyBpKysgKXtcclxuICAgICAgICAgICAgdiA9IHRoaXMubW9kZSggMSwgaSsyICk7XHJcbiAgICAgICAgICAgIGlmKHYpIHIgPSB0cnVlO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5tb2RlcyggMSAsIDIgKTtcclxuXHJcbiAgICBcdC8qaWYoIHRoaXMuc2VsZWN0ZWQgKXtcclxuICAgIFx0XHR0aGlzLnNbIHRoaXMuc2VsZWN0ZWQgXS5jb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgICAgICB0aGlzLnNbIHRoaXMuc2VsZWN0ZWQgXS5iYWNrZ3JvdW5kID0gdGhpcy5idXR0b25Db2xvcjtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZCA9IG51bGw7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIFx0fVxyXG4gICAgICAgIHJldHVybiBmYWxzZTsqL1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgZHJhZ292ZXIgKCBlICkge1xyXG5cclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIHRoaXMuc1s0XS5ib3JkZXJDb2xvciA9IHRoaXMuY29sb3JzLnNlbGVjdDtcclxuICAgICAgICB0aGlzLnNbNF0uY29sb3IgPSB0aGlzLmNvbG9ycy5zZWxlY3Q7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGRyYWdlbmQgKCBlICkge1xyXG5cclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIHRoaXMuc1s0XS5ib3JkZXJDb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgIHRoaXMuc1s0XS5jb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBkcm9wICggZSApIHtcclxuXHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICB0aGlzLmRyYWdlbmQoZSk7XHJcbiAgICAgICAgdGhpcy5maWxlU2VsZWN0KCBlLmRhdGFUcmFuc2Zlci5maWxlc1swXSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBpbml0RHJhZ2VyICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jWzRdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy50eHQgKycgdGV4dC1hbGlnbjpjZW50ZXI7IGxpbmUtaGVpZ2h0OicrKHRoaXMuaC04KSsncHg7IGJvcmRlcjoxcHggZGFzaGVkICcrdGhpcy5mb250Q29sb3IrJzsgdG9wOjJweDsgIGhlaWdodDonKyh0aGlzLmgtNCkrJ3B4OyBib3JkZXItcmFkaXVzOicrdGhpcy5yYWRpdXMrJ3B4OyBwb2ludGVyLWV2ZW50czphdXRvOycgKTsvLyBjdXJzb3I6ZGVmYXVsdDtcclxuICAgICAgICB0aGlzLmNbNF0udGV4dENvbnRlbnQgPSAnRFJBRyc7XHJcblxyXG4gICAgICAgIHRoaXMuY1s0XS5hZGRFdmVudExpc3RlbmVyKCAnZHJhZ292ZXInLCBmdW5jdGlvbihlKXsgdGhpcy5kcmFnb3ZlcihlKTsgfS5iaW5kKHRoaXMpLCBmYWxzZSApO1xyXG4gICAgICAgIHRoaXMuY1s0XS5hZGRFdmVudExpc3RlbmVyKCAnZHJhZ2VuZCcsIGZ1bmN0aW9uKGUpeyB0aGlzLmRyYWdlbmQoZSk7IH0uYmluZCh0aGlzKSwgZmFsc2UgKTtcclxuICAgICAgICB0aGlzLmNbNF0uYWRkRXZlbnRMaXN0ZW5lciggJ2RyYWdsZWF2ZScsIGZ1bmN0aW9uKGUpeyB0aGlzLmRyYWdlbmQoZSk7IH0uYmluZCh0aGlzKSwgZmFsc2UgKTtcclxuICAgICAgICB0aGlzLmNbNF0uYWRkRXZlbnRMaXN0ZW5lciggJ2Ryb3AnLCBmdW5jdGlvbihlKXsgdGhpcy5kcm9wKGUpOyB9LmJpbmQodGhpcyksIGZhbHNlICk7XHJcblxyXG4gICAgICAgIC8vdGhpcy5jWzJdLmV2ZW50cyA9IFsgIF07XHJcbiAgICAgICAgLy90aGlzLmNbNF0uZXZlbnRzID0gWyAnZHJhZ292ZXInLCAnZHJhZ2VuZCcsICdkcmFnbGVhdmUnLCAnZHJvcCcgXTtcclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGluaXRMb2FkZXIgKCkge1xyXG5cclxuICAgICAgICB0aGlzLmNbM10gPSB0aGlzLmRvbSggJ2lucHV0JywgdGhpcy5jc3MuYmFzaWMgKyd0b3A6MHB4OyBvcGFjaXR5OjA7IGhlaWdodDonKyh0aGlzLmgpKydweDsgcG9pbnRlci1ldmVudHM6YXV0bzsgY3Vyc29yOnBvaW50ZXI7JyApOy8vXHJcbiAgICAgICAgdGhpcy5jWzNdLm5hbWUgPSAnbG9hZGVyJztcclxuICAgICAgICB0aGlzLmNbM10udHlwZSA9IFwiZmlsZVwiO1xyXG5cclxuICAgICAgICB0aGlzLmNbM10uYWRkRXZlbnRMaXN0ZW5lciggJ2NoYW5nZScsIGZ1bmN0aW9uKGUpeyB0aGlzLmZpbGVTZWxlY3QoIGUudGFyZ2V0LmZpbGVzWzBdICk7IH0uYmluZCh0aGlzKSwgZmFsc2UgKTtcclxuICAgICAgICAvL3RoaXMuY1szXS5hZGRFdmVudExpc3RlbmVyKCAnbW91c2Vkb3duJywgZnVuY3Rpb24oZSl7ICB9LmJpbmQodGhpcyksIGZhbHNlICk7XHJcblxyXG4gICAgICAgIC8vdGhpcy5jWzJdLmV2ZW50cyA9IFsgIF07XHJcbiAgICAgICAgLy90aGlzLmNbM10uZXZlbnRzID0gWyAnY2hhbmdlJywgJ21vdXNlb3ZlcicsICdtb3VzZWRvd24nLCAnbW91c2V1cCcsICdtb3VzZW91dCcgXTtcclxuXHJcbiAgICAgICAgLy90aGlzLmhpZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBmaWxlU2VsZWN0ICggZmlsZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGRhdGFVcmwgPSBbICdwbmcnLCAnanBnJywgJ21wNCcsICd3ZWJtJywgJ29nZycgXTtcclxuICAgICAgICBsZXQgZGF0YUJ1ZiA9IFsgJ3NlYScsICd6JywgJ2hleCcsICdidmgnLCAnQlZIJywgJ2dsYicgXTtcclxuXHJcbiAgICAgICAgLy9pZiggISBlLnRhcmdldC5maWxlcyApIHJldHVybjtcclxuXHJcbiAgICAgICAgLy9sZXQgZmlsZSA9IGUudGFyZ2V0LmZpbGVzWzBdO1xyXG4gICAgICAgXHJcbiAgICAgICAgLy90aGlzLmNbM10udHlwZSA9IFwibnVsbFwiO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCB0aGlzLmNbNF0gKVxyXG5cclxuICAgICAgICBpZiggZmlsZSA9PT0gdW5kZWZpbmVkICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgICAgICBsZXQgZm5hbWUgPSBmaWxlLm5hbWU7XHJcbiAgICAgICAgbGV0IHR5cGUgPSBmbmFtZS5zdWJzdHJpbmcoZm5hbWUubGFzdEluZGV4T2YoJy4nKSsxLCBmbmFtZS5sZW5ndGggKTtcclxuXHJcbiAgICAgICAgaWYoIGRhdGFVcmwuaW5kZXhPZiggdHlwZSApICE9PSAtMSApIHJlYWRlci5yZWFkQXNEYXRhVVJMKCBmaWxlICk7XHJcbiAgICAgICAgZWxzZSBpZiggZGF0YUJ1Zi5pbmRleE9mKCB0eXBlICkgIT09IC0xICkgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKCBmaWxlICk7Ly9yZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoIGZpbGUgKTtcclxuICAgICAgICBlbHNlIHJlYWRlci5yZWFkQXNUZXh0KCBmaWxlICk7XHJcblxyXG4gICAgICAgIC8vIGlmKCB0eXBlID09PSAncG5nJyB8fCB0eXBlID09PSAnanBnJyB8fCB0eXBlID09PSAnbXA0JyB8fCB0eXBlID09PSAnd2VibScgfHwgdHlwZSA9PT0gJ29nZycgKSByZWFkZXIucmVhZEFzRGF0YVVSTCggZmlsZSApO1xyXG4gICAgICAgIC8vZWxzZSBpZiggdHlwZSA9PT0gJ3onICkgcmVhZGVyLnJlYWRBc0JpbmFyeVN0cmluZyggZmlsZSApO1xyXG4gICAgICAgIC8vZWxzZSBpZiggdHlwZSA9PT0gJ3NlYScgfHwgdHlwZSA9PT0gJ2J2aCcgfHwgdHlwZSA9PT0gJ0JWSCcgfHwgdHlwZSA9PT0gJ3onKSByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoIGZpbGUgKTtcclxuICAgICAgICAvL2Vsc2UgaWYoICApIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlciggZmlsZSApO1xyXG4gICAgICAgIC8vZWxzZSByZWFkZXIucmVhZEFzVGV4dCggZmlsZSApO1xyXG5cclxuICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmKCB0aGlzLmNhbGxiYWNrICkgdGhpcy5jYWxsYmFjayggZS50YXJnZXQucmVzdWx0LCBmbmFtZSwgdHlwZSApO1xyXG4gICAgICAgICAgICAvL3RoaXMuY1szXS50eXBlID0gXCJmaWxlXCI7XHJcbiAgICAgICAgICAgIC8vdGhpcy5zZW5kKCBlLnRhcmdldC5yZXN1bHQgKTsgXHJcbiAgICAgICAgfS5iaW5kKHRoaXMpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBsYWJlbCAoIHN0cmluZywgbiApIHtcclxuXHJcbiAgICAgICAgbiA9IG4gfHwgMjtcclxuICAgICAgICB0aGlzLmNbbl0udGV4dENvbnRlbnQgPSBzdHJpbmc7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGljb24gKCBzdHJpbmcsIHksIG4gKSB7XHJcblxyXG4gICAgICAgIG4gPSBuIHx8IDI7XHJcbiAgICAgICAgdGhpcy5zW25dLnBhZGRpbmcgPSAoIHkgfHwgMCApICsncHggMHB4JztcclxuICAgICAgICB0aGlzLmNbbl0uaW5uZXJIVE1MID0gc3RyaW5nO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByU2l6ZSAoKSB7XHJcblxyXG4gICAgICAgIHN1cGVyLnJTaXplKCk7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG4gICAgICAgIGxldCB3ID0gdGhpcy5zYjtcclxuICAgICAgICBsZXQgZCA9IHRoaXMuc2E7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgbGV0IGRjID0gIDM7XHJcbiAgICAgICAgbGV0IHNpemUgPSBNYXRoLmZsb29yKCAoIHctKGRjKihpLTEpKSApIC8gaSApO1xyXG5cclxuICAgICAgICB3aGlsZSggaS0tICl7XHJcblxyXG4gICAgICAgIFx0dGhpcy50bXBbaV0gPSBbIE1hdGguZmxvb3IoIGQgKyAoIHNpemUgKiBpICkgKyAoIGRjICogaSApKSwgc2l6ZSBdO1xyXG4gICAgICAgIFx0dGhpcy50bXBbaV1bMl0gPSB0aGlzLnRtcFtpXVswXSArIHRoaXMudG1wW2ldWzFdO1xyXG5cclxuICAgICAgICAgICAgc1tpKzJdLmxlZnQgPSB0aGlzLnRtcFtpXVswXSArICdweCc7XHJcbiAgICAgICAgICAgIHNbaSsyXS53aWR0aCA9IHRoaXMudG1wW2ldWzFdICsgJ3B4JztcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggdGhpcy5pc0RyYWdCdXR0b24gKXsgXHJcbiAgICAgICAgICAgIHNbNF0ubGVmdCA9IChkK3NpemUrZGMpICsgJ3B4JztcclxuICAgICAgICAgICAgc1s0XS53aWR0aCA9IHNpemUgKyAncHgnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNMb2FkQnV0dG9uICl7XHJcbiAgICAgICAgICAgIHNbM10ubGVmdCA9IGQgKyAncHgnO1xyXG4gICAgICAgICAgICBzWzNdLndpZHRoID0gc2l6ZSArICdweCc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5pbXBvcnQgeyBWMiB9IGZyb20gJy4uL2NvcmUvVjInO1xyXG5cclxuZXhwb3J0IGNsYXNzIENpcmN1bGFyIGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcblxyXG4gICAgICAgIHRoaXMuYXV0b1dpZHRoID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuYnV0dG9uQ29sb3IgPSB0aGlzLmNvbG9ycy5idXR0b247XHJcblxyXG4gICAgICAgIHRoaXMuc2V0VHlwZU51bWJlciggbyApO1xyXG5cclxuICAgICAgICB0aGlzLnJhZGl1cyA9IHRoaXMudyAqIDAuNTsvL01hdGguZmxvb3IoKHRoaXMudy0yMCkqMC41KTtcclxuXHJcbiAgICAgICAgdGhpcy50d29QaSA9IE1hdGguUEkgKiAyO1xyXG4gICAgICAgIHRoaXMucGk5MCA9IE1hdGguUEkgKiAwLjU7XHJcblxyXG4gICAgICAgIHRoaXMub2Zmc2V0ID0gbmV3IFYyKCk7XHJcblxyXG4gICAgICAgIHRoaXMuaCA9IG8uaCB8fCB0aGlzLncgKyAxMDtcclxuICAgICAgICB0aGlzLnRvcCA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuY1swXS5zdHlsZS53aWR0aCA9IHRoaXMudyArJ3B4JztcclxuXHJcbiAgICAgICAgaWYodGhpcy5jWzFdICE9PSB1bmRlZmluZWQpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY1sxXS5zdHlsZS53aWR0aCA9IHRoaXMudyArJ3B4JztcclxuICAgICAgICAgICAgdGhpcy5jWzFdLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICB0aGlzLnRvcCA9IDEwO1xyXG4gICAgICAgICAgICB0aGlzLmggKz0gMTA7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5wZXJjZW50ID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5jbW9kZSA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0ICsgJ3RleHQtYWxpZ246Y2VudGVyOyB0b3A6JysodGhpcy5oLTIwKSsncHg7IHdpZHRoOicrdGhpcy53KydweDsgY29sb3I6JysgdGhpcy5mb250Q29sb3IgKTtcclxuICAgICAgICB0aGlzLmNbM10gPSB0aGlzLmdldENpcmN1bGFyKCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdkJywgdGhpcy5tYWtlUGF0aCgpLCAxICk7XHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsIHRoaXMuZm9udENvbG9yLCAxICk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICd2aWV3Qm94JywgJzAgMCAnK3RoaXMudysnICcrdGhpcy53ICk7XHJcbiAgICAgICAgdGhpcy5zZXRDc3MoIHRoaXMuY1szXSwgeyB3aWR0aDp0aGlzLncsIGhlaWdodDp0aGlzLncsIGxlZnQ6MCwgdG9wOnRoaXMudG9wIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2RlICggbW9kZSApIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuY21vZGUgPT09IG1vZGUgKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgIHN3aXRjaCggbW9kZSApe1xyXG4gICAgICAgICAgICBjYXNlIDA6IC8vIGJhc2VcclxuICAgICAgICAgICAgICAgIHRoaXMuc1syXS5jb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsJ3JnYmEoMCwwLDAsMC4xKScsIDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsIHRoaXMuZm9udENvbG9yLCAxICk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDE6IC8vIG92ZXJcclxuICAgICAgICAgICAgICAgIHRoaXMuc1syXS5jb2xvciA9IHRoaXMuY29sb3JQbHVzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsJ3JnYmEoMCwwLDAsMC4zKScsIDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsIHRoaXMuY29sb3JQbHVzLCAxICk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jbW9kZSA9IG1vZGU7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICByZXNldCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICAgICAgXHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZW5kRW5kKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kZSgwKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMub2xkID0gdGhpcy52YWx1ZTtcclxuICAgICAgICB0aGlzLm9sZHIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kZSgxKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vtb3ZlICggZSApIHtcclxuXHJcbiAgICAgICAgLy90aGlzLm1vZGUoMSk7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5pc0Rvd24gKSByZXR1cm47XHJcblxyXG4gICAgICAgIHZhciBvZmYgPSB0aGlzLm9mZnNldDtcclxuXHJcbiAgICAgICAgb2ZmLnggPSB0aGlzLnJhZGl1cyAtIChlLmNsaWVudFggLSB0aGlzLnpvbmUueCApO1xyXG4gICAgICAgIG9mZi55ID0gdGhpcy5yYWRpdXMgLSAoZS5jbGllbnRZIC0gdGhpcy56b25lLnkgLSB0aGlzLnRvcCApO1xyXG5cclxuICAgICAgICB0aGlzLnIgPSBvZmYuYW5nbGUoKSAtIHRoaXMucGk5MDtcclxuICAgICAgICB0aGlzLnIgPSAoKCh0aGlzLnIldGhpcy50d29QaSkrdGhpcy50d29QaSkldGhpcy50d29QaSk7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLm9sZHIgIT09IG51bGwgKXsgXHJcblxyXG4gICAgICAgICAgICB2YXIgZGlmID0gdGhpcy5yIC0gdGhpcy5vbGRyO1xyXG4gICAgICAgICAgICB0aGlzLnIgPSBNYXRoLmFicyhkaWYpID4gTWF0aC5QSSA/IHRoaXMub2xkciA6IHRoaXMucjtcclxuXHJcbiAgICAgICAgICAgIGlmKCBkaWYgPiA2ICkgdGhpcy5yID0gMDtcclxuICAgICAgICAgICAgaWYoIGRpZiA8IC02ICkgdGhpcy5yID0gdGhpcy50d29QaTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgc3RlcHMgPSAxIC8gdGhpcy50d29QaTtcclxuICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLnIgKiBzdGVwcztcclxuXHJcbiAgICAgICAgdmFyIG4gPSAoICggdGhpcy5yYW5nZSAqIHZhbHVlICkgKyB0aGlzLm1pbiApIC0gdGhpcy5vbGQ7XHJcblxyXG4gICAgICAgIGlmKG4gPj0gdGhpcy5zdGVwIHx8IG4gPD0gdGhpcy5zdGVwKXsgXHJcbiAgICAgICAgICAgIG4gPSB+fiAoIG4gLyB0aGlzLnN0ZXAgKTtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMubnVtVmFsdWUoIHRoaXMub2xkICsgKCBuICogdGhpcy5zdGVwICkgKTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUoIHRydWUgKTtcclxuICAgICAgICAgICAgdGhpcy5vbGQgPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLm9sZHIgPSB0aGlzLnI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbWFrZVBhdGggKCkge1xyXG5cclxuICAgICAgICB2YXIgciA9IDQwO1xyXG4gICAgICAgIHZhciBkID0gMjQ7XHJcbiAgICAgICAgdmFyIGEgPSB0aGlzLnBlcmNlbnQgKiB0aGlzLnR3b1BpIC0gMC4wMDE7XHJcbiAgICAgICAgdmFyIHgyID0gKHIgKyByICogTWF0aC5zaW4oYSkpICsgZDtcclxuICAgICAgICB2YXIgeTIgPSAociAtIHIgKiBNYXRoLmNvcyhhKSkgKyBkO1xyXG4gICAgICAgIHZhciBiaWcgPSBhID4gTWF0aC5QSSA/IDEgOiAwO1xyXG4gICAgICAgIHJldHVybiBcIk0gXCIgKyAocitkKSArIFwiLFwiICsgZCArIFwiIEEgXCIgKyByICsgXCIsXCIgKyByICsgXCIgMCBcIiArIGJpZyArIFwiIDEgXCIgKyB4MiArIFwiLFwiICsgeTI7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZSAoIHVwICkge1xyXG5cclxuICAgICAgICB0aGlzLmNbMl0udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgIHRoaXMucGVyY2VudCA9ICggdGhpcy52YWx1ZSAtIHRoaXMubWluICkgLyB0aGlzLnJhbmdlO1xyXG5cclxuICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnZCcsIHRoaXMubWFrZVBhdGgoKSwgMSApO1xyXG4gICAgICAgIGlmKCB1cCApIHRoaXMuc2VuZCgpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxufSIsImltcG9ydCB7IFRvb2xzIH0gZnJvbSAnLi4vY29yZS9Ub29scyc7XHJcbmltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcbmltcG9ydCB7IFYyIH0gZnJvbSAnLi4vY29yZS9WMic7XHJcblxyXG5leHBvcnQgY2xhc3MgQ29sb3IgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcblx0ICAgIC8vdGhpcy5hdXRvSGVpZ2h0ID0gdHJ1ZTtcclxuXHJcblx0ICAgIHRoaXMuY3R5cGUgPSBvLmN0eXBlIHx8ICdoZXgnO1xyXG5cclxuXHQgICAgdGhpcy53Zml4ZSA9IHRoaXMuc2IgPiAyNTYgPyAyNTYgOiB0aGlzLnNiO1xyXG5cclxuXHQgICAgaWYoby5jdyAhPSB1bmRlZmluZWQgKSB0aGlzLndmaXhlID0gby5jdztcclxuXHJcblx0ICAgIC8vIGNvbG9yIHVwIG9yIGRvd25cclxuXHQgICAgdGhpcy5zaWRlID0gby5zaWRlIHx8ICdkb3duJztcclxuXHQgICAgdGhpcy51cCA9IHRoaXMuc2lkZSA9PT0gJ2Rvd24nID8gMCA6IDE7XHJcblx0ICAgIFxyXG5cdCAgICB0aGlzLmJhc2VIID0gdGhpcy5oO1xyXG5cclxuXHQgICAgdGhpcy5vZmZzZXQgPSBuZXcgVjIoKTtcclxuXHQgICAgdGhpcy5kZWNhbCA9IG5ldyBWMigpO1xyXG5cdCAgICB0aGlzLnAgPSBuZXcgVjIoKTtcclxuXHJcblx0ICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgIHRoaXMuY3NzLnR4dCArICdoZWlnaHQ6JysodGhpcy5oLTQpKydweDsnICsgJ2JvcmRlci1yYWRpdXM6Jyt0aGlzLnJhZGl1cysncHg7IGxpbmUtaGVpZ2h0OicrKHRoaXMuaC04KSsncHg7JyApO1xyXG5cdCAgICB0aGlzLnNbMl0gPSB0aGlzLmNbMl0uc3R5bGU7XHJcblxyXG5cdCAgICBpZiggdGhpcy51cCApe1xyXG5cdCAgICAgICAgdGhpcy5zWzJdLnRvcCA9ICdhdXRvJztcclxuXHQgICAgICAgIHRoaXMuc1syXS5ib3R0b20gPSAnMnB4JztcclxuXHQgICAgfVxyXG5cclxuXHQgICAgdGhpcy5jWzNdID0gdGhpcy5nZXRDb2xvclJpbmcoKTtcclxuXHQgICAgdGhpcy5jWzNdLnN0eWxlLnZpc2liaWxpdHkgID0gJ2hpZGRlbic7XHJcblxyXG5cdCAgICB0aGlzLmhzbCA9IG51bGw7XHJcblx0ICAgIHRoaXMudmFsdWUgPSAnI2ZmZmZmZic7XHJcblx0ICAgIGlmKCBvLnZhbHVlICE9PSB1bmRlZmluZWQgKXtcclxuXHQgICAgICAgIGlmKCBvLnZhbHVlIGluc3RhbmNlb2YgQXJyYXkgKSB0aGlzLnZhbHVlID0gVG9vbHMucmdiVG9IZXgoIG8udmFsdWUgKTtcclxuXHQgICAgICAgIGVsc2UgaWYoIWlzTmFOKG8udmFsdWUpKSB0aGlzLnZhbHVlID0gVG9vbHMuaGV4VG9IdG1sKCBvLnZhbHVlICk7XHJcblx0ICAgICAgICBlbHNlIHRoaXMudmFsdWUgPSBvLnZhbHVlO1xyXG5cdCAgICB9XHJcblxyXG5cdCAgICB0aGlzLmJjb2xvciA9IG51bGw7XHJcblx0ICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcblx0ICAgIHRoaXMuZmlzdERvd24gPSBmYWxzZTtcclxuXHJcblx0ICAgIHRoaXMudHIgPSA5ODtcclxuXHQgICAgdGhpcy50c2wgPSBNYXRoLnNxcnQoMykgKiB0aGlzLnRyO1xyXG5cclxuXHQgICAgdGhpcy5odWUgPSAwO1xyXG5cdCAgICB0aGlzLmQgPSAyNTY7XHJcblxyXG5cdCAgICB0aGlzLnNldENvbG9yKCB0aGlzLnZhbHVlICk7XHJcblxyXG5cdCAgICB0aGlzLmluaXQoKTtcclxuXHJcblx0ICAgIGlmKCBvLm9wZW4gIT09IHVuZGVmaW5lZCApIHRoaXMub3BlbigpO1xyXG5cclxuXHR9XHJcblxyXG5cdHRlc3Rab25lICggbXgsIG15ICkge1xyXG5cclxuXHRcdGxldCBsID0gdGhpcy5sb2NhbDtcclxuXHRcdGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcblxyXG5cclxuXHJcblx0XHRpZiggdGhpcy51cCAmJiB0aGlzLmlzT3BlbiApe1xyXG5cclxuXHRcdFx0aWYoIGwueSA+IHRoaXMud2ZpeGUgKSByZXR1cm4gJ3RpdGxlJztcclxuXHRcdCAgICBlbHNlIHJldHVybiAnY29sb3InO1xyXG5cclxuXHRcdH0gZWxzZSB7XHJcblxyXG5cdFx0XHRpZiggbC55IDwgdGhpcy5iYXNlSCsyICkgcmV0dXJuICd0aXRsZSc7XHJcblx0ICAgIFx0ZWxzZSBpZiggdGhpcy5pc09wZW4gKSByZXR1cm4gJ2NvbG9yJztcclxuXHJcblxyXG5cdFx0fVxyXG5cclxuICAgIH1cclxuXHJcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcblx0bW91c2V1cCAoIGUgKSB7XHJcblxyXG5cdCAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cdCAgICB0aGlzLmQgPSAyNTY7XHJcblxyXG5cdH1cclxuXHJcblx0bW91c2Vkb3duICggZSApIHtcclxuXHJcblxyXG5cdFx0bGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlLmNsaWVudFgsIGUuY2xpZW50WSApO1xyXG5cclxuXHJcblx0XHQvL2lmKCAhbmFtZSApIHJldHVybjtcclxuXHRcdGlmKG5hbWUgPT09ICd0aXRsZScpe1xyXG5cdFx0XHRpZiggIXRoaXMuaXNPcGVuICkgdGhpcy5vcGVuKCk7XHJcblx0ICAgICAgICBlbHNlIHRoaXMuY2xvc2UoKTtcclxuXHQgICAgICAgIHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRpZiggbmFtZSA9PT0gJ2NvbG9yJyApe1xyXG5cclxuXHRcdFx0dGhpcy5pc0Rvd24gPSB0cnVlO1xyXG5cdFx0XHR0aGlzLmZpc3REb3duID0gdHJ1ZVxyXG5cdFx0XHR0aGlzLm1vdXNlbW92ZSggZSApO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0bW91c2Vtb3ZlICggZSApIHtcclxuXHJcblx0ICAgIGxldCBuYW1lID0gdGhpcy50ZXN0Wm9uZSggZS5jbGllbnRYLCBlLmNsaWVudFkgKTtcclxuXHJcblx0ICAgIGxldCBvZmYsIGQsIGh1ZSwgc2F0LCBsdW0sIHJhZCwgeCwgeSwgcnIsIFQgPSBUb29scztcclxuXHJcblx0ICAgIGlmKCBuYW1lID09PSAndGl0bGUnICkgdGhpcy5jdXJzb3IoJ3BvaW50ZXInKTtcclxuXHJcblx0ICAgIGlmKCBuYW1lID09PSAnY29sb3InICl7XHJcblxyXG5cdCAgICBcdG9mZiA9IHRoaXMub2Zmc2V0O1xyXG5cdFx0ICAgIG9mZi54ID0gZS5jbGllbnRYIC0gKCB0aGlzLnpvbmUueCArIHRoaXMuZGVjYWwueCArIHRoaXMubWlkICk7XHJcblx0XHQgICAgb2ZmLnkgPSBlLmNsaWVudFkgLSAoIHRoaXMuem9uZS55ICsgdGhpcy5kZWNhbC55ICsgdGhpcy5taWQgKTtcclxuXHRcdFx0ZCA9IG9mZi5sZW5ndGgoKSAqIHRoaXMucmF0aW87XHJcblx0XHRcdHJyID0gb2ZmLmFuZ2xlKCk7XHJcblx0XHRcdGlmKHJyIDwgMCkgcnIgKz0gMiAqIFQuUEk7XHJcblx0XHRcdFx0XHRcdFxyXG5cclxuXHQgICAgXHRpZiAoIGQgPCAxMjggKSB0aGlzLmN1cnNvcignY3Jvc3NoYWlyJyk7XHJcblx0ICAgIFx0ZWxzZSBpZiggIXRoaXMuaXNEb3duICkgdGhpcy5jdXJzb3IoKVxyXG5cclxuXHQgICAgXHRpZiggdGhpcy5pc0Rvd24gKXtcclxuXHJcblx0XHRcdCAgICBpZiggdGhpcy5maXN0RG93biApe1xyXG5cdFx0XHQgICAgXHR0aGlzLmQgPSBkO1xyXG5cdFx0XHQgICAgXHR0aGlzLmZpc3REb3duID0gZmFsc2U7XHJcblx0XHRcdCAgICB9XHJcblxyXG5cdFx0XHQgICAgaWYgKCB0aGlzLmQgPCAxMjggKSB7XHJcblxyXG5cdFx0XHRcdCAgICBpZiAoIHRoaXMuZCA+IHRoaXMudHIgKSB7IC8vIG91dHNpZGUgaHVlXHJcblxyXG5cdFx0XHRcdCAgICAgICAgaHVlID0gKCByciArIFQucGk5MCApIC8gVC5Ud29QSTtcclxuXHRcdFx0XHQgICAgICAgIHRoaXMuaHVlID0gKGh1ZSArIDEpICUgMTtcclxuXHRcdFx0XHQgICAgICAgIHRoaXMuc2V0SFNMKFsoaHVlICsgMSkgJSAxLCB0aGlzLmhzbFsxXSwgdGhpcy5oc2xbMl1dKTtcclxuXHJcblx0XHRcdFx0ICAgIH0gZWxzZSB7IC8vIHRyaWFuZ2xlXHJcblxyXG5cdFx0XHRcdCAgICBcdHggPSBvZmYueCAqIHRoaXMucmF0aW87XHJcblx0XHRcdFx0ICAgIFx0eSA9IG9mZi55ICogdGhpcy5yYXRpbztcclxuXHJcblx0XHRcdFx0ICAgIFx0bGV0IHJyID0gKHRoaXMuaHVlICogVC5Ud29QSSkgKyBULlBJO1xyXG5cdFx0XHRcdCAgICBcdGlmKHJyIDwgMCkgcnIgKz0gMiAqIFQuUEk7XHJcblxyXG5cdFx0XHRcdCAgICBcdHJhZCA9IE1hdGguYXRhbjIoLXksIHgpO1xyXG5cdFx0XHRcdCAgICBcdGlmKHJhZCA8IDApIHJhZCArPSAyICogVC5QSTtcclxuXHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0ICAgIFx0bGV0IHJhZDAgPSAoIHJhZCArIFQucGk5MCArIFQuVHdvUEkgKyByciApICUgKFQuVHdvUEkpLFxyXG5cdFx0XHRcdCAgICBcdHJhZDEgPSByYWQwICUgKCgyLzMpICogVC5QSSkgLSAoVC5waTYwKSxcclxuXHRcdFx0XHQgICAgXHRhICAgID0gMC41ICogdGhpcy50cixcclxuXHRcdFx0XHQgICAgXHRiICAgID0gTWF0aC50YW4ocmFkMSkgKiBhLFxyXG5cdFx0XHRcdCAgICBcdHIgICAgPSBNYXRoLnNxcnQoeCp4ICsgeSp5KSxcclxuXHRcdFx0XHQgICAgXHRtYXhSID0gTWF0aC5zcXJ0KGEqYSArIGIqYik7XHJcblxyXG5cdFx0XHRcdCAgICBcdGlmKCByID4gbWF4UiApIHtcclxuXHRcdFx0XHRcdFx0XHRsZXQgZHggPSBNYXRoLnRhbihyYWQxKSAqIHI7XHJcblx0XHRcdFx0XHRcdFx0bGV0IHJhZDIgPSBNYXRoLmF0YW4oZHggLyBtYXhSKTtcclxuXHRcdFx0XHRcdFx0XHRpZihyYWQyID4gVC5waTYwKSAgcmFkMiA9IFQucGk2MDtcclxuXHRcdFx0XHRcdFx0ICAgIGVsc2UgaWYoIHJhZDIgPCAtVC5waTYwICkgcmFkMiA9IC1ULnBpNjA7XHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdHJhZCArPSByYWQyIC0gcmFkMTtcclxuXHJcblx0XHRcdFx0XHRcdFx0cmFkMCA9IChyYWQgKyBULnBpOTAgICsgVC5Ud29QSSArIHJyKSAlIChULlR3b1BJKSxcclxuXHRcdFx0XHRcdFx0XHRyYWQxID0gcmFkMCAlICgoMi8zKSAqIFQuUEkpIC0gKFQucGk2MCk7XHJcblx0XHRcdFx0XHRcdFx0YiA9IE1hdGgudGFuKHJhZDEpICogYTtcclxuXHRcdFx0XHRcdFx0XHRyID0gbWF4UiA9IE1hdGguc3FydChhKmEgKyBiKmIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHRsdW0gPSAoKE1hdGguc2luKHJhZDApICogcikgLyB0aGlzLnRzbCkgKyAwLjU7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdGxldCB3ID0gMSAtIChNYXRoLmFicyhsdW0gLSAwLjUpICogMik7XHJcblx0XHRcdFx0XHRcdHNhdCA9ICgoKE1hdGguY29zKHJhZDApICogcikgKyAodGhpcy50ciAvIDIpKSAvICgxLjUgKiB0aGlzLnRyKSkgLyB3O1xyXG5cdFx0XHRcdFx0XHRzYXQgPSBULmNsYW1wKCBzYXQsIDAsIDEgKTtcclxuXHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0ICAgICAgICB0aGlzLnNldEhTTChbdGhpcy5oc2xbMF0sIHNhdCwgbHVtXSk7XHJcblxyXG5cdFx0XHRcdCAgICB9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdH1cclxuXHJcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuXHRzZXRIZWlnaHQgKCkge1xyXG5cclxuXHRcdHRoaXMuaCA9IHRoaXMuaXNPcGVuID8gdGhpcy53Zml4ZSArIHRoaXMuYmFzZUggKyA1IDogdGhpcy5iYXNlSDtcclxuXHRcdHRoaXMuc1swXS5oZWlnaHQgPSB0aGlzLmggKyAncHgnO1xyXG5cdFx0dGhpcy56b25lLmggPSB0aGlzLmg7XHJcblxyXG5cdH1cclxuXHJcblx0cGFyZW50SGVpZ2h0ICggdCApIHtcclxuXHJcblx0XHRpZiAoIHRoaXMucGFyZW50R3JvdXAgIT09IG51bGwgKSB0aGlzLnBhcmVudEdyb3VwLmNhbGMoIHQgKTtcclxuXHQgICAgZWxzZSBpZiAoIHRoaXMuaXNVSSApIHRoaXMubWFpbi5jYWxjKCB0ICk7XHJcblxyXG5cdH1cclxuXHJcblx0b3BlbiAoKSB7XHJcblxyXG5cdFx0c3VwZXIub3BlbigpO1xyXG5cclxuXHRcdHRoaXMuc2V0SGVpZ2h0KCk7XHJcblxyXG5cdFx0aWYoIHRoaXMudXAgKSB0aGlzLnpvbmUueSAtPSB0aGlzLndmaXhlICsgNTtcclxuXHJcblx0XHRsZXQgdCA9IHRoaXMuaCAtIHRoaXMuYmFzZUg7XHJcblxyXG5cdCAgICB0aGlzLnNbM10udmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcclxuXHQgICAgLy90aGlzLnNbM10uZGlzcGxheSA9ICdibG9jayc7XHJcblx0ICAgIHRoaXMucGFyZW50SGVpZ2h0KCB0ICk7XHJcblxyXG5cdH1cclxuXHJcblx0Y2xvc2UgKCkge1xyXG5cclxuXHRcdHN1cGVyLmNsb3NlKCk7XHJcblxyXG5cdFx0aWYoIHRoaXMudXAgKSB0aGlzLnpvbmUueSArPSB0aGlzLndmaXhlICsgNTtcclxuXHJcblx0XHRsZXQgdCA9IHRoaXMuaCAtIHRoaXMuYmFzZUg7XHJcblxyXG5cdFx0dGhpcy5zZXRIZWlnaHQoKTtcclxuXHJcblx0ICAgIHRoaXMuc1szXS52aXNpYmlsaXR5ICA9ICdoaWRkZW4nO1xyXG5cdCAgICAvL3RoaXMuc1szXS5kaXNwbGF5ID0gJ25vbmUnO1xyXG5cdCAgICB0aGlzLnBhcmVudEhlaWdodCggLXQgKTtcclxuXHJcblx0fVxyXG5cclxuXHR1cGRhdGUgKCB1cCApIHtcclxuXHJcblx0ICAgIGxldCBjYyA9IFRvb2xzLnJnYlRvSGV4KCBUb29scy5oc2xUb1JnYihbIHRoaXMuaHNsWzBdLCAxLCAwLjUgXSkgKTtcclxuXHJcblx0ICAgIHRoaXMubW92ZU1hcmtlcnMoKTtcclxuXHQgICAgXHJcblx0ICAgIHRoaXMudmFsdWUgPSB0aGlzLmJjb2xvcjtcclxuXHJcblx0ICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdmaWxsJywgY2MsIDIsIDAgKTtcclxuXHJcblxyXG5cdCAgICB0aGlzLnNbMl0uYmFja2dyb3VuZCA9IHRoaXMuYmNvbG9yO1xyXG5cdCAgICB0aGlzLmNbMl0udGV4dENvbnRlbnQgPSBUb29scy5odG1sVG9IZXgoIHRoaXMuYmNvbG9yICk7XHJcblxyXG5cdCAgICB0aGlzLmludmVydCA9IFRvb2xzLmZpbmREZWVwSW52ZXIoIHRoaXMucmdiICk7XHJcblx0ICAgIHRoaXMuc1syXS5jb2xvciA9IHRoaXMuaW52ZXJ0ID8gJyNmZmYnIDogJyMwMDAnO1xyXG5cclxuXHQgICAgaWYoIXVwKSByZXR1cm47XHJcblxyXG5cdCAgICBpZiggdGhpcy5jdHlwZSA9PT0gJ2FycmF5JyApIHRoaXMuc2VuZCggdGhpcy5yZ2IgKTtcclxuXHQgICAgaWYoIHRoaXMuY3R5cGUgPT09ICdyZ2InICkgdGhpcy5zZW5kKCBUb29scy5odG1sUmdiKCB0aGlzLnJnYiApICk7XHJcblx0ICAgIGlmKCB0aGlzLmN0eXBlID09PSAnaGV4JyApIHRoaXMuc2VuZCggVG9vbHMuaHRtbFRvSGV4KCB0aGlzLnZhbHVlICkgKTtcclxuXHQgICAgaWYoIHRoaXMuY3R5cGUgPT09ICdodG1sJyApIHRoaXMuc2VuZCgpO1xyXG5cclxuXHR9XHJcblxyXG5cdHNldENvbG9yICggY29sb3IgKSB7XHJcblxyXG5cdCAgICBsZXQgdW5wYWNrID0gVG9vbHMudW5wYWNrKGNvbG9yKTtcclxuXHQgICAgaWYgKHRoaXMuYmNvbG9yICE9IGNvbG9yICYmIHVucGFjaykge1xyXG5cclxuXHQgICAgICAgIHRoaXMuYmNvbG9yID0gY29sb3I7XHJcblx0ICAgICAgICB0aGlzLnJnYiA9IHVucGFjaztcclxuXHQgICAgICAgIHRoaXMuaHNsID0gVG9vbHMucmdiVG9Ic2woIHRoaXMucmdiICk7XHJcblxyXG5cdCAgICAgICAgdGhpcy5odWUgPSB0aGlzLmhzbFswXTtcclxuXHJcblx0ICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG5cdCAgICB9XHJcblx0ICAgIHJldHVybiB0aGlzO1xyXG5cclxuXHR9XHJcblxyXG5cdHNldEhTTCAoIGhzbCApIHtcclxuXHJcblx0ICAgIHRoaXMuaHNsID0gaHNsO1xyXG5cdCAgICB0aGlzLnJnYiA9IFRvb2xzLmhzbFRvUmdiKCBoc2wgKTtcclxuXHQgICAgdGhpcy5iY29sb3IgPSBUb29scy5yZ2JUb0hleCggdGhpcy5yZ2IgKTtcclxuXHQgICAgdGhpcy51cGRhdGUoIHRydWUgKTtcclxuXHQgICAgcmV0dXJuIHRoaXM7XHJcblxyXG5cdH1cclxuXHJcblx0bW92ZU1hcmtlcnMgKCkge1xyXG5cclxuXHRcdGxldCBwID0gdGhpcy5wO1xyXG5cdFx0bGV0IFQgPSBUb29scztcclxuXHJcblx0ICAgIGxldCBjMSA9IHRoaXMuaW52ZXJ0ID8gJyNmZmYnIDogJyMwMDAnO1xyXG5cdCAgICBsZXQgYSA9IHRoaXMuaHNsWzBdICogVC5Ud29QSTtcclxuXHQgICAgbGV0IHRoaXJkID0gKDIvMykgKiBULlBJO1xyXG5cdCAgICBsZXQgciA9IHRoaXMudHI7XHJcblx0ICAgIGxldCBoID0gdGhpcy5oc2xbMF07XHJcblx0ICAgIGxldCBzID0gdGhpcy5oc2xbMV07XHJcblx0ICAgIGxldCBsID0gdGhpcy5oc2xbMl07XHJcblxyXG5cdCAgICBsZXQgYW5nbGUgPSAoIGEgLSBULnBpOTAgKSAqIFQudG9kZWc7XHJcblxyXG5cdCAgICBoID0gLSBhICsgVC5waTkwO1xyXG5cclxuXHRcdGxldCBoeCA9IE1hdGguY29zKGgpICogcjtcclxuXHRcdGxldCBoeSA9IC1NYXRoLnNpbihoKSAqIHI7XHJcblx0XHRsZXQgc3ggPSBNYXRoLmNvcyhoIC0gdGhpcmQpICogcjtcclxuXHRcdGxldCBzeSA9IC1NYXRoLnNpbihoIC0gdGhpcmQpICogcjtcclxuXHRcdGxldCB2eCA9IE1hdGguY29zKGggKyB0aGlyZCkgKiByO1xyXG5cdFx0bGV0IHZ5ID0gLU1hdGguc2luKGggKyB0aGlyZCkgKiByO1xyXG5cdFx0bGV0IG14ID0gKHN4ICsgdngpIC8gMiwgbXkgPSAoc3kgKyB2eSkgLyAyO1xyXG5cdFx0YSAgPSAoMSAtIDIgKiBNYXRoLmFicyhsIC0gLjUpKSAqIHM7XHJcblx0XHRsZXQgeCA9IHN4ICsgKHZ4IC0gc3gpICogbCArIChoeCAtIG14KSAqIGE7XHJcblx0XHRsZXQgeSA9IHN5ICsgKHZ5IC0gc3kpICogbCArIChoeSAtIG15KSAqIGE7XHJcblxyXG5cdCAgICBwLnNldCggeCwgeSApLmFkZFNjYWxhcigxMjgpO1xyXG5cclxuXHQgICAgLy9sZXQgZmYgPSAoMS1sKSoyNTU7XHJcblx0ICAgIC8vIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCAncmdiKCcrZmYrJywnK2ZmKycsJytmZisnKScsIDMgKTtcclxuXHJcblx0ICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICd0cmFuc2Zvcm0nLCAncm90YXRlKCcrYW5nbGUrJyApJywgMiApO1xyXG5cclxuXHQgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2N4JywgcC54LCAzICk7XHJcblx0ICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdjeScsIHAueSwgMyApO1xyXG5cdCAgICBcclxuXHQgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsIHRoaXMuaW52ZXJ0ID8gJyNmZmYnIDogJyMwMDAnLCAyLCAzICk7XHJcblx0ICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCB0aGlzLmludmVydCA/ICcjZmZmJyA6ICcjMDAwJywgMyApO1xyXG5cdCAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnZmlsbCcsdGhpcy5iY29sb3IsIDMgKTtcclxuXHJcblx0fVxyXG5cclxuXHRyU2l6ZSAoKSB7XHJcblxyXG5cdCAgICAvL1Byb3RvLnByb3RvdHlwZS5yU2l6ZS5jYWxsKCB0aGlzICk7XHJcblx0ICAgIHN1cGVyLnJTaXplKCk7XHJcblxyXG5cdCAgICBsZXQgcyA9IHRoaXMucztcclxuXHJcblx0ICAgIHNbMl0ud2lkdGggPSB0aGlzLnNiICsgJ3B4JztcclxuXHQgICAgc1syXS5sZWZ0ID0gdGhpcy5zYSArICdweCc7XHJcblxyXG5cdCAgICB0aGlzLmRlY2FsLnggPSBNYXRoLmZsb29yKCh0aGlzLncgLSB0aGlzLndmaXhlKSAqIDAuNSk7XHJcblx0ICAgIHRoaXMuZGVjYWwueSA9IHRoaXMuc2lkZSA9PT0gJ3VwJyA/IDIgOiB0aGlzLmJhc2VIICsgMjtcclxuXHQgICAgdGhpcy5taWQgPSBNYXRoLmZsb29yKCB0aGlzLndmaXhlICogMC41ICk7XHJcblxyXG5cclxuXHQgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3ZpZXdCb3gnLCAnMCAwICcrdGhpcy53Zml4ZSsnICcrdGhpcy53Zml4ZSApO1xyXG5cdCAgICBzWzNdLndpZHRoID0gdGhpcy53Zml4ZSArICdweCc7XHJcblx0ICAgIHNbM10uaGVpZ2h0ID0gdGhpcy53Zml4ZSArICdweCc7XHJcbiAgICBcdHNbM10ubGVmdCA9IHRoaXMuZGVjYWwueCArICdweCc7XHJcblx0ICAgIHNbM10udG9wID0gdGhpcy5kZWNhbC55ICsgJ3B4JztcclxuXHJcblx0ICAgIHRoaXMucmF0aW8gPSAyNTYvdGhpcy53Zml4ZTtcclxuXHQgICAgdGhpcy5zcXVhcmUgPSAxIC8gKDYwKih0aGlzLndmaXhlLzI1NikpO1xyXG5cdCAgICBcclxuXHQgICAgdGhpcy5zZXRIZWlnaHQoKTtcclxuXHQgICAgXHJcblx0fVxyXG5cclxufSIsImltcG9ydCB7IFJvb3RzIH0gZnJvbSAnLi4vY29yZS9Sb290cyc7XHJcbmltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcblxyXG5leHBvcnQgY2xhc3MgRnBzIGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcblxyXG4gICAgICAgIHRoaXMucm91bmQgPSBNYXRoLnJvdW5kO1xyXG5cclxuICAgICAgICB0aGlzLmF1dG9IZWlnaHQgPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLmJhc2VIID0gdGhpcy5oO1xyXG4gICAgICAgIHRoaXMuaHBsdXMgPSBvLmhwbHVzIHx8IDUwO1xyXG5cclxuICAgICAgICB0aGlzLnJlcyA9IG8ucmVzIHx8IDQwO1xyXG4gICAgICAgIHRoaXMubCA9IDE7XHJcblxyXG4gICAgICAgIHRoaXMucHJlY2lzaW9uID0gby5wcmVjaXNpb24gfHwgMDtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgdGhpcy5jdXN0b20gPSBvLmN1c3RvbSB8fCBmYWxzZTtcclxuICAgICAgICB0aGlzLm5hbWVzID0gby5uYW1lcyB8fCBbJ0ZQUycsICdNUyddO1xyXG4gICAgICAgIGxldCBjYyA9IG8uY2MgfHwgWyc5MCw5MCw5MCcsICcyNTUsMjU1LDAnXTtcclxuXHJcbiAgICAgICAvLyB0aGlzLmRpdmlkID0gWyAxMDAsIDEwMCwgMTAwIF07XHJcbiAgICAgICAvLyB0aGlzLm11bHR5ID0gWyAzMCwgMzAsIDMwIF07XHJcblxyXG4gICAgICAgIHRoaXMuYWRkaW5nID0gby5hZGRpbmcgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMucmFuZ2UgPSBvLnJhbmdlIHx8IFsgMTY1LCAxMDAsIDEwMCBdO1xyXG5cclxuICAgICAgICB0aGlzLmFscGhhID0gby5hbHBoYSB8fCAwLjI1O1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMucG9pbnRzID0gW107XHJcbiAgICAgICAgdGhpcy50ZXh0RGlzcGxheSA9IFtdO1xyXG5cclxuICAgICAgICBpZighdGhpcy5jdXN0b20pe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5ub3cgPSAoIHNlbGYucGVyZm9ybWFuY2UgJiYgc2VsZi5wZXJmb3JtYW5jZS5ub3cgKSA/IHNlbGYucGVyZm9ybWFuY2Uubm93LmJpbmQoIHBlcmZvcm1hbmNlICkgOiBEYXRlLm5vdztcclxuICAgICAgICAgICAgdGhpcy5zdGFydFRpbWUgPSAwOy8vdGhpcy5ub3coKVxyXG4gICAgICAgICAgICB0aGlzLnByZXZUaW1lID0gMDsvL3RoaXMuc3RhcnRUaW1lO1xyXG4gICAgICAgICAgICB0aGlzLmZyYW1lcyA9IDA7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm1zID0gMDtcclxuICAgICAgICAgICAgdGhpcy5mcHMgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLm1lbSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMubW0gPSAwO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5pc01lbSA9ICggc2VsZi5wZXJmb3JtYW5jZSAmJiBzZWxmLnBlcmZvcm1hbmNlLm1lbW9yeSApID8gdHJ1ZSA6IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAvLyB0aGlzLmRpdmlkID0gWyAxMDAsIDIwMCwgMSBdO1xyXG4gICAgICAgICAgIC8vIHRoaXMubXVsdHkgPSBbIDMwLCAzMCwgMzAgXTtcclxuXHJcbiAgICAgICAgICAgIGlmKCB0aGlzLmlzTWVtICl7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lcy5wdXNoKCdNRU0nKTtcclxuICAgICAgICAgICAgICAgIGNjLnB1c2goJzAsMjU1LDI1NScpO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy50eHQgPSAnRlBTJ1xyXG5cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBsZXQgZmx0b3AgPSBNYXRoLmZsb29yKHRoaXMuaCowLjUpLTY7XHJcblxyXG4gICAgICAgIHRoaXMuY1sxXS50ZXh0Q29udGVudCA9IHRoaXMudHh0O1xyXG4gICAgICAgIHRoaXMuY1swXS5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XHJcbiAgICAgICAgdGhpcy5jWzBdLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnYXV0byc7XHJcblxyXG4gICAgICAgIGxldCBwYW5lbENzcyA9ICdkaXNwbGF5Om5vbmU7IGxlZnQ6MTBweDsgdG9wOicrIHRoaXMuaCArICdweDsgaGVpZ2h0OicrKHRoaXMuaHBsdXMgLSA4KSsncHg7IGJveC1zaXppbmc6Ym9yZGVyLWJveDsgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjIpOyBib3JkZXI6JyArICh0aGlzLmNvbG9ycy5ncm91cEJvcmRlciAhPT0gJ25vbmUnPyB0aGlzLmNvbG9ycy5ncm91cEJvcmRlcisnOycgOiAnMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsnKTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMucmFkaXVzICE9PSAwICkgcGFuZWxDc3MgKz0gJ2JvcmRlci1yYWRpdXM6JyArIHRoaXMucmFkaXVzKydweDsnOyBcclxuXHJcbiAgICAgICAgdGhpcy5jWzJdID0gdGhpcy5kb20oICdwYXRoJywgdGhpcy5jc3MuYmFzaWMgKyBwYW5lbENzcyAsIHt9ICk7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXS5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwICcrdGhpcy5yZXMrJyA1MCcgKTtcclxuICAgICAgICB0aGlzLmNbMl0uc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMTAwJScgKTtcclxuICAgICAgICB0aGlzLmNbMl0uc2V0QXR0cmlidXRlKCd3aWR0aCcsICcxMDAlJyApO1xyXG4gICAgICAgIHRoaXMuY1syXS5zZXRBdHRyaWJ1dGUoJ3ByZXNlcnZlQXNwZWN0UmF0aW8nLCAnbm9uZScgKTtcclxuXHJcblxyXG4gICAgICAgIC8vdGhpcy5kb20oICdwYXRoJywgbnVsbCwgeyBmaWxsOidyZ2JhKDI1NSwyNTUsMCwwLjMpJywgJ3N0cm9rZS13aWR0aCc6MSwgc3Ryb2tlOicjRkYwJywgJ3ZlY3Rvci1lZmZlY3QnOidub24tc2NhbGluZy1zdHJva2UnIH0sIHRoaXMuY1syXSApO1xyXG4gICAgICAgIC8vdGhpcy5kb20oICdwYXRoJywgbnVsbCwgeyBmaWxsOidyZ2JhKDAsMjU1LDI1NSwwLjMpJywgJ3N0cm9rZS13aWR0aCc6MSwgc3Ryb2tlOicjMEZGJywgJ3ZlY3Rvci1lZmZlY3QnOidub24tc2NhbGluZy1zdHJva2UnIH0sIHRoaXMuY1syXSApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGFycm93XHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdwYXRoJywgdGhpcy5jc3MuYmFzaWMgKyAncG9zaXRpb246YWJzb2x1dGU7IHdpZHRoOjEwcHg7IGhlaWdodDoxMHB4OyBsZWZ0OjRweDsgdG9wOicrZmx0b3ArJ3B4OycsIHsgZDp0aGlzLnN2Z3MuYXJyb3csIGZpbGw6dGhpcy5mb250Q29sb3IsIHN0cm9rZTonbm9uZSd9KTtcclxuXHJcbiAgICAgICAgLy8gcmVzdWx0IHRlc3RcclxuICAgICAgICB0aGlzLmNbNF0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dCArICdwb3NpdGlvbjphYnNvbHV0ZTsgbGVmdDoxMHB4OyB0b3A6JysodGhpcy5oKzIpICsncHg7IGRpc3BsYXk6bm9uZTsgd2lkdGg6MTAwJTsgdGV4dC1hbGlnbjpjZW50ZXI7JyApO1xyXG5cclxuICAgICAgICAvLyBib3R0b20gbGluZVxyXG4gICAgICAgIGlmKCBvLmJvdHRvbUxpbmUgKSB0aGlzLmNbNF0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ3dpZHRoOjEwMCU7IGJvdHRvbTowcHg7IGhlaWdodDoxcHg7IGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsnKTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1Nob3cgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcblxyXG4gICAgICAgIHNbMV0ubWFyZ2luTGVmdCA9ICcxMHB4JztcclxuICAgICAgICBzWzFdLmxpbmVIZWlnaHQgPSB0aGlzLmgtNDtcclxuICAgICAgICBzWzFdLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgc1sxXS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5yYWRpdXMgIT09IDAgKSAgc1swXS5ib3JkZXJSYWRpdXMgPSB0aGlzLnJhZGl1cysncHgnOyBcclxuICAgICAgICBzWzBdLmJvcmRlciA9IHRoaXMuY29sb3JzLmdyb3VwQm9yZGVyO1xyXG5cclxuXHJcblxyXG5cclxuICAgICAgICBsZXQgaiA9IDA7XHJcblxyXG4gICAgICAgIGZvciggaj0wOyBqPHRoaXMubmFtZXMubGVuZ3RoOyBqKysgKXtcclxuXHJcbiAgICAgICAgICAgIGxldCBiYXNlID0gW107XHJcbiAgICAgICAgICAgIGxldCBpID0gdGhpcy5yZXMrMTtcclxuICAgICAgICAgICAgd2hpbGUoIGktLSApIGJhc2UucHVzaCg1MCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJhbmdlW2pdID0gKCAxIC8gdGhpcy5yYW5nZVtqXSApICogNDk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnBvaW50cy5wdXNoKCBiYXNlICk7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWVzLnB1c2goMCk7XHJcbiAgICAgICAgICAgLy8gIHRoaXMuZG9tKCAncGF0aCcsIG51bGwsIHsgZmlsbDoncmdiYSgnK2NjW2pdKycsMC41KScsICdzdHJva2Utd2lkdGgnOjEsIHN0cm9rZToncmdiYSgnK2NjW2pdKycsMSknLCAndmVjdG9yLWVmZmVjdCc6J25vbi1zY2FsaW5nLXN0cm9rZScgfSwgdGhpcy5jWzJdICk7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dERpc3BsYXkucHVzaCggXCI8c3BhbiBzdHlsZT0nY29sb3I6cmdiKFwiK2NjW2pdK1wiKSc+IFwiICsgdGhpcy5uYW1lc1tqXSArXCIgXCIpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGogPSB0aGlzLm5hbWVzLmxlbmd0aDtcclxuICAgICAgICB3aGlsZShqLS0pe1xyXG4gICAgICAgICAgICB0aGlzLmRvbSggJ3BhdGgnLCBudWxsLCB7IGZpbGw6J3JnYmEoJytjY1tqXSsnLCcrdGhpcy5hbHBoYSsnKScsICdzdHJva2Utd2lkdGgnOjEsIHN0cm9rZToncmdiYSgnK2NjW2pdKycsMSknLCAndmVjdG9yLWVmZmVjdCc6J25vbi1zY2FsaW5nLXN0cm9rZScgfSwgdGhpcy5jWzJdICk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgICAgIC8vaWYoIHRoaXMuaXNTaG93ICkgdGhpcy5zaG93KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNTaG93ICkgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIGVsc2UgdGhpcy5vcGVuKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAvKm1vZGU6IGZ1bmN0aW9uICggbW9kZSApIHtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcblxyXG4gICAgICAgIHN3aXRjaChtb2RlKXtcclxuICAgICAgICAgICAgY2FzZSAwOiAvLyBiYXNlXHJcbiAgICAgICAgICAgICAgICBzWzFdLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgICAgICAvL3NbMV0uYmFja2dyb3VuZCA9ICdub25lJztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTogLy8gb3ZlclxyXG4gICAgICAgICAgICAgICAgc1sxXS5jb2xvciA9ICcjRkZGJztcclxuICAgICAgICAgICAgICAgIC8vc1sxXS5iYWNrZ3JvdW5kID0gVUlMLlNFTEVDVDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjogLy8gZWRpdCAvIGRvd25cclxuICAgICAgICAgICAgICAgIHNbMV0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICAgICAgICAgIC8vc1sxXS5iYWNrZ3JvdW5kID0gVUlMLlNFTEVDVERPV047XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICB9XHJcbiAgICB9LCovXHJcblxyXG4gICAgdGljayAoIHYgKSB7XHJcblxyXG4gICAgICAgIHRoaXMudmFsdWVzID0gdjtcclxuICAgICAgICBpZiggIXRoaXMuaXNTaG93ICkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuZHJhd0dyYXBoKCk7XHJcbiAgICAgICAgdGhpcy51cFRleHQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbWFrZVBhdGggKCBwb2ludCApIHtcclxuXHJcbiAgICAgICAgbGV0IHAgPSAnJztcclxuICAgICAgICBwICs9ICdNICcgKyAoLTEpICsgJyAnICsgNTA7XHJcbiAgICAgICAgZm9yICggbGV0IGkgPSAwOyBpIDwgdGhpcy5yZXMgKyAxOyBpICsrICkgeyBwICs9ICcgTCAnICsgaSArICcgJyArIHBvaW50W2ldOyB9XHJcbiAgICAgICAgcCArPSAnIEwgJyArICh0aGlzLnJlcyArIDEpICsgJyAnICsgNTA7XHJcbiAgICAgICAgcmV0dXJuIHA7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVwVGV4dCAoIHZhbCApIHtcclxuXHJcbiAgICAgICAgbGV0IHYgPSB2YWwgfHwgdGhpcy52YWx1ZXMsIHQgPSAnJztcclxuICAgICAgICBmb3IoIGxldCBqPTAsIGxuZyA9dGhpcy5uYW1lcy5sZW5ndGg7IGo8bG5nOyBqKysgKSB0ICs9IHRoaXMudGV4dERpc3BsYXlbal0gKyAodltqXSkudG9GaXhlZCh0aGlzLnByZWNpc2lvbikgKyAnPC9zcGFuPic7XHJcbiAgICAgICAgdGhpcy5jWzRdLmlubmVySFRNTCA9IHQ7XHJcbiAgICBcclxuICAgIH1cclxuXHJcbiAgICBkcmF3R3JhcGggKCkge1xyXG5cclxuICAgICAgICBsZXQgc3ZnID0gdGhpcy5jWzJdO1xyXG4gICAgICAgIGxldCBpID0gdGhpcy5uYW1lcy5sZW5ndGgsIHYsIG9sZCA9IDAsIG4gPSAwO1xyXG5cclxuICAgICAgICB3aGlsZSggaS0tICl7XHJcbiAgICAgICAgICAgIGlmKCB0aGlzLmFkZGluZyApIHYgPSAodGhpcy52YWx1ZXNbbl0rb2xkKSAqIHRoaXMucmFuZ2Vbbl07XHJcbiAgICAgICAgICAgIGVsc2UgIHYgPSAodGhpcy52YWx1ZXNbbl0gKiB0aGlzLnJhbmdlW25dKTtcclxuICAgICAgICAgICAgdGhpcy5wb2ludHNbbl0uc2hpZnQoKTtcclxuICAgICAgICAgICAgdGhpcy5wb2ludHNbbl0ucHVzaCggNTAgLSB2ICk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCBzdmcsICdkJywgdGhpcy5tYWtlUGF0aCggdGhpcy5wb2ludHNbbl0gKSwgaSsxICk7XHJcbiAgICAgICAgICAgIG9sZCArPSB0aGlzLnZhbHVlc1tuXTtcclxuICAgICAgICAgICAgbisrO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG9wZW4gKCkge1xyXG5cclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcblxyXG4gICAgICAgIHRoaXMuaCA9IHRoaXMuaHBsdXMgKyB0aGlzLmJhc2VIO1xyXG5cclxuICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnZCcsIHRoaXMuc3Zncy5hcnJvd0Rvd24gKTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMucGFyZW50R3JvdXAgIT09IG51bGwgKXsgdGhpcy5wYXJlbnRHcm91cC5jYWxjKCB0aGlzLmhwbHVzICk7fVxyXG4gICAgICAgIGVsc2UgaWYoIHRoaXMuaXNVSSApIHRoaXMubWFpbi5jYWxjKCB0aGlzLmhwbHVzICk7XHJcblxyXG4gICAgICAgIHRoaXMuc1swXS5oZWlnaHQgPSB0aGlzLmggKydweCc7XHJcbiAgICAgICAgdGhpcy5zWzJdLmRpc3BsYXkgPSAnYmxvY2snOyBcclxuICAgICAgICB0aGlzLnNbNF0uZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgdGhpcy5pc1Nob3cgPSB0cnVlO1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuY3VzdG9tICkgUm9vdHMuYWRkTGlzdGVuKCB0aGlzICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuXHJcbiAgICAgICAgdGhpcy5oID0gdGhpcy5iYXNlSDtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2QnLCB0aGlzLnN2Z3MuYXJyb3cgKTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMucGFyZW50R3JvdXAgIT09IG51bGwgKXsgdGhpcy5wYXJlbnRHcm91cC5jYWxjKCAtdGhpcy5ocGx1cyApO31cclxuICAgICAgICBlbHNlIGlmKCB0aGlzLmlzVUkgKSB0aGlzLm1haW4uY2FsYyggLXRoaXMuaHBsdXMgKTtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnNbMF0uaGVpZ2h0ID0gdGhpcy5oICsncHgnO1xyXG4gICAgICAgIHRoaXMuc1syXS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIHRoaXMuc1s0XS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIHRoaXMuaXNTaG93ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5jdXN0b20gKSBSb290cy5yZW1vdmVMaXN0ZW4oIHRoaXMgKTtcclxuXHJcbiAgICAgICAgdGhpcy5jWzRdLmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLy8vLyBBVVRPIEZQUyAvLy8vLy9cclxuXHJcbiAgICBiZWdpbiAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc3RhcnRUaW1lID0gdGhpcy5ub3coKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBlbmQgKCkge1xyXG5cclxuICAgICAgICBsZXQgdGltZSA9IHRoaXMubm93KCk7XHJcbiAgICAgICAgdGhpcy5tcyA9IHRpbWUgLSB0aGlzLnN0YXJ0VGltZTtcclxuXHJcbiAgICAgICAgdGhpcy5mcmFtZXMgKys7XHJcblxyXG4gICAgICAgIGlmICggdGltZSA+IHRoaXMucHJldlRpbWUgKyAxMDAwICkge1xyXG5cclxuICAgICAgICAgICAgdGhpcy5mcHMgPSB0aGlzLnJvdW5kKCAoIHRoaXMuZnJhbWVzICogMTAwMCApIC8gKCB0aW1lIC0gdGhpcy5wcmV2VGltZSApICk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnByZXZUaW1lID0gdGltZTtcclxuICAgICAgICAgICAgdGhpcy5mcmFtZXMgPSAwO1xyXG5cclxuICAgICAgICAgICAgaWYgKCB0aGlzLmlzTWVtICkge1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBoZWFwU2l6ZSA9IHBlcmZvcm1hbmNlLm1lbW9yeS51c2VkSlNIZWFwU2l6ZTtcclxuICAgICAgICAgICAgICAgIGxldCBoZWFwU2l6ZUxpbWl0ID0gcGVyZm9ybWFuY2UubWVtb3J5LmpzSGVhcFNpemVMaW1pdDtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lbSA9IHRoaXMucm91bmQoIGhlYXBTaXplICogMC4wMDAwMDA5NTQgKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubW0gPSBoZWFwU2l6ZSAvIGhlYXBTaXplTGltaXQ7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBbIHRoaXMuZnBzLCB0aGlzLm1zICwgdGhpcy5tbSBdO1xyXG5cclxuICAgICAgICB0aGlzLmRyYXdHcmFwaCgpO1xyXG4gICAgICAgIHRoaXMudXBUZXh0KCBbIHRoaXMuZnBzLCB0aGlzLm1zLCB0aGlzLm1lbSBdICk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aW1lO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBsaXN0ZW5pbmcgKCkge1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuY3VzdG9tICkgdGhpcy5zdGFydFRpbWUgPSB0aGlzLmVuZCgpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHJTaXplICgpIHtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgbGV0IHcgPSB0aGlzLnc7XHJcblxyXG4gICAgICAgIHNbMF0ud2lkdGggPSB3ICsgJ3B4JztcclxuICAgICAgICBzWzFdLndpZHRoID0gdyArICdweCc7XHJcbiAgICAgICAgc1syXS5sZWZ0ID0gMTAgKyAncHgnO1xyXG4gICAgICAgIHNbMl0ud2lkdGggPSAody0yMCkgKyAncHgnO1xyXG4gICAgICAgIHNbNF0ud2lkdGggPSAody0yMCkgKyAncHgnO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbn0iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5pbXBvcnQgeyBWMiB9IGZyb20gJy4uL2NvcmUvVjInO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdyYXBoIGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcblxyXG4gICAgXHR0aGlzLnZhbHVlID0gby52YWx1ZSAhPT0gdW5kZWZpbmVkID8gby52YWx1ZSA6IFswLDAsMF07XHJcbiAgICAgICAgdGhpcy5sbmcgPSB0aGlzLnZhbHVlLmxlbmd0aDtcclxuXHJcbiAgICAgICAgdGhpcy5wcmVjaXNpb24gPSBvLnByZWNpc2lvbiAhPT0gdW5kZWZpbmVkID8gby5wcmVjaXNpb24gOiAyO1xyXG4gICAgICAgIHRoaXMubXVsdGlwbGljYXRvciA9IG8ubXVsdGlwbGljYXRvciB8fCAxO1xyXG4gICAgICAgIHRoaXMubmVnID0gby5uZWcgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMubGluZSA9IG8ubGluZSAhPT0gdW5kZWZpbmVkID8gIG8ubGluZSA6IHRydWU7XHJcblxyXG4gICAgICAgIC8vaWYodGhpcy5uZWcpdGhpcy5tdWx0aXBsaWNhdG9yKj0yO1xyXG5cclxuICAgICAgICB0aGlzLmF1dG9XaWR0aCA9IG8uYXV0b1dpZHRoICE9PSB1bmRlZmluZWQgPyBvLmF1dG9XaWR0aCA6IHRydWU7XHJcbiAgICAgICAgdGhpcy5pc051bWJlciA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmggPSBvLmggfHwgMTI4ICsgMTA7XHJcbiAgICAgICAgdGhpcy5yaCA9IHRoaXMuaCAtIDEwO1xyXG4gICAgICAgIHRoaXMudG9wID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5jWzBdLnN0eWxlLndpZHRoID0gdGhpcy53ICsncHgnO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5jWzFdICE9PSB1bmRlZmluZWQgKSB7IC8vIHdpdGggdGl0bGVcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY1sxXS5zdHlsZS53aWR0aCA9IHRoaXMudyArJ3B4JztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvL3RoaXMuY1sxXS5zdHlsZS5iYWNrZ3JvdW5kID0gJyNmZjAwMDAnO1xyXG4gICAgICAgICAgICAvL3RoaXMuY1sxXS5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJztcclxuICAgICAgICAgICAgdGhpcy50b3AgPSAxMDtcclxuICAgICAgICAgICAgdGhpcy5oICs9IDEwO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZ2ggPSB0aGlzLnJoIC0gMjg7XHJcbiAgICAgICAgdGhpcy5ndyA9IHRoaXMudyAtIDI4O1xyXG5cclxuICAgICAgICB0aGlzLmNbMl0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dCArICd0ZXh0LWFsaWduOmNlbnRlcjsgdG9wOicrKHRoaXMuaC0yMCkrJ3B4OyB3aWR0aDonK3RoaXMudysncHg7IGNvbG9yOicrIHRoaXMuZm9udENvbG9yICk7XHJcbiAgICAgICAgdGhpcy5jWzJdLnRleHRDb250ZW50ID0gdGhpcy52YWx1ZTtcclxuXHJcbiAgICAgICAgbGV0IHN2ZyA9IHRoaXMuZG9tKCAnc3ZnJywgdGhpcy5jc3MuYmFzaWMgLCB7IHZpZXdCb3g6JzAgMCAnK3RoaXMudysnICcrdGhpcy5yaCwgd2lkdGg6dGhpcy53LCBoZWlnaHQ6dGhpcy5yaCwgcHJlc2VydmVBc3BlY3RSYXRpbzonbm9uZScgfSApO1xyXG4gICAgICAgIHRoaXMuc2V0Q3NzKCBzdmcsIHsgd2lkdGg6dGhpcy53LCBoZWlnaHQ6dGhpcy5yaCwgbGVmdDowLCB0b3A6dGhpcy50b3AgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuZG9tKCAncGF0aCcsICcnLCB7IGQ6JycsIHN0cm9rZTp0aGlzLmNvbG9ycy50ZXh0LCAnc3Ryb2tlLXdpZHRoJzoyLCBmaWxsOidub25lJywgJ3N0cm9rZS1saW5lY2FwJzonYnV0dCcgfSwgc3ZnICk7XHJcbiAgICAgICAgdGhpcy5kb20oICdyZWN0JywgJycsIHsgeDoxMCwgeToxMCwgd2lkdGg6dGhpcy5ndys4LCBoZWlnaHQ6dGhpcy5naCs4LCBzdHJva2U6J3JnYmEoMCwwLDAsMC4zKScsICdzdHJva2Utd2lkdGgnOjEgLCBmaWxsOidub25lJ30sIHN2ZyApO1xyXG5cclxuICAgICAgICB0aGlzLml3ID0gKCh0aGlzLmd3LSg0Kih0aGlzLmxuZy0xKSkpL3RoaXMubG5nKTtcclxuICAgICAgICBsZXQgdCA9IFtdO1xyXG4gICAgICAgIHRoaXMuY01vZGUgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy52ID0gW107XHJcblxyXG4gICAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy5sbmc7IGkrKyApe1xyXG5cclxuICAgICAgICBcdHRbaV0gPSBbIDE0ICsgKGkqdGhpcy5pdykgKyAoaSo0KSwgdGhpcy5pdyBdO1xyXG4gICAgICAgIFx0dFtpXVsyXSA9IHRbaV1bMF0gKyB0W2ldWzFdO1xyXG4gICAgICAgIFx0dGhpcy5jTW9kZVtpXSA9IDA7XHJcblxyXG4gICAgICAgICAgICBpZiggdGhpcy5uZWcgKSB0aGlzLnZbaV0gPSAoKDErKHRoaXMudmFsdWVbaV0gLyB0aGlzLm11bHRpcGxpY2F0b3IpKSowLjUpO1xyXG4gICAgICAgIFx0ZWxzZSB0aGlzLnZbaV0gPSB0aGlzLnZhbHVlW2ldIC8gdGhpcy5tdWx0aXBsaWNhdG9yO1xyXG5cclxuICAgICAgICBcdHRoaXMuZG9tKCAncmVjdCcsICcnLCB7IHg6dFtpXVswXSwgeToxNCwgd2lkdGg6dFtpXVsxXSwgaGVpZ2h0OjEsIGZpbGw6dGhpcy5mb250Q29sb3IsICdmaWxsLW9wYWNpdHknOjAuMyB9LCBzdmcgKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnRtcCA9IHQ7XHJcbiAgICAgICAgdGhpcy5jWzNdID0gc3ZnO1xyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudylcclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmNbMV0gIT09IHVuZGVmaW5lZCApe1xyXG4gICAgICAgICAgICB0aGlzLmNbMV0uc3R5bGUudG9wID0gMCArJ3B4JztcclxuICAgICAgICAgICAgdGhpcy5jWzFdLnN0eWxlLmhlaWdodCA9IDIwICsncHgnO1xyXG4gICAgICAgICAgICB0aGlzLnNbMV0ubGluZUhlaWdodCA9ICgyMC01KSsncHgnXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZSggZmFsc2UgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlU1ZHICgpIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMubGluZSApIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdkJywgdGhpcy5tYWtlUGF0aCgpLCAwICk7XHJcblxyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGk8dGhpcy5sbmc7IGkrKyApe1xyXG5cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdoZWlnaHQnLCB0aGlzLnZbaV0qdGhpcy5naCwgaSsyICk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICd5JywgMTQgKyAodGhpcy5naCAtIHRoaXMudltpXSp0aGlzLmdoKSwgaSsyICk7XHJcbiAgICAgICAgICAgIGlmKCB0aGlzLm5lZyApIHRoaXMudmFsdWVbaV0gPSAoICgodGhpcy52W2ldKjIpLTEpICogdGhpcy5tdWx0aXBsaWNhdG9yICkudG9GaXhlZCggdGhpcy5wcmVjaXNpb24gKSAqIDE7XHJcbiAgICAgICAgICAgIGVsc2UgdGhpcy52YWx1ZVtpXSA9ICggKHRoaXMudltpXSAqIHRoaXMubXVsdGlwbGljYXRvcikgKS50b0ZpeGVkKCB0aGlzLnByZWNpc2lvbiApICogMTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmNbMl0udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB0ZXN0Wm9uZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBsID0gdGhpcy5sb2NhbDtcclxuICAgICAgICBpZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICkgcmV0dXJuICcnO1xyXG5cclxuICAgICAgICBsZXQgaSA9IHRoaXMubG5nO1xyXG4gICAgICAgIGxldCB0ID0gdGhpcy50bXA7XHJcbiAgICAgICAgXHJcblx0ICAgIGlmKCBsLnk+dGhpcy50b3AgJiYgbC55PHRoaXMuaC0yMCApe1xyXG5cdCAgICAgICAgd2hpbGUoIGktLSApe1xyXG5cdCAgICAgICAgICAgIGlmKCBsLng+dFtpXVswXSAmJiBsLng8dFtpXVsyXSApIHJldHVybiBpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAnJ1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2RlICggbiwgbmFtZSApIHtcclxuXHJcbiAgICBcdGlmKCBuID09PSB0aGlzLmNNb2RlW25hbWVdICkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIFx0bGV0IGE7XHJcblxyXG4gICAgICAgIHN3aXRjaChuKXtcclxuICAgICAgICAgICAgY2FzZSAwOiBhPTAuMzsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTogYT0wLjY7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDI6IGE9MTsgYnJlYWs7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnJlc2V0KCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdmaWxsLW9wYWNpdHknLCBhLCBuYW1lICsgMiApO1xyXG4gICAgICAgIHRoaXMuY01vZGVbbmFtZV0gPSBuO1xyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcblxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEVWRU5UU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICBcdGxldCBudXAgPSBmYWxzZTtcclxuICAgICAgICAvL3RoaXMuaXNEb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgd2hpbGUoaS0tKXsgXHJcbiAgICAgICAgICAgIGlmKCB0aGlzLmNNb2RlW2ldICE9PSAwICl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNNb2RlW2ldID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdmaWxsLW9wYWNpdHknLCAwLjMsIGkgKyAyICk7XHJcbiAgICAgICAgICAgICAgICBudXAgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVwO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZXVwICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuICAgICAgICBpZiggdGhpcy5jdXJyZW50ICE9PSAtMSApIHJldHVybiB0aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICBcdHRoaXMuaXNEb3duID0gdHJ1ZTtcclxuICAgICAgICByZXR1cm4gdGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vtb3ZlICggZSApIHtcclxuXHJcbiAgICBcdGxldCBudXAgPSBmYWxzZTtcclxuXHJcbiAgICBcdGxldCBuYW1lID0gdGhpcy50ZXN0Wm9uZShlKTtcclxuXHJcbiAgICBcdGlmKCBuYW1lID09PSAnJyApe1xyXG5cclxuICAgICAgICAgICAgbnVwID0gdGhpcy5yZXNldCgpO1xyXG4gICAgICAgICAgICAvL3RoaXMuY3Vyc29yKCk7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7IFxyXG5cclxuICAgICAgICAgICAgbnVwID0gdGhpcy5tb2RlKCB0aGlzLmlzRG93biA/IDIgOiAxLCBuYW1lICk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5jdXJzb3IoIHRoaXMuY3VycmVudCAhPT0gLTEgPyAnbW92ZScgOiAncG9pbnRlcicgKTtcclxuICAgICAgICAgICAgaWYodGhpcy5pc0Rvd24pe1xyXG4gICAgICAgICAgICBcdHRoaXMudltuYW1lXSA9IHRoaXMuY2xhbXAoIDEgLSAoKCBlLmNsaWVudFkgLSB0aGlzLnpvbmUueSAtIHRoaXMudG9wIC0gMTAgKSAvIHRoaXMuZ2gpICwgMCwgMSApO1xyXG4gICAgICAgICAgICBcdHRoaXMudXBkYXRlKCB0cnVlICk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVwO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgdXBkYXRlICggdXAgKSB7XHJcblxyXG4gICAgXHR0aGlzLnVwZGF0ZVNWRygpO1xyXG5cclxuICAgICAgICBpZiggdXAgKSB0aGlzLnNlbmQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbWFrZVBhdGggKCkge1xyXG5cclxuICAgIFx0bGV0IHAgPSBcIlwiLCBoLCB3LCB3biwgd20sIG93LCBvaDtcclxuICAgIFx0Ly9sZXQgZyA9IHRoaXMuaXcqMC41XHJcblxyXG4gICAgXHRmb3IobGV0IGkgPSAwOyBpPHRoaXMubG5nOyBpKysgKXtcclxuXHJcbiAgICBcdFx0aCA9IDE0ICsgKHRoaXMuZ2ggLSB0aGlzLnZbaV0qdGhpcy5naCk7XHJcbiAgICBcdFx0dyA9ICgxNCArIChpKnRoaXMuaXcpICsgKGkqNCkpO1xyXG5cclxuICAgIFx0XHR3bSA9IHcgKyB0aGlzLml3KjAuNTtcclxuICAgIFx0XHR3biA9IHcgKyB0aGlzLml3O1xyXG5cclxuICAgIFx0XHRpZihpPT09MCkgcCs9J00gJyt3KycgJysgaCArICcgVCAnICsgd20gKycgJysgaDtcclxuICAgIFx0XHRlbHNlIHAgKz0gJyBDICcgKyBvdyArJyAnKyBvaCArICcsJyArIHcgKycgJysgaCArICcsJyArIHdtICsnICcrIGg7XHJcbiAgICBcdFx0aWYoaSA9PT0gdGhpcy5sbmctMSkgcCs9JyBUICcgKyB3biArJyAnKyBoO1xyXG5cclxuICAgIFx0XHRvdyA9IHduXHJcbiAgICBcdFx0b2ggPSBoIFxyXG5cclxuICAgIFx0fVxyXG5cclxuICAgIFx0cmV0dXJuIHA7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJTaXplICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIuclNpemUoKTtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgaWYoIHRoaXMuY1sxXSAhPT0gdW5kZWZpbmVkICkgc1sxXS53aWR0aCA9IHRoaXMudyArICdweCc7XHJcbiAgICAgICAgc1syXS53aWR0aCA9IHRoaXMudyArICdweCc7XHJcbiAgICAgICAgc1szXS53aWR0aCA9IHRoaXMudyArICdweCc7XHJcblxyXG4gICAgICAgIGxldCBndyA9IHRoaXMudyAtIDI4O1xyXG4gICAgICAgIGxldCBpdyA9ICgoZ3ctKDQqKHRoaXMubG5nLTEpKSkvdGhpcy5sbmcpO1xyXG5cclxuICAgICAgICBsZXQgdCA9IFtdO1xyXG5cclxuICAgICAgICBmb3IoIGxldCBpID0gMDsgaSA8IHRoaXMubG5nOyBpKysgKXtcclxuXHJcbiAgICAgICAgICAgIHRbaV0gPSBbIDE0ICsgKGkqaXcpICsgKGkqNCksIGl3IF07XHJcbiAgICAgICAgICAgIHRbaV1bMl0gPSB0W2ldWzBdICsgdFtpXVsxXTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnRtcCA9IHQ7XHJcblxyXG4gICAgfVxyXG5cclxufSIsIlxyXG5pbXBvcnQgeyBSb290cyB9IGZyb20gJy4uL2NvcmUvUm9vdHMnO1xyXG5pbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdyb3VwIGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcblxyXG4gICAgICAgIHRoaXMuQUREID0gby5hZGQ7XHJcblxyXG4gICAgICAgIHRoaXMudWlzID0gW107XHJcblxyXG4gICAgICAgIHRoaXMuYXV0b0hlaWdodCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gLTE7XHJcbiAgICAgICAgdGhpcy50YXJnZXQgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLmRlY2FsID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5iYXNlSCA9IHRoaXMuaDtcclxuXHJcbiAgICAgICAgbGV0IGZsdG9wID0gTWF0aC5mbG9vcih0aGlzLmgqMC41KS02O1xyXG5cclxuICAgICAgICB0aGlzLmlzTGluZSA9IG8ubGluZSAhPT0gdW5kZWZpbmVkID8gby5saW5lIDogZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnd2lkdGg6MTAwJTsgbGVmdDowOyBoZWlnaHQ6YXV0bzsgb3ZlcmZsb3c6aGlkZGVuOyB0b3A6Jyt0aGlzLmgrJ3B4Jyk7XHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdwYXRoJywgdGhpcy5jc3MuYmFzaWMgKyAncG9zaXRpb246YWJzb2x1dGU7IHdpZHRoOjEwcHg7IGhlaWdodDoxMHB4OyBsZWZ0OjA7IHRvcDonK2ZsdG9wKydweDsnLCB7IGQ6dGhpcy5zdmdzLmdyb3VwLCBmaWxsOnRoaXMuZm9udENvbG9yLCBzdHJva2U6J25vbmUnfSk7XHJcbiAgICAgICAgdGhpcy5jWzRdID0gdGhpcy5kb20oICdwYXRoJywgdGhpcy5jc3MuYmFzaWMgKyAncG9zaXRpb246YWJzb2x1dGU7IHdpZHRoOjEwcHg7IGhlaWdodDoxMHB4OyBsZWZ0OjRweDsgdG9wOicrZmx0b3ArJ3B4OycsIHsgZDp0aGlzLnN2Z3MuYXJyb3csIGZpbGw6dGhpcy5mb250Q29sb3IsIHN0cm9rZTonbm9uZSd9KTtcclxuICAgICAgICAvLyBib3R0b20gbGluZVxyXG4gICAgICAgIGlmKHRoaXMuaXNMaW5lKSB0aGlzLmNbNV0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgICdiYWNrZ3JvdW5kOnJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKTsgd2lkdGg6MTAwJTsgbGVmdDowOyBoZWlnaHQ6MXB4OyBib3R0b206MHB4Jyk7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG5cclxuICAgICAgICBzWzBdLmhlaWdodCA9IHRoaXMuaCArICdweCc7XHJcbiAgICAgICAgc1sxXS5oZWlnaHQgPSB0aGlzLmggKyAncHgnO1xyXG4gICAgICAgIHRoaXMuY1sxXS5uYW1lID0gJ2dyb3VwJztcclxuXHJcbiAgICAgICAgc1sxXS5tYXJnaW5MZWZ0ID0gJzEwcHgnO1xyXG4gICAgICAgIHNbMV0ubGluZUhlaWdodCA9IHRoaXMuaC00O1xyXG4gICAgICAgIHNbMV0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICBzWzFdLmZvbnRXZWlnaHQgPSAnYm9sZCc7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnJhZGl1cyAhPT0gMCApIHNbMF0uYm9yZGVyUmFkaXVzID0gdGhpcy5yYWRpdXMrJ3B4JzsgXHJcbiAgICAgICAgc1swXS5ib3JkZXIgPSB0aGlzLmNvbG9ycy5ncm91cEJvcmRlcjtcclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgICAgIGlmKCBvLmJnICE9PSB1bmRlZmluZWQgKSB0aGlzLnNldEJHKG8uYmcpO1xyXG4gICAgICAgIGlmKCBvLm9wZW4gIT09IHVuZGVmaW5lZCApIHRoaXMub3BlbigpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB0ZXN0Wm9uZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBsID0gdGhpcy5sb2NhbDtcclxuICAgICAgICBpZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICkgcmV0dXJuICcnO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9ICcnO1xyXG5cclxuICAgICAgICBpZiggbC55IDwgdGhpcy5iYXNlSCApIG5hbWUgPSAndGl0bGUnO1xyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiggdGhpcy5pc09wZW4gKSBuYW1lID0gJ2NvbnRlbnQnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG5hbWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyVGFyZ2V0ICgpIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuY3VycmVudCA9PT0gLTEgKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgLy8gaWYoIXRoaXMudGFyZ2V0KSByZXR1cm47XHJcbiAgICAgICAgdGhpcy50YXJnZXQudWlvdXQoKTtcclxuICAgICAgICB0aGlzLnRhcmdldC5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudCA9IC0xO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmN1cnNvcigpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXNldCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXJUYXJnZXQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBoYW5kbGVFdmVudCAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCB0eXBlID0gZS50eXBlO1xyXG5cclxuICAgICAgICBsZXQgY2hhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IHRhcmdldENoYW5nZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgaWYoICFuYW1lICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBzd2l0Y2goIG5hbWUgKXtcclxuXHJcbiAgICAgICAgICAgIGNhc2UgJ2NvbnRlbnQnOlxyXG4gICAgICAgICAgICB0aGlzLmN1cnNvcigpO1xyXG5cclxuICAgICAgICAgICAgaWYoIFJvb3RzLmlzTW9iaWxlICYmIHR5cGUgPT09ICdtb3VzZWRvd24nICkgdGhpcy5nZXROZXh0KCBlLCBjaGFuZ2UgKTtcclxuXHJcbiAgICAgICAgICAgIGlmKCB0aGlzLnRhcmdldCApIHRhcmdldENoYW5nZSA9IHRoaXMudGFyZ2V0LmhhbmRsZUV2ZW50KCBlICk7XHJcblxyXG4gICAgICAgICAgICAvL2lmKCB0eXBlID09PSAnbW91c2Vtb3ZlJyApIGNoYW5nZSA9IHRoaXMuc3R5bGVzKCdkZWYnKTtcclxuXHJcbiAgICAgICAgICAgIGlmKCAhUm9vdHMubG9jayApIHRoaXMuZ2V0TmV4dCggZSwgY2hhbmdlICk7XHJcblxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAndGl0bGUnOlxyXG4gICAgICAgICAgICB0aGlzLmN1cnNvcigncG9pbnRlcicpO1xyXG4gICAgICAgICAgICBpZiggdHlwZSA9PT0gJ21vdXNlZG93bicgKXtcclxuICAgICAgICAgICAgICAgIGlmKCB0aGlzLmlzT3BlbiApIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIGVsc2UgdGhpcy5vcGVuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzRG93biApIGNoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgaWYoIHRhcmdldENoYW5nZSApIGNoYW5nZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHJldHVybiBjaGFuZ2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldE5leHQgKCBlLCBjaGFuZ2UgKSB7XHJcblxyXG4gICAgICAgIGxldCBuZXh0ID0gUm9vdHMuZmluZFRhcmdldCggdGhpcy51aXMsIGUgKTtcclxuXHJcbiAgICAgICAgaWYoIG5leHQgIT09IHRoaXMuY3VycmVudCApe1xyXG4gICAgICAgICAgICB0aGlzLmNsZWFyVGFyZ2V0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IG5leHQ7XHJcbiAgICAgICAgICAgIGNoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggbmV4dCAhPT0gLTEgKXsgXHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGhpcy51aXNbIHRoaXMuY3VycmVudCBdO1xyXG4gICAgICAgICAgICB0aGlzLnRhcmdldC51aW92ZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBjYWxjSCAoKSB7XHJcblxyXG4gICAgICAgIGxldCBsbmcgPSB0aGlzLnVpcy5sZW5ndGgsIGksIHUsICBoPTAsIHB4PTAsIHRtcGg9MDtcclxuICAgICAgICBmb3IoIGkgPSAwOyBpIDwgbG5nOyBpKyspe1xyXG4gICAgICAgICAgICB1ID0gdGhpcy51aXNbaV07XHJcbiAgICAgICAgICAgIGlmKCAhdS5hdXRvV2lkdGggKXtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihweD09PTApIGggKz0gdS5oKzE7XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZih0bXBoPHUuaCkgaCArPSB1LmgtdG1waDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRtcGggPSB1Lmg7XHJcblxyXG4gICAgICAgICAgICAgICAgLy90bXBoID0gdG1waCA8IHUuaCA/IHUuaCA6IHRtcGg7XHJcbiAgICAgICAgICAgICAgICBweCArPSB1Lnc7XHJcbiAgICAgICAgICAgICAgICBpZiggcHgrdS53ID4gdGhpcy53ICkgcHggPSAwO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGggKz0gdS5oKzE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gaDtcclxuICAgIH1cclxuXHJcbiAgICBjYWxjVWlzICgpIHtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzT3BlbiApIHJldHVybjtcclxuXHJcbiAgICAgICAgUm9vdHMuY2FsY1VpcyggdGhpcy51aXMsIHRoaXMuem9uZSwgdGhpcy56b25lLnkgKyB0aGlzLmJhc2VIICk7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzZXRCRyAoIGMgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc1swXS5iYWNrZ3JvdW5kID0gYztcclxuXHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLnVpcy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUoaS0tKXtcclxuICAgICAgICAgICAgdGhpcy51aXNbaV0uc2V0QkcoIGMgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFkZCAoKSB7XHJcblxyXG4gICAgICAgIGxldCBhID0gYXJndW1lbnRzO1xyXG5cclxuICAgICAgICBpZiggdHlwZW9mIGFbMV0gPT09ICdvYmplY3QnICl7IFxyXG4gICAgICAgICAgICBhWzFdLmlzVUkgPSB0aGlzLmlzVUk7XHJcbiAgICAgICAgICAgIGFbMV0udGFyZ2V0ID0gdGhpcy5jWzJdO1xyXG4gICAgICAgICAgICBhWzFdLm1haW4gPSB0aGlzLm1haW47XHJcbiAgICAgICAgfSBlbHNlIGlmKCB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnc3RyaW5nJyApe1xyXG4gICAgICAgICAgICBpZiggYVsyXSA9PT0gdW5kZWZpbmVkICkgW10ucHVzaC5jYWxsKGEsIHsgaXNVSTp0cnVlLCB0YXJnZXQ6dGhpcy5jWzJdLCBtYWluOnRoaXMubWFpbiB9KTtcclxuICAgICAgICAgICAgZWxzZXsgXHJcbiAgICAgICAgICAgICAgICBhWzJdLmlzVUkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYVsyXS50YXJnZXQgPSB0aGlzLmNbMl07XHJcbiAgICAgICAgICAgICAgICBhWzJdLm1haW4gPSB0aGlzLm1haW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vbGV0IG4gPSBhZGQuYXBwbHkoIHRoaXMsIGEgKTtcclxuICAgICAgICBsZXQgbiA9IHRoaXMuQURELmFwcGx5KCB0aGlzLCBhICk7XHJcbiAgICAgICAgdGhpcy51aXMucHVzaCggbiApO1xyXG5cclxuICAgICAgICBpZiggbi5hdXRvSGVpZ2h0ICkgbi5wYXJlbnRHcm91cCA9IHRoaXM7XHJcblxyXG4gICAgICAgIHJldHVybiBuO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwYXJlbnRIZWlnaHQgKCB0ICkge1xyXG5cclxuICAgICAgICBpZiAoIHRoaXMucGFyZW50R3JvdXAgIT09IG51bGwgKSB0aGlzLnBhcmVudEdyb3VwLmNhbGMoIHQgKTtcclxuICAgICAgICBlbHNlIGlmICggdGhpcy5pc1VJICkgdGhpcy5tYWluLmNhbGMoIHQgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb3BlbiAoKSB7XHJcblxyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1s0XSwgJ2QnLCB0aGlzLnN2Z3MuYXJyb3dEb3duICk7XHJcbiAgICAgICAgdGhpcy5yU2l6ZUNvbnRlbnQoKTtcclxuXHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLmggLSB0aGlzLmJhc2VIO1xyXG5cclxuICAgICAgICB0aGlzLnBhcmVudEhlaWdodCggdCApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSAoKSB7XHJcblxyXG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XHJcblxyXG4gICAgICAgIGxldCB0ID0gdGhpcy5oIC0gdGhpcy5iYXNlSDtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1s0XSwgJ2QnLCB0aGlzLnN2Z3MuYXJyb3cgKTtcclxuICAgICAgICB0aGlzLmggPSB0aGlzLmJhc2VIO1xyXG4gICAgICAgIHRoaXMuc1swXS5oZWlnaHQgPSB0aGlzLmggKyAncHgnO1xyXG5cclxuICAgICAgICB0aGlzLnBhcmVudEhlaWdodCggLXQgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXIgKCkge1xyXG5cclxuICAgICAgICB0aGlzLmNsZWFyR3JvdXAoKTtcclxuICAgICAgICBpZiggdGhpcy5pc1VJICkgdGhpcy5tYWluLmNhbGMoIC0odGhpcy5oICsxICkpO1xyXG4gICAgICAgIFByb3RvLnByb3RvdHlwZS5jbGVhci5jYWxsKCB0aGlzICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyR3JvdXAgKCkge1xyXG5cclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy51aXMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlKGktLSl7XHJcbiAgICAgICAgICAgIHRoaXMudWlzW2ldLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMudWlzLnBvcCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnVpcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuaCA9IHRoaXMuYmFzZUg7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNhbGMgKCB5ICkge1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuaXNPcGVuICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiggeSAhPT0gdW5kZWZpbmVkICl7IFxyXG4gICAgICAgICAgICB0aGlzLmggKz0geTtcclxuICAgICAgICAgICAgaWYoIHRoaXMuaXNVSSApIHRoaXMubWFpbi5jYWxjKCB5ICk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5oID0gdGhpcy5jYWxjSCgpICsgdGhpcy5iYXNlSDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zWzBdLmhlaWdodCA9IHRoaXMuaCArICdweCc7XHJcblxyXG4gICAgICAgIC8vaWYodGhpcy5pc09wZW4pIHRoaXMuY2FsY1VpcygpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByU2l6ZUNvbnRlbnQgKCkge1xyXG5cclxuICAgICAgICBsZXQgaSA9IHRoaXMudWlzLmxlbmd0aDtcclxuICAgICAgICB3aGlsZShpLS0pe1xyXG4gICAgICAgICAgICB0aGlzLnVpc1tpXS5zZXRTaXplKCB0aGlzLncgKTtcclxuICAgICAgICAgICAgdGhpcy51aXNbaV0uclNpemUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYWxjKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJTaXplICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIuclNpemUoKTtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcblxyXG4gICAgICAgIHNbM10ubGVmdCA9ICggdGhpcy5zYSArIHRoaXMuc2IgLSAxNyApICsgJ3B4JztcclxuICAgICAgICBzWzFdLndpZHRoID0gdGhpcy53ICsgJ3B4JztcclxuICAgICAgICBzWzJdLndpZHRoID0gdGhpcy53ICsgJ3B4JztcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNPcGVuICkgdGhpcy5yU2l6ZUNvbnRlbnQoKTtcclxuXHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5Hcm91cC5wcm90b3R5cGUuaXNHcm91cCA9IHRydWU7IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuaW1wb3J0IHsgVjIgfSBmcm9tICcuLi9jb3JlL1YyJztcclxuXHJcbmV4cG9ydCBjbGFzcyBKb3lzdGljayBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG5cclxuICAgICAgICB0aGlzLmF1dG9XaWR0aCA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlID0gWzAsMF07XHJcblxyXG4gICAgICAgIHRoaXMuam95VHlwZSA9ICdhbmFsb2dpcXVlJztcclxuICAgICAgICB0aGlzLm1vZGVsID0gby5tb2RlICE9PSB1bmRlZmluZWQgPyBvLm1vZGUgOiAwO1xyXG5cclxuICAgICAgICB0aGlzLnByZWNpc2lvbiA9IG8ucHJlY2lzaW9uIHx8IDI7XHJcbiAgICAgICAgdGhpcy5tdWx0aXBsaWNhdG9yID0gby5tdWx0aXBsaWNhdG9yIHx8IDE7XHJcblxyXG4gICAgICAgIHRoaXMucG9zID0gbmV3IFYyKCk7XHJcbiAgICAgICAgdGhpcy50bXAgPSBuZXcgVjIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbnRlcnZhbCA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMucmFkaXVzID0gdGhpcy53ICogMC41O1xyXG4gICAgICAgIHRoaXMuZGlzdGFuY2UgPSB0aGlzLnJhZGl1cyowLjI1O1xyXG5cclxuICAgICAgICB0aGlzLmggPSBvLmggfHwgdGhpcy53ICsgMTA7XHJcbiAgICAgICAgdGhpcy50b3AgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmNbMF0uc3R5bGUud2lkdGggPSB0aGlzLncgKydweCc7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmNbMV0gIT09IHVuZGVmaW5lZCApIHsgLy8gd2l0aCB0aXRsZVxyXG5cclxuICAgICAgICAgICAgdGhpcy5jWzFdLnN0eWxlLndpZHRoID0gdGhpcy53ICsncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbMV0uc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7XHJcbiAgICAgICAgICAgIHRoaXMudG9wID0gMTA7XHJcbiAgICAgICAgICAgIHRoaXMuaCArPSAxMDtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmNbMl0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dCArICd0ZXh0LWFsaWduOmNlbnRlcjsgdG9wOicrKHRoaXMuaC0yMCkrJ3B4OyB3aWR0aDonK3RoaXMudysncHg7IGNvbG9yOicrIHRoaXMuZm9udENvbG9yICk7XHJcbiAgICAgICAgdGhpcy5jWzJdLnRleHRDb250ZW50ID0gdGhpcy52YWx1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5nZXRKb3lzdGljayggdGhpcy5tb2RlbCApO1xyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICd2aWV3Qm94JywgJzAgMCAnK3RoaXMudysnICcrdGhpcy53ICk7XHJcbiAgICAgICAgdGhpcy5zZXRDc3MoIHRoaXMuY1szXSwgeyB3aWR0aDp0aGlzLncsIGhlaWdodDp0aGlzLncsIGxlZnQ6MCwgdG9wOnRoaXMudG9wIH0pO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5yYXRpbyA9IDEyOC90aGlzLnc7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZShmYWxzZSk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgbW9kZSAoIG1vZGUgKSB7XHJcblxyXG4gICAgICAgIHN3aXRjaChtb2RlKXtcclxuICAgICAgICAgICAgY2FzZSAwOiAvLyBiYXNlXHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLm1vZGVsPT09MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2ZpbGwnLCAndXJsKCNncmFkSW4pJywgNCApO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCAnIzAwMCcsIDQgKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsICdyZ2JhKDEwMCwxMDAsMTAwLDAuMjUpJywgMiApO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsICdyZ2IoMCwwLDAsMC4xKScsIDMgKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnc3Ryb2tlJywgJyM2NjYnLCA0ICk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2ZpbGwnLCAnbm9uZScsIDQgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiAvLyBvdmVyXHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLm1vZGVsPT09MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2ZpbGwnLCAndXJsKCNncmFkSW4yKScsIDQgKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnc3Ryb2tlJywgJ3JnYmEoMCwwLDAsMCknLCA0ICk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCAncmdiYSg0OCwxMzgsMjU1LDAuMjUpJywgMiApO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsICdyZ2IoMCwwLDAsMC4zKScsIDMgKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnc3Ryb2tlJywgdGhpcy5jb2xvcnMuc2VsZWN0LCA0ICk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2ZpbGwnLCAncmdiYSg0OCwxMzgsMjU1LDAuMjUpJywgNCApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOiAvLyBlZGl0XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBhZGRJbnRlcnZhbCAoKXtcclxuICAgICAgICBpZiggdGhpcy5pbnRlcnZhbCAhPT0gbnVsbCApIHRoaXMuc3RvcEludGVydmFsKCk7XHJcbiAgICAgICAgaWYoIHRoaXMucG9zLmlzWmVybygpICkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCggZnVuY3Rpb24oKXsgdGhpcy51cGRhdGUoKTsgfS5iaW5kKHRoaXMpLCAxMCApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzdG9wSW50ZXJ2YWwgKCl7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmludGVydmFsID09PSBudWxsICkgcmV0dXJuO1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwoIHRoaXMuaW50ZXJ2YWwgKTtcclxuICAgICAgICB0aGlzLmludGVydmFsID0gbnVsbDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXQgKCkge1xyXG5cclxuICAgICAgICB0aGlzLmFkZEludGVydmFsKCk7XHJcbiAgICAgICAgdGhpcy5tb2RlKDApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZXVwICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRJbnRlcnZhbCgpO1xyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICBcclxuICAgIH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgICAgICB0aGlzLmlzRG93biA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuICAgICAgICB0aGlzLm1vZGUoIDIgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vtb3ZlICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5tb2RlKDEpO1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuaXNEb3duICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLnRtcC54ID0gdGhpcy5yYWRpdXMgLSAoIGUuY2xpZW50WCAtIHRoaXMuem9uZS54ICk7XHJcbiAgICAgICAgdGhpcy50bXAueSA9IHRoaXMucmFkaXVzIC0gKCBlLmNsaWVudFkgLSB0aGlzLnpvbmUueSAtIHRoaXMudG9wICk7XHJcblxyXG4gICAgICAgIGxldCBkaXN0YW5jZSA9IHRoaXMudG1wLmxlbmd0aCgpO1xyXG5cclxuICAgICAgICBpZiAoIGRpc3RhbmNlID4gdGhpcy5kaXN0YW5jZSApIHtcclxuICAgICAgICAgICAgbGV0IGFuZ2xlID0gTWF0aC5hdGFuMih0aGlzLnRtcC54LCB0aGlzLnRtcC55KTtcclxuICAgICAgICAgICAgdGhpcy50bXAueCA9IE1hdGguc2luKCBhbmdsZSApICogdGhpcy5kaXN0YW5jZTtcclxuICAgICAgICAgICAgdGhpcy50bXAueSA9IE1hdGguY29zKCBhbmdsZSApICogdGhpcy5kaXN0YW5jZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucG9zLmNvcHkoIHRoaXMudG1wICkuZGl2aWRlU2NhbGFyKCB0aGlzLmRpc3RhbmNlICkubmVnYXRlKCk7XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNldFZhbHVlICggdiApIHtcclxuXHJcbiAgICAgICAgaWYodj09PXVuZGVmaW5lZCkgdj1bMCwwXTtcclxuXHJcbiAgICAgICAgdGhpcy5wb3Muc2V0KCB2WzBdIHx8IDAsIHZbMV0gIHx8IDAgKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVNWRygpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUgKCB1cCApIHtcclxuXHJcbiAgICAgICAgaWYoIHVwID09PSB1bmRlZmluZWQgKSB1cCA9IHRydWU7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmludGVydmFsICE9PSBudWxsICl7XHJcblxyXG4gICAgICAgICAgICBpZiggIXRoaXMuaXNEb3duICl7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5wb3MubGVycCggbnVsbCwgMC4zICk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5wb3MueCA9IE1hdGguYWJzKCB0aGlzLnBvcy54ICkgPCAwLjAxID8gMCA6IHRoaXMucG9zLng7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBvcy55ID0gTWF0aC5hYnMoIHRoaXMucG9zLnkgKSA8IDAuMDEgPyAwIDogdGhpcy5wb3MueTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiggdGhpcy5pc1VJICYmIHRoaXMubWFpbi5pc0NhbnZhcyApIHRoaXMubWFpbi5kcmF3KCk7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGVTVkcoKTtcclxuXHJcbiAgICAgICAgaWYoIHVwICkgdGhpcy5zZW5kKCk7XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnBvcy5pc1plcm8oKSApIHRoaXMuc3RvcEludGVydmFsKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZVNWRyAoKSB7XHJcblxyXG4gICAgICAgIGxldCB4ID0gdGhpcy5yYWRpdXMgLSAoIC10aGlzLnBvcy54ICogdGhpcy5kaXN0YW5jZSApO1xyXG4gICAgICAgIGxldCB5ID0gdGhpcy5yYWRpdXMgLSAoIC10aGlzLnBvcy55ICogdGhpcy5kaXN0YW5jZSApO1xyXG5cclxuICAgICAgICAgaWYodGhpcy5tb2RlbCA9PT0gMCl7XHJcblxyXG4gICAgICAgICAgICBsZXQgc3ggPSB4ICsgKCh0aGlzLnBvcy54KSo1KSArIDU7XHJcbiAgICAgICAgICAgIGxldCBzeSA9IHkgKyAoKHRoaXMucG9zLnkpKjUpICsgMTA7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnY3gnLCBzeCp0aGlzLnJhdGlvLCAzICk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdjeScsIHN5KnRoaXMucmF0aW8sIDMgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnY3gnLCB4KnRoaXMucmF0aW8sIDMgKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2N5JywgeSp0aGlzLnJhdGlvLCAzICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBcclxuXHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2N4JywgeCp0aGlzLnJhdGlvLCA0ICk7XHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2N5JywgeSp0aGlzLnJhdGlvLCA0ICk7XHJcblxyXG4gICAgICAgIHRoaXMudmFsdWVbMF0gPSAgKCB0aGlzLnBvcy54ICogdGhpcy5tdWx0aXBsaWNhdG9yICkudG9GaXhlZCggdGhpcy5wcmVjaXNpb24gKSAqIDE7XHJcbiAgICAgICAgdGhpcy52YWx1ZVsxXSA9ICAoIHRoaXMucG9zLnkgKiB0aGlzLm11bHRpcGxpY2F0b3IgKS50b0ZpeGVkKCB0aGlzLnByZWNpc2lvbiApICogMTtcclxuXHJcbiAgICAgICAgdGhpcy5jWzJdLnRleHRDb250ZW50ID0gdGhpcy52YWx1ZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXIgKCkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc3RvcEludGVydmFsKCk7XHJcbiAgICAgICAgc3VwZXIuY2xlYXIoKTtcclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuaW1wb3J0IHsgQ2lyY3VsYXIgfSBmcm9tICcuL0NpcmN1bGFyJztcclxuaW1wb3J0IHsgVjIgfSBmcm9tICcuLi9jb3JlL1YyJztcclxuXHJcbmV4cG9ydCBjbGFzcyBLbm9iIGV4dGVuZHMgQ2lyY3VsYXIge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcblxyXG4gICAgICAgIHRoaXMuYXV0b1dpZHRoID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuYnV0dG9uQ29sb3IgPSB0aGlzLmNvbG9ycy5idXR0b247XHJcblxyXG4gICAgICAgIHRoaXMuc2V0VHlwZU51bWJlciggbyApO1xyXG5cclxuICAgICAgICB0aGlzLm1QSSA9IE1hdGguUEkgKiAwLjg7XHJcbiAgICAgICAgdGhpcy50b0RlZyA9IDE4MCAvIE1hdGguUEk7XHJcbiAgICAgICAgdGhpcy5jaXJSYW5nZSA9IHRoaXMubVBJICogMjtcclxuXHJcbiAgICAgICAgdGhpcy5vZmZzZXQgPSBuZXcgVjIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5yYWRpdXMgPSB0aGlzLncgKiAwLjU7Ly9NYXRoLmZsb29yKCh0aGlzLnctMjApKjAuNSk7XHJcblxyXG4gICAgICAgIC8vdGhpcy53dyA9IHRoaXMuaGVpZ2h0ID0gdGhpcy5yYWRpdXMgKiAyO1xyXG4gICAgICAgIHRoaXMuaCA9IG8uaCB8fCB0aGlzLncgKyAxMDtcclxuICAgICAgICB0aGlzLnRvcCA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuY1swXS5zdHlsZS53aWR0aCA9IHRoaXMudyArJ3B4JztcclxuXHJcbiAgICAgICAgaWYodGhpcy5jWzFdICE9PSB1bmRlZmluZWQpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY1sxXS5zdHlsZS53aWR0aCA9IHRoaXMudyArJ3B4JztcclxuICAgICAgICAgICAgdGhpcy5jWzFdLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICB0aGlzLnRvcCA9IDEwO1xyXG4gICAgICAgICAgICB0aGlzLmggKz0gMTA7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5wZXJjZW50ID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5jbW9kZSA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0ICsgJ3RleHQtYWxpZ246Y2VudGVyOyB0b3A6JysodGhpcy5oLTIwKSsncHg7IHdpZHRoOicrdGhpcy53KydweDsgY29sb3I6JysgdGhpcy5mb250Q29sb3IgKTtcclxuXHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5nZXRLbm9iKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsIHRoaXMuZm9udENvbG9yLCAxICk7XHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3N0cm9rZScsIHRoaXMuZm9udENvbG9yLCAzICk7XHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2QnLCB0aGlzLm1ha2VHcmFkKCksIDMgKTtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ3ZpZXdCb3gnLCAnMCAwICcrdGhpcy53dysnICcrdGhpcy53dyApO1xyXG4gICAgICAgIHRoaXMuc2V0Q3NzKCB0aGlzLmNbM10sIHsgd2lkdGg6dGhpcy53LCBoZWlnaHQ6dGhpcy53LCBsZWZ0OjAsIHRvcDp0aGlzLnRvcCB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5yID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZGUgKCBtb2RlICkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5jbW9kZSA9PT0gbW9kZSApIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgc3dpdGNoKG1vZGUpe1xyXG4gICAgICAgICAgICBjYXNlIDA6IC8vIGJhc2VcclxuICAgICAgICAgICAgICAgIHRoaXMuc1syXS5jb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2ZpbGwnLHRoaXMuY29sb3JzLmJ1dHRvbiwgMCk7XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCdyZ2JhKDAsMCwwLDAuMiknLCAyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdzdHJva2UnLCB0aGlzLmZvbnRDb2xvciwgMSApO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiAvLyBvdmVyXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNbMl0uY29sb3IgPSB0aGlzLmNvbG9yUGx1cztcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICdmaWxsJyx0aGlzLmNvbG9ycy5zZWxlY3QsIDApO1xyXG4gICAgICAgICAgICAgICAgLy90aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnc3Ryb2tlJywncmdiYSgwLDAsMCwwLjYpJywgMik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnc3Ryb2tlJywgdGhpcy5jb2xvclBsdXMsIDEgKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmNtb2RlID0gbW9kZTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIC8vdGhpcy5tb2RlKDEpO1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuaXNEb3duICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQgb2ZmID0gdGhpcy5vZmZzZXQ7XHJcblxyXG4gICAgICAgIG9mZi54ID0gdGhpcy5yYWRpdXMgLSAoIGUuY2xpZW50WCAtIHRoaXMuem9uZS54ICk7XHJcbiAgICAgICAgb2ZmLnkgPSB0aGlzLnJhZGl1cyAtICggZS5jbGllbnRZIC0gdGhpcy56b25lLnkgLSB0aGlzLnRvcCApO1xyXG5cclxuICAgICAgICB0aGlzLnIgPSAtIE1hdGguYXRhbjIoIG9mZi54LCBvZmYueSApO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5vbGRyICE9PSBudWxsICkgdGhpcy5yID0gTWF0aC5hYnModGhpcy5yIC0gdGhpcy5vbGRyKSA+IE1hdGguUEkgPyB0aGlzLm9sZHIgOiB0aGlzLnI7XHJcblxyXG4gICAgICAgIHRoaXMuciA9IHRoaXMuciA+IHRoaXMubVBJID8gdGhpcy5tUEkgOiB0aGlzLnI7XHJcbiAgICAgICAgdGhpcy5yID0gdGhpcy5yIDwgLXRoaXMubVBJID8gLXRoaXMubVBJIDogdGhpcy5yO1xyXG5cclxuICAgICAgICBsZXQgc3RlcHMgPSAxIC8gdGhpcy5jaXJSYW5nZTtcclxuICAgICAgICBsZXQgdmFsdWUgPSAodGhpcy5yICsgdGhpcy5tUEkpICogc3RlcHM7XHJcblxyXG4gICAgICAgIGxldCBuID0gKCAoIHRoaXMucmFuZ2UgKiB2YWx1ZSApICsgdGhpcy5taW4gKSAtIHRoaXMub2xkO1xyXG5cclxuICAgICAgICBpZihuID49IHRoaXMuc3RlcCB8fCBuIDw9IHRoaXMuc3RlcCl7IFxyXG4gICAgICAgICAgICBuID0gTWF0aC5mbG9vciggbiAvIHRoaXMuc3RlcCApO1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5udW1WYWx1ZSggdGhpcy5vbGQgKyAoIG4gKiB0aGlzLnN0ZXAgKSApO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSggdHJ1ZSApO1xyXG4gICAgICAgICAgICB0aGlzLm9sZCA9IHRoaXMudmFsdWU7XHJcbiAgICAgICAgICAgIHRoaXMub2xkciA9IHRoaXMucjtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1ha2VHcmFkICgpIHtcclxuXHJcbiAgICAgICAgbGV0IGQgPSAnJywgc3RlcCwgcmFuZ2UsIGEsIHgsIHksIHgyLCB5MiwgciA9IDY0O1xyXG4gICAgICAgIGxldCBzdGFydGFuZ2xlID0gTWF0aC5QSSArIHRoaXMubVBJO1xyXG4gICAgICAgIGxldCBlbmRhbmdsZSA9IE1hdGguUEkgLSB0aGlzLm1QSTtcclxuICAgICAgICAvL2xldCBzdGVwID0gdGhpcy5zdGVwPjUgPyB0aGlzLnN0ZXAgOiAxO1xyXG5cclxuICAgICAgICBpZih0aGlzLnN0ZXA+NSl7XHJcbiAgICAgICAgICAgIHJhbmdlID0gIHRoaXMucmFuZ2UgLyB0aGlzLnN0ZXA7XHJcbiAgICAgICAgICAgIHN0ZXAgPSAoIHN0YXJ0YW5nbGUgLSBlbmRhbmdsZSApIC8gcmFuZ2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RlcCA9ICgoIHN0YXJ0YW5nbGUgLSBlbmRhbmdsZSApIC8gcikqMjtcclxuICAgICAgICAgICAgcmFuZ2UgPSByKjAuNTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAoIGxldCBpID0gMDsgaSA8PSByYW5nZTsgKytpICkge1xyXG5cclxuICAgICAgICAgICAgYSA9IHN0YXJ0YW5nbGUgLSAoIHN0ZXAgKiBpICk7XHJcbiAgICAgICAgICAgIHggPSByICsgTWF0aC5zaW4oIGEgKSAqICggciAtIDIwICk7XHJcbiAgICAgICAgICAgIHkgPSByICsgTWF0aC5jb3MoIGEgKSAqICggciAtIDIwICk7XHJcbiAgICAgICAgICAgIHgyID0gciArIE1hdGguc2luKCBhICkgKiAoIHIgLSAyNCApO1xyXG4gICAgICAgICAgICB5MiA9IHIgKyBNYXRoLmNvcyggYSApICogKCByIC0gMjQgKTtcclxuICAgICAgICAgICAgZCArPSAnTScgKyB4ICsgJyAnICsgeSArICcgTCcgKyB4MiArICcgJyt5MiArICcgJztcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlICggdXAgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWU7XHJcbiAgICAgICAgdGhpcy5wZXJjZW50ID0gKHRoaXMudmFsdWUgLSB0aGlzLm1pbikgLyB0aGlzLnJhbmdlO1xyXG5cclxuICAgICAgIC8vIGxldCByID0gNTA7XHJcbiAgICAgICAvLyBsZXQgZCA9IDY0OyBcclxuICAgICAgICBsZXQgciA9ICggKHRoaXMucGVyY2VudCAqIHRoaXMuY2lyUmFuZ2UpIC0gKHRoaXMubVBJKSkvLyogdGhpcy50b0RlZztcclxuXHJcbiAgICAgICAgbGV0IHNpbiA9IE1hdGguc2luKHIpO1xyXG4gICAgICAgIGxldCBjb3MgPSBNYXRoLmNvcyhyKTtcclxuXHJcbiAgICAgICAgbGV0IHgxID0gKDI1ICogc2luKSArIDY0O1xyXG4gICAgICAgIGxldCB5MSA9IC0oMjUgKiBjb3MpICsgNjQ7XHJcbiAgICAgICAgbGV0IHgyID0gKDIwICogc2luKSArIDY0O1xyXG4gICAgICAgIGxldCB5MiA9IC0oMjAgKiBjb3MpICsgNjQ7XHJcblxyXG4gICAgICAgIC8vdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2N4JywgeCwgMSApO1xyXG4gICAgICAgIC8vdGhpcy5zZXRTdmcoIHRoaXMuY1szXSwgJ2N5JywgeSwgMSApO1xyXG5cclxuICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzNdLCAnZCcsICdNICcgKyB4MSArJyAnICsgeTEgKyAnIEwgJyArIHgyICsnICcgKyB5MiwgMSApO1xyXG5cclxuICAgICAgICAvL3RoaXMuc2V0U3ZnKCB0aGlzLmNbM10sICd0cmFuc2Zvcm0nLCAncm90YXRlKCcrIHIgKycgJys2NCsnICcrNjQrJyknLCAxICk7XHJcblxyXG4gICAgICAgIGlmKCB1cCApIHRoaXMuc2VuZCgpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxufSIsImltcG9ydCB7IFByb3RvIH0gZnJvbSAnLi4vY29yZS9Qcm90byc7XHJcblxyXG5leHBvcnQgY2xhc3MgTGlzdCBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG5cclxuICAgICAgICAvLyBpbWFnZXNcclxuICAgICAgICB0aGlzLnBhdGggPSBvLnBhdGggfHwgJyc7XHJcbiAgICAgICAgdGhpcy5mb3JtYXQgPSBvLmZvcm1hdCB8fCAnJztcclxuICAgICAgICB0aGlzLmltYWdlU2l6ZSA9IG8uaW1hZ2VTaXplIHx8IFsyMCwyMF07XHJcblxyXG4gICAgICAgIHRoaXMuaXNXaXRoSW1hZ2UgPSB0aGlzLnBhdGggIT09ICcnID8gdHJ1ZTpmYWxzZTtcclxuICAgICAgICB0aGlzLnByZUxvYWRDb21wbGV0ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnRtcEltYWdlID0ge307XHJcbiAgICAgICAgdGhpcy50bXBVcmwgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5hdXRvSGVpZ2h0ID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IGFsaWduID0gby5hbGlnbiB8fCAnY2VudGVyJztcclxuXHJcbiAgICAgICAgdGhpcy5zTW9kZSA9IDA7XHJcbiAgICAgICAgdGhpcy50TW9kZSA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMubGlzdE9ubHkgPSBvLmxpc3RPbmx5IHx8IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmJ1dHRvbkNvbG9yID0gby5iQ29sb3IgfHwgdGhpcy5jb2xvcnMuYnV0dG9uO1xyXG5cclxuICAgICAgICBsZXQgZmx0b3AgPSBNYXRoLmZsb29yKHRoaXMuaCowLjUpLTU7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAndG9wOjA7IGRpc3BsYXk6bm9uZTsnICk7XHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy50eHQgKyAndGV4dC1hbGlnbjonK2FsaWduKyc7IGxpbmUtaGVpZ2h0OicrKHRoaXMuaC00KSsncHg7IHRvcDoxcHg7IGJhY2tncm91bmQ6Jyt0aGlzLmJ1dHRvbkNvbG9yKyc7IGhlaWdodDonKyh0aGlzLmgtMikrJ3B4OyBib3JkZXItcmFkaXVzOicrdGhpcy5yYWRpdXMrJ3B4OycgKTtcclxuICAgICAgICB0aGlzLmNbNF0gPSB0aGlzLmRvbSggJ3BhdGgnLCB0aGlzLmNzcy5iYXNpYyArICdwb3NpdGlvbjphYnNvbHV0ZTsgd2lkdGg6MTBweDsgaGVpZ2h0OjEwcHg7IHRvcDonK2ZsdG9wKydweDsnLCB7IGQ6dGhpcy5zdmdzLmFycm93LCBmaWxsOnRoaXMuZm9udENvbG9yLCBzdHJva2U6J25vbmUnfSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2Nyb2xsZXIgPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ3JpZ2h0OjVweDsgIHdpZHRoOjEwcHg7IGJhY2tncm91bmQ6IzY2NjsgZGlzcGxheTpub25lOycpO1xyXG5cclxuICAgICAgICB0aGlzLmNbM10uc3R5bGUuY29sb3IgPSB0aGlzLmZvbnRDb2xvcjtcclxuXHJcbiAgICAgICAgdGhpcy5saXN0ID0gby5saXN0IHx8IFtdO1xyXG4gICAgICAgIHRoaXMuaXRlbXMgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5wcmV2TmFtZSA9ICcnO1xyXG5cclxuICAgICAgICB0aGlzLmJhc2VIID0gdGhpcy5oO1xyXG5cclxuICAgICAgICB0aGlzLml0ZW1IZWlnaHQgPSBvLml0ZW1IZWlnaHQgfHwgKHRoaXMuaC0zKTtcclxuXHJcbiAgICAgICAgLy8gZm9yY2UgZnVsbCBsaXN0IFxyXG4gICAgICAgIHRoaXMuZnVsbCA9IG8uZnVsbCB8fCBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5weSA9IDA7XHJcbiAgICAgICAgdGhpcy53dyA9IHRoaXMuc2I7XHJcbiAgICAgICAgdGhpcy5zY3JvbGwgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBsaXN0IHVwIG9yIGRvd25cclxuICAgICAgICB0aGlzLnNpZGUgPSBvLnNpZGUgfHwgJ2Rvd24nO1xyXG4gICAgICAgIHRoaXMudXAgPSB0aGlzLnNpZGUgPT09ICdkb3duJyA/IDAgOiAxO1xyXG5cclxuICAgICAgICBpZiggdGhpcy51cCApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jWzJdLnN0eWxlLnRvcCA9ICdhdXRvJztcclxuICAgICAgICAgICAgdGhpcy5jWzNdLnN0eWxlLnRvcCA9ICdhdXRvJztcclxuICAgICAgICAgICAgdGhpcy5jWzRdLnN0eWxlLnRvcCA9ICdhdXRvJztcclxuICAgICAgICAgICAgLy90aGlzLmNbNV0uc3R5bGUudG9wID0gJ2F1dG8nO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jWzJdLnN0eWxlLmJvdHRvbSA9IHRoaXMuaC0yICsgJ3B4JztcclxuICAgICAgICAgICAgdGhpcy5jWzNdLnN0eWxlLmJvdHRvbSA9ICcxcHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNF0uc3R5bGUuYm90dG9tID0gZmx0b3AgKyAncHgnO1xyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNbMl0uc3R5bGUudG9wID0gdGhpcy5iYXNlSCArICdweCc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmxpc3RJbiA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnbGVmdDowOyB0b3A6MDsgd2lkdGg6MTAwJTsgYmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuMik7Jyk7XHJcbiAgICAgICAgdGhpcy5saXN0SW4ubmFtZSA9ICdsaXN0JztcclxuXHJcbiAgICAgICAgdGhpcy50b3BMaXN0ID0gMDtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmNbMl0uYXBwZW5kQ2hpbGQoIHRoaXMubGlzdEluICk7XHJcbiAgICAgICAgdGhpcy5jWzJdLmFwcGVuZENoaWxkKCB0aGlzLnNjcm9sbGVyICk7XHJcblxyXG4gICAgICAgIGlmKCBvLnZhbHVlICE9PSB1bmRlZmluZWQgKXtcclxuICAgICAgICAgICAgaWYoIWlzTmFOKG8udmFsdWUpKSB0aGlzLnZhbHVlID0gdGhpcy5saXN0WyBvLnZhbHVlIF07XHJcbiAgICAgICAgICAgIGVsc2UgdGhpcy52YWx1ZSA9IG8udmFsdWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLmxpc3RbMF07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmlzT3Blbk9uU3RhcnQgPSBvLm9wZW4gfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmxpc3RPbmx5ICl7XHJcbiAgICAgICAgICAgIHRoaXMuYmFzZUggPSA1O1xyXG4gICAgICAgICAgICB0aGlzLmNbM10uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgdGhpcy5jWzRdLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIHRoaXMuY1syXS5zdHlsZS50b3AgPSB0aGlzLmJhc2VIKydweCdcclxuICAgICAgICAgICAgdGhpcy5pc09wZW5PblN0YXJ0ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAvL3RoaXMuY1swXS5zdHlsZS5iYWNrZ3JvdW5kID0gJyNGRjAwMDAnXHJcbiAgICAgICAgaWYoIHRoaXMuaXNXaXRoSW1hZ2UgKSB0aGlzLnByZWxvYWRJbWFnZSgpO1xyXG4gICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gcG9wdWxhdGUgbGlzdFxyXG4gICAgICAgICAgICB0aGlzLnNldExpc3QoIHRoaXMubGlzdCApO1xyXG4gICAgICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgICAgICAgICAgaWYoIHRoaXMuaXNPcGVuT25TdGFydCApIHRoaXMub3BlbiggdHJ1ZSApO1xyXG4gICAgICAgLy8gfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyBpbWFnZSBsaXN0XHJcblxyXG4gICAgcHJlbG9hZEltYWdlICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5wcmVMb2FkQ29tcGxldGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy50bXBJbWFnZSA9IHt9O1xyXG4gICAgICAgIGZvciggbGV0IGk9MDsgaTx0aGlzLmxpc3QubGVuZ3RoOyBpKysgKSB0aGlzLnRtcFVybC5wdXNoKCB0aGlzLmxpc3RbaV0gKTtcclxuICAgICAgICB0aGlzLmxvYWRPbmUoKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBuZXh0SW1nICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy50bXBVcmwuc2hpZnQoKTtcclxuICAgICAgICBpZiggdGhpcy50bXBVcmwubGVuZ3RoID09PSAwICl7IFxyXG5cclxuICAgICAgICAgICAgdGhpcy5wcmVMb2FkQ29tcGxldGUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5hZGRJbWFnZXMoKTtcclxuICAgICAgICAgICAgLyp0aGlzLnNldExpc3QoIHRoaXMubGlzdCApO1xyXG4gICAgICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgICAgICAgICAgaWYoIHRoaXMuaXNPcGVuT25TdGFydCApIHRoaXMub3BlbigpOyovXHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHRoaXMubG9hZE9uZSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBsb2FkT25lKCl7XHJcblxyXG4gICAgICAgIGxldCBzZWxmID0gdGhpc1xyXG4gICAgICAgIGxldCBuYW1lID0gdGhpcy50bXBVcmxbMF07XHJcbiAgICAgICAgbGV0IGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gICAgICAgIGltZy5zdHlsZS5jc3NUZXh0ID0gJ3Bvc2l0aW9uOmFic29sdXRlOyB3aWR0aDonK3NlbGYuaW1hZ2VTaXplWzBdKydweDsgaGVpZ2h0Oicrc2VsZi5pbWFnZVNpemVbMV0rJ3B4JztcclxuICAgICAgICBpbWcuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLnBhdGggKyBuYW1lICsgdGhpcy5mb3JtYXQgKTtcclxuXHJcbiAgICAgICAgaW1nLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgIHNlbGYuaW1hZ2VTaXplWzJdID0gaW1nLndpZHRoO1xyXG4gICAgICAgICAgICBzZWxmLmltYWdlU2l6ZVszXSA9IGltZy5oZWlnaHQ7XHJcbiAgICAgICAgICAgIHNlbGYudG1wSW1hZ2VbbmFtZV0gPSBpbWc7XHJcbiAgICAgICAgICAgIHNlbGYubmV4dEltZygpO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy9cclxuXHJcbiAgICB0ZXN0Wm9uZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBsID0gdGhpcy5sb2NhbDtcclxuICAgICAgICBpZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICkgcmV0dXJuICcnO1xyXG5cclxuICAgICAgICBpZiggdGhpcy51cCAmJiB0aGlzLmlzT3BlbiApe1xyXG4gICAgICAgICAgICBpZiggbC55ID4gdGhpcy5oIC0gdGhpcy5iYXNlSCApIHJldHVybiAndGl0bGUnO1xyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMuc2Nyb2xsICYmICggbC54ID4gKHRoaXMuc2ErdGhpcy5zYi0yMCkpICkgcmV0dXJuICdzY3JvbGwnO1xyXG4gICAgICAgICAgICAgICAgaWYobC54ID4gdGhpcy5zYSkgcmV0dXJuIHRoaXMudGVzdEl0ZW1zKCBsLnktdGhpcy5iYXNlSCApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmKCBsLnkgPCB0aGlzLmJhc2VIKzIgKSByZXR1cm4gJ3RpdGxlJztcclxuICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgIGlmKCB0aGlzLmlzT3BlbiApe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCB0aGlzLnNjcm9sbCAmJiAoIGwueCA+ICh0aGlzLnNhK3RoaXMuc2ItMjApKSApIHJldHVybiAnc2Nyb2xsJztcclxuICAgICAgICAgICAgICAgICAgICBpZihsLnggPiB0aGlzLnNhKSByZXR1cm4gdGhpcy50ZXN0SXRlbXMoIGwueS10aGlzLmJhc2VIICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gJyc7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3RJdGVtcyAoIHkgKSB7XHJcblxyXG4gICAgICAgIGxldCBuYW1lID0gJyc7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5pdGVtcy5sZW5ndGgsIGl0ZW0sIGEsIGI7XHJcbiAgICAgICAgd2hpbGUoaS0tKXtcclxuICAgICAgICAgICAgaXRlbSA9IHRoaXMuaXRlbXNbaV07XHJcbiAgICAgICAgICAgIGEgPSBpdGVtLnBvc3kgKyB0aGlzLnRvcExpc3Q7XHJcbiAgICAgICAgICAgIGIgPSBpdGVtLnBvc3kgKyB0aGlzLml0ZW1IZWlnaHQgKyAxICsgdGhpcy50b3BMaXN0O1xyXG4gICAgICAgICAgICBpZiggeSA+PSBhICYmIHkgPD0gYiApeyBcclxuICAgICAgICAgICAgICAgIG5hbWUgPSAnaXRlbScgKyBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51blNlbGVjdGVkKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSBpdGVtO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbmFtZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdW5TZWxlY3RlZCAoKSB7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmN1cnJlbnQgKXtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50LnN0eWxlLmJhY2tncm91bmQgPSAncmdiYSgwLDAsMCwwLjIpJztcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50LnN0eWxlLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZWxlY3RlZCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudC5zdHlsZS5iYWNrZ3JvdW5kID0gdGhpcy5jb2xvcnMuc2VsZWN0O1xyXG4gICAgICAgIHRoaXMuY3VycmVudC5zdHlsZS5jb2xvciA9ICcjRkZGJztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb3VzZXVwICggZSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCAhbmFtZSApIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYoIG5hbWUgPT09ICdzY3JvbGwnICl7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmlzRG93biA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiggbmFtZSA9PT0gJ3RpdGxlJyApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5tb2RlVGl0bGUoMik7XHJcbiAgICAgICAgICAgIGlmKCAhdGhpcy5saXN0T25seSApe1xyXG4gICAgICAgICAgICAgICAgaWYoICF0aGlzLmlzT3BlbiApIHRoaXMub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiggdGhpcy5jdXJyZW50ICl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5saXN0W3RoaXMuY3VycmVudC5pZF1cclxuICAgICAgICAgICAgICAgIC8vdGhpcy52YWx1ZSA9IHRoaXMuY3VycmVudC50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VuZCgpO1xyXG4gICAgICAgICAgICAgICAgaWYoICF0aGlzLmxpc3RPbmx5ICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFRvcEl0ZW0oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbnVwID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCAhbmFtZSApIHJldHVybiBudXA7XHJcblxyXG4gICAgICAgIGlmKCBuYW1lID09PSAndGl0bGUnICl7XHJcbiAgICAgICAgICAgIHRoaXMudW5TZWxlY3RlZCgpO1xyXG4gICAgICAgICAgICB0aGlzLm1vZGVUaXRsZSgxKTtcclxuICAgICAgICAgICAgdGhpcy5jdXJzb3IoJ3BvaW50ZXInKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIGlmKCBuYW1lID09PSAnc2Nyb2xsJyApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jdXJzb3IoJ3MtcmVzaXplJyk7XHJcbiAgICAgICAgICAgIHRoaXMubW9kZVNjcm9sbCgxKTtcclxuICAgICAgICAgICAgaWYoIHRoaXMuaXNEb3duICl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVTY3JvbGwoMik7XHJcbiAgICAgICAgICAgICAgICBsZXQgdG9wID0gdGhpcy56b25lLnkrdGhpcy5iYXNlSC0yO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoICggZS5jbGllbnRZIC0gdG9wICApIC0gKCB0aGlzLnNoKjAuNSApICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9pZih0aGlzLmlzRG93bikgdGhpcy5saXN0bW92ZShlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgLy8gaXMgaXRlbVxyXG4gICAgICAgICAgICB0aGlzLm1vZGVUaXRsZSgwKTtcclxuICAgICAgICAgICAgdGhpcy5tb2RlU2Nyb2xsKDApO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnNvcigncG9pbnRlcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIG5hbWUgIT09IHRoaXMucHJldk5hbWUgKSBudXAgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMucHJldk5hbWUgPSBuYW1lO1xyXG5cclxuICAgICAgICByZXR1cm4gbnVwO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB3aGVlbCAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBuYW1lID0gdGhpcy50ZXN0Wm9uZSggZSApO1xyXG4gICAgICAgIGlmKCBuYW1lID09PSAndGl0bGUnICkgcmV0dXJuIGZhbHNlOyBcclxuICAgICAgICB0aGlzLnB5ICs9IGUuZGVsdGEqMTA7XHJcbiAgICAgICAgdGhpcy51cGRhdGUodGhpcy5weSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5wcmV2TmFtZSA9ICcnO1xyXG4gICAgICAgIHRoaXMudW5TZWxlY3RlZCgpO1xyXG4gICAgICAgIHRoaXMubW9kZVRpdGxlKDApO1xyXG4gICAgICAgIHRoaXMubW9kZVNjcm9sbCgwKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBtb2RlU2Nyb2xsICggbW9kZSApIHtcclxuXHJcbiAgICAgICAgaWYoIG1vZGUgPT09IHRoaXMuc01vZGUgKSByZXR1cm47XHJcblxyXG4gICAgICAgIHN3aXRjaChtb2RlKXtcclxuICAgICAgICAgICAgY2FzZSAwOiAvLyBiYXNlXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbkNvbG9yO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiAvLyBvdmVyXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zZWxlY3Q7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDI6IC8vIGVkaXQgLyBkb3duXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5kb3duO1xyXG4gICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNNb2RlID0gbW9kZTtcclxuICAgIH1cclxuXHJcbiAgICBtb2RlVGl0bGUgKCBtb2RlICkge1xyXG5cclxuICAgICAgICBpZiggbW9kZSA9PT0gdGhpcy50TW9kZSApIHJldHVybjtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcblxyXG4gICAgICAgIHN3aXRjaChtb2RlKXtcclxuICAgICAgICAgICAgY2FzZSAwOiAvLyBiYXNlXHJcbiAgICAgICAgICAgICAgICBzWzNdLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgICAgICBzWzNdLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbkNvbG9yO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAxOiAvLyBvdmVyXHJcbiAgICAgICAgICAgICAgICBzWzNdLmNvbG9yID0gJyNGRkYnO1xyXG4gICAgICAgICAgICAgICAgc1szXS5iYWNrZ3JvdW5kID0gdGhpcy5jb2xvcnMuc2VsZWN0O1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAyOiAvLyBlZGl0IC8gZG93blxyXG4gICAgICAgICAgICAgICAgc1szXS5jb2xvciA9IHRoaXMuZm9udENvbG9yO1xyXG4gICAgICAgICAgICAgICAgc1szXS5iYWNrZ3JvdW5kID0gdGhpcy5jb2xvcnMuZG93bjtcclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50TW9kZSA9IG1vZGU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyTGlzdCAoKSB7XHJcblxyXG4gICAgICAgIHdoaWxlICggdGhpcy5saXN0SW4uY2hpbGRyZW4ubGVuZ3RoICkgdGhpcy5saXN0SW4ucmVtb3ZlQ2hpbGQoIHRoaXMubGlzdEluLmxhc3RDaGlsZCApO1xyXG4gICAgICAgIHRoaXMuaXRlbXMgPSBbXTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0TGlzdCAoIGxpc3QgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXJMaXN0KCk7XHJcblxyXG4gICAgICAgIHRoaXMubGlzdCA9IGxpc3Q7XHJcbiAgICAgICAgdGhpcy5sZW5ndGggPSB0aGlzLmxpc3QubGVuZ3RoO1xyXG5cclxuICAgICAgICB0aGlzLm1heEl0ZW0gPSB0aGlzLmZ1bGwgPyB0aGlzLmxlbmd0aCA6IDU7XHJcbiAgICAgICAgdGhpcy5tYXhJdGVtID0gdGhpcy5sZW5ndGggPCB0aGlzLm1heEl0ZW0gPyB0aGlzLmxlbmd0aCA6IHRoaXMubWF4SXRlbTtcclxuXHJcbiAgICAgICAgdGhpcy5tYXhIZWlnaHQgPSB0aGlzLm1heEl0ZW0gKiAodGhpcy5pdGVtSGVpZ2h0KzEpICsgMjtcclxuXHJcbiAgICAgICAgdGhpcy5tYXggPSB0aGlzLmxlbmd0aCAqICh0aGlzLml0ZW1IZWlnaHQrMSkgKyAyO1xyXG4gICAgICAgIHRoaXMucmF0aW8gPSB0aGlzLm1heEhlaWdodCAvIHRoaXMubWF4O1xyXG4gICAgICAgIHRoaXMuc2ggPSB0aGlzLm1heEhlaWdodCAqIHRoaXMucmF0aW87XHJcbiAgICAgICAgdGhpcy5yYW5nZSA9IHRoaXMubWF4SGVpZ2h0IC0gdGhpcy5zaDtcclxuXHJcbiAgICAgICAgdGhpcy5jWzJdLnN0eWxlLmhlaWdodCA9IHRoaXMubWF4SGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICB0aGlzLnNjcm9sbGVyLnN0eWxlLmhlaWdodCA9IHRoaXMuc2ggKyAncHgnO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5tYXggPiB0aGlzLm1heEhlaWdodCApeyBcclxuICAgICAgICAgICAgdGhpcy53dyA9IHRoaXMuc2IgLSAyMDtcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGwgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGl0ZW0sIG47Ly8sIGwgPSB0aGlzLnNiO1xyXG4gICAgICAgIGZvciggbGV0IGk9MDsgaTx0aGlzLmxlbmd0aDsgaSsrICl7XHJcblxyXG4gICAgICAgICAgICBuID0gdGhpcy5saXN0W2ldO1xyXG4gICAgICAgICAgICBpdGVtID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy5pdGVtICsgJ3dpZHRoOicrdGhpcy53dysncHg7IGhlaWdodDonK3RoaXMuaXRlbUhlaWdodCsncHg7IGxpbmUtaGVpZ2h0OicrKHRoaXMuaXRlbUhlaWdodC01KSsncHg7IGNvbG9yOicrdGhpcy5mb250Q29sb3IrJzsnICk7XHJcbiAgICAgICAgICAgIGl0ZW0ubmFtZSA9ICdpdGVtJytpO1xyXG4gICAgICAgICAgICBpdGVtLmlkID0gaTtcclxuICAgICAgICAgICAgaXRlbS5wb3N5ID0gKHRoaXMuaXRlbUhlaWdodCsxKSppO1xyXG4gICAgICAgICAgICB0aGlzLmxpc3RJbi5hcHBlbmRDaGlsZCggaXRlbSApO1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2goIGl0ZW0gKTtcclxuXHJcbiAgICAgICAgICAgIC8vaWYoIHRoaXMuaXNXaXRoSW1hZ2UgKSBpdGVtLmFwcGVuZENoaWxkKCB0aGlzLnRtcEltYWdlW25dICk7XHJcbiAgICAgICAgICAgIGlmKCAhdGhpcy5pc1dpdGhJbWFnZSApIGl0ZW0udGV4dENvbnRlbnQgPSBuO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2V0VG9wSXRlbSgpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGFkZEltYWdlcyAoKXtcclxuICAgICAgICBsZXQgbG5nID0gdGhpcy5saXN0Lmxlbmd0aDtcclxuICAgICAgICBmb3IoIGxldCBpPTA7IGk8bG5nOyBpKysgKXtcclxuICAgICAgICAgICAgdGhpcy5pdGVtc1tpXS5hcHBlbmRDaGlsZCggdGhpcy50bXBJbWFnZVt0aGlzLmxpc3RbaV1dICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0VG9wSXRlbSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFRvcEl0ZW0gKCl7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzV2l0aEltYWdlICl7IFxyXG5cclxuICAgICAgICAgICAgaWYoICF0aGlzLnByZUxvYWRDb21wbGV0ZSApIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGlmKCF0aGlzLmNbM10uY2hpbGRyZW4ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHRoaXMuaW1hZ2VTaXplWzBdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gdGhpcy5pbWFnZVNpemVbMV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5jc3NUZXh0ID0gJ3Bvc2l0aW9uOmFic29sdXRlOyB0b3A6MHB4OyBsZWZ0OjBweDsnXHJcbiAgICAgICAgICAgICAgICB0aGlzLmN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY1szXS5hcHBlbmRDaGlsZCggdGhpcy5jYW52YXMgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGV0IGltZyA9IHRoaXMudG1wSW1hZ2VbIHRoaXMudmFsdWUgXTtcclxuICAgICAgICAgICAgdGhpcy5jdHguZHJhd0ltYWdlKCB0aGlzLnRtcEltYWdlWyB0aGlzLnZhbHVlIF0sIDAsIDAsIHRoaXMuaW1hZ2VTaXplWzJdLCB0aGlzLmltYWdlU2l6ZVszXSwgMCwwLCB0aGlzLmltYWdlU2l6ZVswXSwgdGhpcy5pbWFnZVNpemVbMV0gKTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgdGhpcy5jWzNdLnRleHRDb250ZW50ID0gdGhpcy52YWx1ZTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIC0tLS0tIExJU1RcclxuXHJcbiAgICB1cGRhdGUgKCB5ICkge1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuc2Nyb2xsICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB5ID0geSA8IDAgPyAwIDogeTtcclxuICAgICAgICB5ID0geSA+IHRoaXMucmFuZ2UgPyB0aGlzLnJhbmdlIDogeTtcclxuXHJcbiAgICAgICAgdGhpcy50b3BMaXN0ID0gLU1hdGguZmxvb3IoIHkgLyB0aGlzLnJhdGlvICk7XHJcblxyXG4gICAgICAgIHRoaXMubGlzdEluLnN0eWxlLnRvcCA9IHRoaXMudG9wTGlzdCsncHgnO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsZXIuc3R5bGUudG9wID0gTWF0aC5mbG9vciggeSApICArICdweCc7XHJcblxyXG4gICAgICAgIHRoaXMucHkgPSB5O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwYXJlbnRIZWlnaHQgKCB0ICkge1xyXG5cclxuICAgICAgICBpZiAoIHRoaXMucGFyZW50R3JvdXAgIT09IG51bGwgKSB0aGlzLnBhcmVudEdyb3VwLmNhbGMoIHQgKTtcclxuICAgICAgICBlbHNlIGlmICggdGhpcy5pc1VJICkgdGhpcy5tYWluLmNhbGMoIHQgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb3BlbiAoIGZpcnN0ICkge1xyXG5cclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlKCAwICk7XHJcbiAgICAgICAgdGhpcy5oID0gdGhpcy5tYXhIZWlnaHQgKyB0aGlzLmJhc2VIICsgNTtcclxuICAgICAgICBpZiggIXRoaXMuc2Nyb2xsICl7XHJcbiAgICAgICAgICAgIHRoaXMudG9wTGlzdCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuaCA9IHRoaXMuYmFzZUggKyA1ICsgdGhpcy5tYXg7XHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbGVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNbMF0uaGVpZ2h0ID0gdGhpcy5oICsgJ3B4JztcclxuICAgICAgICB0aGlzLnNbMl0uZGlzcGxheSA9ICdibG9jayc7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnVwICl7IFxyXG4gICAgICAgICAgICB0aGlzLnpvbmUueSAtPSB0aGlzLmggLSAodGhpcy5iYXNlSC0xMCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbNF0sICdkJywgdGhpcy5zdmdzLmFycm93VXAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN2ZyggdGhpcy5jWzRdLCAnZCcsIHRoaXMuc3Zncy5hcnJvd0Rvd24gKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuclNpemVDb250ZW50KCk7XHJcblxyXG4gICAgICAgIGxldCB0ID0gdGhpcy5oIC0gdGhpcy5iYXNlSDtcclxuXHJcbiAgICAgICAgdGhpcy56b25lLmggPSB0aGlzLmg7XHJcblxyXG4gICAgICAgIGlmKCFmaXJzdCkgdGhpcy5wYXJlbnRIZWlnaHQoIHQgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UgKCkge1xyXG5cclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG5cclxuICAgICAgICBpZiggdGhpcy51cCApIHRoaXMuem9uZS55ICs9IHRoaXMuaCAtICh0aGlzLmJhc2VILTEwKTtcclxuXHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLmggLSB0aGlzLmJhc2VIO1xyXG5cclxuICAgICAgICB0aGlzLmggPSB0aGlzLmJhc2VIO1xyXG4gICAgICAgIHRoaXMuc1swXS5oZWlnaHQgPSB0aGlzLmggKyAncHgnO1xyXG4gICAgICAgIHRoaXMuc1syXS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIHRoaXMuc2V0U3ZnKCB0aGlzLmNbNF0sICdkJywgdGhpcy5zdmdzLmFycm93ICk7XHJcblxyXG4gICAgICAgIHRoaXMuem9uZS5oID0gdGhpcy5oO1xyXG5cclxuICAgICAgICB0aGlzLnBhcmVudEhlaWdodCggLXQgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS1cclxuXHJcbiAgICB0ZXh0ICggdHh0ICkge1xyXG5cclxuICAgICAgICB0aGlzLmNbM10udGV4dENvbnRlbnQgPSB0eHQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJTaXplQ29udGVudCAoKSB7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUoaS0tKSB0aGlzLmxpc3RJbi5jaGlsZHJlbltpXS5zdHlsZS53aWR0aCA9IHRoaXMud3cgKyAncHgnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByU2l6ZSAoKSB7XHJcblxyXG4gICAgICAgIFByb3RvLnByb3RvdHlwZS5yU2l6ZS5jYWxsKCB0aGlzICk7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG4gICAgICAgIGxldCB3ID0gdGhpcy5zYjtcclxuICAgICAgICBsZXQgZCA9IHRoaXMuc2E7XHJcblxyXG4gICAgICAgIGlmKHNbMl09PT0gdW5kZWZpbmVkKSByZXR1cm47XHJcblxyXG4gICAgICAgIHNbMl0ud2lkdGggPSB3ICsgJ3B4JztcclxuICAgICAgICBzWzJdLmxlZnQgPSBkICsncHgnO1xyXG5cclxuICAgICAgICBzWzNdLndpZHRoID0gdyArICdweCc7XHJcbiAgICAgICAgc1szXS5sZWZ0ID0gZCArICdweCc7XHJcblxyXG4gICAgICAgIHNbNF0ubGVmdCA9IGQgKyB3IC0gMTcgKyAncHgnO1xyXG5cclxuICAgICAgICB0aGlzLnd3ID0gdztcclxuICAgICAgICBpZiggdGhpcy5tYXggPiB0aGlzLm1heEhlaWdodCApIHRoaXMud3cgPSB3LTIwO1xyXG4gICAgICAgIGlmKHRoaXMuaXNPcGVuKSB0aGlzLnJTaXplQ29udGVudCgpO1xyXG5cclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5pbXBvcnQgeyBUb29scyB9IGZyb20gJy4uL2NvcmUvVG9vbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIE51bWVyaWMgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRUeXBlTnVtYmVyKCBvICk7XHJcblxyXG4gICAgICAgIHRoaXMuYWxsd2F5ID0gby5hbGx3YXkgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMudmFsdWUgPSBbMF07XHJcbiAgICAgICAgdGhpcy5tdWx0eSA9IDE7XHJcbiAgICAgICAgdGhpcy5pbnZtdWx0eSA9IDE7XHJcbiAgICAgICAgdGhpcy5pc1NpbmdsZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5pc0FuZ2xlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pc1ZlY3RvciA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiggby5pc0FuZ2xlICl7XHJcbiAgICAgICAgICAgIHRoaXMuaXNBbmdsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMubXVsdHkgPSBUb29scy50b3JhZDtcclxuICAgICAgICAgICAgdGhpcy5pbnZtdWx0eSA9IFRvb2xzLnRvZGVnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pc0RyYWcgPSBvLmRyYWcgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCBvLnZhbHVlICE9PSB1bmRlZmluZWQgKXtcclxuICAgICAgICAgICAgaWYoIWlzTmFOKG8udmFsdWUpKXsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gW28udmFsdWVdO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYoIG8udmFsdWUgaW5zdGFuY2VvZiBBcnJheSApeyBcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBvLnZhbHVlOyBcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNTaW5nbGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmKCBvLnZhbHVlIGluc3RhbmNlb2YgT2JqZWN0ICl7IFxyXG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgaWYoIG8udmFsdWUueCAhPT0gdW5kZWZpbmVkICkgdGhpcy52YWx1ZVswXSA9IG8udmFsdWUueDtcclxuICAgICAgICAgICAgICAgIGlmKCBvLnZhbHVlLnkgIT09IHVuZGVmaW5lZCApIHRoaXMudmFsdWVbMV0gPSBvLnZhbHVlLnk7XHJcbiAgICAgICAgICAgICAgICBpZiggby52YWx1ZS56ICE9PSB1bmRlZmluZWQgKSB0aGlzLnZhbHVlWzJdID0gby52YWx1ZS56O1xyXG4gICAgICAgICAgICAgICAgaWYoIG8udmFsdWUudyAhPT0gdW5kZWZpbmVkICkgdGhpcy52YWx1ZVszXSA9IG8udmFsdWUudztcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNWZWN0b3IgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1NpbmdsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmxuZyA9IHRoaXMudmFsdWUubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMudG1wID0gW107XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSAtMTtcclxuICAgICAgICB0aGlzLnByZXYgPSB7IHg6MCwgeTowLCBkOjAsIHY6MCB9O1xyXG5cclxuICAgICAgICAvLyBiZ1xyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnIGJhY2tncm91bmQ6JyArIHRoaXMuY29sb3JzLnNlbGVjdCArICc7IHRvcDo0cHg7IHdpZHRoOjBweDsgaGVpZ2h0OicgKyAodGhpcy5oLTgpICsgJ3B4OycgKTtcclxuXHJcbiAgICAgICAgdGhpcy5jTW9kZSA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgd2hpbGUoaS0tKXtcclxuXHJcbiAgICAgICAgICAgIGlmKHRoaXMuaXNBbmdsZSkgdGhpcy52YWx1ZVtpXSA9ICh0aGlzLnZhbHVlW2ldICogMTgwIC8gTWF0aC5QSSkudG9GaXhlZCggdGhpcy5wcmVjaXNpb24gKTtcclxuICAgICAgICAgICAgdGhpcy5jWzMraV0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dHNlbGVjdCArICcgaGVpZ2h0OicrKHRoaXMuaC00KSsncHg7IGJhY2tncm91bmQ6JyArIHRoaXMuY29sb3JzLmlucHV0QmcgKyAnOyBib3JkZXJDb2xvcjonICsgdGhpcy5jb2xvcnMuaW5wdXRCb3JkZXIrJzsgYm9yZGVyLXJhZGl1czonK3RoaXMucmFkaXVzKydweDsnKTtcclxuICAgICAgICAgICAgaWYoby5jZW50ZXIpIHRoaXMuY1syK2ldLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICB0aGlzLmNbMytpXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWVbaV07XHJcbiAgICAgICAgICAgIHRoaXMuY1szK2ldLnN0eWxlLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuY1szK2ldLmlzTnVtID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY01vZGVbaV0gPSAwO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGN1cnNvclxyXG4gICAgICAgIHRoaXMuY3Vyc29ySWQgPSAzICsgdGhpcy5sbmc7XHJcbiAgICAgICAgdGhpcy5jWyB0aGlzLmN1cnNvcklkIF0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ3RvcDo0cHg7IGhlaWdodDonICsgKHRoaXMuaC04KSArICdweDsgd2lkdGg6MHB4OyBiYWNrZ3JvdW5kOicrdGhpcy5mb250Q29sb3IrJzsnICk7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLnRtcDtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgd2hpbGUoIGktLSApe1xyXG4gICAgICAgICAgICBpZiggbC54PnRbaV1bMF0gJiYgbC54PHRbaV1bMl0gKSByZXR1cm4gaTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAnJztcclxuXHJcbiAgICB9XHJcblxyXG4gICAvKiBtb2RlOiBmdW5jdGlvbiAoIG4sIG5hbWUgKSB7XHJcblxyXG4gICAgICAgIGlmKCBuID09PSB0aGlzLmNNb2RlW25hbWVdICkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAvL2xldCBtO1xyXG5cclxuICAgICAgICAvKnN3aXRjaChuKXtcclxuXHJcbiAgICAgICAgICAgIGNhc2UgMDogbSA9IHRoaXMuY29sb3JzLmJvcmRlcjsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTogbSA9IHRoaXMuY29sb3JzLmJvcmRlck92ZXI7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDI6IG0gPSB0aGlzLmNvbG9ycy5ib3JkZXJTZWxlY3Q7ICBicmVhaztcclxuXHJcbiAgICAgICAgfSovXHJcblxyXG4gICAvKiAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIC8vdGhpcy5jW25hbWUrMl0uc3R5bGUuYm9yZGVyQ29sb3IgPSBtO1xyXG4gICAgICAgIHRoaXMuY01vZGVbbmFtZV0gPSBuO1xyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICB9LCovXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzRG93biApe1xyXG4gICAgICAgICAgICB0aGlzLmlzRG93biA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmKCBuYW1lICE9PSAnJyApeyBcclxuICAgICAgICAgICAgXHR0aGlzLmN1cnJlbnQgPSBuYW1lO1xyXG4gICAgICAgICAgICBcdHRoaXMucHJldiA9IHsgeDplLmNsaWVudFgsIHk6ZS5jbGllbnRZLCBkOjAsIHY6IHRoaXMuaXNTaW5nbGUgPyBwYXJzZUZsb2F0KHRoaXMudmFsdWUpIDogcGFyc2VGbG9hdCggdGhpcy52YWx1ZVsgdGhpcy5jdXJyZW50IF0gKSAgfTtcclxuICAgICAgICAgICAgXHR0aGlzLnNldElucHV0KCB0aGlzLmNbIDMgKyB0aGlzLmN1cnJlbnQgXSApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIC8qXHJcblxyXG4gICAgICAgIGlmKCBuYW1lID09PSAnJyApIHJldHVybiBmYWxzZTtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLnByZXYgPSB7IHg6ZS5jbGllbnRYLCB5OmUuY2xpZW50WSwgZDowLCB2OiB0aGlzLmlzU2luZ2xlID8gcGFyc2VGbG9hdCh0aGlzLnZhbHVlKSA6IHBhcnNlRmxvYXQoIHRoaXMudmFsdWVbIHRoaXMuY3VycmVudCBdICkgIH07XHJcblxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5tb2RlKCAyLCBuYW1lICk7Ki9cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcblxyXG4gICAgXHRpZiggdGhpcy5pc0Rvd24gKXtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5jdXJyZW50ID0gLTE7XHJcbiAgICAgICAgICAgIHRoaXMucHJldiA9IHsgeDowLCB5OjAsIGQ6MCwgdjowIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgLypsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5jdXJyZW50ICE9PSAtMSApeyBcclxuXHJcbiAgICAgICAgICAgIC8vbGV0IHRtID0gdGhpcy5jdXJyZW50O1xyXG4gICAgICAgICAgICBsZXQgdGQgPSB0aGlzLnByZXYuZDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IC0xO1xyXG4gICAgICAgICAgICB0aGlzLnByZXYgPSB7IHg6MCwgeTowLCBkOjAsIHY6MCB9O1xyXG5cclxuICAgICAgICAgICAgaWYoICF0ZCApe1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0SW5wdXQoIHRoaXMuY1sgMyArIG5hbWUgXSApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7Ly90aGlzLm1vZGUoIDIsIG5hbWUgKTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZXNldCgpOy8vdGhpcy5tb2RlKCAwLCB0bSApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0qL1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbnVwID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IHggPSAwO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgaWYoIG5hbWUgPT09ICcnICkgdGhpcy5jdXJzb3IoKTtcclxuICAgICAgICBlbHNleyBcclxuICAgICAgICBcdGlmKCF0aGlzLmlzRHJhZykgdGhpcy5jdXJzb3IoJ3RleHQnKTtcclxuICAgICAgICBcdGVsc2UgdGhpcy5jdXJzb3IoIHRoaXMuY3VycmVudCAhPT0gLTEgPyAnbW92ZScgOiAncG9pbnRlcicgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICBpZiggdGhpcy5pc0RyYWcgKXtcclxuXHJcbiAgICAgICAgXHRpZiggdGhpcy5jdXJyZW50ICE9PSAtMSApe1xyXG5cclxuICAgICAgICAgICAgXHR0aGlzLnByZXYuZCArPSAoIGUuY2xpZW50WCAtIHRoaXMucHJldi54ICkgLSAoIGUuY2xpZW50WSAtIHRoaXMucHJldi55ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IG4gPSB0aGlzLnByZXYudiArICggdGhpcy5wcmV2LmQgKiB0aGlzLnN0ZXApO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVbIHRoaXMuY3VycmVudCBdID0gdGhpcy5udW1WYWx1ZShuKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY1sgMyArIHRoaXMuY3VycmVudCBdLnRleHRDb250ZW50ID0gdGhpcy52YWx1ZVt0aGlzLmN1cnJlbnRdO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnByZXYueCA9IGUuY2xpZW50WDtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJldi55ID0gZS5jbGllbnRZO1xyXG5cclxuICAgICAgICAgICAgICAgIG51cCA9IHRydWU7XHJcbiAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgIFx0aWYoIHRoaXMuaXNEb3duICkgeCA9IGUuY2xpZW50WCAtIHRoaXMuem9uZS54IC0zO1xyXG4gICAgICAgIFx0aWYoIHRoaXMuY3VycmVudCAhPT0gLTEgKSB4IC09IHRoaXMudG1wW3RoaXMuY3VycmVudF1bMF1cclxuICAgICAgICBcdHJldHVybiB0aGlzLnVwSW5wdXQoIHgsIHRoaXMuaXNEb3duICk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcblxyXG5cclxuICAgICAgICByZXR1cm4gbnVwO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvL2tleWRvd246IGZ1bmN0aW9uICggZSApIHsgcmV0dXJuIHRydWU7IH0sXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgbGV0IG51cCA9IGZhbHNlO1xyXG4gICAgICAgIC8vdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLy90aGlzLmN1cnJlbnQgPSAwO1xyXG5cclxuICAgICAgIC8qIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgd2hpbGUoaS0tKXsgXHJcbiAgICAgICAgICAgIGlmKHRoaXMuY01vZGVbaV0hPT0wKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY01vZGVbaV0gPSAwO1xyXG4gICAgICAgICAgICAgICAgLy90aGlzLmNbMitpXS5zdHlsZS5ib3JkZXJDb2xvciA9IHRoaXMuY29sb3JzLmJvcmRlcjtcclxuICAgICAgICAgICAgICAgIG51cCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9Ki9cclxuXHJcbiAgICAgICAgcmV0dXJuIG51cDtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIHNldFZhbHVlICggdiApIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNWZWN0b3IgKXtcclxuXHJcbiAgICAgICAgICAgIGlmKCB2LnggIT09IHVuZGVmaW5lZCApIHRoaXMudmFsdWVbMF0gPSB2Lng7XHJcbiAgICAgICAgICAgIGlmKCB2LnkgIT09IHVuZGVmaW5lZCApIHRoaXMudmFsdWVbMV0gPSB2Lnk7XHJcbiAgICAgICAgICAgIGlmKCB2LnogIT09IHVuZGVmaW5lZCApIHRoaXMudmFsdWVbMl0gPSB2Lno7XHJcbiAgICAgICAgICAgIGlmKCB2LncgIT09IHVuZGVmaW5lZCApIHRoaXMudmFsdWVbM10gPSB2Lnc7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuXHJcbiAgICAgICAgLy9sZXQgaSA9IHRoaXMudmFsdWUubGVuZ3RoO1xyXG5cclxuICAgICAgICAvKm4gPSBuIHx8IDA7XHJcbiAgICAgICAgdGhpcy52YWx1ZVtuXSA9IHRoaXMubnVtVmFsdWUoIHYgKTtcclxuICAgICAgICB0aGlzLmNbIDMgKyBuIF0udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlW25dOyovXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNhbWVTdHIgKCBzdHIgKXtcclxuXHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLnZhbHVlLmxlbmd0aDtcclxuICAgICAgICB3aGlsZShpLS0pIHRoaXMuY1sgMyArIGkgXS50ZXh0Q29udGVudCA9IHN0cjtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlICggdXAgKSB7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy52YWx1ZS5sZW5ndGg7XHJcblxyXG4gICAgICAgIHdoaWxlKGktLSl7XHJcbiAgICAgICAgICAgICB0aGlzLnZhbHVlW2ldID0gdGhpcy5udW1WYWx1ZSggdGhpcy52YWx1ZVtpXSAqIHRoaXMuaW52bXVsdHkgKTtcclxuICAgICAgICAgICAgIHRoaXMuY1sgMyArIGkgXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWVbaV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggdXAgKSB0aGlzLnNlbmQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2VuZCAoIHYgKSB7XHJcblxyXG4gICAgICAgIHYgPSB2IHx8IHRoaXMudmFsdWU7XHJcblxyXG4gICAgICAgIHRoaXMuaXNTZW5kID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMub2JqZWN0TGluayAhPT0gbnVsbCApeyBcclxuXHJcbiAgICAgICAgICAgIGlmKCB0aGlzLmlzVmVjdG9yICl7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5vYmplY3RMaW5rWyB0aGlzLnZhbCBdLmZyb21BcnJheSggdiApO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qdGhpcy5vYmplY3RMaW5rWyB0aGlzLnZhbCBdLnggPSB2WzBdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vYmplY3RMaW5rWyB0aGlzLnZhbCBdLnkgPSB2WzFdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vYmplY3RMaW5rWyB0aGlzLnZhbCBdLnogPSB2WzJdO1xyXG4gICAgICAgICAgICAgICAgaWYoIHZbM10gKSB0aGlzLm9iamVjdExpbmtbIHRoaXMudmFsIF0udyA9IHZbM107Ki9cclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9iamVjdExpbmtbIHRoaXMudmFsIF0gPSB2O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIHRoaXMuY2FsbGJhY2sgKSB0aGlzLmNhbGxiYWNrKCB2LCB0aGlzLnZhbCApO1xyXG5cclxuICAgICAgICB0aGlzLmlzU2VuZCA9IGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBJTlBVVFxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHNlbGVjdCAoIGMsIGUsIHcgKSB7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG4gICAgICAgIGxldCBkID0gdGhpcy5jdXJyZW50ICE9PSAtMSA/IHRoaXMudG1wW3RoaXMuY3VycmVudF1bMF0gKyA1IDogMDtcclxuICAgICAgICBzW3RoaXMuY3Vyc29ySWRdLndpZHRoID0gJzFweCc7XHJcbiAgICAgICAgc1t0aGlzLmN1cnNvcklkXS5sZWZ0ID0gKCBkICsgYyApICsgJ3B4JztcclxuICAgICAgICBzWzJdLmxlZnQgPSAoIGQgKyBlICkgKyAncHgnO1xyXG4gICAgICAgIHNbMl0ud2lkdGggPSB3ICsgJ3B4JztcclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHVuc2VsZWN0ICgpIHtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgaWYoIXMpIHJldHVybjtcclxuICAgICAgICBzWzJdLndpZHRoID0gMCArICdweCc7XHJcbiAgICAgICAgc1t0aGlzLmN1cnNvcklkXS53aWR0aCA9IDAgKyAncHgnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB2YWxpZGF0ZSAoIGZvcmNlICkge1xyXG5cclxuICAgICAgICBsZXQgYXIgPSBbXTtcclxuICAgICAgICBsZXQgaSA9IHRoaXMubG5nO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5hbGx3YXkgKSBmb3JjZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHdoaWxlKGktLSl7XHJcbiAgICAgICAgXHRpZighaXNOYU4oIHRoaXMuY1sgMyArIGkgXS50ZXh0Q29udGVudCApKXsgXHJcbiAgICAgICAgICAgICAgICBsZXQgbnggPSB0aGlzLm51bVZhbHVlKCB0aGlzLmNbIDMgKyBpIF0udGV4dENvbnRlbnQgKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY1sgMyArIGkgXS50ZXh0Q29udGVudCA9IG54O1xyXG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVtpXSA9IG54O1xyXG4gICAgICAgICAgICB9IGVsc2UgeyAvLyBub3QgbnVtYmVyXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNbIDMgKyBpIF0udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlW2ldO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIFx0YXJbaV0gPSB0aGlzLnZhbHVlW2ldICogdGhpcy5tdWx0eTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCAhZm9yY2UgKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzU2luZ2xlICkgdGhpcy5zZW5kKCBhclswXSApO1xyXG4gICAgICAgIGVsc2UgdGhpcy5zZW5kKCBhciApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIFJFWklTRVxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHJTaXplICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIuclNpemUoKTtcclxuXHJcbiAgICAgICAgbGV0IHcgPSBNYXRoLmZsb29yKCAoIHRoaXMuc2IgKyA1ICkgLyB0aGlzLmxuZyApLTU7XHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLmxuZztcclxuICAgICAgICB3aGlsZShpLS0pe1xyXG4gICAgICAgICAgICB0aGlzLnRtcFtpXSA9IFsgTWF0aC5mbG9vciggdGhpcy5zYSArICggdyAqIGkgKSsoIDUgKiBpICkpLCB3IF07XHJcbiAgICAgICAgICAgIHRoaXMudG1wW2ldWzJdID0gdGhpcy50bXBbaV1bMF0gKyB0aGlzLnRtcFtpXVsxXTtcclxuICAgICAgICAgICAgc1sgMyArIGkgXS5sZWZ0ID0gdGhpcy50bXBbaV1bMF0gKyAncHgnO1xyXG4gICAgICAgICAgICBzWyAzICsgaSBdLndpZHRoID0gdGhpcy50bXBbaV1bMV0gKyAncHgnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgU2xpZGUgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRUeXBlTnVtYmVyKCBvICk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLm1vZGVsID0gby5zdHlwZSB8fCAwO1xyXG4gICAgICAgIGlmKCBvLm1vZGUgIT09IHVuZGVmaW5lZCApIHRoaXMubW9kZWwgPSBvLm1vZGU7XHJcbiAgICAgICAgdGhpcy5idXR0b25Db2xvciA9IG8uYkNvbG9yIHx8IHRoaXMuY29sb3JzLmJ1dHRvbjtcclxuXHJcbiAgICAgICAgdGhpcy5kZWZhdWx0Qm9yZGVyQ29sb3IgPSB0aGlzLmNvbG9ycy5oaWRlO1xyXG5cclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNPdmVyID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5hbGx3YXkgPSBvLmFsbHdheSB8fCBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5pc0RlZyA9IG8uaXNEZWcgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuZmlyc3RJbXB1dCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvL3RoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0c2VsZWN0ICsgJ2xldHRlci1zcGFjaW5nOi0xcHg7IHRleHQtYWxpZ246cmlnaHQ7IHdpZHRoOjQ3cHg7IGJvcmRlcjoxcHggZGFzaGVkICcrdGhpcy5kZWZhdWx0Qm9yZGVyQ29sb3IrJzsgY29sb3I6JysgdGhpcy5mb250Q29sb3IgKTtcclxuICAgICAgICAvL3RoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0c2VsZWN0ICsgJ3RleHQtYWxpZ246cmlnaHQ7IHdpZHRoOjQ3cHg7IGJvcmRlcjoxcHggZGFzaGVkICcrdGhpcy5kZWZhdWx0Qm9yZGVyQ29sb3IrJzsgY29sb3I6JysgdGhpcy5mb250Q29sb3IgKTtcclxuICAgICAgICB0aGlzLmNbMl0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dHNlbGVjdCArICdib3JkZXI6bm9uZTsgd2lkdGg6NDdweDsgY29sb3I6JysgdGhpcy5mb250Q29sb3IgKTtcclxuICAgICAgICAvL3RoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0c2VsZWN0ICsgJ2xldHRlci1zcGFjaW5nOi0xcHg7IHRleHQtYWxpZ246cmlnaHQ7IHdpZHRoOjQ3cHg7IGNvbG9yOicrIHRoaXMuZm9udENvbG9yICk7XHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy5iYXNpYyArICcgdG9wOjA7IGhlaWdodDonK3RoaXMuaCsncHg7JyApO1xyXG4gICAgICAgIHRoaXMuY1s0XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnYmFja2dyb3VuZDonK3RoaXMuY29sb3JzLnNjcm9sbGJhY2srJzsgdG9wOjJweDsgaGVpZ2h0OicrKHRoaXMuaC00KSsncHg7JyApO1xyXG4gICAgICAgIHRoaXMuY1s1XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnbGVmdDo0cHg7IHRvcDo1cHg7IGhlaWdodDonKyh0aGlzLmgtMTApKydweDsgYmFja2dyb3VuZDonICsgdGhpcy5mb250Q29sb3IgKyc7JyApO1xyXG5cclxuICAgICAgICB0aGlzLmNbMl0uaXNOdW0gPSB0cnVlO1xyXG4gICAgICAgIC8vdGhpcy5jWzJdLnN0eWxlLmhlaWdodCA9ICh0aGlzLmgtNCkgKyAncHgnO1xyXG4gICAgICAgIC8vdGhpcy5jWzJdLnN0eWxlLmxpbmVIZWlnaHQgPSAodGhpcy5oLTgpICsgJ3B4JztcclxuICAgICAgICB0aGlzLmNbMl0uc3R5bGUuaGVpZ2h0ID0gKHRoaXMuaC0yKSArICdweCc7XHJcbiAgICAgICAgdGhpcy5jWzJdLnN0eWxlLmxpbmVIZWlnaHQgPSAodGhpcy5oLTEwKSArICdweCc7XHJcblxyXG4gICAgICAgIGlmKHRoaXMubW9kZWwgIT09IDApe1xyXG5cclxuICAgICAgICAgICAgbGV0IGgxID0gNCwgaDIgPSA4LCB3dyA9IHRoaXMuaC00LCByYSA9IDIwO1xyXG5cclxuICAgICAgICAgICAgaWYoIHRoaXMubW9kZWwgPT09IDIgKXtcclxuICAgICAgICAgICAgICAgIGgxID0gNDsvLzJcclxuICAgICAgICAgICAgICAgIGgyID0gODtcclxuICAgICAgICAgICAgICAgIHJhID0gMjtcclxuICAgICAgICAgICAgICAgIHd3ID0gKHRoaXMuaC00KSowLjVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYodGhpcy5tb2RlbCA9PT0gMykgdGhpcy5jWzVdLnN0eWxlLnZpc2libGUgPSAnbm9uZSc7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNbNF0uc3R5bGUuYm9yZGVyUmFkaXVzID0gaDEgKyAncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNF0uc3R5bGUuaGVpZ2h0ID0gaDIgKyAncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNF0uc3R5bGUudG9wID0gKHRoaXMuaCowLjUpIC0gaDEgKyAncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNV0uc3R5bGUuYm9yZGVyUmFkaXVzID0gKGgxKjAuNSkgKyAncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNV0uc3R5bGUuaGVpZ2h0ID0gaDEgKyAncHgnO1xyXG4gICAgICAgICAgICB0aGlzLmNbNV0uc3R5bGUudG9wID0gKHRoaXMuaCowLjUpLShoMSowLjUpICsgJ3B4JztcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY1s2XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnYm9yZGVyLXJhZGl1czonK3JhKydweDsgbWFyZ2luLWxlZnQ6JysoLXd3KjAuNSkrJ3B4OyBib3JkZXI6MXB4IHNvbGlkICcrdGhpcy5jb2xvcnMuYm9yZGVyKyc7IGJhY2tncm91bmQ6Jyt0aGlzLmJ1dHRvbkNvbG9yKyc7IGxlZnQ6NHB4OyB0b3A6MnB4OyBoZWlnaHQ6JysodGhpcy5oLTQpKydweDsgd2lkdGg6Jyt3dysncHg7JyApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYoIGwueCA+PSB0aGlzLnR4bCApIHJldHVybiAndGV4dCc7XHJcbiAgICAgICAgZWxzZSBpZiggbC54ID49IHRoaXMuc2EgKSByZXR1cm4gJ3Njcm9sbCc7XHJcbiAgICAgICAgZWxzZSByZXR1cm4gJyc7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYoIHRoaXMuaXNEb3duICkgdGhpcy5pc0Rvd24gPSBmYWxzZTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgaWYoICFuYW1lICkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICBpZiggbmFtZSA9PT0gJ3Njcm9sbCcgKXsgXHJcbiAgICAgICAgICAgIHRoaXMuaXNEb3duID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5vbGQgPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qaWYoIG5hbWUgPT09ICd0ZXh0JyApe1xyXG4gICAgICAgICAgICB0aGlzLnNldElucHV0KCB0aGlzLmNbMl0sIGZ1bmN0aW9uKCl7IHRoaXMudmFsaWRhdGUoKSB9LmJpbmQodGhpcykgKTtcclxuICAgICAgICB9Ki9cclxuXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vdXNlbW92ZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBudXAgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCBuYW1lID09PSAnc2Nyb2xsJyApIHtcclxuICAgICAgICAgICAgdGhpcy5tb2RlKDEpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnNvcigndy1yZXNpemUnKTtcclxuICAgICAgICAvL30gZWxzZSBpZihuYW1lID09PSAndGV4dCcpeyBcclxuICAgICAgICAgICAgLy90aGlzLmN1cnNvcigncG9pbnRlcicpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3Vyc29yKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiggdGhpcy5pc0Rvd24gKXtcclxuXHJcbiAgICAgICAgICAgIGxldCBuID0gKCgoIGUuY2xpZW50WCAtICh0aGlzLnpvbmUueCt0aGlzLnNhKSAtIDMgKSAvIHRoaXMud3cgKSAqIHRoaXMucmFuZ2UgKyB0aGlzLm1pbiApIC0gdGhpcy5vbGQ7XHJcbiAgICAgICAgICAgIGlmKG4gPj0gdGhpcy5zdGVwIHx8IG4gPD0gdGhpcy5zdGVwKXsgXHJcbiAgICAgICAgICAgICAgICBuID0gTWF0aC5mbG9vciggbiAvIHRoaXMuc3RlcCApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMubnVtVmFsdWUoIHRoaXMub2xkICsgKCBuICogdGhpcy5zdGVwICkgKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCB0cnVlICk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9sZCA9IHRoaXMudmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbnVwID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudXA7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8va2V5ZG93bjogZnVuY3Rpb24gKCBlICkgeyByZXR1cm4gdHJ1ZTsgfSxcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgdmFsaWRhdGUgKCkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBuID0gdGhpcy5jWzJdLnRleHRDb250ZW50O1xyXG5cclxuICAgICAgICBpZighaXNOYU4oIG4gKSl7IFxyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5udW1WYWx1ZSggbiApOyBcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodHJ1ZSk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZWxzZSB0aGlzLmNbMl0udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlICsgKHRoaXMuaXNEZWcgPyAnwrAnOicnKTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgLy90aGlzLmNsZWFySW5wdXQoKTtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubW9kZSgwKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kZSAoIG1vZGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG5cclxuICAgICAgICBzd2l0Y2gobW9kZSl7XHJcbiAgICAgICAgICAgIGNhc2UgMDogLy8gYmFzZVxyXG4gICAgICAgICAgICAgICAvLyBzWzJdLmJvcmRlciA9ICcxcHggc29saWQgJyArIHRoaXMuY29sb3JzLmhpZGU7XHJcbiAgICAgICAgICAgICAgICBzWzJdLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgICAgICBzWzRdLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zY3JvbGxiYWNrO1xyXG4gICAgICAgICAgICAgICAgc1s1XS5iYWNrZ3JvdW5kID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDE6IC8vIHNjcm9sbCBvdmVyXHJcbiAgICAgICAgICAgICAgICAvL3NbMl0uYm9yZGVyID0gJzFweCBkYXNoZWQgJyArIHRoaXMuY29sb3JzLmhpZGU7XHJcbiAgICAgICAgICAgICAgICBzWzJdLmNvbG9yID0gdGhpcy5jb2xvclBsdXM7XHJcbiAgICAgICAgICAgICAgICBzWzRdLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zY3JvbGxiYWNrb3ZlcjtcclxuICAgICAgICAgICAgICAgIHNbNV0uYmFja2dyb3VuZCA9IHRoaXMuY29sb3JQbHVzO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAvKiBjYXNlIDI6IFxyXG4gICAgICAgICAgICAgICAgc1syXS5ib3JkZXIgPSAnMXB4IHNvbGlkICcgKyB0aGlzLmNvbG9ycy5ib3JkZXJTZWxlY3Q7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDM6IFxyXG4gICAgICAgICAgICAgICAgc1syXS5ib3JkZXIgPSAnMXB4IGRhc2hlZCAnICsgdGhpcy5mb250Q29sb3I7Ly90aGlzLmNvbG9ycy5ib3JkZXJTZWxlY3Q7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDQ6IFxyXG4gICAgICAgICAgICAgICAgc1syXS5ib3JkZXIgPSAnMXB4IGRhc2hlZCAnICsgdGhpcy5jb2xvcnMuaGlkZTtcclxuICAgICAgICAgICAgYnJlYWs7Ki9cclxuXHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUgKCB1cCApIHtcclxuXHJcbiAgICAgICAgbGV0IHd3ID0gTWF0aC5mbG9vciggdGhpcy53dyAqICgoIHRoaXMudmFsdWUgLSB0aGlzLm1pbiApIC8gdGhpcy5yYW5nZSApKTtcclxuICAgICAgIFxyXG4gICAgICAgIGlmKHRoaXMubW9kZWwgIT09IDMpIHRoaXMuc1s1XS53aWR0aCA9IHd3ICsgJ3B4JztcclxuICAgICAgICBpZih0aGlzLnNbNl0pIHRoaXMuc1s2XS5sZWZ0ID0gKCB0aGlzLnNhICsgd3cgKyAzICkgKyAncHgnO1xyXG4gICAgICAgIHRoaXMuY1syXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWUgKyAodGhpcy5pc0RlZyA/ICfCsCc6JycpO1xyXG5cclxuICAgICAgICBpZiggdXAgKSB0aGlzLnNlbmQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgclNpemUgKCkge1xyXG5cclxuICAgICAgICBzdXBlci5yU2l6ZSgpO1xyXG5cclxuICAgICAgICBsZXQgdyA9IHRoaXMuc2IgLSB0aGlzLnNjO1xyXG4gICAgICAgIHRoaXMud3cgPSB3IC0gNjtcclxuXHJcbiAgICAgICAgbGV0IHR4ID0gdGhpcy5zYztcclxuICAgICAgICBpZih0aGlzLmlzVUkgfHwgIXRoaXMuc2ltcGxlKSB0eCA9IHRoaXMuc2MrMTA7XHJcbiAgICAgICAgdGhpcy50eGwgPSB0aGlzLncgLSB0eCArIDI7XHJcblxyXG4gICAgICAgIC8vbGV0IHR5ID0gTWF0aC5mbG9vcih0aGlzLmggKiAwLjUpIC0gODtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcblxyXG4gICAgICAgIHNbMl0ud2lkdGggPSAodGhpcy5zYyAtNiApKyAncHgnO1xyXG4gICAgICAgIHNbMl0ubGVmdCA9ICh0aGlzLnR4bCArNCkgKyAncHgnO1xyXG4gICAgICAgIC8vc1syXS50b3AgPSB0eSArICdweCc7XHJcbiAgICAgICAgc1szXS5sZWZ0ID0gdGhpcy5zYSArICdweCc7XHJcbiAgICAgICAgc1szXS53aWR0aCA9IHcgKyAncHgnO1xyXG4gICAgICAgIHNbNF0ubGVmdCA9IHRoaXMuc2EgKyAncHgnO1xyXG4gICAgICAgIHNbNF0ud2lkdGggPSB3ICsgJ3B4JztcclxuICAgICAgICBzWzVdLmxlZnQgPSAodGhpcy5zYSArIDMpICsgJ3B4JztcclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcbmV4cG9ydCBjbGFzcyBUZXh0SW5wdXQgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy5jbW9kZSA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMudmFsdWUgPSBvLnZhbHVlIHx8ICcnO1xyXG4gICAgICAgIHRoaXMucGxhY2VIb2xkZXIgPSBvLnBsYWNlSG9sZGVyIHx8ICcnO1xyXG5cclxuICAgICAgICB0aGlzLmFsbHdheSA9IG8uYWxsd2F5IHx8IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZWRpdGFibGUgPSBvLmVkaXQgIT09IHVuZGVmaW5lZCA/IG8uZWRpdCA6IHRydWU7XHJcblxyXG5cclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBiZ1xyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnIGJhY2tncm91bmQ6JyArIHRoaXMuY29sb3JzLnNlbGVjdCArICc7IHRvcDo0cHg7IHdpZHRoOjBweDsgaGVpZ2h0OicgKyAodGhpcy5oLTgpICsgJ3B4OycgKTtcclxuXHJcbiAgICAgICAgdGhpcy5jWzNdID0gdGhpcy5kb20oICdkaXYnLCB0aGlzLmNzcy50eHRzZWxlY3QgKyAnaGVpZ2h0OicgKyAodGhpcy5oLTQpICsgJ3B4OyBiYWNrZ3JvdW5kOicgKyB0aGlzLmNvbG9ycy5pbnB1dEJnICsgJzsgYm9yZGVyQ29sb3I6JyArIHRoaXMuY29sb3JzLmlucHV0Qm9yZGVyKyc7IGJvcmRlci1yYWRpdXM6Jyt0aGlzLnJhZGl1cysncHg7JyApO1xyXG4gICAgICAgIHRoaXMuY1szXS50ZXh0Q29udGVudCA9IHRoaXMudmFsdWU7XHJcblxyXG4gICAgICAgIC8vIGN1cnNvclxyXG4gICAgICAgIHRoaXMuY1s0XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAndG9wOjRweDsgaGVpZ2h0OicgKyAodGhpcy5oLTgpICsgJ3B4OyB3aWR0aDowcHg7IGJhY2tncm91bmQ6Jyt0aGlzLmZvbnRDb2xvcisnOycgKTtcclxuXHJcbiAgICAgICAgLy8gZmFrZVxyXG4gICAgICAgIHRoaXMuY1s1XSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0c2VsZWN0ICsgJ2hlaWdodDonICsgKHRoaXMuaC00KSArICdweDsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGZvbnQtc3R5bGU6IGl0YWxpYzsgY29sb3I6Jyt0aGlzLmNvbG9ycy5pbnB1dEhvbGRlcisnOycgKTtcclxuICAgICAgICBpZiggdGhpcy52YWx1ZSA9PT0gJycgKSB0aGlzLmNbNV0udGV4dENvbnRlbnQgPSB0aGlzLnBsYWNlSG9sZGVyO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcbiAgICAgICAgaWYoIGwueCA+PSB0aGlzLnNhICkgcmV0dXJuICd0ZXh0JztcclxuICAgICAgICByZXR1cm4gJyc7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgRVZFTlRTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgbW91c2V1cCAoIGUgKSB7XHJcblxyXG4gICAgICAgIGlmKCF0aGlzLmVkaXRhYmxlKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzRG93biApe1xyXG4gICAgICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICAgICAgaWYoIXRoaXMuZWRpdGFibGUpIHJldHVybjtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5pc0Rvd24gKXtcclxuICAgICAgICAgICAgdGhpcy5pc0Rvd24gPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiggbmFtZSA9PT0gJ3RleHQnICkgdGhpcy5zZXRJbnB1dCggdGhpcy5jWzNdICk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICBpZighdGhpcy5lZGl0YWJsZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMudGVzdFpvbmUoIGUgKTtcclxuXHJcbiAgICAgICAgLy9sZXQgbCA9IHRoaXMubG9jYWw7XHJcbiAgICAgICAgLy9pZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICl7IHJldHVybjt9XHJcblxyXG4gICAgICAgIC8vaWYoIGwueCA+PSB0aGlzLnNhICkgdGhpcy5jdXJzb3IoJ3RleHQnKTtcclxuICAgICAgICAvL2Vsc2UgdGhpcy5jdXJzb3IoKTtcclxuXHJcbiAgICAgICAgbGV0IHggPSAwO1xyXG5cclxuICAgICAgICBpZiggbmFtZSA9PT0gJ3RleHQnICkgdGhpcy5jdXJzb3IoJ3RleHQnKTtcclxuICAgICAgICBlbHNlIHRoaXMuY3Vyc29yKCk7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzRG93biApIHggPSBlLmNsaWVudFggLSB0aGlzLnpvbmUueDtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMudXBJbnB1dCggeCAtIHRoaXMuc2EgLTMsIHRoaXMuaXNEb3duICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICByZW5kZXIgKCBjLCBlLCBzICkge1xyXG5cclxuICAgICAgICB0aGlzLnNbNF0ud2lkdGggPSAnMXB4JztcclxuICAgICAgICB0aGlzLnNbNF0ubGVmdCA9ICh0aGlzLnNhICsgYys1KSArICdweCc7XHJcblxyXG4gICAgICAgIHRoaXMuc1syXS5sZWZ0ID0gKHRoaXMuc2EgKyBlKzUpICsgJ3B4JztcclxuICAgICAgICB0aGlzLnNbMl0ud2lkdGggPSBzKydweCc7XHJcbiAgICBcclxuICAgIH1cclxuXHJcblxyXG4gICAgcmVzZXQgKCkge1xyXG5cclxuICAgICAgICB0aGlzLmN1cnNvcigpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIElOUFVUXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgc2VsZWN0ICggYywgZSwgdyApIHtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgbGV0IGQgPSB0aGlzLnNhICsgNTtcclxuICAgICAgICBzWzRdLndpZHRoID0gJzFweCc7XHJcbiAgICAgICAgc1s0XS5sZWZ0ID0gKCBkICsgYyApICsgJ3B4JztcclxuICAgICAgICBzWzJdLmxlZnQgPSAoIGQgKyBlICkgKyAncHgnO1xyXG4gICAgICAgIHNbMl0ud2lkdGggPSB3ICsgJ3B4JztcclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHVuc2VsZWN0ICgpIHtcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLnM7XHJcbiAgICAgICAgaWYoIXMpIHJldHVybjtcclxuICAgICAgICBzWzJdLndpZHRoID0gMCArICdweCc7XHJcbiAgICAgICAgc1s0XS53aWR0aCA9IDAgKyAncHgnO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB2YWxpZGF0ZSAoIGZvcmNlICkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5hbGx3YXkgKSBmb3JjZSA9IHRydWU7IFxyXG5cclxuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5jWzNdLnRleHRDb250ZW50O1xyXG5cclxuICAgICAgICBpZih0aGlzLnZhbHVlICE9PSAnJykgdGhpcy5jWzVdLnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgICAgZWxzZSB0aGlzLmNbNV0udGV4dENvbnRlbnQgPSB0aGlzLnBsYWNlSG9sZGVyO1xyXG5cclxuICAgICAgICBpZiggIWZvcmNlICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLnNlbmQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBSRVpJU0VcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICByU2l6ZSAoKSB7XHJcblxyXG4gICAgICAgIHN1cGVyLnJTaXplKCk7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG4gICAgICAgIHNbM10ubGVmdCA9IHRoaXMuc2EgKyAncHgnO1xyXG4gICAgICAgIHNbM10ud2lkdGggPSB0aGlzLnNiICsgJ3B4JztcclxuXHJcbiAgICAgICAgc1s1XS5sZWZ0ID0gdGhpcy5zYSArICdweCc7XHJcbiAgICAgICAgc1s1XS53aWR0aCA9IHRoaXMuc2IgKyAncHgnO1xyXG4gICAgIFxyXG4gICAgfVxyXG5cclxuXHJcbn0iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBUaXRsZSBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG5cclxuICAgICAgICBsZXQgcHJlZml4ID0gby5wcmVmaXggfHwgJyc7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0ICsgJ3RleHQtYWxpZ246cmlnaHQ7IHdpZHRoOjYwcHg7IGxpbmUtaGVpZ2h0OicrICh0aGlzLmgtOCkgKyAncHg7IGNvbG9yOicgKyB0aGlzLmZvbnRDb2xvciApO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5oID09PSAzMSApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zWzBdLmhlaWdodCA9IHRoaXMuaCArICdweCc7XHJcbiAgICAgICAgICAgIHRoaXMuc1sxXS50b3AgPSA4ICsgJ3B4JztcclxuICAgICAgICAgICAgdGhpcy5jWzJdLnN0eWxlLnRvcCA9IDggKyAncHgnO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY1sxXS50ZXh0Q29udGVudCA9IHRoaXMudHh0LnN1YnN0cmluZygwLDEpLnRvVXBwZXJDYXNlKCkgKyB0aGlzLnR4dC5zdWJzdHJpbmcoMSkucmVwbGFjZShcIi1cIiwgXCIgXCIpO1xyXG4gICAgICAgIHRoaXMuY1syXS50ZXh0Q29udGVudCA9IHByZWZpeDtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRleHQgKCB0eHQgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY1sxXS50ZXh0Q29udGVudCA9IHR4dDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdGV4dDIgKCB0eHQgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY1syXS50ZXh0Q29udGVudCA9IHR4dDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgclNpemUgKCkge1xyXG5cclxuICAgICAgICBzdXBlci5yU2l6ZSgpO1xyXG4gICAgICAgIHRoaXMuc1sxXS53aWR0aCA9IHRoaXMudyAtIDUwICsgJ3B4JztcclxuICAgICAgICB0aGlzLnNbMl0ubGVmdCA9IHRoaXMudyAtICggNTAgKyAyNiApICsgJ3B4JztcclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcbmV4cG9ydCBjbGFzcyBTZWxlY3QgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IG8udmFsdWUgfHwgJyc7XHJcblxyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMub25BY3RpZiA9IG8ub25BY3RpZiB8fCBmdW5jdGlvbigpe307XHJcblxyXG4gICAgICAgIHRoaXMuYnV0dG9uQ29sb3IgPSBvLmJDb2xvciB8fCB0aGlzLmNvbG9ycy5idXR0b247XHJcbiAgICAgICAgdGhpcy5idXR0b25PdmVyID0gby5iT3ZlciB8fCB0aGlzLmNvbG9ycy5vdmVyO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uRG93biA9IG8uYkRvd24gfHwgdGhpcy5jb2xvcnMuc2VsZWN0O1xyXG4gICAgICAgIHRoaXMuYnV0dG9uQWN0aW9uID0gby5iQWN0aW9uIHx8IHRoaXMuY29sb3JzLmFjdGlvbjtcclxuXHJcbiAgICAgICAgbGV0IHByZWZpeCA9IG8ucHJlZml4IHx8ICcnO1xyXG5cclxuICAgICAgICB0aGlzLmNbMl0gPSB0aGlzLmRvbSggJ2RpdicsIHRoaXMuY3NzLnR4dCArIHRoaXMuY3NzLmJ1dHRvbiArICcgdG9wOjFweDsgYmFja2dyb3VuZDonK3RoaXMuYnV0dG9uQ29sb3IrJzsgaGVpZ2h0OicrKHRoaXMuaC0yKSsncHg7IGJvcmRlcjonK3RoaXMuY29sb3JzLmJ1dHRvbkJvcmRlcisnOyBib3JkZXItcmFkaXVzOjE1cHg7IHdpZHRoOjMwcHg7IGxlZnQ6MTBweDsnICk7XHJcbiAgICAgICAgdGhpcy5jWzJdLnN0eWxlLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcblxyXG4gICAgICAgIHRoaXMuY1szXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0c2VsZWN0ICsgJ2hlaWdodDonICsgKHRoaXMuaC00KSArICdweDsgYmFja2dyb3VuZDonICsgdGhpcy5jb2xvcnMuaW5wdXRCZyArICc7IGJvcmRlckNvbG9yOicgKyB0aGlzLmNvbG9ycy5pbnB1dEJvcmRlcisnOyBib3JkZXItcmFkaXVzOicrdGhpcy5yYWRpdXMrJ3B4OycgKTtcclxuICAgICAgICB0aGlzLmNbM10udGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlO1xyXG5cclxuICAgICAgICBsZXQgZmx0b3AgPSBNYXRoLmZsb29yKHRoaXMuaCowLjUpLTc7XHJcbiAgICAgICAgdGhpcy5jWzRdID0gdGhpcy5kb20oICdwYXRoJywgdGhpcy5jc3MuYmFzaWMgKyAncG9zaXRpb246YWJzb2x1dGU7IHdpZHRoOjE0cHg7IGhlaWdodDoxNHB4OyBsZWZ0OjVweDsgdG9wOicrZmx0b3ArJ3B4OycsIHsgZDp0aGlzLnN2Z3NbICdjdXJzb3InIF0sIGZpbGw6dGhpcy5mb250Q29sb3IsIHN0cm9rZTonbm9uZSd9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zdGF0ID0gMTtcclxuICAgICAgICB0aGlzLmlzQWN0aWYgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gJyc7XHJcbiAgICAgICAgaWYoIGwueCA+IHRoaXMuc2EgJiYgbC54IDwgdGhpcy5zYSszMCApIHJldHVybiAnb3Zlcic7XHJcbiAgICAgICAgcmV0dXJuICcwJ1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEVWRU5UU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1vdXNldXAgKCBlICkge1xyXG4gICAgXHJcbiAgICAgICAgaWYoIHRoaXMuaXNEb3duICl7XHJcbiAgICAgICAgICAgIC8vdGhpcy52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL3RoaXMuc2VuZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIGlmKCAhbmFtZSApIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5pc0Rvd24gPSB0cnVlO1xyXG4gICAgICAgIC8vdGhpcy52YWx1ZSA9IHRoaXMudmFsdWVzWyBuYW1lLTIgXTtcclxuICAgICAgICAvL3RoaXMuc2VuZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgdXAgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcbiAgICAgICAgLy9sZXQgc2VsID0gZmFsc2U7XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKG5hbWUpXHJcblxyXG4gICAgICAgIGlmKCBuYW1lID09PSAnb3ZlcicgKXtcclxuICAgICAgICAgICAgdGhpcy5jdXJzb3IoJ3BvaW50ZXInKTtcclxuICAgICAgICAgICAgdXAgPSB0aGlzLm1vZGUoIHRoaXMuaXNEb3duID8gMyA6IDIgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB1cCA9IHRoaXMucmVzZXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB1cDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGFwcGx5ICggdiApIHtcclxuXHJcbiAgICAgICAgdiA9IHYgfHwgJyc7XHJcblxyXG4gICAgICAgIGlmKCB2ICE9PSB0aGlzLnZhbHVlICkge1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdjtcclxuICAgICAgICAgICAgdGhpcy5jWzNdLnRleHRDb250ZW50ID0gdGhpcy52YWx1ZTtcclxuICAgICAgICAgICAgdGhpcy5zZW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMubW9kZSgxKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5tb2RlKCAzICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZGUgKCBuICkge1xyXG5cclxuICAgICAgICBsZXQgY2hhbmdlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnN0YXQgIT09IG4gKXtcclxuXHJcbiAgICAgICAgICAgIGlmKCBuPT09MSApIHRoaXMuaXNBY3RpZiA9IGZhbHNlOztcclxuXHJcbiAgICAgICAgICAgIGlmKCBuPT09MyApeyBcclxuICAgICAgICAgICAgICAgIGlmKCAhdGhpcy5pc0FjdGlmICl7IHRoaXMuaXNBY3RpZiA9IHRydWU7IG49NDsgdGhpcy5vbkFjdGlmKCB0aGlzICk7IH1cclxuICAgICAgICAgICAgICAgIGVsc2UgeyB0aGlzLmlzQWN0aWYgPSBmYWxzZTsgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiggbj09PTIgJiYgdGhpcy5pc0FjdGlmICkgbiA9IDQ7XHJcblxyXG4gICAgICAgICAgICBzd2l0Y2goIG4gKXtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6IHRoaXMuc3RhdCA9IDE7IHRoaXMuc1sgMiBdLmNvbG9yID0gdGhpcy5mb250Q29sb3I7ICB0aGlzLnNbIDIgXS5iYWNrZ3JvdW5kID0gdGhpcy5idXR0b25Db2xvcjsgYnJlYWs7IC8vIGJhc2VcclxuICAgICAgICAgICAgICAgIGNhc2UgMjogdGhpcy5zdGF0ID0gMjsgdGhpcy5zWyAyIF0uY29sb3IgPSB0aGlzLmZvbnRTZWxlY3Q7IHRoaXMuc1sgMiBdLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbk92ZXI7IGJyZWFrOyAvLyBvdmVyXHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6IHRoaXMuc3RhdCA9IDM7IHRoaXMuc1sgMiBdLmNvbG9yID0gdGhpcy5mb250U2VsZWN0OyB0aGlzLnNbIDIgXS5iYWNrZ3JvdW5kID0gdGhpcy5idXR0b25Eb3duOyBicmVhazsgLy8gZG93blxyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiB0aGlzLnN0YXQgPSA0OyB0aGlzLnNbIDIgXS5jb2xvciA9IHRoaXMuZm9udFNlbGVjdDsgdGhpcy5zWyAyIF0uYmFja2dyb3VuZCA9IHRoaXMuYnV0dG9uQWN0aW9uOyBicmVhazsgLy8gYWN0aWZcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNoYW5nZSA9IHRydWU7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGNoYW5nZTtcclxuXHJcblxyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXNldCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY3Vyc29yKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kZSggdGhpcy5pc0FjdGlmID8gNCA6IDEgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdGV4dCAoIHR4dCApIHtcclxuXHJcbiAgICAgICAgdGhpcy5jWzNdLnRleHRDb250ZW50ID0gdHh0O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByU2l6ZSAoKSB7XHJcblxyXG4gICAgICAgIHN1cGVyLnJTaXplKCk7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG4gICAgICAgIHNbMl0ubGVmdCA9IHRoaXMuc2EgKyAncHgnO1xyXG4gICAgICAgIHNbM10ubGVmdCA9ICh0aGlzLnNhICsgNDApICsgJ3B4JztcclxuICAgICAgICBzWzNdLndpZHRoID0gKHRoaXMuc2IgLSA0MCkgKyAncHgnO1xyXG4gICAgICAgIHNbNF0ubGVmdCA9ICh0aGlzLnNhKzgpICsgJ3B4JztcclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcbmV4cG9ydCBjbGFzcyBTZWxlY3RvciBleHRlbmRzIFByb3RvIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICBzdXBlciggbyApO1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlcyA9IG8udmFsdWVzO1xyXG4gICAgICAgIGlmKHR5cGVvZiB0aGlzLnZhbHVlcyA9PT0gJ3N0cmluZycgKSB0aGlzLnZhbHVlcyA9IFsgdGhpcy52YWx1ZXMgXTtcclxuXHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IG8udmFsdWUgfHwgdGhpcy52YWx1ZXNbMF07XHJcblxyXG5cclxuXHJcbiAgICAgICAgLy90aGlzLnNlbGVjdGVkID0gbnVsbDtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmJ1dHRvbkNvbG9yID0gby5iQ29sb3IgfHwgdGhpcy5jb2xvcnMuYnV0dG9uO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uT3ZlciA9IG8uYk92ZXIgfHwgdGhpcy5jb2xvcnMub3ZlcjtcclxuICAgICAgICB0aGlzLmJ1dHRvbkRvd24gPSBvLmJEb3duIHx8IHRoaXMuY29sb3JzLnNlbGVjdDtcclxuXHJcbiAgICAgICAgdGhpcy5sbmcgPSB0aGlzLnZhbHVlcy5sZW5ndGg7XHJcbiAgICAgICAgdGhpcy50bXAgPSBbXTtcclxuICAgICAgICB0aGlzLnN0YXQgPSBbXTtcclxuXHJcbiAgICAgICAgbGV0IHNlbDtcclxuXHJcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMubG5nOyBpKyspe1xyXG5cclxuICAgICAgICAgICAgc2VsID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmKCB0aGlzLnZhbHVlc1tpXSA9PT0gdGhpcy52YWx1ZSApIHNlbCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNbaSsyXSA9IHRoaXMuZG9tKCAnZGl2JywgdGhpcy5jc3MudHh0ICsgdGhpcy5jc3MuYnV0dG9uICsgJyB0b3A6MXB4OyBiYWNrZ3JvdW5kOicrKHNlbD8gdGhpcy5idXR0b25Eb3duIDogdGhpcy5idXR0b25Db2xvcikrJzsgaGVpZ2h0OicrKHRoaXMuaC0yKSsncHg7IGJvcmRlcjonK3RoaXMuY29sb3JzLmJ1dHRvbkJvcmRlcisnOyBib3JkZXItcmFkaXVzOicrdGhpcy5yYWRpdXMrJ3B4OycgKTtcclxuICAgICAgICAgICAgdGhpcy5jW2krMl0uc3R5bGUuY29sb3IgPSBzZWwgPyB0aGlzLmZvbnRTZWxlY3QgOiB0aGlzLmZvbnRDb2xvcjtcclxuICAgICAgICAgICAgdGhpcy5jW2krMl0uaW5uZXJIVE1MID0gdGhpcy52YWx1ZXNbaV07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLnN0YXRbaV0gPSBzZWwgPyAzOjE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgICBcclxuICAgIH1cclxuXHJcbiAgICB0ZXN0Wm9uZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBsID0gdGhpcy5sb2NhbDtcclxuICAgICAgICBpZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICkgcmV0dXJuICcnO1xyXG5cclxuICAgICAgICBsZXQgaSA9IHRoaXMubG5nO1xyXG4gICAgICAgIGxldCB0ID0gdGhpcy50bXA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUoIGktLSApe1xyXG4gICAgICAgIFx0aWYoIGwueD50W2ldWzBdICYmIGwueDx0W2ldWzJdICkgcmV0dXJuIGkrMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAnJ1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEVWRU5UU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1vdXNldXAgKCBlICkge1xyXG4gICAgXHJcbiAgICAgICAgaWYoIHRoaXMuaXNEb3duICl7XHJcbiAgICAgICAgICAgIC8vdGhpcy52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL3RoaXMuc2VuZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tb3VzZW1vdmUoIGUgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2Vkb3duICggZSApIHtcclxuXHJcbiAgICBcdGxldCBuYW1lID0gdGhpcy50ZXN0Wm9uZSggZSApO1xyXG5cclxuICAgICAgICBpZiggIW5hbWUgKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgXHR0aGlzLmlzRG93biA9IHRydWU7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMudmFsdWVzWyBuYW1lLTIgXTtcclxuICAgICAgICB0aGlzLnNlbmQoKTtcclxuICAgIFx0cmV0dXJuIHRoaXMubW91c2Vtb3ZlKCBlICk7XHJcbiBcclxuICAgICAgICAvLyB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgdXAgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcbiAgICAgICAgLy9sZXQgc2VsID0gZmFsc2U7XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKG5hbWUpXHJcblxyXG4gICAgICAgIGlmKCBuYW1lICE9PSAnJyApe1xyXG4gICAgICAgICAgICB0aGlzLmN1cnNvcigncG9pbnRlcicpO1xyXG4gICAgICAgICAgICB1cCA9IHRoaXMubW9kZXMoIHRoaXMuaXNEb3duID8gMyA6IDIsIG5hbWUgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgIFx0dXAgPSB0aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdXA7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb2RlcyAoIG4sIG5hbWUgKSB7XHJcblxyXG4gICAgICAgIGxldCB2LCByID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy5sbmc7IGkrKyApe1xyXG5cclxuICAgICAgICAgICAgaWYoIGkgPT09IG5hbWUtMiAmJiB0aGlzLnZhbHVlc1sgaSBdICE9PSB0aGlzLnZhbHVlICkgdiA9IHRoaXMubW9kZSggbiwgaSsyICk7XHJcbiAgICAgICAgICAgIGVsc2V7IFxyXG5cclxuICAgICAgICAgICAgICAgIGlmKCB0aGlzLnZhbHVlc1sgaSBdID09PSB0aGlzLnZhbHVlICkgdiA9IHRoaXMubW9kZSggMywgaSsyICk7XHJcbiAgICAgICAgICAgICAgICBlbHNlIHYgPSB0aGlzLm1vZGUoIDEsIGkrMiApO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYodikgciA9IHRydWU7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHI7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZGUgKCBuLCBuYW1lICkge1xyXG5cclxuICAgICAgICBsZXQgY2hhbmdlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGxldCBpID0gbmFtZSAtIDI7XHJcblxyXG5cclxuICAgICAgICBpZiggdGhpcy5zdGF0W2ldICE9PSBuICl7XHJcblxyXG4gICAgICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBzd2l0Y2goIG4gKXtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6IHRoaXMuc3RhdFtpXSA9IDE7IHRoaXMuc1sgaSsyIF0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjsgIHRoaXMuc1sgaSsyIF0uYmFja2dyb3VuZCA9IHRoaXMuYnV0dG9uQ29sb3I7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOiB0aGlzLnN0YXRbaV0gPSAyOyB0aGlzLnNbIGkrMiBdLmNvbG9yID0gdGhpcy5mb250U2VsZWN0OyB0aGlzLnNbIGkrMiBdLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbk92ZXI7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOiB0aGlzLnN0YXRbaV0gPSAzOyB0aGlzLnNbIGkrMiBdLmNvbG9yID0gdGhpcy5mb250U2VsZWN0OyB0aGlzLnNbIGkrMiBdLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbkRvd247IGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2hhbmdlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICByZXR1cm4gY2hhbmdlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgcmVzZXQgKCkge1xyXG5cclxuICAgICAgICB0aGlzLmN1cnNvcigpO1xyXG5cclxuICAgICAgICBsZXQgdiwgciA9IGZhbHNlO1xyXG5cclxuICAgICAgICBmb3IoIGxldCBpID0gMDsgaSA8IHRoaXMubG5nOyBpKysgKXtcclxuXHJcbiAgICAgICAgICAgIGlmKCB0aGlzLnZhbHVlc1sgaSBdID09PSB0aGlzLnZhbHVlICkgdiA9IHRoaXMubW9kZSggMywgaSsyICk7XHJcbiAgICAgICAgICAgIGVsc2UgdiA9IHRoaXMubW9kZSggMSwgaSsyICk7XHJcbiAgICAgICAgICAgIGlmKHYpIHIgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHI7Ly90aGlzLm1vZGVzKCAxICwgMiApO1xyXG5cclxuICAgIFx0LyppZiggdGhpcy5zZWxlY3RlZCApe1xyXG4gICAgXHRcdHRoaXMuc1sgdGhpcy5zZWxlY3RlZCBdLmNvbG9yID0gdGhpcy5mb250Q29sb3I7XHJcbiAgICAgICAgICAgIHRoaXMuc1sgdGhpcy5zZWxlY3RlZCBdLmJhY2tncm91bmQgPSB0aGlzLmJ1dHRvbkNvbG9yO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkID0gbnVsbDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgXHR9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlOyovXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGxhYmVsICggc3RyaW5nLCBuICkge1xyXG5cclxuICAgICAgICBuID0gbiB8fCAyO1xyXG4gICAgICAgIHRoaXMuY1tuXS50ZXh0Q29udGVudCA9IHN0cmluZztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgaWNvbiAoIHN0cmluZywgeSwgbiApIHtcclxuXHJcbiAgICAgICAgbiA9IG4gfHwgMjtcclxuICAgICAgICB0aGlzLnNbbl0ucGFkZGluZyA9ICggeSB8fCAwICkgKydweCAwcHgnO1xyXG4gICAgICAgIHRoaXMuY1tuXS5pbm5lckhUTUwgPSBzdHJpbmc7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJTaXplICgpIHtcclxuXHJcbiAgICAgICAgc3VwZXIuclNpemUoKTs7XHJcblxyXG4gICAgICAgIGxldCBzID0gdGhpcy5zO1xyXG4gICAgICAgIGxldCB3ID0gdGhpcy5zYjtcclxuICAgICAgICBsZXQgZCA9IHRoaXMuc2E7XHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy5sbmc7XHJcbiAgICAgICAgbGV0IGRjID0gIDM7XHJcbiAgICAgICAgbGV0IHNpemUgPSBNYXRoLmZsb29yKCAoIHctKGRjKihpLTEpKSApIC8gaSApO1xyXG5cclxuICAgICAgICB3aGlsZShpLS0pe1xyXG5cclxuICAgICAgICBcdHRoaXMudG1wW2ldID0gWyBNYXRoLmZsb29yKCBkICsgKCBzaXplICogaSApICsgKCBkYyAqIGkgKSksIHNpemUgXTtcclxuICAgICAgICBcdHRoaXMudG1wW2ldWzJdID0gdGhpcy50bXBbaV1bMF0gKyB0aGlzLnRtcFtpXVsxXTtcclxuICAgICAgICAgICAgc1tpKzJdLmxlZnQgPSB0aGlzLnRtcFtpXVswXSArICdweCc7XHJcbiAgICAgICAgICAgIHNbaSsyXS53aWR0aCA9IHRoaXMudG1wW2ldWzFdICsgJ3B4JztcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5cclxuZXhwb3J0IGNsYXNzIEVtcHR5IGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG5cdCAgICBvLnNpbXBsZSA9IHRydWU7XHJcblx0ICAgIG8uaXNFbXB0eSA9IHRydWU7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgfVxyXG4gICAgXHJcbn1cclxuIiwiaW1wb3J0IHsgUHJvdG8gfSBmcm9tICcuLi9jb3JlL1Byb3RvJztcclxuXHJcbmV4cG9ydCBjbGFzcyBJdGVtIGV4dGVuZHMgUHJvdG8ge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCBvID0ge30gKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCBvICk7XHJcblxyXG4gICAgICAgIHRoaXMucCA9IDEwMDtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy50eHQ7XHJcbiAgICAgICAgdGhpcy5zdGF0dXMgPSAxO1xyXG5cclxuICAgICAgICB0aGlzLml0eXBlID0gby5pdHlwZSB8fCAnbm9uZSc7XHJcbiAgICAgICAgdGhpcy52YWwgPSB0aGlzLml0eXBlO1xyXG5cclxuICAgICAgICB0aGlzLmdyYXBoID0gdGhpcy5zdmdzWyB0aGlzLml0eXBlIF07XHJcblxyXG4gICAgICAgIGxldCBmbHRvcCA9IE1hdGguZmxvb3IodGhpcy5oKjAuNSktNztcclxuXHJcbiAgICAgICAgdGhpcy5jWzJdID0gdGhpcy5kb20oICdwYXRoJywgdGhpcy5jc3MuYmFzaWMgKyAncG9zaXRpb246YWJzb2x1dGU7IHdpZHRoOjE0cHg7IGhlaWdodDoxNHB4OyBsZWZ0OjVweDsgdG9wOicrZmx0b3ArJ3B4OycsIHsgZDp0aGlzLmdyYXBoLCBmaWxsOnRoaXMuZm9udENvbG9yLCBzdHJva2U6J25vbmUnfSk7XHJcblxyXG4gICAgICAgIHRoaXMuc1sxXS5tYXJnaW5MZWZ0ID0gMjAgKyAncHgnO1xyXG5cclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICB0aGlzLmN1cnNvcigncG9pbnRlcicpO1xyXG5cclxuICAgICAgICAvL3VwID0gdGhpcy5tb2RlcyggdGhpcy5pc0Rvd24gPyAzIDogMiwgbmFtZSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc1VJICkgdGhpcy5tYWluLnJlc2V0SXRlbSgpO1xyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdGVkKCB0cnVlICk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VuZCgpO1xyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdWlvdXQgKCkge1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc1NlbGVjdCApIHRoaXMubW9kZSgzKTtcclxuICAgICAgICBlbHNlIHRoaXMubW9kZSgxKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdWlvdmVyICgpIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNTZWxlY3QgKSB0aGlzLm1vZGUoNCk7XHJcbiAgICAgICAgZWxzZSB0aGlzLm1vZGUoMik7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZSAoKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIC8qclNpemUgKCkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIHN1cGVyLnJTaXplKCk7XHJcblxyXG4gICAgfSovXHJcblxyXG4gICAgbW9kZSAoIG4gKSB7XHJcblxyXG4gICAgICAgIGxldCBjaGFuZ2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuc3RhdHVzICE9PSBuICl7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnN0YXR1cyA9IG47XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIHN3aXRjaCggbiApe1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgMTogdGhpcy5zdGF0dXMgPSAxOyB0aGlzLnNbMV0uY29sb3IgPSB0aGlzLmZvbnRDb2xvcjsgdGhpcy5zWzBdLmJhY2tncm91bmQgPSAnbm9uZSc7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOiB0aGlzLnN0YXR1cyA9IDI7IHRoaXMuc1sxXS5jb2xvciA9IHRoaXMuZm9udENvbG9yOyB0aGlzLnNbMF0uYmFja2dyb3VuZCA9IHRoaXMuYmdPdmVyOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgMzogdGhpcy5zdGF0dXMgPSAzOyB0aGlzLnNbMV0uY29sb3IgPSAnI0ZGRic7ICAgICAgICAgdGhpcy5zWzBdLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zZWxlY3Q7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiB0aGlzLnN0YXR1cyA9IDQ7IHRoaXMuc1sxXS5jb2xvciA9ICcjRkZGJzsgICAgICAgICB0aGlzLnNbMF0uYmFja2dyb3VuZCA9IHRoaXMuY29sb3JzLmRvd247IGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2hhbmdlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gY2hhbmdlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXNldCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY3Vyc29yKCk7XHJcbiAgICAgICAvLyByZXR1cm4gdGhpcy5tb2RlKCAxICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNlbGVjdGVkICggYiApe1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc1NlbGVjdCApIHRoaXMubW9kZSgxKTtcclxuXHJcbiAgICAgICAgdGhpcy5pc1NlbGVjdCA9IGIgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzU2VsZWN0ICkgdGhpcy5tb2RlKDMpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuXHJcbn0iLCJpbXBvcnQgeyBQcm90byB9IGZyb20gJy4uL2NvcmUvUHJvdG8nO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdyaWQgZXh0ZW5kcyBQcm90byB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoIG8gPSB7fSApIHtcclxuXHJcbiAgICAgICAgc3VwZXIoIG8gKTtcclxuXHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnZhbHVlcyA9IG8udmFsdWVzIHx8IFtdO1xyXG5cclxuICAgICAgICBpZiggdHlwZW9mIHRoaXMudmFsdWVzID09PSAnc3RyaW5nJyApIHRoaXMudmFsdWVzID0gWyB0aGlzLnZhbHVlcyBdO1xyXG5cclxuICAgICAgICAvL3RoaXMuc2VsZWN0ZWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuYnV0dG9uQ29sb3IgPSBvLmJDb2xvciB8fCB0aGlzLmNvbG9ycy5idXR0b247XHJcbiAgICAgICAgdGhpcy5idXR0b25PdmVyID0gby5iT3ZlciB8fCB0aGlzLmNvbG9ycy5vdmVyO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uRG93biA9IG8uYkRvd24gfHwgdGhpcy5jb2xvcnMuc2VsZWN0O1xyXG5cclxuICAgICAgICB0aGlzLnNwYWNlcyA9IG8uc3BhY2VzIHx8IFsxMCwzXTtcclxuICAgICAgICB0aGlzLmJzaXplID0gby5ic2l6ZSB8fCBbOTAsMjBdO1xyXG5cclxuXHJcblxyXG4gICAgICAgIHRoaXMubG5nID0gdGhpcy52YWx1ZXMubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMudG1wID0gW107XHJcbiAgICAgICAgdGhpcy5zdGF0ID0gW107XHJcbiAgICAgICAgdGhpcy5ncmlkID0gWzIsIE1hdGgucm91bmQoIHRoaXMubG5nICogMC41ICkgXTtcclxuICAgICAgICB0aGlzLmggPSBNYXRoLnJvdW5kKCB0aGlzLmxuZyAqIDAuNSApICogKCB0aGlzLmJzaXplWzFdICsgdGhpcy5zcGFjZXNbMV0gKSArIHRoaXMuc3BhY2VzWzFdOyBcclxuICAgICAgICB0aGlzLmNbMV0udGV4dENvbnRlbnQgPSAnJztcclxuXHJcbiAgICAgICAgdGhpcy5jWzJdID0gdGhpcy5kb20oICd0YWJsZScsIHRoaXMuY3NzLmJhc2ljICsgJ3dpZHRoOjEwMCU7IHRvcDonKyh0aGlzLnNwYWNlc1sxXS0yKSsncHg7IGhlaWdodDphdXRvOyBib3JkZXItY29sbGFwc2U6c2VwYXJhdGU7IGJvcmRlcjpub25lOyBib3JkZXItc3BhY2luZzogJysodGhpcy5zcGFjZXNbMF0tMikrJ3B4ICcrKHRoaXMuc3BhY2VzWzFdLTIpKydweDsnICk7XHJcblxyXG4gICAgICAgIGxldCBuID0gMCwgYiwgbWlkLCB0ZCwgdHI7XHJcblxyXG4gICAgICAgIHRoaXMuYnV0dG9ucyA9IFtdO1xyXG4gICAgICAgIHRoaXMuc3RhdCA9IFtdO1xyXG4gICAgICAgIHRoaXMudG1wWCA9IFtdO1xyXG4gICAgICAgIHRoaXMudG1wWSA9IFtdO1xyXG5cclxuXHJcbiAgICAgICAgZm9yKCBsZXQgaSA9IDA7IGkgPCB0aGlzLmdyaWRbMV07IGkrKyApe1xyXG4gICAgICAgICAgICB0ciA9IHRoaXMuY1syXS5pbnNlcnRSb3coKTtcclxuICAgICAgICAgICAgdHIuc3R5bGUuY3NzVGV4dCA9ICdwb2ludGVyLWV2ZW50czpub25lOyc7XHJcbiAgICAgICAgICAgIGZvciggbGV0IGogPSAwOyBqIDwgdGhpcy5ncmlkWzBdOyBqKysgKXtcclxuXHJcbiAgICAgICAgICAgICAgICB0ZCA9IHRyLmluc2VydENlbGwoKTtcclxuICAgICAgICAgICAgICAgIHRkLnN0eWxlLmNzc1RleHQgPSAncG9pbnRlci1ldmVudHM6bm9uZTsnO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCB0aGlzLnZhbHVlc1tuXSApe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTtcclxuICAgICAgICAgICAgICAgICAgICBiLnN0eWxlLmNzc1RleHQgPSB0aGlzLmNzcy50eHQgKyB0aGlzLmNzcy5idXR0b24gKyAncG9zaXRpb246c3RhdGljOyB3aWR0aDonK3RoaXMuYnNpemVbMF0rJ3B4OyBoZWlnaHQ6Jyt0aGlzLmJzaXplWzFdKydweDsgYm9yZGVyOicrdGhpcy5jb2xvcnMuYnV0dG9uQm9yZGVyKyc7IGxlZnQ6YXV0bzsgcmlnaHQ6YXV0bzsgYmFja2dyb3VuZDonK3RoaXMuYnV0dG9uQ29sb3IrJzsgIGJvcmRlci1yYWRpdXM6Jyt0aGlzLnJhZGl1cysncHg7JztcclxuICAgICAgICAgICAgICAgICAgICBiLmlubmVySFRNTCA9IHRoaXMudmFsdWVzW25dO1xyXG4gICAgICAgICAgICAgICAgICAgIHRkLmFwcGVuZENoaWxkKCBiICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnV0dG9ucy5wdXNoKGIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdC5wdXNoKDEpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xyXG4gICAgICAgICAgICAgICAgICAgIGIuc3R5bGUuY3NzVGV4dCA9IHRoaXMuY3NzLnR4dCArICdwb3NpdGlvbjpzdGF0aWM7IHdpZHRoOicrdGhpcy5ic2l6ZVswXSsncHg7IGhlaWdodDonK3RoaXMuYnNpemVbMV0rJ3B4OyB0ZXh0LWFsaWduOmNlbnRlcjsgIGxlZnQ6YXV0bzsgcmlnaHQ6YXV0bzsgYmFja2dyb3VuZDpub25lOyc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGQuYXBwZW5kQ2hpbGQoIGIgKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoaj09PTApIGIuc3R5bGUuY3NzVGV4dCArPSAnZmxvYXQ6cmlnaHQ7JztcclxuICAgICAgICAgICAgICAgIGVsc2UgYi5zdHlsZS5jc3NUZXh0ICs9ICdmbG9hdDpsZWZ0Oyc7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgbisrO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRlc3Rab25lICggZSApIHtcclxuXHJcbiAgICAgICAgbGV0IGwgPSB0aGlzLmxvY2FsO1xyXG4gICAgICAgIGlmKCBsLnggPT09IC0xICYmIGwueSA9PT0gLTEgKSByZXR1cm4gLTE7XHJcblxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCB0eCA9IHRoaXMudG1wWDtcclxuICAgICAgICBsZXQgdHkgPSB0aGlzLnRtcFk7XHJcblxyXG4gICAgICAgIGxldCBpZCA9IC0xO1xyXG4gICAgICAgIGxldCBjID0gLTE7XHJcbiAgICAgICAgbGV0IGxpbmUgPSAtMTtcclxuICAgICAgICBsZXQgaSA9IHRoaXMuZ3JpZFswXTtcclxuICAgICAgICB3aGlsZSggaS0tICl7XHJcbiAgICAgICAgXHRpZiggbC54ID4gdHhbaV1bMF0gJiYgbC54IDwgdHhbaV1bMV0gKSBjID0gaTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGkgPSB0aGlzLmdyaWRbMV07XHJcbiAgICAgICAgd2hpbGUoIGktLSApe1xyXG4gICAgICAgICAgICBpZiggbC55ID4gdHlbaV1bMF0gJiYgbC55IDwgdHlbaV1bMV0gKSBsaW5lID0gaTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKGMhPT0tMSAmJiBsaW5lIT09LTEpe1xyXG4gICAgICAgICAgICBpZCA9IGMgKyAobGluZSoyKTtcclxuICAgICAgICAgICAgaWYoaWQ+dGhpcy5sbmctMSkgaWQgPSAtMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBpZDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb3VzZXVwICggZSApIHtcclxuICAgIFxyXG4gICAgICAgIGlmKCB0aGlzLmlzRG93biApe1xyXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vdGhpcy5zZW5kKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZWRvd24gKCBlICkge1xyXG5cclxuICAgIFx0bGV0IGlkID0gdGhpcy50ZXN0Wm9uZSggZSApO1xyXG5cclxuICAgICAgICBpZiggaWQgPCAwICkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIFx0dGhpcy5pc0Rvd24gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlc1tpZF07XHJcbiAgICAgICAgdGhpcy5zZW5kKCk7XHJcbiAgICBcdHJldHVybiB0aGlzLm1vdXNlbW92ZSggZSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb3VzZW1vdmUgKCBlICkge1xyXG5cclxuICAgICAgICBsZXQgdXAgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IGlkID0gdGhpcy50ZXN0Wm9uZSggZSApO1xyXG5cclxuICAgICAgICBpZiggaWQgIT09IC0xICl7XHJcbiAgICAgICAgICAgIHRoaXMuY3Vyc29yKCdwb2ludGVyJyk7XHJcbiAgICAgICAgICAgIHVwID0gdGhpcy5tb2RlcyggdGhpcy5pc0Rvd24gPyAzIDogMiwgaWQgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgIFx0dXAgPSB0aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdXA7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBtb2RlcyAoIG4sIGlkICkge1xyXG5cclxuICAgICAgICBsZXQgdiwgciA9IGZhbHNlO1xyXG5cclxuICAgICAgICBmb3IoIGxldCBpID0gMDsgaSA8IHRoaXMubG5nOyBpKysgKXtcclxuXHJcbiAgICAgICAgICAgIGlmKCBpID09PSBpZCApIHYgPSB0aGlzLm1vZGUoIG4sIGkgKTtcclxuICAgICAgICAgICAgZWxzZSB2ID0gdGhpcy5tb2RlKCAxLCBpICk7XHJcblxyXG4gICAgICAgICAgICBpZih2KSByID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcjtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kZSAoIG4sIGlkICkge1xyXG5cclxuICAgICAgICBsZXQgY2hhbmdlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGxldCBpID0gaWQ7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLnN0YXRbaV0gIT09IG4gKXtcclxuICAgICAgICBcclxuICAgICAgICAgICAgc3dpdGNoKCBuICl7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAxOiB0aGlzLnN0YXRbaV0gPSAxOyB0aGlzLmJ1dHRvbnNbIGkgXS5zdHlsZS5jb2xvciA9IHRoaXMuZm9udENvbG9yOyAgdGhpcy5idXR0b25zWyBpIF0uc3R5bGUuYmFja2dyb3VuZCA9IHRoaXMuYnV0dG9uQ29sb3I7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAyOiB0aGlzLnN0YXRbaV0gPSAyOyB0aGlzLmJ1dHRvbnNbIGkgXS5zdHlsZS5jb2xvciA9IHRoaXMuZm9udFNlbGVjdDsgdGhpcy5idXR0b25zWyBpIF0uc3R5bGUuYmFja2dyb3VuZCA9IHRoaXMuYnV0dG9uT3ZlcjsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDM6IHRoaXMuc3RhdFtpXSA9IDM7IHRoaXMuYnV0dG9uc1sgaSBdLnN0eWxlLmNvbG9yID0gdGhpcy5mb250U2VsZWN0OyB0aGlzLmJ1dHRvbnNbIGkgXS5zdHlsZS5iYWNrZ3JvdW5kID0gdGhpcy5idXR0b25Eb3duOyBicmVhaztcclxuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNoYW5nZSA9IHRydWU7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuXHJcbiAgICAgICAgcmV0dXJuIGNoYW5nZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHJlc2V0ICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJzb3IoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5tb2RlcyggMSAsIDAgKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgbGFiZWwgKCBzdHJpbmcsIG4gKSB7XHJcblxyXG4gICAgICAgIHRoaXMuYnV0dG9uc1tuXS50ZXh0Q29udGVudCA9IHN0cmluZztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgaWNvbiAoIHN0cmluZywgeSwgbiApIHtcclxuXHJcbiAgICAgICAgdGhpcy5idXR0b25zW25dLnN0eWxlLnBhZGRpbmcgPSAoIHkgfHwgMCApICsncHggMHB4JztcclxuICAgICAgICB0aGlzLmJ1dHRvbnNbbl0uaW5uZXJIVE1MID0gc3RyaW5nO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByU2l6ZSAoKSB7XHJcblxyXG4gICAgICAgIHN1cGVyLnJTaXplKCk7XHJcblxyXG4gICAgICAgIGxldCBuID0gMCwgYiwgbWlkO1xyXG5cclxuICAgICAgICB0aGlzLnRtcFggPSBbXTtcclxuICAgICAgICB0aGlzLnRtcFkgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yKCBsZXQgaiA9IDA7IGogPCB0aGlzLmdyaWRbMF07IGorKyApe1xyXG5cclxuICAgICAgICAgICAgaWYoaj09PTApe1xyXG4gICAgICAgICAgICAgICAgbWlkID0gKCB0aGlzLncqMC41ICkgLSAoIHRoaXMuc3BhY2VzWzBdKjAuNSApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50bXBYLnB1c2goIFsgbWlkLXRoaXMuYnNpemVbMF0sIG1pZCBdICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBtaWQgPSAoIHRoaXMudyowLjUgKSArICggdGhpcy5zcGFjZXNbMF0qMC41ICk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRtcFgucHVzaCggWyBtaWQsIG1pZCt0aGlzLmJzaXplWzBdIF0gKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG1pZCA9IHRoaXMuc3BhY2VzWzFdO1xyXG5cclxuICAgICAgICBmb3IoIGxldCBpID0gMDsgaSA8IHRoaXMuZ3JpZFsxXTsgaSsrICl7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRtcFkucHVzaCggWyBtaWQsIG1pZCArIHRoaXMuYnNpemVbMV0gXSApO1xyXG5cclxuICAgICAgICAgICAgbWlkICs9IHRoaXMuYnNpemVbMV0gKyB0aGlzLnNwYWNlc1sxXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn0iLCJcclxuaW1wb3J0IHsgQm9vbCB9IGZyb20gJy4uL3Byb3RvL0Jvb2wuanMnO1xyXG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICcuLi9wcm90by9CdXR0b24uanMnO1xyXG5pbXBvcnQgeyBDaXJjdWxhciB9IGZyb20gJy4uL3Byb3RvL0NpcmN1bGFyLmpzJztcclxuaW1wb3J0IHsgQ29sb3IgfSBmcm9tICcuLi9wcm90by9Db2xvci5qcyc7XHJcbmltcG9ydCB7IEZwcyB9IGZyb20gJy4uL3Byb3RvL0Zwcy5qcyc7XHJcbmltcG9ydCB7IEdyYXBoIH0gZnJvbSAnLi4vcHJvdG8vR3JhcGguanMnO1xyXG5pbXBvcnQgeyBHcm91cCAgfSBmcm9tICcuLi9wcm90by9Hcm91cC5qcyc7XHJcbmltcG9ydCB7IEpveXN0aWNrIH0gZnJvbSAnLi4vcHJvdG8vSm95c3RpY2suanMnO1xyXG5pbXBvcnQgeyBLbm9iIH0gZnJvbSAnLi4vcHJvdG8vS25vYi5qcyc7XHJcbmltcG9ydCB7IExpc3QgfSBmcm9tICcuLi9wcm90by9MaXN0LmpzJztcclxuaW1wb3J0IHsgTnVtZXJpYyB9IGZyb20gJy4uL3Byb3RvL051bWVyaWMuanMnO1xyXG5pbXBvcnQgeyBTbGlkZSB9IGZyb20gJy4uL3Byb3RvL1NsaWRlLmpzJztcclxuaW1wb3J0IHsgVGV4dElucHV0IH0gZnJvbSAnLi4vcHJvdG8vVGV4dElucHV0LmpzJztcclxuaW1wb3J0IHsgVGl0bGUgfSBmcm9tICcuLi9wcm90by9UaXRsZS5qcyc7XHJcbmltcG9ydCB7IFNlbGVjdCB9IGZyb20gJy4uL3Byb3RvL1NlbGVjdC5qcyc7XHJcbmltcG9ydCB7IFNlbGVjdG9yIH0gZnJvbSAnLi4vcHJvdG8vU2VsZWN0b3IuanMnO1xyXG5pbXBvcnQgeyBFbXB0eSB9IGZyb20gJy4uL3Byb3RvL0VtcHR5LmpzJztcclxuaW1wb3J0IHsgSXRlbSB9IGZyb20gJy4uL3Byb3RvL0l0ZW0uanMnO1xyXG5pbXBvcnQgeyBHcmlkIH0gZnJvbSAnLi4vcHJvdG8vR3JpZC5qcyc7XHJcblxyXG5leHBvcnQgY2xhc3MgYWRkIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciAoKSB7XHJcblxyXG4gICAgICAgIGxldCBhID0gYXJndW1lbnRzOyBcclxuXHJcbiAgICAgICAgbGV0IHR5cGUsIG8sIHJlZiA9IGZhbHNlLCBuID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYoIHR5cGVvZiBhWzBdID09PSAnc3RyaW5nJyApeyBcclxuXHJcbiAgICAgICAgICAgIHR5cGUgPSBhWzBdO1xyXG4gICAgICAgICAgICBvID0gYVsxXSB8fCB7fTtcclxuXHJcbiAgICAgICAgfSBlbHNlIGlmICggdHlwZW9mIGFbMF0gPT09ICdvYmplY3QnICl7IC8vIGxpa2UgZGF0IGd1aVxyXG5cclxuICAgICAgICAgICAgcmVmID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYoIGFbMl0gPT09IHVuZGVmaW5lZCApIFtdLnB1c2guY2FsbChhLCB7fSk7XHJcblxyXG4gICAgICAgICAgICB0eXBlID0gYVsyXS50eXBlID8gYVsyXS50eXBlIDogJ3NsaWRlJzsvL2F1dG9UeXBlLmFwcGx5KCB0aGlzLCBhICk7XHJcblxyXG4gICAgICAgICAgICBvID0gYVsyXTtcclxuICAgICAgICAgICAgby5uYW1lID0gYVsxXTtcclxuICAgICAgICAgICAgby52YWx1ZSA9IGFbMF1bYVsxXV07XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSB0eXBlLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgIGlmKCBuYW1lID09PSAnZ3JvdXAnICkgby5hZGQgPSBhZGQ7XHJcblxyXG4gICAgICAgIHN3aXRjaCggbmFtZSApe1xyXG5cclxuICAgICAgICAgICAgY2FzZSAnYm9vbCc6IG4gPSBuZXcgQm9vbChvKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2J1dHRvbic6IG4gPSBuZXcgQnV0dG9uKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY2lyY3VsYXInOiBuID0gbmV3IENpcmN1bGFyKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY29sb3InOiBuID0gbmV3IENvbG9yKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZnBzJzogbiA9IG5ldyBGcHMobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdncmFwaCc6IG4gPSBuZXcgR3JhcGgobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdncm91cCc6IG4gPSBuZXcgR3JvdXAobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdqb3lzdGljayc6IG4gPSBuZXcgSm95c3RpY2sobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdrbm9iJzogbiA9IG5ldyBLbm9iKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnbGlzdCc6IG4gPSBuZXcgTGlzdChvKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ251bWVyaWMnOiBjYXNlICdudW1iZXInOiBuID0gbmV3IE51bWVyaWMobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdzbGlkZSc6IG4gPSBuZXcgU2xpZGUobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd0ZXh0SW5wdXQnOiBjYXNlICdzdHJpbmcnOiBuID0gbmV3IFRleHRJbnB1dChvKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RpdGxlJzogbiA9IG5ldyBUaXRsZShvKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdCc6IG4gPSBuZXcgU2VsZWN0KG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnc2VsZWN0b3InOiBuID0gbmV3IFNlbGVjdG9yKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZW1wdHknOiBjYXNlICdzcGFjZSc6IG4gPSBuZXcgRW1wdHkobyk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdpdGVtJzogbiA9IG5ldyBJdGVtKG8pOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZ3JpZCc6IG4gPSBuZXcgR3JpZChvKTsgYnJlYWs7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIG4gIT09IG51bGwgKXtcclxuXHJcbiAgICAgICAgICAgIGlmKCByZWYgKSBuLnNldFJlZmVyZW5jeSggYVswXSwgYVsxXSApO1xyXG4gICAgICAgICAgICByZXR1cm4gbjtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxufSIsIlxyXG5pbXBvcnQgeyBSb290cyB9IGZyb20gJy4vUm9vdHMnO1xyXG5pbXBvcnQgeyBUb29scyB9IGZyb20gJy4vVG9vbHMnO1xyXG5pbXBvcnQgeyBhZGQgfSBmcm9tICcuL2FkZCc7XHJcbmltcG9ydCB7IFYyIH0gZnJvbSAnLi9WMic7XHJcblxyXG4vKipcclxuICogQGF1dGhvciBsdGggLyBodHRwczovL2dpdGh1Yi5jb20vbG8tdGhcclxuICovXHJcblxyXG5leHBvcnQgY2xhc3MgR3VpIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciggbyA9IHt9ICkge1xyXG5cclxuICAgICAgICB0aGlzLmNhbnZhcyA9IG51bGw7XHJcblxyXG4gICAgICAgIC8vIGNvbG9yXHJcbiAgICAgICAgdGhpcy5jb2xvcnMgPSBUb29scy5jbG9uZUNvbG9yKCk7XHJcbiAgICAgICAgdGhpcy5jc3MgPSBUb29scy5jbG9uZUNzcygpO1xyXG5cclxuXHJcbiAgICAgICAgaWYoIG8uY29uZmlnICkgdGhpcy5zZXRDb25maWcoIG8uY29uZmlnICk7XHJcblxyXG5cclxuICAgICAgICB0aGlzLmJnID0gby5iZyB8fCB0aGlzLmNvbG9ycy5iYWNrZ3JvdW5kO1xyXG5cclxuICAgICAgICBpZiggby50cmFuc3BhcmVudCAhPT0gdW5kZWZpbmVkICl7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3JzLmJhY2tncm91bmQgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3JzLmJhY2tncm91bmRPdmVyID0gJ25vbmUnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9pZiggby5jYWxsYmFjayApIHRoaXMuY2FsbGJhY2sgPSAgby5jYWxsYmFjaztcclxuXHJcbiAgICAgICAgdGhpcy5pc1Jlc2V0ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy50bXBBZGQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudG1wSCA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuaXNDYW52YXMgPSBvLmlzQ2FudmFzIHx8IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNDYW52YXNPbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jc3NHdWkgPSBvLmNzcyAhPT0gdW5kZWZpbmVkID8gby5jc3MgOiAnJztcclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gby5jYWxsYmFjayAgPT09IHVuZGVmaW5lZCA/IG51bGwgOiBvLmNhbGxiYWNrO1xyXG5cclxuICAgICAgICB0aGlzLmZvcmNlSGVpZ2h0ID0gby5tYXhIZWlnaHQgfHwgMDtcclxuICAgICAgICB0aGlzLmxvY2tIZWlnaHQgPSBvLmxvY2tIZWlnaHQgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuaXNJdGVtTW9kZSA9IG8uaXRlbU1vZGUgIT09IHVuZGVmaW5lZCA/IG8uaXRlbU1vZGUgOiBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5jbiA9ICcnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHNpemUgZGVmaW5lXHJcbiAgICAgICAgdGhpcy5zaXplID0gVG9vbHMuc2l6ZTtcclxuICAgICAgICBpZiggby5wICE9PSB1bmRlZmluZWQgKSB0aGlzLnNpemUucCA9IG8ucDtcclxuICAgICAgICBpZiggby53ICE9PSB1bmRlZmluZWQgKSB0aGlzLnNpemUudyA9IG8udztcclxuICAgICAgICBpZiggby5oICE9PSB1bmRlZmluZWQgKSB0aGlzLnNpemUuaCA9IG8uaDtcclxuICAgICAgICBpZiggby5zICE9PSB1bmRlZmluZWQgKSB0aGlzLnNpemUucyA9IG8ucztcclxuXHJcbiAgICAgICAgdGhpcy5zaXplLmggPSB0aGlzLnNpemUuaCA8IDExID8gMTEgOiB0aGlzLnNpemUuaDtcclxuXHJcbiAgICAgICAgLy8gbG9jYWwgbW91c2UgYW5kIHpvbmVcclxuICAgICAgICB0aGlzLmxvY2FsID0gbmV3IFYyKCkubmVnKCk7XHJcbiAgICAgICAgdGhpcy56b25lID0geyB4OjAsIHk6MCwgdzp0aGlzLnNpemUudywgaDowIH07XHJcblxyXG4gICAgICAgIC8vIHZpcnR1YWwgbW91c2VcclxuICAgICAgICB0aGlzLm1vdXNlID0gbmV3IFYyKCkubmVnKCk7XHJcblxyXG4gICAgICAgIHRoaXMuaCA9IDA7XHJcbiAgICAgICAgdGhpcy5wcmV2WSA9IC0xO1xyXG4gICAgICAgIHRoaXMuc3cgPSAwO1xyXG5cclxuICAgICAgICBcclxuXHJcbiAgICAgICAgLy8gYm90dG9tIGFuZCBjbG9zZSBoZWlnaHRcclxuICAgICAgICB0aGlzLmlzV2l0aENsb3NlID0gby5jbG9zZSAhPT0gdW5kZWZpbmVkID8gby5jbG9zZSA6IHRydWU7XHJcbiAgICAgICAgdGhpcy5iaCA9ICF0aGlzLmlzV2l0aENsb3NlID8gMCA6IHRoaXMuc2l6ZS5oO1xyXG5cclxuICAgICAgICB0aGlzLmF1dG9SZXNpemUgPSBvLmF1dG9SZXNpemUgPT09IHVuZGVmaW5lZCA/IHRydWUgOiBvLmF1dG9SZXNpemU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5pc0NlbnRlciA9IG8uY2VudGVyIHx8IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmlzRG93biA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNTY3JvbGwgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy51aXMgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50ID0gLTE7XHJcbiAgICAgICAgdGhpcy50YXJnZXQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZGVjYWwgPSAwO1xyXG4gICAgICAgIHRoaXMucmF0aW8gPSAxO1xyXG4gICAgICAgIHRoaXMub3kgPSAwO1xyXG5cclxuXHJcblxyXG4gICAgICAgIHRoaXMuaXNOZXdUYXJnZXQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5jb250ZW50ID0gVG9vbHMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnIHdpZHRoOjBweDsgaGVpZ2h0OmF1dG87IHRvcDowcHg7ICcgKyB0aGlzLmNzc0d1aSApO1xyXG5cclxuICAgICAgICB0aGlzLmlubmVyQ29udGVudCA9IFRvb2xzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ3dpZHRoOjEwMCU7IHRvcDowOyBsZWZ0OjA7IGhlaWdodDphdXRvOyBvdmVyZmxvdzpoaWRkZW47Jyk7XHJcbiAgICAgICAgdGhpcy5jb250ZW50LmFwcGVuZENoaWxkKCB0aGlzLmlubmVyQ29udGVudCApO1xyXG5cclxuICAgICAgICB0aGlzLmlubmVyID0gVG9vbHMuZG9tKCAnZGl2JywgdGhpcy5jc3MuYmFzaWMgKyAnd2lkdGg6MTAwJTsgbGVmdDowOyAnKTtcclxuICAgICAgICB0aGlzLmlubmVyQ29udGVudC5hcHBlbmRDaGlsZCh0aGlzLmlubmVyKTtcclxuXHJcbiAgICAgICAgLy8gc2Nyb2xsXHJcbiAgICAgICAgdGhpcy5zY3JvbGxCRyA9IFRvb2xzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ3JpZ2h0OjA7IHRvcDowOyB3aWR0aDonKyAodGhpcy5zaXplLnMgLSAxKSArJ3B4OyBoZWlnaHQ6MTBweDsgZGlzcGxheTpub25lOyBiYWNrZ3JvdW5kOicrdGhpcy5iZysnOycpO1xyXG4gICAgICAgIHRoaXMuY29udGVudC5hcHBlbmRDaGlsZCggdGhpcy5zY3JvbGxCRyApO1xyXG5cclxuICAgICAgICB0aGlzLnNjcm9sbCA9IFRvb2xzLmRvbSggJ2RpdicsIHRoaXMuY3NzLmJhc2ljICsgJ2JhY2tncm91bmQ6Jyt0aGlzLmNvbG9ycy5zY3JvbGwrJzsgcmlnaHQ6MnB4OyB0b3A6MDsgd2lkdGg6JysodGhpcy5zaXplLnMtNCkrJ3B4OyBoZWlnaHQ6MTBweDsnKTtcclxuICAgICAgICB0aGlzLnNjcm9sbEJHLmFwcGVuZENoaWxkKCB0aGlzLnNjcm9sbCApO1xyXG5cclxuICAgICAgICAvLyBib3R0b20gYnV0dG9uXHJcbiAgICAgICAgdGhpcy5ib3R0b20gPSBUb29scy5kb20oICdkaXYnLCAgdGhpcy5jc3MudHh0ICsgJ3dpZHRoOjEwMCU7IHRvcDphdXRvOyBib3R0b206MDsgbGVmdDowOyBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czoxMHB4OyAgYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czoxMHB4OyB0ZXh0LWFsaWduOmNlbnRlcjsgaGVpZ2h0OicrdGhpcy5iaCsncHg7IGxpbmUtaGVpZ2h0OicrKHRoaXMuYmgtNSkrJ3B4OyBib3JkZXItdG9wOjFweCBzb2xpZCAnK1Rvb2xzLmNvbG9ycy5zdHJva2UrJzsnKTtcclxuICAgICAgICB0aGlzLmNvbnRlbnQuYXBwZW5kQ2hpbGQoIHRoaXMuYm90dG9tICk7XHJcbiAgICAgICAgdGhpcy5ib3R0b20udGV4dENvbnRlbnQgPSAnY2xvc2UnO1xyXG4gICAgICAgIHRoaXMuYm90dG9tLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmJnO1xyXG5cclxuICAgICAgICAvL1xyXG5cclxuICAgICAgICB0aGlzLnBhcmVudCA9IG8ucGFyZW50ICE9PSB1bmRlZmluZWQgPyBvLnBhcmVudCA6IG51bGw7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYoIHRoaXMucGFyZW50ID09PSBudWxsICYmICF0aGlzLmlzQ2FudmFzICl7IFxyXG4gICAgICAgIFx0dGhpcy5wYXJlbnQgPSBkb2N1bWVudC5ib2R5O1xyXG4gICAgICAgICAgICAvLyBkZWZhdWx0IHBvc2l0aW9uXHJcbiAgICAgICAgXHRpZiggIXRoaXMuaXNDZW50ZXIgKSB0aGlzLmNvbnRlbnQuc3R5bGUucmlnaHQgPSAnMTBweCc7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIHRoaXMucGFyZW50ICE9PSBudWxsICkgdGhpcy5wYXJlbnQuYXBwZW5kQ2hpbGQoIHRoaXMuY29udGVudCApO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc0NhbnZhcyAmJiB0aGlzLnBhcmVudCA9PT0gbnVsbCApIHRoaXMuaXNDYW52YXNPbmx5ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzQ2FudmFzT25seSApIHRoaXMuY29udGVudC5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ2F1dG8nO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5zZXRXaWR0aCgpO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc0NhbnZhcyApIHRoaXMubWFrZUNhbnZhcygpO1xyXG5cclxuICAgICAgICBSb290cy5hZGQoIHRoaXMgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0VG9wICggdCwgaCApIHtcclxuXHJcbiAgICAgICAgdGhpcy5jb250ZW50LnN0eWxlLnRvcCA9IHQgKyAncHgnO1xyXG4gICAgICAgIGlmKCBoICE9PSB1bmRlZmluZWQgKSB0aGlzLmZvcmNlSGVpZ2h0ID0gaDtcclxuICAgICAgICB0aGlzLnNldEhlaWdodCgpO1xyXG5cclxuICAgICAgICBSb290cy5uZWVkUmVab25lID0gdHJ1ZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy9jYWxsYmFjazogZnVuY3Rpb24gKCkge30sXHJcblxyXG4gICAgZGlzcG9zZSAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICBpZiggdGhpcy5wYXJlbnQgIT09IG51bGwgKSB0aGlzLnBhcmVudC5yZW1vdmVDaGlsZCggdGhpcy5jb250ZW50ICk7XHJcbiAgICAgICAgUm9vdHMucmVtb3ZlKCB0aGlzICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgQ0FOVkFTXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgb25EcmF3ICgpIHt9XHJcblxyXG4gICAgbWFrZUNhbnZhcyAoKSB7XHJcblxyXG4gICAgXHR0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyggJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwnLCBcImNhbnZhc1wiICk7XHJcbiAgICBcdHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy56b25lLnc7XHJcbiAgICBcdHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuZm9yY2VIZWlnaHQgPyB0aGlzLmZvcmNlSGVpZ2h0IDogdGhpcy56b25lLmg7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGRyYXcgKCBmb3JjZSApIHtcclxuXHJcbiAgICBcdGlmKCB0aGlzLmNhbnZhcyA9PT0gbnVsbCApIHJldHVybjtcclxuXHJcbiAgICBcdGxldCB3ID0gdGhpcy56b25lLnc7XHJcbiAgICBcdGxldCBoID0gdGhpcy5mb3JjZUhlaWdodCA/IHRoaXMuZm9yY2VIZWlnaHQgOiB0aGlzLnpvbmUuaDtcclxuICAgIFx0Um9vdHMudG9DYW52YXMoIHRoaXMsIHcsIGgsIGZvcmNlICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vLy8vL1xyXG5cclxuICAgIGdldERvbSAoKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNldE1vdXNlICggbSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5tb3VzZS5zZXQoIG0ueCwgbS55ICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNldENvbmZpZyAoIG8gKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0Q29sb3JzKCBvICk7XHJcbiAgICAgICAgdGhpcy5zZXRUZXh0KCBvLmZvbnRTaXplLCBvLnRleHQsIG8uZm9udCwgby5zaGFkb3cgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0Q29sb3JzICggbyApIHtcclxuXHJcbiAgICAgICAgZm9yKCBsZXQgYyBpbiBvICl7XHJcbiAgICAgICAgICAgIGlmKCB0aGlzLmNvbG9yc1tjXSApIHRoaXMuY29sb3JzW2NdID0gb1tjXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNldFRleHQgKCBzaXplLCBjb2xvciwgZm9udCwgc2hhZG93ICkge1xyXG5cclxuICAgICAgICBUb29scy5zZXRUZXh0KCBzaXplLCBjb2xvciwgZm9udCwgc2hhZG93LCB0aGlzLmNvbG9ycywgdGhpcy5jc3MgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgaGlkZSAoIGIgKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS5kaXNwbGF5ID0gYiA/ICdub25lJyA6ICdibG9jayc7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgb25DaGFuZ2UgKCBmICkge1xyXG5cclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gZiB8fCBudWxsO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIFNUWUxFU1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIG1vZGUgKCBuICkge1xyXG5cclxuICAgIFx0bGV0IG5lZWRDaGFuZ2UgPSBmYWxzZTtcclxuXHJcbiAgICBcdGlmKCBuICE9PSB0aGlzLmNuICl7XHJcblxyXG5cdCAgICBcdHRoaXMuY24gPSBuO1xyXG5cclxuXHQgICAgXHRzd2l0Y2goIG4gKXtcclxuXHJcblx0ICAgIFx0XHRjYXNlICdkZWYnOiBcclxuXHQgICAgXHRcdCAgIHRoaXMuc2Nyb2xsLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zY3JvbGw7IFxyXG5cdCAgICBcdFx0ICAgdGhpcy5ib3R0b20uc3R5bGUuYmFja2dyb3VuZCA9IHRoaXMuY29sb3JzLmJhY2tncm91bmQ7XHJcblx0ICAgIFx0XHQgICB0aGlzLmJvdHRvbS5zdHlsZS5jb2xvciA9IHRoaXMuY29sb3JzLnRleHQ7XHJcblx0ICAgIFx0XHRicmVhaztcclxuXHJcblx0ICAgIFx0XHQvL2Nhc2UgJ3Njcm9sbERlZic6IHRoaXMuc2Nyb2xsLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zY3JvbGw7IGJyZWFrO1xyXG5cdCAgICBcdFx0Y2FzZSAnc2Nyb2xsT3Zlcic6IHRoaXMuc2Nyb2xsLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zZWxlY3Q7IGJyZWFrO1xyXG5cdCAgICBcdFx0Y2FzZSAnc2Nyb2xsRG93bic6IHRoaXMuc2Nyb2xsLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5kb3duOyBicmVhaztcclxuXHJcblx0ICAgIFx0XHQvL2Nhc2UgJ2JvdHRvbURlZic6IHRoaXMuYm90dG9tLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5iYWNrZ3JvdW5kOyBicmVhaztcclxuXHQgICAgXHRcdGNhc2UgJ2JvdHRvbU92ZXInOiB0aGlzLmJvdHRvbS5zdHlsZS5iYWNrZ3JvdW5kID0gdGhpcy5jb2xvcnMuYmFja2dyb3VuZE92ZXI7IHRoaXMuYm90dG9tLnN0eWxlLmNvbG9yID0gJyNGRkYnOyBicmVhaztcclxuXHQgICAgXHRcdC8vY2FzZSAnYm90dG9tRG93bic6IHRoaXMuYm90dG9tLnN0eWxlLmJhY2tncm91bmQgPSB0aGlzLmNvbG9ycy5zZWxlY3Q7IHRoaXMuYm90dG9tLnN0eWxlLmNvbG9yID0gJyMwMDAnOyBicmVhaztcclxuXHJcblx0ICAgIFx0fVxyXG5cclxuXHQgICAgXHRuZWVkQ2hhbmdlID0gdHJ1ZTtcclxuXHJcblx0ICAgIH1cclxuXHJcbiAgICBcdHJldHVybiBuZWVkQ2hhbmdlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIFRBUkdFVFxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGNsZWFyVGFyZ2V0ICgpIHtcclxuXHJcbiAgICBcdGlmKCB0aGlzLmN1cnJlbnQgPT09IC0xICkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIC8vaWYoIXRoaXMudGFyZ2V0KSByZXR1cm47XHJcbiAgICAgICAgdGhpcy50YXJnZXQudWlvdXQoKTtcclxuICAgICAgICB0aGlzLnRhcmdldC5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSAtMTtcclxuXHJcbiAgICAgICAgLy8vY29uc29sZS5sb2codGhpcy5pc0Rvd24pLy9pZih0aGlzLmlzRG93bilSb290cy5jbGVhcklucHV0KCk7XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgICAgICBSb290cy5jdXJzb3IoKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBaT05FIFRFU1RcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICB0ZXN0Wm9uZSAoIGUgKSB7XHJcblxyXG4gICAgICAgIGxldCBsID0gdGhpcy5sb2NhbDtcclxuICAgICAgICBpZiggbC54ID09PSAtMSAmJiBsLnkgPT09IC0xICkgcmV0dXJuICcnO1xyXG5cclxuICAgICAgICB0aGlzLmlzUmVzZXQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbGV0IG5hbWUgPSAnJztcclxuXHJcbiAgICAgICAgbGV0IHMgPSB0aGlzLmlzU2Nyb2xsID8gIHRoaXMuem9uZS53ICAtIHRoaXMuc2l6ZS5zIDogdGhpcy56b25lLnc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYoIGwueSA+IHRoaXMuem9uZS5oIC0gdGhpcy5iaCAmJiAgbC55IDwgdGhpcy56b25lLmggKSBuYW1lID0gJ2JvdHRvbSc7XHJcbiAgICAgICAgZWxzZSBuYW1lID0gbC54ID4gcyA/ICdzY3JvbGwnIDogJ2NvbnRlbnQnO1xyXG5cclxuICAgICAgICByZXR1cm4gbmFtZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBFVkVOVFNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBoYW5kbGVFdmVudCAoIGUgKSB7XHJcblxyXG4gICAgXHRsZXQgdHlwZSA9IGUudHlwZTtcclxuXHJcbiAgICBcdGxldCBjaGFuZ2UgPSBmYWxzZTtcclxuICAgIFx0bGV0IHRhcmdldENoYW5nZSA9IGZhbHNlO1xyXG5cclxuICAgIFx0bGV0IG5hbWUgPSB0aGlzLnRlc3Rab25lKCBlICk7XHJcblxyXG4gICAgICAgIFxyXG5cclxuICAgIFx0aWYoIHR5cGUgPT09ICdtb3VzZXVwJyAmJiB0aGlzLmlzRG93biApIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcbiAgICBcdGlmKCB0eXBlID09PSAnbW91c2Vkb3duJyAmJiAhdGhpcy5pc0Rvd24gKSB0aGlzLmlzRG93biA9IHRydWU7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzRG93biAmJiB0aGlzLmlzTmV3VGFyZ2V0ICl7IFJvb3RzLmNsZWFySW5wdXQoKTsgdGhpcy5pc05ld1RhcmdldD1mYWxzZTsgfVxyXG5cclxuICAgIFx0aWYoICFuYW1lICkgcmV0dXJuO1xyXG5cclxuICAgIFx0c3dpdGNoKCBuYW1lICl7XHJcblxyXG4gICAgXHRcdGNhc2UgJ2NvbnRlbnQnOlxyXG5cclxuICAgICAgICAgICAgICAgIGUuY2xpZW50WSA9IHRoaXMuaXNTY3JvbGwgPyAgZS5jbGllbnRZICsgdGhpcy5kZWNhbCA6IGUuY2xpZW50WTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiggUm9vdHMuaXNNb2JpbGUgJiYgdHlwZSA9PT0gJ21vdXNlZG93bicgKSB0aGlzLmdldE5leHQoIGUsIGNoYW5nZSApO1xyXG5cclxuXHQgICAgXHRcdGlmKCB0aGlzLnRhcmdldCApIHRhcmdldENoYW5nZSA9IHRoaXMudGFyZ2V0LmhhbmRsZUV2ZW50KCBlICk7XHJcblxyXG5cdCAgICBcdFx0aWYoIHR5cGUgPT09ICdtb3VzZW1vdmUnICkgY2hhbmdlID0gdGhpcy5tb2RlKCdkZWYnKTtcclxuICAgICAgICAgICAgICAgIGlmKCB0eXBlID09PSAnd2hlZWwnICYmICF0YXJnZXRDaGFuZ2UgJiYgdGhpcy5pc1Njcm9sbCApIGNoYW5nZSA9IHRoaXMub25XaGVlbCggZSApO1xyXG4gICAgICAgICAgICAgICBcclxuXHQgICAgXHRcdGlmKCAhUm9vdHMubG9jayApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldE5leHQoIGUsIGNoYW5nZSApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgIFx0XHRicmVhaztcclxuICAgIFx0XHRjYXNlICdib3R0b20nOlxyXG5cclxuXHQgICAgXHRcdHRoaXMuY2xlYXJUYXJnZXQoKTtcclxuXHQgICAgXHRcdGlmKCB0eXBlID09PSAnbW91c2Vtb3ZlJyApIGNoYW5nZSA9IHRoaXMubW9kZSgnYm90dG9tT3ZlcicpO1xyXG5cdCAgICBcdFx0aWYoIHR5cGUgPT09ICdtb3VzZWRvd24nICkge1xyXG5cdCAgICBcdFx0XHR0aGlzLmlzT3BlbiA9IHRoaXMuaXNPcGVuID8gZmFsc2UgOiB0cnVlO1xyXG5cdFx0ICAgICAgICAgICAgdGhpcy5ib3R0b20udGV4dENvbnRlbnQgPSB0aGlzLmlzT3BlbiA/ICdjbG9zZScgOiAnb3Blbic7XHJcblx0XHQgICAgICAgICAgICB0aGlzLnNldEhlaWdodCgpO1xyXG5cdFx0ICAgICAgICAgICAgdGhpcy5tb2RlKCdkZWYnKTtcclxuXHRcdCAgICAgICAgICAgIGNoYW5nZSA9IHRydWU7XHJcblx0ICAgIFx0XHR9XHJcblxyXG4gICAgXHRcdGJyZWFrO1xyXG4gICAgXHRcdGNhc2UgJ3Njcm9sbCc6XHJcblxyXG5cdCAgICBcdFx0dGhpcy5jbGVhclRhcmdldCgpO1xyXG5cdCAgICBcdFx0aWYoIHR5cGUgPT09ICdtb3VzZW1vdmUnICkgY2hhbmdlID0gdGhpcy5tb2RlKCdzY3JvbGxPdmVyJyk7XHJcblx0ICAgIFx0XHRpZiggdHlwZSA9PT0gJ21vdXNlZG93bicgKSBjaGFuZ2UgPSB0aGlzLm1vZGUoJ3Njcm9sbERvd24nKTsgXHJcbiAgICAgICAgICAgICAgICBpZiggdHlwZSA9PT0gJ3doZWVsJyApIGNoYW5nZSA9IHRoaXMub25XaGVlbCggZSApOyBcclxuXHQgICAgXHRcdGlmKCB0aGlzLmlzRG93biApIHRoaXMudXBkYXRlKCAoZS5jbGllbnRZLXRoaXMuem9uZS55KS0odGhpcy5zaCowLjUpICk7XHJcblxyXG4gICAgXHRcdGJyZWFrO1xyXG5cclxuXHJcbiAgICBcdH1cclxuXHJcbiAgICBcdGlmKCB0aGlzLmlzRG93biApIGNoYW5nZSA9IHRydWU7XHJcbiAgICBcdGlmKCB0YXJnZXRDaGFuZ2UgKSBjaGFuZ2UgPSB0cnVlO1xyXG5cclxuICAgICAgICBpZiggdHlwZSA9PT0gJ2tleXVwJyApIGNoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgaWYoIHR5cGUgPT09ICdrZXlkb3duJyApIGNoYW5nZSA9IHRydWU7XHJcblxyXG4gICAgXHRpZiggY2hhbmdlICkgdGhpcy5kcmF3KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldE5leHQgKCBlLCBjaGFuZ2UgKSB7XHJcblxyXG5cclxuXHJcbiAgICAgICAgbGV0IG5leHQgPSBSb290cy5maW5kVGFyZ2V0KCB0aGlzLnVpcywgZSApO1xyXG5cclxuICAgICAgICBpZiggbmV4dCAhPT0gdGhpcy5jdXJyZW50ICl7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXJUYXJnZXQoKTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gbmV4dDtcclxuICAgICAgICAgICAgY2hhbmdlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuaXNOZXdUYXJnZXQgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCBuZXh0ICE9PSAtMSApeyBcclxuICAgICAgICAgICAgdGhpcy50YXJnZXQgPSB0aGlzLnVpc1sgdGhpcy5jdXJyZW50IF07XHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0LnVpb3ZlcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25XaGVlbCAoIGUgKSB7XHJcblxyXG4gICAgICAgIHRoaXMub3kgKz0gMjAqZS5kZWx0YTtcclxuICAgICAgICB0aGlzLnVwZGF0ZSggdGhpcy5veSApO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIFJFU0VUXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgcmVzZXQgKCBmb3JjZSApIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNSZXNldCApIHJldHVybjtcclxuXHJcbiAgICAgICAgLy90aGlzLnJlc2V0SXRlbSgpO1xyXG5cclxuICAgICAgICB0aGlzLm1vdXNlLm5lZygpO1xyXG4gICAgICAgIHRoaXMuaXNEb3duID0gZmFsc2U7XHJcblxyXG4gICAgICAgIC8vUm9vdHMuY2xlYXJJbnB1dCgpO1xyXG4gICAgICAgIGxldCByID0gdGhpcy5tb2RlKCdkZWYnKTtcclxuICAgICAgICBsZXQgcjIgPSB0aGlzLmNsZWFyVGFyZ2V0KCk7XHJcblxyXG4gICAgICAgIGlmKCByIHx8IHIyICkgdGhpcy5kcmF3KCB0cnVlICk7XHJcblxyXG4gICAgICAgIHRoaXMuaXNSZXNldCA9IHRydWU7XHJcblxyXG4gICAgICAgIC8vUm9vdHMubG9jayA9IGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyAgIEFERCBOT0RFXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgYWRkICgpIHtcclxuXHJcbiAgICAgICAgbGV0IGEgPSBhcmd1bWVudHM7XHJcblxyXG4gICAgICAgIGlmKCB0eXBlb2YgYVsxXSA9PT0gJ29iamVjdCcgKXsgXHJcblxyXG4gICAgICAgICAgICBhWzFdLmlzVUkgPSB0cnVlO1xyXG4gICAgICAgICAgICBhWzFdLm1haW4gPSB0aGlzO1xyXG5cclxuICAgICAgICB9IGVsc2UgaWYoIHR5cGVvZiBhWzFdID09PSAnc3RyaW5nJyApe1xyXG5cclxuICAgICAgICAgICAgaWYoIGFbMl0gPT09IHVuZGVmaW5lZCApIFtdLnB1c2guY2FsbChhLCB7IGlzVUk6dHJ1ZSwgbWFpbjp0aGlzIH0pO1xyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFbMl0uaXNVSSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBhWzJdLm1haW4gPSB0aGlzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0gXHJcblxyXG4gICAgICAgIGxldCB1ID0gYWRkLmFwcGx5KCB0aGlzLCBhICk7XHJcblxyXG4gICAgICAgIGlmKCB1ID09PSBudWxsICkgcmV0dXJuO1xyXG5cclxuXHJcbiAgICAgICAgLy9sZXQgbiA9IGFkZC5hcHBseSggdGhpcywgYSApO1xyXG4gICAgICAgIC8vbGV0IG4gPSBVSUwuYWRkKCAuLi5hcmdzICk7XHJcblxyXG4gICAgICAgIHRoaXMudWlzLnB1c2goIHUgKTtcclxuICAgICAgICAvL24ucHkgPSB0aGlzLmg7XHJcblxyXG4gICAgICAgIGlmKCAhdS5hdXRvV2lkdGggKXtcclxuICAgICAgICAgICAgbGV0IHkgPSB1LmNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xyXG4gICAgICAgICAgICBpZiggdGhpcy5wcmV2WSAhPT0geSApe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWxjKCB1LmggKyAxICk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZZID0geTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLnByZXZZID0gMDsvLy0xO1xyXG4gICAgICAgICAgICB0aGlzLmNhbGMoIHUuaCArIDEgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB1O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhcHBseUNhbGMgKCkge1xyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudWlzLmxlbmd0aCwgdGhpcy50bXBIIClcclxuXHJcbiAgICAgICAgdGhpcy5jYWxjKCB0aGlzLnRtcEggKTtcclxuICAgICAgICAvL3RoaXMudG1wSCA9IDA7XHJcbiAgICAgICAgdGhpcy50bXBBZGQgPSBudWxsO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBjYWxjVWlzICgpIHtcclxuXHJcbiAgICAgICAgUm9vdHMuY2FsY1VpcyggdGhpcy51aXMsIHRoaXMuem9uZSwgdGhpcy56b25lLnkgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gcmVtb3ZlIG9uZSBub2RlXHJcblxyXG4gICAgcmVtb3ZlICggbiApIHsgXHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy51aXMuaW5kZXhPZiggbiApOyBcclxuICAgICAgICBpZiAoIGkgIT09IC0xICkgdGhpcy51aXNbaV0uY2xlYXIoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gY2FsbCBhZnRlciB1aXMgY2xlYXJcclxuXHJcbiAgICBjbGVhck9uZSAoIG4gKSB7IFxyXG5cclxuICAgICAgICBsZXQgaSA9IHRoaXMudWlzLmluZGV4T2YoIG4gKTsgXHJcbiAgICAgICAgaWYgKCBpICE9PSAtMSApIHtcclxuICAgICAgICAgICAgdGhpcy5pbm5lci5yZW1vdmVDaGlsZCggdGhpcy51aXNbaV0uY1swXSApO1xyXG4gICAgICAgICAgICB0aGlzLnVpcy5zcGxpY2UoIGksIDEgKTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyBjbGVhciBhbGwgZ3VpXHJcblxyXG4gICAgY2xlYXIgKCkge1xyXG5cclxuICAgICAgICAvL3RoaXMuY2FsbGJhY2sgPSBudWxsO1xyXG5cclxuICAgICAgICBsZXQgaSA9IHRoaXMudWlzLmxlbmd0aDtcclxuICAgICAgICB3aGlsZShpLS0pIHRoaXMudWlzW2ldLmNsZWFyKCk7XHJcblxyXG4gICAgICAgIHRoaXMudWlzID0gW107XHJcbiAgICAgICAgUm9vdHMubGlzdGVucyA9IFtdO1xyXG5cclxuICAgICAgICB0aGlzLmNhbGMoIC10aGlzLmggKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBJVEVNUyBTUEVDSUFMXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cclxuICAgIHJlc2V0SXRlbSAoKSB7XHJcblxyXG4gICAgICAgIGlmKCAhdGhpcy5pc0l0ZW1Nb2RlICkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQgaSA9IHRoaXMudWlzLmxlbmd0aDtcclxuICAgICAgICB3aGlsZShpLS0pIHRoaXMudWlzW2ldLnNlbGVjdGVkKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNldEl0ZW0gKCBuYW1lICkge1xyXG5cclxuICAgICAgICBpZiggIXRoaXMuaXNJdGVtTW9kZSApIHJldHVybjtcclxuXHJcbiAgICAgICAgbmFtZSA9IG5hbWUgfHwgJyc7XHJcblxyXG4gICAgICAgIHRoaXMucmVzZXRJdGVtKCk7XHJcblxyXG4gICAgICAgIGlmKCAhbmFtZSApe1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgwKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gXHJcblxyXG4gICAgICAgIGxldCBpID0gdGhpcy51aXMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlKGktLSl7IFxyXG4gICAgICAgICAgICBpZiggdGhpcy51aXNbaV0udmFsdWUgPT09IG5hbWUgKXsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnVpc1tpXS5zZWxlY3RlZCggdHJ1ZSApO1xyXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMuaXNTY3JvbGwgKSB0aGlzLnVwZGF0ZSggKCBpKih0aGlzLnVpc1tpXS5oKzEpICkqdGhpcy5yYXRpbyApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vICAgU0NST0xMXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgdXBTY3JvbGwgKCBiICkge1xyXG5cclxuICAgICAgICB0aGlzLnN3ID0gYiA/IHRoaXMuc2l6ZS5zIDogMDtcclxuICAgICAgICB0aGlzLm95ID0gYiA/IHRoaXMub3kgOiAwO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsQkcuc3R5bGUuZGlzcGxheSA9IGIgPyAnYmxvY2snIDogJ25vbmUnO1xyXG5cclxuICAgICAgICBpZiggYiApe1xyXG5cclxuICAgICAgICAgICAgdGhpcy50b3RhbCA9IHRoaXMuaDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMubWF4VmlldyA9IHRoaXMubWF4SGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yYXRpbyA9IHRoaXMubWF4VmlldyAvIHRoaXMudG90YWw7XHJcbiAgICAgICAgICAgIHRoaXMuc2ggPSB0aGlzLm1heFZpZXcgKiB0aGlzLnJhdGlvO1xyXG5cclxuICAgICAgICAgICAgLy9pZiggdGhpcy5zaCA8IDIwICkgdGhpcy5zaCA9IDIwO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yYW5nZSA9IHRoaXMubWF4VmlldyAtIHRoaXMuc2g7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm95ID0gVG9vbHMuY2xhbXAoIHRoaXMub3ksIDAsIHRoaXMucmFuZ2UgKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsQkcuc3R5bGUuaGVpZ2h0ID0gdGhpcy5tYXhWaWV3ICsgJ3B4JztcclxuICAgICAgICAgICAgdGhpcy5zY3JvbGwuc3R5bGUuaGVpZ2h0ID0gdGhpcy5zaCArICdweCc7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZXRJdGVtV2lkdGgoIHRoaXMuem9uZS53IC0gdGhpcy5zdyApO1xyXG4gICAgICAgIHRoaXMudXBkYXRlKCB0aGlzLm95ICk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZSAoIHkgKSB7XHJcblxyXG4gICAgICAgIHkgPSBUb29scy5jbGFtcCggeSwgMCwgdGhpcy5yYW5nZSApO1xyXG5cclxuICAgICAgICB0aGlzLmRlY2FsID0gTWF0aC5mbG9vciggeSAvIHRoaXMucmF0aW8gKTtcclxuICAgICAgICB0aGlzLmlubmVyLnN0eWxlLnRvcCA9IC0gdGhpcy5kZWNhbCArICdweCc7XHJcbiAgICAgICAgdGhpcy5zY3JvbGwuc3R5bGUudG9wID0gTWF0aC5mbG9vciggeSApICsgJ3B4JztcclxuICAgICAgICB0aGlzLm95ID0geTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gICBSRVNJWkUgRlVOQ1RJT05cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBjYWxjICggeSApIHtcclxuXHJcbiAgICAgICAgdGhpcy5oICs9IHk7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KCB0aGlzLnRtcCApO1xyXG4gICAgICAgIHRoaXMudG1wID0gc2V0VGltZW91dCggdGhpcy5zZXRIZWlnaHQuYmluZCh0aGlzKSwgMTAgKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0SGVpZ2h0ICgpIHtcclxuXHJcbiAgICAgICAgaWYoIHRoaXMudG1wICkgY2xlYXJUaW1lb3V0KCB0aGlzLnRtcCApO1xyXG5cclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuaCApXHJcblxyXG4gICAgICAgIHRoaXMuem9uZS5oID0gdGhpcy5iaDtcclxuICAgICAgICB0aGlzLmlzU2Nyb2xsID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGlmKCB0aGlzLmlzT3BlbiApe1xyXG5cclxuICAgICAgICAgICAgbGV0IGhoaCA9IHRoaXMuZm9yY2VIZWlnaHQgPyB0aGlzLmZvcmNlSGVpZ2h0ICsgdGhpcy56b25lLnkgOiB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm1heEhlaWdodCA9IGhoaCAtIHRoaXMuem9uZS55IC0gdGhpcy5iaDtcclxuXHJcbiAgICAgICAgICAgIGxldCBkaWZmID0gdGhpcy5oIC0gdGhpcy5tYXhIZWlnaHQ7XHJcblxyXG4gICAgICAgICAgICBpZiggZGlmZiA+IDEgKXsgLy90aGlzLmggPiB0aGlzLm1heEhlaWdodCApe1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuaXNTY3JvbGwgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy56b25lLmggPSB0aGlzLm1heEhlaWdodCArIHRoaXMuYmg7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuem9uZS5oID0gdGhpcy5oICsgdGhpcy5iaDtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy51cFNjcm9sbCggdGhpcy5pc1Njcm9sbCApO1xyXG5cclxuICAgICAgICB0aGlzLmlubmVyQ29udGVudC5zdHlsZS5oZWlnaHQgPSB0aGlzLnpvbmUuaCAtIHRoaXMuYmggKyAncHgnO1xyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS5oZWlnaHQgPSB0aGlzLnpvbmUuaCArICdweCc7XHJcbiAgICAgICAgdGhpcy5ib3R0b20uc3R5bGUudG9wID0gdGhpcy56b25lLmggLSB0aGlzLmJoICsgJ3B4JztcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuZm9yY2VIZWlnaHQgJiYgdGhpcy5sb2NrSGVpZ2h0ICkgdGhpcy5jb250ZW50LnN0eWxlLmhlaWdodCA9IHRoaXMuZm9yY2VIZWlnaHQgKyAncHgnO1xyXG5cclxuICAgICAgICBpZiggdGhpcy5pc09wZW4gKSB0aGlzLmNhbGNVaXMoKTtcclxuICAgICAgICBpZiggdGhpcy5pc0NhbnZhcyApIHRoaXMuZHJhdyggdHJ1ZSApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXpvbmUgKCkge1xyXG4gICAgICAgIFJvb3RzLm5lZWRSZVpvbmUgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFdpZHRoICggdyApIHtcclxuXHJcbiAgICAgICAgaWYoIHcgKSB0aGlzLnpvbmUudyA9IHc7XHJcblxyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS53aWR0aCA9IHRoaXMuem9uZS53ICsgJ3B4JztcclxuXHJcbiAgICAgICAgaWYoIHRoaXMuaXNDZW50ZXIgKSB0aGlzLmNvbnRlbnQuc3R5bGUubWFyZ2luTGVmdCA9IC0oTWF0aC5mbG9vcih0aGlzLnpvbmUudyowLjUpKSArICdweCc7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0SXRlbVdpZHRoKCB0aGlzLnpvbmUudyAtIHRoaXMuc3cgKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgaWYoICF0aGlzLmlzQ2FudmFzT25seSApIFJvb3RzLm5lZWRSZVpvbmUgPSB0cnVlO1xyXG4gICAgICAgIC8vdGhpcy5yZXNpemUoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0SXRlbVdpZHRoICggdyApIHtcclxuXHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLnVpcy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUoaS0tKXtcclxuICAgICAgICAgICAgdGhpcy51aXNbaV0uc2V0U2l6ZSggdyApO1xyXG4gICAgICAgICAgICB0aGlzLnVpc1tpXS5yU2l6ZSgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbkd1aS5wcm90b3R5cGUuaXNHdWkgPSB0cnVlOyIsIi8vaW1wb3J0ICcuL3BvbHlmaWxscy5qcyc7XHJcblxyXG5leHBvcnQgY29uc3QgUkVWSVNJT04gPSAnMi44JztcclxuXHJcbmV4cG9ydCB7IFRvb2xzIH0gZnJvbSAnLi9jb3JlL1Rvb2xzLmpzJztcclxuZXhwb3J0IHsgR3VpIH0gZnJvbSAnLi9jb3JlL0d1aS5qcyc7XHJcbmV4cG9ydCB7IFByb3RvIH0gZnJvbSAnLi9jb3JlL1Byb3RvLmpzJztcclxuZXhwb3J0IHsgYWRkIH0gZnJvbSAnLi9jb3JlL2FkZC5qcyc7XHJcbi8vXHJcbmV4cG9ydCB7IEJvb2wgfSBmcm9tICcuL3Byb3RvL0Jvb2wuanMnO1xyXG5leHBvcnQgeyBCdXR0b24gfSBmcm9tICcuL3Byb3RvL0J1dHRvbi5qcyc7XHJcbmV4cG9ydCB7IENpcmN1bGFyIH0gZnJvbSAnLi9wcm90by9DaXJjdWxhci5qcyc7XHJcbmV4cG9ydCB7IENvbG9yIH0gZnJvbSAnLi9wcm90by9Db2xvci5qcyc7XHJcbmV4cG9ydCB7IEZwcyB9IGZyb20gJy4vcHJvdG8vRnBzLmpzJztcclxuZXhwb3J0IHsgR3JvdXAgfSBmcm9tICcuL3Byb3RvL0dyb3VwLmpzJztcclxuZXhwb3J0IHsgSm95c3RpY2sgfSBmcm9tICcuL3Byb3RvL0pveXN0aWNrLmpzJztcclxuZXhwb3J0IHsgS25vYiB9IGZyb20gJy4vcHJvdG8vS25vYi5qcyc7XHJcbmV4cG9ydCB7IExpc3QgfSBmcm9tICcuL3Byb3RvL0xpc3QuanMnO1xyXG5leHBvcnQgeyBOdW1lcmljIH0gZnJvbSAnLi9wcm90by9OdW1lcmljLmpzJztcclxuZXhwb3J0IHsgU2xpZGUgfSBmcm9tICcuL3Byb3RvL1NsaWRlLmpzJztcclxuZXhwb3J0IHsgVGV4dElucHV0IH0gZnJvbSAnLi9wcm90by9UZXh0SW5wdXQuanMnO1xyXG5leHBvcnQgeyBUaXRsZSB9IGZyb20gJy4vcHJvdG8vVGl0bGUuanMnOyJdLCJuYW1lcyI6WyJydW50aW1lIiwiZXhwb3J0cyIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiaXRlcmF0b3IiLCJhc3luY0l0ZXJhdG9yIiwidG9TdHJpbmdUYWciLCJvYmoiLCJrZXkiLCJ2YWx1ZSIsImlubmVyRm4iLCJhcmciLCJFcnJvciIsIm1ldGhvZCIsImNvbnRleHQiLCJHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0IiwiQ29udGludWVTZW50aW5lbCIsImRvbmUiLCJyZWNvcmQiLCJzZWxmIiwiZm4iLCJ3cmFwIiwiaXRlcmF0b3JTeW1ib2wiLCJnZXRQcm90b3R5cGVPZiIsImdldFByb3RvIiwidmFsdWVzIiwiY2FsbCIsIk5hdGl2ZUl0ZXJhdG9yUHJvdG90eXBlIiwiY3JlYXRlIiwiSXRlcmF0b3JQcm90b3R5cGUiLCJmb3JFYWNoIiwiZ2VuZXJhdG9yIiwicmVzb2x2ZSIsInJlamVjdCIsInRyeUNhdGNoIiwiaGFzT3duIiwidGhlbiIsIlByb21pc2VJbXBsIiwicHJldmlvdXNQcm9taXNlIiwiY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmciLCJkZWxlZ2F0ZSIsIlR5cGVFcnJvciIsImluZm8iLCJsb2NzIiwiZW50cnkiLCJ0cnlMb2NzTGlzdCIsInRoaXMiLCJpdGVyYWJsZSIsIm5leHQiLCJjb25zdHJ1Y3RvciIsImRpc3BsYXlOYW1lIiwiR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUiLCJpc0dlbmVyYXRvckZ1bmN0aW9uIiwibWFyayIsImF3cmFwIiwiQXN5bmNJdGVyYXRvciIsImFzeW5jSXRlcmF0b3JTeW1ib2wiLCJhc3luYyIsIm91dGVyRm4iLCJyZXN1bHQiLCJpdGVyIiwiR3AiLCJ0b1N0cmluZyIsImtleXMiLCJvYmplY3QiLCJDb250ZXh0IiwidW5kZWZpbmVkIiwibmFtZSIsImlzTmFOIiwiaSIsImhhbmRsZSIsImNhdGNoTG9jIiwiZmluYWxseUxvYyIsImZpbmFsbHlFbnRyeSIsInR5cGUiLCJhZnRlckxvYyIsInJlc3VsdE5hbWUiLCJuZXh0TG9jIiwibW9kdWxlIiwiYWNjaWRlbnRhbFN0cmljdE1vZGUiLCJUIiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsIlBJIiwiY3NzIiwibyIsImRvbSIsImNoaWxkTm9kZXMiLCJzZXRBdHRyaWJ1dGVOUyIsImxpbmtzIiwic2V0IiwiZG9jdW1lbnQiLCJodG1scyIsIl9kb20iLCJpZCIsImFwcGVuZENoaWxkIiwiZyIsImEiLCJuIiwiaGV4IiwicmVwbGFjZSIsInBhcnNlSW50IiwiTWF0aCIsImMiLCJsIiwibGVuZ3RoIiwidiIsInN1YnN0ciIsInQiLCJiIiwibWluIiwibWF4IiwiaCIsInMiLCJyIiwiaHVlVG9SZ2IiLCJwIiwicSIsInNldHRpbmdzIiwicGFyZW50IiwiY29sb3JzIiwidyIsInN2ZyIsImQiLCJjeCIsImN5IiwiZngiLCJmeSIsInRhbiIsImQyIiwiYTIiLCJhciIsImoiLCJwYXRoIiwiY2NjIiwiYTEiLCJoc2xUb1JnYiIsIm1pZCIsImNvbG9yIiwibnVkZ2UiLCJzZXRUZXh0IiwiVG9vbHMiLCJSIiwiTmFOIiwidWkiLCJpc0NhbnZhc09ubHkiLCJldmVudCIsImUiLCJjbGllbnRYIiwiY2xpZW50WSIsIklEIiwibW91c2UiLCJ4IiwieSIsInUiLCJ1aXMiLCJhdXRvV2lkdGgiLCJweSIsInB4IiwieiIsIm15IiwidG1wVGltZSIsImlzTmV3U2l6ZSIsImN0eCIsImhpZGRlbkltcHV0IiwiaGlkZGVuU2l6ZXIiLCJzdHIiLCJzdGFydFgiLCJtb3ZlWCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIlJvb3RzIiwiVjIiLCJhbmdsZSIsImFscGhhIiwiUHJvdG8iLCJzdHlsZSIsIm1hcmdpbkJvdHRvbSIsInRleHRDb250ZW50IiwicG9zaXRpb24iLCJwb3MiLCJjc3NUZXh0IiwiaGVpZ2h0IiwiYmFja2dyb3VuZCIsImxpbmVIZWlnaHQiLCJsbmciLCJpZDIiLCJwcCIsIndpZHRoIiwidG9GaXhlZCIsImRpc3BsYXkiLCJkb3duIiwiQm9vbCIsIl90aGlzIiwiYm9yZGVyQ29sb3IiLCJtYXJnaW5MZWZ0IiwibGVmdCIsIkJ1dHRvbiIsImNjIiwiaW5uZXJIVE1MIiwic3RhdCIsImZvbnRDb2xvciIsImZvbnRTZWxlY3QiLCJhZGRFdmVudExpc3RlbmVyIiwidGFyZ2V0IiwiZm5hbWUiLCJyZWFkZXIiLCJwYWRkaW5nIiwic2l6ZSIsIkNpcmN1bGFyIiwiQ29sb3IiLCJ0b3AiLCJib3R0b20iLCJvZmYiLCJyciIsInRyIiwiVHdvUEkiLCJodWUiLCJfcnIiLCJyYWQiLCJyYWQwIiwicmFkMSIsInNxcnQiLCJtYXhSIiwicmFkMiIsInBpOTAiLCJsdW0iLCJ0c2wiLCJjb3MiLCJzYXQiLCJjbGFtcCIsImhzbCIsInZpc2liaWxpdHkiLCJ1bnBhY2siLCJzeSIsImFkZFNjYWxhciIsIkZwcyIsIkRhdGUiLCJwYW5lbENzcyIsInNldEF0dHJpYnV0ZSIsImZvbnRXZWlnaHQiLCJib3JkZXJSYWRpdXMiLCJib3JkZXIiLCJwb2ludCIsInRpbWUiLCJHcmFwaCIsImdoIiwid20iLCJvaCIsInduIiwiaXciLCJHcm91cCIsImNoYW5nZSIsImlzT3BlbiIsImNsb3NlIiwib3BlbiIsInRtcGgiLCJpc1VJIiwibWFpbiIsInB1c2giLCJpc0dyb3VwIiwiSm95c3RpY2siLCJkaXZpZGVTY2FsYXIiLCJuZWdhdGUiLCJ1cCIsImFicyIsIktub2IiLCJlbmRhbmdsZSIsInN0YXJ0YW5nbGUiLCJzdGVwIiwiTGlzdCIsImZsdG9wIiwic2EiLCJzY3JvbGwiLCJzYiIsInRlc3RJdGVtcyIsImJhc2VIIiwiaXRlbSIsIm51cCIsImNoaWxkcmVuIiwiTnVtZXJpYyIsImlzU2luZ2xlIiwiY3VycmVudCIsImZvcmNlIiwibngiLCJTbGlkZSIsImlzTnVtIiwiaDIiLCJ3dyIsInJhIiwiaDEiLCJ0eCIsIlRleHRJbnB1dCIsIlRpdGxlIiwidG9VcHBlckNhc2UiLCJTZWxlY3QiLCJidXR0b25Db2xvciIsImJ1dHRvbk92ZXIiLCJidXR0b25Eb3duIiwiYnV0dG9uQWN0aW9uIiwiU2VsZWN0b3IiLCJzZWwiLCJFbXB0eSIsIkl0ZW0iLCJiZ092ZXIiLCJHcmlkIiwiaW5zZXJ0Um93IiwicmFkaXVzIiwidHkiLCJsaW5lIiwiYWRkIiwidG9Mb3dlckNhc2UiLCJHdWkiLCJtIiwiZm9udCIsInNoYWRvdyIsIm1vZGUiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJjbGVhciIsInNlbGVjdGVkIiwiY2xlYXJUaW1lb3V0Iiwid2luZG93IiwiaGhoIiwiaXNHdWkiXSwibWFwcGluZ3MiOiIyT0FPQSxJQUFJQSxFQUFXLFNBQVVDLGtCQUdSQyxjQUNBQyx5REFHYUMsMkJBQ0tDLHFDQUNGQyx3Q0FFL0JDLHNDQUNFQyxFQUFBLG1FQVVNLElBRlIsc0JBSVdBLEVBQUFDLGVBQ0FBLGNBSVhDLHFIQThNQUEsaUNBR1NDLHNCQUVHQywrRkFhUkMsUUFDQUYsdUlBaUJTRyxpQkFDSUMsNERBT0pELG9HQWNERSxtQ0FNRkMsa0JBR0dDLGdEQXpReUJDLEVBQUFMLGdCQWdCdENNLHdGQVpPQyx1SUF3Q1VDLHdDQUlJQyxzQkFDNkJDLEVBQVNDLEVBQU8sa0JBR3hEQyxLQUFOQyxvQkFNK0J6QixZQUN4QkEsaUJBQW1CMEIsT0FBTkMsY0FXeEIzQixXQUNFLFFBQUEsVUFBQTRCLGtGQW9DRkMsa0JBQ0VwQixFQUFBcUIsRUFBQUMsU0FDWUMsT0FBcUJILDhFQU16QkksK0NBR3dDQyw4TEF1QmhEekIsMkJBRVcwQix1QkFDVTFCLG1CQWlCRjJCLFlBQUFDLGdCQXVIckJDLHlDQUVFLGVBR0UsaUZBV1Esd0RBUVFDLCtFQU9HRCxXQUFBMUIsMkNBR25CLGNBQ0FJLGlCQUNBLG9EQWdCQXdCLGVBR0FGLHdGQVpBLGNBQ0EsNkRBQ0EsbUJBcURKRywyQ0FJSUEsNEJBSUFBLGdCQUNBQSx5Q0FNSkMsaUZBT0FDLGlEQUtFQyxnQ0ErQkZDLFFBQ0UsT0FDb0JBLHFGQVNSLFFBQ0gsOENBRVNBLGlDQUVIOUIsYUFLVCtCLFVBQ0FBLHlGQTlZUzlDLFlBQWUrQyxnQkFDTkEsZ0JBQ1RDLGNBQXFCQywyQkFnQi9CQywrSUFVQUMsc0ZBSUhGLGdFQVdHRyx1Q0F1RWNDLEVBQWNyRCxhQUN0QkEsVUFBYnNELDZCQUdPRCxrQkFLQUUsdUNBQ0xwQiwyQkFHTXFCLEVBQUF2QyxFQUFBMEIsR0FES1IsOEVBUUVzQixRQUFBQyxlQXVLTUMsS0FFZkEsbUJBT0p2Qyw2QkFJQXdDLGtEQW1DS0MseUhBWU1DLFdBQ0xoQixVQUNBQSx5QkFRSixRQXVDR3ZCLFdBTUF2Qix1QkFDTStELFFBRU4seUJBQ0gsWUFDQSxZQUdBbkIsV0FBWW9CLGFBQ1osZ0JBQ0EsaUJBRUEsZ0JBQ0FBLHdDQUtPQyxLQUFMckIsYUFFTXFCLGtCQUNPekMsVUFEUDBDLFNBRVFELDZCQU9kLHNCQUNGLFFBRWFyQixrR0FTRSx1Q0FLSkEsdUdBZ0JEQSx1QkFBRyxFQUF5QnVCLFNBQWFBLDJGQVc3Q3ZCLHdCQUNvQnBCLHVCQUNFQSx3Q0FHTmtCLGtCQUNQMEIsRUFBTUMsYUFEZixlQUV1QjNCLG9CQUNkMEIsRUFBTUUsc0NBSUM1QixrQkFDUDBCLEVBQU1DLHdDQVNMM0QseURBTE1nQyxvQkFDUDBCLEVBQU1FLHVCQVVqQixXQUFFN0QsYUFDSW1DLHVCQUFHLEVBQXlCdUIsU0FBYUEsdUNBRTdDdkIsV0FBQVgsd0JBQUFXLHNIQWtCSTJCLEVBQWVBLGFBQUEsaUJBQ3pCQyxRQUNBL0QsNkVBV00sV0FBRWdFLCtOQW1CSixzQkFDTTdCLHVCQUFHLEVBQXlCdUIsU0FBYUEsaUlBV3pDdkIsdUJBQUcsRUFBeUJ1QixTQUFhQSxpRUFJM0MscUdBYUcsV0FBRU8sRUFBQUMsd0JBQ2IsZ0ZBenJCUyxDQW90QkssaUJBQVhDLE9BQXNCQSxPQUFPN0UsUUFBVSxJQUdoRCx5QkFFRSxNQUFPOEUsWUFVQyw4QkFBUi9FLEdDdHVCRixJQUFNZ0YsRUFBSSxlQUVRQyx1TkFZSixzSEFDRSw0SUFDQSxrRkFFSkMsZ0JBQ0dBLGdCQUNEQSxhQUNBQSxnQkFFQ0Esc0JBQ01BLDZEQVVQLE1BQVEsS0FBTyxLQUFPLGtEQVFuQkYsRUFBa0JBLHFEQU9sQkEsRUFBa0JBLG1CQU92QixtQkFDSSxzQkFDRyxrQkFFRCxvQ0FDSSxpQ0FJSCxzQkFDQSw0QkFDTSxrQkFDViw0QkFDRSx5QkFFSCxxQkFDSSx1QkFDRSxxQkFFRixvQ0FDSSw0QkFFUixpQkFDQSxpQkFDQSxpQkFFQSxpQkFDQSxlQUNGLGVBQ0EsaUJBQ0UsaUJBRUEsNEJBQ0EsZUFFRiw0QkFFTyxvQkFDQyxtQkFRUCxtT0FDQyw0RkFPRCxrT0FDQSxrQ0FDSSxnQ0FDRiw4QkFFRixzRkFDRCw2SEFDRyxzS0FDSyx1R0FDSCxnSEFDRix5SkFDRixxZEFDRiwrUEFDTSxtR0FDTix1RkFDSyxzRkFDRCx3REFDRCwyRUFDRixtQ0FDRSxtSkFZYUEsY0FDTkEsdUxBSWJHLHVUQVFPQyxpREFNUEMsc0JBQWdCWCxFQUFBakUsY0FDWDRFLG1CQUF3QkMsaUJBQUFDLG9CQUFBYixFQUFBakUsc0JBQ3hCOEUsb0JBQUFiLEVBQUFqRSxtRUFPOEI0RSxnQkFBbUIsaUZBUzlCRCxvQ0FDQ0ksd0ZBUXpCLHNCQUNLLGlEQUVFLHVDQUEwQ0Ysb0JBQzFDLHVDQUEwQ0EsaUJBQW9CQSxvRUFTakVOLDhCQUFxQ0EsaUZBSy9CUyxzR0FnQnFCQywyQkFBR0MsU0FDdEJDLHlDQUFvQkQsY0FJaENDLHFIQVNrQ1osTUFBMUJOLFlBQ1JNLE1BQUFJLEtBQ0FKLE1BQUFhLEdBQUFDLHNCQUNJZCx3QkFBSmUsRUFBd0NBLHVEQU94Q2YsdUpBWUtnQixxQ0FFR0MsS0FBSzlCLFVBQzZCa0IsR0FBRyw4QkFLeENXLHdCQUVZWCxrREFZakJhLHVCQUdZQyxzQkFBTixrQkFFQ0QsS0FBR0EsS0FBQUEsS0FBQUEsS0FBQUEsS0FBQUEsbUNBTVY3QixJQUFBQSxNQUNLK0Isa0JBQXdCLElBQUMsR0FBYixnQkFDWkMsK0JBQWdDQyxFQUFJQSxFQUFLQyxHQUFsQixNQUFUekMsZUFDRndDLFNBQU5FLHVEQVNIRixTQUFhQSxTQUFhQSxxRUFPVEcsY0FBWkMsUUFBQSxtQ0FNTkQsMEJBQUEsNENBTVNILFlBQUFqQyxLQUFELDZDQU1DaUMsWUFBQWpDLEtBQUQsdUNBTVhpQyxVQUF3QnRCLE9BQUEsR0FBRkEsRUFBZ0JBLE9BQUEsR0FBaEJBLEVBQThCQSxPQUFBLFNBQy9Dc0IsVUFBd0J0QixNQUFBLEdBQUZBLEVBQWNBLE1BQUEsR0FBZEEsRUFBMEJBLE1BQUEsOERBTTlCc0IseUJBQThCQSx5QkFBOEJBLHFDQUtwRkwsU0FBSEEsd0RBTW1CSyxJQUFYeEMsZ0NBQ1d3QyxJQUFYeEMsZ0NBQ1d3QyxJQUFYeEMseUJBQ0trQixTQUFXQSxTQUFXQSw4Q0FRbkMyQixZQUNBQSx1RkFVUUwsS0FBTVAsT0FBVWEsZ0JBQXFCQyxFQUFMZCxnQkFBOEJlLEVBQUxmLGFBQXNDZ0IsSUFBT0MsS0FBUUgsS0FBRyxvQkFDekhHLHlDQUUyQmpCLE1BQVVhLG1CQUNWQSxRQUFlSyxtQkFDZkEsUUFBZWxCLGVBR25DaUIsRUFBQVQsbUNBTUdRLE9BQVVDLE9BQVVULHFCQUVSQSxFQUFBQSxNQUdiLEVBQUpBLEtBREFBLE1BQUdBLEtBQWlCLEdBQWpCQSxFQUEwQlMsRUFBRFQsRUFBV1MsTUFFakNFLFdBQWFDLEVBQUdDLEVBQUksUUFBbEJwQyxhQUEwQ21DLEVBQUdDLEdBQWRwQyxhQUFnQ21DLEVBQUdDLEVBQUksNENBV25GcEMsTUFBQSxLQUFBcUMsRUFBQUMsRUFBQSwrQkFFUWhDLHdCQUVSakIsV0FBQUEsTUFFS2tELGlDQUU0QixHQUFFLDhDQUEvQixFQUE0RnRCLHdDQXlCdEZqQixVQUFBQSxFQUFjQSxVQUFkLG9CQUFzQ3dDLGtEQUNoRHhDLGFBQUEsR0FBQSxrRkFBQXlDLEtBQ0F6QyxXQUFBLEdBQUEsR0FBcUIwQywrRUFBckJELEtBQ0F6QyxhQUFBLEdBQUEsZUFBcUNpQywwREFBckNRLEtBQ0F6QyxXQUFBLEdBQUEsR0FBcUIwQyw2R0FBckJELEtBQ0F6QywrQ0FRVUEsVUFBQUEsRUFBY0EsVUFBZCxvQkFBc0N3QyxrREFDaER4QyxhQUFBLEdBQUEsMEVBQUF5QyxLQUNBekMsV0FBQSxHQUFBLEdBQXFCMEMsOEVBQXJCRCxLQUNBekMseUZBV1VBLFVBQUFBLEVBQWNBLFVBQWQsb0JBQXNDd0MscURBQ2hEeEMsV0FBQSxLQUFBLEdBQUF5QyxLQUNBekMsUUFBQSxLQUFBLEdBQUF5QyxTQUVBLEdBS08sc0JBQUssQ0FBRixtQkFBMkIsQ0FBM0IsdUJBQWtELENBQWxELDREQUM4QjVCLFVBQVc4QixTQUFVQyxpQkFBbUJDLFNBQVVDLGNBR25GLHNCQUFLLENBQUYseURBQzhCakMsV0FBWThCLFNBQVVDLGlCQUFtQkMsU0FBVUMsa0JBR2hGLG9EQUNBLG9EQUVKLFVBQWEsR0FBUixDQUFGLFFBQTJCLEdBQVIsQ0FBbkIsUUFBNEMsR0FBUixDQUFwQyxTQUE4RCx3Q0FDaENqQyxZQUFhOEIsU0FBVUMsaUJBQW1CQyxTQUFVQyxjQUVyRixVQUFhLEdBQVIsQ0FBRixRQUEyQixHQUFSLENBQW5CLFFBQTRDLEdBQVIsQ0FBcEMsU0FBOEQsd0NBQ2hDakMsYUFBYzhCLFNBQVVDLGlCQUFtQkMsU0FBVUMsa0NBSWxFSCxNQUFPQyxtREFDUEQsTUFBU0MsdURBQ1RELE1BQU9DLDRDQUU5QkgsU0FJRyxxQkFBSyxDQUFGLG9CQUF3QixDQUF4Qix5REFDOEI1QixXQUFZOEIsU0FBVUMsaUJBQW1CQyxTQUFVQyxrQ0FFaEVILE1BQU9DLGdHQUNQRCxNQUFPQyx1REFDUEQsTUFBT0MsaUZBRTlCSCwwQ0FVTXpDLFVBQUFBLEVBQWNBLFVBQWQsb0JBQXNDd0Msa0RBQ2hEeEMsV0FBQSxLQUFBLEdBQUF5QyxLQUNBekMsUUFBQSxLQUFBLEdBQUF5QyxTQU1BTSxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBN0QsRUFBQThELEVBQUFDLEVBQUFDLG1CQUQ0QnBDLHlCQUk1QjVCLFFBQXFCQSxFQUFyQixrQkFFTUEsTUFDS1csWUFFSixpQkFBbUJzRCxNQUVwQixjQUFHakMsWUFDY0EsZUFEZEEsWUFFbUIwQixlQUZuQjFCLGtCQU1MckIsYUFBV3VELGNBQTRCLFFBRWxDLEVBQUcsT0FFSkosaUJBRUtELFFBQWlCTSx1QkFHTixTQUFjLFVBQWUsU0FBYyxTQUFjLFlBRXRFLEdBQUtDLEtBQVMsR0FBRyxDQUFaLFNBQTJCLG1EQUNhLFFBQVUsUUFBVSxRQUFVLDhDQUU1RXBELFVBQWEsNkVBR2pCNEMsRUFBS1MsT0FDUEQsU0FVRSxFQUFFLFVBQUEsR0FBRixJQUFxQixVQUFBLEdBQXJCLElBQXlDLFVBQUEsR0FBekMsS0FBNkQsVUFBQSxNQUNuRXpELDhCQUFBLHVFQUFBeUMsRUFBQVksT0FFTSxFQUFFLFVBQUEsR0FBRixJQUFxQixVQUFBLElBQXJCLEtBQTJDLFVBQUEsTUFDakRyRCw4QkFBQSxvRUFBQXlDLEVBQUFZLEtBRUFyRCxRQUFBLEtBQUEseURBQUF5QyxLQUNBekMsY0FBQSxHQUFBLHNEQUFBeUMsRUFBQSxLQUNBekMsY0FBQSxHQUFBLGdHQUFBeUMsRUFBQSxLQUNBekMsY0FBQSxHQUFBLGdHQUFBeUMsRUFBQSxLQUNBekMsV0FBQSxHQUFBLEdBQXFCMEMsaUlBQXJCRCxFQUFBLEtBR0F6QyxhQUFBLEdBQUEsaUJBQXVDaUMsOENBQXZDUSxLQUVBekMsaUZBU3dCQSx3Q0FBd0NBLGlMQUkzRCw0RkFJQSxvV0FHTDJCLGtCQUNPQSx3QkFJQyxpakJBQUEsT0FTaEIzQixFQUFFMkQsY0FFV0MsRUFBUTVELEVDem1CZjZELEVBQUkseUNBT0UsNkNBS0ssME9BZ0JBLHFDQUlOLFNBQ0QsNkNBUUUsYUFDRyxVQUNBLFVBQ0FDLFFBQ0osV0FDRSxpQ0FTTEQsYUFDQUEsYUFFS0EsY0FBTEEsRUFBc0JBLHlFQU9sQjVDLHFCQUF1QkEsbUJBQXFCQSxvQkFBc0JBLGtCQUFvQkEsa0JBQW9CQSx3QkFBMEJBLHFEQU9oSTRDLDhDQUlGRSxTQUFXMUUsVUFHYndFLHlEQVlBQSxvQ0FJSkEsV0FBYUEsZUFFVEEsNkNBQ29DQSxvQ0FDRkEscUNBQ0NBLHVDQUVBQSx1Q0FDRUEsaUNBQ05BLDRDQUNTQSwwQ0FDRkEsc0NBRzFDQSxHQUFBLG1DQUNBQSxHQUFBLG9DQUNBQSxFQUFtQ0EsUUFBbkMsS0FHQUEsK0NBTUtBLG9DQUlEQSxnREFDdUNBLHVDQUNGQSx3Q0FDQ0EsMENBRUFBLDBDQUNFQSxvQ0FDTkEsK0NBQ1NBLDZDQUNGQSx5Q0FHN0NBLHNDQUNBQSx1Q0FDQUEsRUFBc0NBLFVBRXRDQSxzQ0FNQUEsNEJBRVFBLGtCQUlIQSxLQUFLRSxjQUNTQyw0RkFpQktILGNBQXhCSSw2Q0FTQUosbUJBRVFBLHNCQUVSQSxFQUE4QkEsNkJBQzlCQSxFQUE0QkEsMEJBRTVCSyxFQUE2QkEsd0JBQ3hCQSxVQUVMQSx1QkFDQUEsdUJBQ0FBLGNBSUlMLHVDQUVxQiwyQkFFTE0sU0FBQSx5QkFDQUMsU0FBQSxrQ0FJaUIsMENBQ0YseUNBQ0MsOEJBWWhDRixPQUFKTCxFQUE2QkEsdUJBQ3pCSyxPQUFKTCxFQUEyQkEsV0FFdkJBLDBCQUFjSyxNQUFsQkwsRUFBMkNBLDBCQUN2Q0ssUUFBMkJMLE1BQS9CQSxFQUF3Q0EsbUJBR3BDQSxVQUVNUSw4QkFFV0MsdUJBQ0FBLGNBSWZELGtCQUlGUix3QkFBY0ssTUFBbEJMLEVBQXlDQSxvREFVakNBLGFBQWlCLGFBSXBCQSxLQUFLRSxvQkFJRlEsWUFDQUMsY0FJQUQsWUFDQUMsc0JBSVVDLEVBQUdGLEdBQWIscURBT01GLGlCQU9kUixFQUFrQkEsc0NBTWJBLE9BQ0xBLGFBQ0FBLGFBQ0FBLFVBQ0FBLHNFQVlBeEUsSUFBQUEsT0FFS3FGLGFBRURELGFBQ0FBLE1BRUlFLG9CQWNPSixhQUNBQyxLQUNMQyxJQUFNMUMsZUFkUzBDLElBQU0xQyxZQUVoQndDLElBQVNBLGVBQ1RDLEVBQVdJLE1BQVc3QyxpQkFJM0IwQyxTQUNTakMsTUFBUXFDLGdHQXNCTlgscUJBQWIsNkNBYUhMLDZCQUVHQSxpQkFJSEEsS0FBS0UsdUNBTVZGLGlFQU1BLGlCQUVRekQsV0FDSzBFLFFBQ0FBLHFCQUVvQ0EsUUFBaUJBLFdBRWxFMUUsRUFBV0EsWUFBQTJFLEtBQ04zRSx5Q0FRREEsc0JBQ0lBLG1DQUNSQSxRQUFXbUUsU0FBVUMsUUFBU2hDLFVBQVdULGlEQVc1QjhCLHVDQUNUMUUsY0FDQUEsOENBYVMwRSx5QkFBbUNtQixtQkFBYSxlQUV6RG5CLFdBRUFBLE9BQUpBLEVBQWFBLHlDQUFvQyxPQUFkLG9CQUt6QnpELG9CQUF3QkEsZ0JBQWxDNkUsZUFFSXBCLFdBQUpBLEVBQTBCQSw0QkFFaEJBLGFBRU9BLGtDQUFtQ3pELHdOQU16Q0EsbUVBTUg4RSxZQUFBLDBCQUVpQixtSUFtQnJCckIsWUFBSixPQUVZQSxhQUFHLEdBQUEseUJBRUpBLGlCQUFHLDRJQUdWbkQsbURBQ0EsbUNBQ0FQLEVBQWlDLDZCQUFxQixHQUFBLHFDQUV0RE8sMERBQ0FQLEVBQWlDLDJDQUVqQ2dGLHlDQUNBQyxlQUlKdkIsMEJBQTRCQSx5QkFDNUJBLG9CQUFzQkEsTUFDdEJBLHdCQUEwQkEsTUFFMUJBLDhDQU1JQSxnQkFDSkEsK0NBTVFBLGFBQWN0QyxJQUFPTiwyQkFFcEJvRSw4REFVTHhCLE9BQUosdUJBSUEsT0FFVUEseUJBRU5oRCxzREFNSWdELFdBQWV5Qiw2Q0FPUEMsc0NBQUoxQixvQ0FLTiw0SkFVRSxrQkFRUkEsRUFBU0Esa0RBUURBLFlBQWFBLGdCQUFBQSxFQUFvQkEsZUFDakNBLFlBQWFBLGdCQUFBQSxFQUFvQkEsb0JBQ2pDQSxZQUFhQSxnQkFBaUJBLGNBQWpCQSxFQUFtQ0Esa0JBRXhEQSxnQkFBQUssRUFBQWxDLDBDQU1JNkIsZ0NBQ0csWUFDUEEsMEJBQ09BLHlEQU9IQSxXQUNDQSxZQUFMQSxFQUFvQkEsc0JBRXBCQSxnQkFDQUEsb0JBR0FBLHlCQUEyQkEsd0JBQzNCQSwwQkFBNEJBLDRCQUM1QkEsbUJBRUFBLGFBQ0FBLGNBQ0FBLE9BQUFBLEVBQ0FBLHlDQU1BQSxlQUVBQSxVQUNBQSxXQUVBQSx5QkFBMkJBLDBCQUMzQkEsMEJBQTRCQSxrQ0FDNUJBLE1BQVFBLG9CQUVSQSw2Q0FZSUEsZ0JBRVVLLG1CQUlkTCxnQkFHSUEsbURBUUpBLG1FQXNCY0ssY0FBREEsY0FBMkNBLHFCQUEzQ0EsaUJBQUFBLGVBQUFBLGlCQUFBQSxxSEFlVEwsV0FFSkEsTUFBUUEsb0JBRUpBLGdCQUFKQSxFQUF3QkEsaUJBQWtCQSxPQUNyQ0Esb0JBQXNCQSxNQUUzQkEsV0FBYUEsNkJBQ2JBLGNBQWlCQSwyQkFBRkEsRUFBZ0NBLDRCQUUvQ0EsaUJBR0FBLHNDQVlJQSxRQUFKMkIsd0JBQXNDM0IsUUFDdENBLHdDQU1RQSxpQ0FDZXhFLDhDQU1kd0UsMkJBQ1RBLEVBQWdCQSxpQkFBQSxTQUNaQSxpQkFBSkEsRUFBNkJBLHlDQU1wQkEsdUJBSVRBLGtCQUVLQSxtQkFDRCxlQVFDNEIsRUFBUTVCLDBMQzd1QlI2Qiw0Q0FFZ0Isa0JBQUEsdUlBaUJqQmpFLFlBQ0FBLGdEQU9BQSxZQUNBQSxnUEE2QkUzRCxxQkFFWjZILHlRQXNDU2xFLFdBQ0FBLHNDQVFFQSxjQUFzQkEsZ0RBTXRCQSxFQUFFOEMsb0JBQXNCQSxjQUFvQjlDLEVBQUUrQyxvQkFBc0JBLGlFQU9wRW9CLGlCQUNHQSxlQUVIckIsRUFBRXpHLHFCQUNDMEcsRUFBRTFHLHNCQ2xIWitILDZDQUVvQixnQkFHTnpGLHVCQUNBQSxpTUFVR0EseUJBRURtRSxJQUFLQyxJQUFLaEMsSUFBS1Qsb0ZBUXBCM0IsSUFBb0JBLGlFQUd6QkEsSUFBSnRDLFNBQWlDc0MseURBRzdCQSxJQUFKdEMsU0FBaUNzQyxrQkFDakN0Qyw2Q0FHaUJzQyxzQ0FNSEEsd0NBSURBLDBCQUNHQSx1REFTRkEseUJBQ2R0QywyQ0FRR3NDLEtBQUh0QyxVQUFrQ3NDLGVBQy9CQSxLQUFIdEMsVUFBa0NzQyxrQkFFbEN0QywyQ0FHVXNDLFFBQTBCQSxzSUFVaENBLGFBQXNCQSxpQkFBZ0JBLGlCQUN0Q0EscUJBQTBCQSw0QkFHWkEsOENBQ0RBLDhDQUNDQSw0Q0FFZEEsUUFBSnRDLGlCQUE2Q3NDLGlEQW1CNUIsZUFFTkEsNEJBQ0dBLHlCQUNBQSxzQ0FFRUEsZ0JBQWtDQSw0RkFHbER0Qyw2REFTS3dELGVBQU94RCxzRkFDUGtFLFVBQVlWLEdBQUx3RSxrQkFFWmhJLE9BQXFCa0UsR0FBTCtELDBGQUtPRCxnQkFDWkUsaUJBQVBsSSxZQUF3QkEsU0FBQUEsc0JBQ2pCMkYsTUFBUDNGLG1CQUdBc0MsSUFBSix3QkFDVzZGLFNBQVAsMkJBRUk5RCxHQUFBL0IsTUFBaUI4RixjQUVyQixJQUdBOUYsTUFBSnRDLE9BQWlCa0UsR0FBTG1FLFVBQW9CL0YsMkZBaUJoQzRCLEdBQUNvRSwrQkFFRHBFLEVBQWlCQSxHQUFDcUUsbUNBQ2xCckUsRUFBb0JBLEdBQUNxRSw4QkFHakIvRSwwQkFDQUEsS0FBU3dFLFdBQ1BNLE9BQUZ0SSxPQUFlLEVBQUQsVUFDWndJLFdBQUZ4SSxPQUFtQixFQUFELDJCQUtqQnlJLElBQWlCakYsT0FBdEJqQyxNQUFBQSw2Q0FHU2lDLEtBQU93RSxvREFLWiw0Q0FFZ0IsZ0NBQ1gsTUFHVHhFLEdBQUNSLGtEQU9VZ0Ysb0JBQVAsOERBV0czRixFQUFBNUUsRUFBQXFGLEVBQUFDLDRDQU1QbkIsRUFBQWpFLEVBQUFvRixFQUFBMkYsc0NBTUFyRyw2Q0FNTzBCLEVBQUFDLGtEQU1QOEIsMkZBT0FBLDBGQU9BQSw0RUFPQUEsOElBeUJZdEMsOENBUVp4RCxPQUFnQmtFLEdBQUxxRSxnRUFRWHZJLE9BQWdCa0UsR0FBTHFFLDhEQU1GL0UsS0FBVHhELE9BQWtDd0QsR0FBTDBFLDZOQXVCN0JsSSxnU0FzQzBCMkQsU0FBMUJBLElBQStDQSw0Q0FHL0MzRCw0Q0FDQUEsZ0JBQW9CQSx5RkFRTTJELFNBQTFCQSxJQUErQ0Esc0JBRS9DM0QsNkNBQ0FBLGdFQVVrQndELDZJQVNsQm1FLG9KQW9CSTNILE9BQVVBLG1CQUVKQSxlQUFjLGFBQ3BCdUQsYUFBd0IsWUFDeEJBLGtCQUFzQm9GLEVBQUEsaURBUXJCekUsR0FBTDBFLGdDQUNBNUksT0FBd0JrRSxHQUFMMEUsd0dBYWhCdEcsNENBQ2dELEVBQWJBLG1CQUM3QkEsNkJBR0VBLFdBQWtDQSx3QkFDbENBLFVBQWtDQSw4QkFDNUJBLGNBQWdDQSxtQ0FLckM0QixpQkFDQUEsa0JBQ0FBLG1CQUNBQSxvQkFDQUEsb0JBQ0FBLDBCQUdBNUIsU0FBNEJBLG1IQVF4Q2EsbUNBQ09JLGtCQUFvQkosSUFBcEIwRixrRkFZS3pDLE1BQUxBLG9TQStCRmxDLEdBQUw0RSwyUkFpREE5SSxrREFNTytJLHFEQ2prQkZDLGlEQUVhLHFDQUlMMUcsMEJBRU1BLGdDQUVSQSxnQ0FDQUEseURBSU5rQixlQUFPeUYsMEpBQ1B6RixlQUFPeUYsa1dBa0NOVixXQUFGdkksd0JBQ0VrSixZQUFGbEosd0JBQ0VtSixXQUFGLGNBSUVaLFdBQUZ2SSx3QkFDRWtKLFlBQUZsSix3QkFDRW1KLFdBQUYsNEZBV0pqRixHQUFDa0YsY0FDRGxGLEdBQUNrRixnQkF0RWlCckIsR0NDYnNCLGlEQUVhLGlEQU1KL0cseUNBRWQyRyx1REFNVUEsZ0JBQUFBLDBCQUVOM0csTUFBSjJHLFVBQXVDM0csZ0JBQ25DQSxTQUFKMkcsVUFBMEMzRyxtQkFDdENBLFVBQUoyRyxVQUEyQzNHLG9CQUN2Q0EsUUFBSjJHLFVBQXlDM0csd0JBRXJCQSw0QkFDQUEsMEJBRXBCMkcsd0VBTUExSCxRQUFBQSxVQUVZLHlCQUF1QjBILGFBQUEsdUJBQUFBLEtBQTZESyxHQUE3RCxpQkFBZ0YsaUJBQWhGTCxzQkFBQSxtQkFBQUEsU0FBQSxhQUN2QixHQUFDakIsWUFBVGlCLGtCQUNRLEdBQUNNLFVBQVROLDRDQUtLekYsS0FBVHlGLElBQW1DekYsR0FBTDBFLGdDQUU5QmUscUpBYUl4RixVQUFjQSxFQUFsQixtREFNS0ksS0FBTXRDLFFBQVNzQyxLQUFNdEMsR0FBRixTQUFrQixvRUFjdEMsZUFDQSwrSUFpQkp2QiwySEFrQk1BLHVCQUFlLEVBQUEsRUFBa0JxQixNQUVwQ3JCLGlEQWFJbUUsTUFFUDVDLFdBQUFBLFdBRWtCLEVBQU12QixZQUFjbUQsRUFBSSxHQUNoQ25ELFlBQWN1QixFQUFJLE1BRXJCb0MsR0FBSSxxRUFlWCw0QkFJcUI2RixHQUFLakksV0FBUSxjQUFzQmtJLG1CQUFnQixtQkFBMkJILDZCQUM5RUUsR0FBS2pJLFdBQVEsY0FBc0JtSSxvQkFBaUIsbUJBQTJCSiw2QkFDL0VFLEdBQUtqSSxXQUFRLGNBQXNCbUksb0JBQWlCLG1CQUEyQkosU0FJMUYsaUVBc0JILDZCQWlCUGxELHdCQUVLbEMsR0FBTGdGLHNDQUNLaEYsR0FBTHlCLGtEQU1BUyx3QkFFS2xDLEdBQUxnRixrQ0FDS2hGLEdBQUx5QiwyQ0FNQVMsbURBR2lCQSx1REFNWjVDLGtCQUFPeEQsaUlBQTRJLHdCQUEzSEEsWUFBQSxtQ0FDeEJ3RCxHQUFMMEUsMEJBRUsxRSxHQUFMbUcsNEJBQUEsMENBQUEsVUFDS25HLEdBQUxtRywyQkFBQSx5Q0FBQSxVQUNLbkcsR0FBTG1HLDZCQUFBLHlDQUFBLFVBQ0tuRyxHQUFMbUcsd0JBQUEsc0NBQUEsbUNBVUtuRyxvQkFBT3hELHVHQUNQd0QsR0FBTG5DLHFCQUNLbUMsR0FBTDVCLG1CQUVLNEIsR0FBTG1HLDBCQUFBLDhCQUFtREMsOEJBQW5ELDZHQTBCV0Msc0JBZEcsTUFBQSxNQUFBLE9BQUEsa0JBZ0JkQywrQkFmYyxJQUFBLE1BQUEsTUFBQSxNQUFBLGtCQWdCVEEsMkZBV21CRixxRUFVbkJwRyxHQUFMMEUsb0RBT0toRSxHQUFMNkYsK0JBQ0t2RyxHQUFMK0YsMkhBY1c3RSw2Q0FJbUJzRixFQUFTekksSUFBYUEsR0FBbkN5SSxlQUNQekksZUFBaUJBLGVBQWlCQSxPQUVyQyxHQUFDNkgsS0FBSnBKLFlBQXVCdUIsWUFDcEIsR0FBQ3FILE1BQUo1SSxZQUF3QnVCLGlDQUt0QjZILEtBQUZ4RSxFQUFjb0YsSUFBRixVQUNWcEIsTUFBRm9CLEVBQWlCLCtCQUlmWixLQUFGeEUsRUFBYSxVQUNYZ0UsTUFBRm9CLEVBQWlCLFVBaFZEakMsR0NBZmtDLHdEQUVhLG9LQWlCVDNILHNCQUdKa0IsR0FBTHdFLGtDQUVReEUsWUFFR3dFLFlBQVBpQixJQUF3QixZQUNqQmpCLGdCQUFQLGVBQ0Esc0NBU0N4RSxlQUFPeUYsNEZBQ1B6RixnQ0FFYUEsR0FBbEIsSUFBQXlGLGFBQUEsZ0JBQ2tCekYsR0FBbEIsU0FBQXlGLFlBQUEsZ0JBRWtCekYsR0FBbEIsVUFBQSxpQ0FDa0JBLEdBQWxCLG9JQVNBLG9DQUlRbUMsMkNBQ29CLG9EQUNBLGtEQUdwQkEsMkNBQ29CLG9EQUNBLGdXQStDTFMsd0NBQ0FBLDJIQUt2QixPQUVXcEcsT0FBR0EsaUJBQ1Z1RCxvQkFBU3ZELFVBQUFBLFNBRUYsSUFBR0EsT0FBSSxVQUNIQSxPQUFJQSwrR0FVWG1ELEVBQU1uRCxzQkFDVkEsdUJBQTRCbUQsRUFBY25ELG9DQUUxQ0EscUJBQ0FBLHdNQXFCQ3dELEdBQUwwRSx3RkFHa0IxRSxHQUFsQixJQUFBeEQsZ0JBQUEsTUFDQUEsZ0JBbEtzQitILEdDQ2pCbUMsd0RBRWEscUNBTVI1SCwrQ0FJVkEsS0FBSDJHLFVBQW9DM0csYUFHeEJBLDZGQVNQa0IsZUFBT3lGLDRCQUFBQSxtRUFDUC9FLE9BQVlWLEdBQUx3RSxvQkFHRG1DLElBQVAsY0FDT0MsT0FBUCxXQUdDNUcsd0JBQ0FBLEdBQUx3RSxrRUFJSTFGLHlDQUMrQndELGFBQWFuSSxlQUM5QkEsZUFDVDJFLFFBRFMyRyxRQUFXbkQsY0FBYW5JLHdJQWtCdEMyRSxNQUFKMkcsa0dBT0N4RixVQUFjQSw4QkFNYnpELCtCQUtBQSxXQUFNLHFJQXNCZW9HLFFBQWZBLEVBQTBCQSxrR0FhcEMsaUJBQ0Esc0ZBTzRCQSxRQUFmQSxFQUEwQkEsV0FFS2xFLGtCQUUxQ2xDLHdDQUlJQSxlQUNIb0csdUJBQXNCcEcsYUFBQUEsY0FDdEJvRyx1QkFBc0JwRyxhQUFBQSxZQUN4QnFLLHlCQUNDQSxXQUNHLElBQUdDLGFBR0Msd0hBVUsxRixjQUVKQSxPQUFTMkYsUUFFSnJJLFVBQUFzSSxrQkFDTUMscUJBQ0VBLDRFQU9iSCxTQUFXRyxlQUNaSCxJQUFFSSxPQUFZdEksT0FFakJ1SSxrQkFDR0EsSUFBR0EsT0FBYXZJLGFBRU51SSxvQkFBRkgsV0FDSkksRUFBSSxFQUFLMUksTUFBT0EsRUFBRUUseUJBRXhCNkMsT0FBZTRGLFNBQ2ZDLFNBQWdCckUsRUFBRUEsVUFDZnFFLFNBQWE1SCxFQUFFQSxVQUVYNkgsdUJBRU5DLGlCQUNEQSxPQUFRQSxFQUFRQSxtQkFDRUEsV0FJc0JSLFVBRjNDRyxFQUFPSyxHQUVBOUksT0FBUytJLFdBQWtCWCxvQkFDVnBJLDJCQUVwQjZJLGNBQWtCakgsRUFBREEsS0FHdEJvSCx1QkFBbUNDLHdCQUViRCxZQUNmRSxxQkFBbUMsSUFBT3BMLFNBQVd1SyxJQUM1RGMsUUFBUUMsRUFBRix1QkFFWUMsbUdBY2pCckgsR0FBTG9FLDBGQU9BdEksb0NBQ1FBLDRGQVVSQSwwREFJUWtFLEdBQUxzSCxxR0FVSHhMLDJFQU1Ra0UsR0FBTHNILHVDQUVBM0gsc0RBTXlCN0QsWUFBZSxFQUFBLG1FQU10QndELEdBQWxCLE9BQUE4RixFQUFBLEVBQUEsVUFHS3BGLEdBQUxxRSw4QkFDSy9FLEdBQUwwRSxrRkFHS2hFLEdBQUx5QiwwREFJQTNGLHdDQUNBQSxtREFDQUEsd0RBQ0FBLDhGQVNJMkYsV0FDQThGLFdBQ0EzRiw4QkFFQTlGLGdPQXdCa0JrQyxjQUNGQSw4REFNRkEsUUFBV0EsYUFFbkJBLHVIQVFhd0osS0FBRywyRUFLMUJySCxNQUFBcUMsR0FBQWlGLGtDQUtrQm5JLEdBQWxCLFlBQUEsaUJBQUEsc0JBRWtCQSxHQUFsQixLQUFBYSxFQUE4QkEsRUFBOUIsc0JBQ2tCYixHQUFsQixLQUFBYSxFQUE4QkEsRUFBOUIsc0JBRWtCYixHQUFsQixTQUFBeEQsMEJBQUEsRUFBQSxzQkFDa0J3RCxHQUFsQixTQUFBeEQsMEJBQUEsc0JBQ2tCd0QsR0FBbEIsT0FBQXhELFlBQUEsbUVBV0FrRSxHQUFDMEUscUJBQ0QxRSxHQUFDa0YsOENBRWNwSix1SEFLR3dELEdBQWxCLFVBQUEsb0NBQ0FVLEdBQUMwRSx3QkFDRDFFLEdBQUNvRSx5QkFDRHBFLEdBQUNrRix5QkFDRGxGLEdBQUNpRyx1R0E1V3FCcEMsR0NEZDZELGlEQUVhLG9GQVNMdEosa0JBRUZBLDRCQUdNQSx3QkFHSEEscUJBQ0RBLGNBQVcsY0FDZkEsZ0JBQVEsd0JBS0hBLHFCQUVEQSxZQUFXLElBQUEsZUFFWEEscUVBUVRqRSx1Q0FBV0EsdUNBQUF3TixxQkFDWCxhQUNBLFdBQ0EsT0FFQSxRQUNBLFFBQ0EsT0FDQSxhQUVBeE4scUdBWUEsc0NBT0NtRixHQUFMMEUsc0JBQ0sxRSxHQUFMd0UsMkJBQ0t4RSxHQUFMd0Usa1JBSUE4RCx3Q0FFS3RJLGdCQUFPeUYsY0FBQSxRQUVQekYsR0FBTHVJLHVCQUFBLHdCQUNLdkksR0FBTHVJLHNCQUFBLFlBQ0t2SSxHQUFMdUkscUJBQUEsWUFDS3ZJLEdBQUx1SSxtQ0FBQSxZQU9LdkksZ0JBQU95RixpRkFBQSxHQUErR3JFLGtEQUd0SHBCLGVBQU95Riw2R0FHUjNHLGFBQUoyRyxJQUF3QnpGLGVBQU95RixrSEFNL0IvRSxHQUFDaUYsb0JBQ0RqRixHQUFDc0UsbUJBQ0R0RSxHQUFDeUIsb0JBQ0R6QixHQUFDOEgsaUNBRUQ5SCxFQUF5QkEsR0FBQytILDhCQUMxQi9ILEdBQUNnSSw0Q0FPRDdHLGlCQUFBQSxJQUFBLFdBRVksS0FDSDRELE1BQUcsMENBR1Esb0ZBS2lDSyxHQUExQixPQUFBTCxXQUFBLG9FQU1rQixxREFBMkQsMElBZ0J4R2pKLG1LQXlDQXVCLGFBQUFBLGVBQWlELElBQUE0Syx5RkFRckJ0SSxPQUN2QjRFLG9CQUFMcEQsSUFBQUEsZ0NBQWlGQSx3QkFBekIsaUJBQ25EN0IsR0FBTCtGLHVEQU1lL0YsNkJBQ3dCTCxzREFJNUJuRCw0Q0FDS21ELHVCQUNBQSwyREFDVzVCLEVBQWtDLHdIQWMzQ2lDLEdBQWxCLElBQUF4RCwwRkFHS0Esa0NBRUFrRSxHQUFMb0UsMEJBQ0twRSxHQUFMNEUsdUJBQ0s1RSxHQUFMNEUsNENBR0FuQix3R0FVa0JuRSxHQUFsQixJQUFBeEQsdUZBR0tBLGdCQUFnQkEsbUJBRWhCa0UsR0FBTG9FLDBCQUNLcEUsR0FBTDRFLHNCQUNLNUUsR0FBTDRFLDJDQUdBbkIsNEJBRUtuRSxHQUFMK0YsdUtBc0JJdkosV0FBeUIsbUJBQTZCQSw4QkFFdERvTSxjQUNBLG1LQWNVcE0sUUFBQUEsdUNBR2RBLFNBQWFBLFFBQUFBLG1EQVFiQSx1RUFTQWtFLEdBQUMwRSxlQUNEMUUsR0FBQzBFLGVBQ0QxRSxHQUFDa0YsY0FDRGxGLEdBQUMwRSxrQkFDRDFFLEdBQUMwRSxvQkEvVGdCYixHQ0Fac0UsaURBRWEsOENBSVIvSixRQUF3QkEsU0FBVSxFQUFBLCtDQUczQkEsWUFBNEJBLDhCQUN4QkEseUJBQ1ZBLDBCQUVDQSxRQUF3QkEsNEJBSW5CQSxhQUE0QkEsMENBS3BDQSwrQkFJSmtCLEdBQUx3RSxrQ0FFU3hFLFlBRUV3RSxZQUFQaUIsSUFBd0IsV0FLeEIseUNBUUN6RixlQUFPeUYsNEZBQ1B6RixHQUFMMEUsc0NBRVVlLFlBQUEsb0JBQTRDLElBQUFBLG1FQUN0RCx1REFFQSxHQUFBLEdBQXdCckUsOEVBQXhCRCxnQkFDQSxHQUFBLEdBQXdCOEIsS0FBTUMsY0FBWSxjQUFrQix5REFBNUQvQix3RUFRQXBELFFBQUFBLFNBRUMsTUFBZ0IwSCxLQUFjLEVBQXJCMUgsRUFBc0IwSCxXQUM3QjFILFFBQVVBLFFBQVVBLHNIQU1HQSxHQUFFLGdCQUFtQkEsR0FBRSxzRUFLNUNpQywyQkFNSUEsWUFDRXdFLFVBQVAsYUFDT0EsYUFBUCxjQUNPUSxXQUFQLHlGQVNKeEksbUJBQWtDd0QsR0FBbEIsSUFBQXhELGdCQUFBLGVBRWhCdUIsV0FBQUEsMEJBR2lCLDZCQUF5Qyx5QkFDekMsWUFBc0J2QixxQkFBTnVCLEVBQXFDLDBDQUNoQyw2SEFLakNpQyxHQUFMMEUsMEVBT0l6RSxVQUFjQSxFQUFsQix3Q0FLQ0EsY0FBZ0JBLDZCQUVOZ0QsS0FBRyxJQUFMaEQsSUFBaUJnRCxLQUFHLEdBQUksNkRBVXBDLGtDQUtldkQsa0JBQ0FBLGtCQUNBQSx5Q0FLTU0sR0FBbEIsZUFBQU4sRUFBQTdCLDJHQXFCUSx3QkFDb0Isb0JBQXlCRSw2RUFZckQseUpBbUJPdkIsZ0JBS0FBLHNCQUFjLEVBQUEsRUFBa0JxQiwyQkFHbENyQixvQ0FBd0QwRyxhQUF4QjFHLFFBQW1Ec00sbUVBZ0J4RnRNLGdFQVNIdUIsV0FBQUEsY0FFV3ZCLGtCQUFULFFBQ0EsS0FBV0EsUUFBYyxFQUFyQnVCLEdBRUksR0FBSHZCLFVBQ0owRSxFQUFJMUUsUUFFQ3FFLGdCQUFNLElBQUFKLEVBQUEsTUFBQXNJLEVBQUEsSUFBQXRJLFVBQ0gsSUFBQXVJLEVBQUEsSUFBQTlILEVBQUEsSUFBQVQsRUFBQSxJQUFBc0ksRUFBQSxJQUFBdEksZUFDRCxJQUFTSSxXQUFNLElBQUFKLEtBRXRCd0ksSUFDQXhJLHlGQWFTVCxLQUFUVSxFQUE4QkEsR0FBQzBFLHFCQUMvQjFFLEdBQUMwRSxvQkFDRDFFLEdBQUMwRSx5RUFPRHJILFdBQUFBLFNBRUksTUFBZ0JtTCxFQUFTLEVBQWhCbkwsRUFBaUJtTCxRQUN4Qm5MLFFBQVVBLFFBQVVBLGtCQXRRUHdHLEdDQ2Q0RSxpREFFYSxtQ0FJUHJLLDZIQWNHQSxRQUF1QkEsU0FFaENrQixlQUFPeUYsbUZBQ1B6RixnQkFBT3lGLCtFQUFBLEdBQTZHckUsa0RBQ3BIcEIsZ0JBQU95RixpRkFBQSxHQUErR3JFLHlEQUUzSHFFLElBQXFCekYsZUFBT3lGLG1IQUk1Qi9FLEdBQUNvRSxrQkFDRHBFLEdBQUNvRSxvQkFDSTlFLEdBQUxuQyxlQUVBNkMsR0FBQ2lGLG9CQUNEakYsR0FBQ3NFLG1CQUNEdEUsR0FBQ3lCLG9CQUNEekIsR0FBQzhILGlDQUVEOUgsRUFBd0JBLEdBQUMrSCw4QkFDekIvSCxHQUFDZ0ksZ0RBS0c1SixJQUFKMkcsVUFBb0MzRyxlQUNoQ0EsTUFBSjJHLDZGQU9JeEYsVUFBY0EsRUFBbEIsMkJBSUlBLGFBQUpwQywwQkFFMEIsc09BaUNmK0Usd0dBY0h4RSxrQkFBeUNnTCxzRUFNM0JBLG1FQU1WQyxZQUFjQyxRQUFsQjlNLEtBQ0srTSw2QkFPYkgsVUFDQUEsOERBUVd4RyxzREFJUGxHLHdCQUtBRiw2RkFVOEJpRSxrQkFDbEMxQyxJQUFBQSxPQUNLdkIsYUFDRzZHLGlCQWFNLFlBWE1GLElBQU0xQyxNQUVQQSxJQUFDMEMsR0FBSzFDLElBQU0rSSxhQUtyQnJHLFNBQ09qQyw4RUFhakIxRSxVQUFBQSxvREFPS2tFLEdBQUxxRSx3REFJYWhILDhEQVNGMkIsU0FDTCtKLEtBQUZqTixlQUNFNEosT0FBRjVKLGVBQ0VrTixLQUFGbE4sNERBRXlCbU4sWUFBYWpLLGlEQUVqQytKLGFBQ0FyRCxzQkFDQXNELDJDQUtEaEssNkJBR0pDLGFBQUpBLEVBQW1CQSx3RUFRbkJuRCxvQ0FDS0Esb0ZBUWF3RCxHQUFsQixJQUFBeEQsa0xBZWtCd0QsR0FBbEIsSUFBQXhELDBDQUVLa0UsR0FBTG9FLHNDQUVBekUsb0RBT0E3RCxpQkFBZ0NBLHlIQVduQnVCLGtKQWdCVHZCLCtCQUVDa0UsR0FBTG9FLDBGQVVhL0csNEJBQ0FBLG9GQVliMkMsR0FBQ2tGLCtCQUNEbEYsR0FBQzBFLG9CQUNEMUUsR0FBQzBFLCtCQUVENUksd0JBNVRtQitILEdBa1UzQjRFLEVBQU12UCxVQUFVZ1EsU0FBVSxNQ25VYkMsd0RBRWEscURBTUwsNkNBR0EvSyxPQUF1QkEscUJBRW5CQSwrQkFDSUEsdUdBVVpBLHNCQUdKa0IsR0FBTHdFLGtDQUVTeEUsWUFFRXdFLFlBQVBpQixJQUF3QixZQUNqQmpCLGdCQUFQLGVBQ0EsZ0JBS0N4RSxlQUFPeUYsNEZBQ1B6RixHQUFMMEUsd0JBRUsxRSx1Q0FDYUEsR0FBbEIsVUFBQSxpQ0FDa0JBLEdBQWxCLHNMQWdCeUJBLEtBQUEsMENBQ0FBLEtBQUEsc0NBRUFBLEtBQUEsc0RBRUFBLEtBQUEsb0NBQ0FBLEtBQUEsZ0VBTUFBLEtBQUEsMkNBQ0FBLEtBQUEsK0NBRUFBLEtBQUEscURBRUFBLEtBQUEsY0FBcUJpQixrQ0FDckJqQixLQUFBLG9GQWN6QnhELHVHQUUyQiwrV0F3Q0VvRywrQ0FDQUEsOERBSTdCLE9BQ2E3QyxzQkFBdUJrRCx1QkFDaENsRCxxQ0FDQUEsa0RBR0orSiw0QkFBQUMsNkRBUUE1SixLQUFvQixtQkFFTkEsTUFBZEEsRUFBeUJBLDJEQU96QjZKLG9EQU1hcEYsdUJBRUFBLEVBQUkzQixTQUFTZ0gsU0FBVXJGLEdBQWYsTUFBZ0NwSSxTQUFTb0ksV0FDakRBLEVBQUkxQixTQUFTK0csU0FBVXJGLEdBQWYsTUFBZ0NwSSxTQUFTb0ksYUFFbERwSSwyREFRWkEsK0JBR0FBLG9KQVNDLE9BRVN5RyxFQUFRLEVBQUp6RyxXQUFELElBQ0gwRyxFQUFRLEVBQUoxRyxXQUFELHlCQUVJLE9BQW1CQSxvQ0FDbkIsT0FBbUJBLHlDQUVuQixPQUFrQkEsb0NBQ2xCLE9BQWtCQSxpQ0FLakJ3RCxHQUFsQixLQUFBaUQsYUFBQSxzQkFDa0JqRCxHQUFsQixLQUFBa0QsYUFBQSxtREFFaUJtQyx3RUFDQUEsK0JBRVpyRixHQUFMMEUsZ0dBcE5zQkgsR0NDakIyRix3REFFYSx3TEFtQlRwTCxzQkFHSmtCLEdBQUx3RSxrQ0FFUXhFLFlBRUd3RSxZQUFQaUIsSUFBd0IsWUFDakJqQixnQkFBUCxlQUNBLHNDQVNDeEUsZUFBT3lGLDRGQUVQekYsNEJBRWFBLEdBQWxCLFNBQUF5RixZQUFBLGdCQUNrQnpGLEdBQWxCLFNBQUF5RixZQUFBLGdCQUNrQnpGLEdBQWxCLElBQUF5RixhQUFBLGdCQUdrQnpGLEdBQWxCLFVBQUEsbUNBQ2tCQSxHQUFsQiwwSUFZQSxvQ0FJUW1DLDJDQUNvQixtREFFQSxrREFHcEJBLDJDQUNvQixtREFFQSxnSUFrQkpTLHdDQUNBQSxxREFFYmlFLHdCQUVYckssMFBBV0t1RCxhQUFnQnZELHNCQUNqQkEsdUJBQTRCbUQsRUFBY25ELG9DQUUxQ0EscUJBQ0FBLGlEQU9zQ21FLDBEQU9uQndKLE1BRGQzTixXQUFJQSxpQkFHVzJOLEtBQWIsSUFDRnhKLGdCQUdUNUMsT0FBNkJBLElBRXhCcU0sRUFBYUMsRUFBU3RNLFVBQ3RCNEMsS0FBSVosYUFJQSxLQUhKWSxLQUFJWixhQUdBLE1BRkhZLEtBQUlaLGFBRUQsS0FESFksS0FBSVosYUFDRCwwQ0FVSkMsR0FBTDBFLHdKQVdTLHFCQUVBLDJCQUtTMUUsR0FBbEIsSUFBQSwyQkFBQSxNQUlBeEQsZ0JBM0trQmlLLEdDRmI2RCxpREFFYSxvQ0FLTnhMLG9CQUNFQSx5QkFDR0EsZUFBZSxxR0FTcEJBLGlEQUtJQSw2QkFFR0EsOERBSWRrQixlQUFPeUYsd0NBQ1B6RixlQUFPeUYseUpBQ1B6RixnQkFBT3lGLHVFQUFBLEdBQXFHckUscUVBRWpHcUUsMEVBRVh6RixHQUFMd0UsaUNBRVkxRiw2REFPTUEsMkJBR05BLDBFQVVBQSxtREFLRDBGLFVBQVAsY0FDT0EsVUFBUCxjQUNPQSxVQUFQLGNBR09BLGFBQVBpQixJQUF5QixFQUFBLFlBQ2xCakIsYUFBUCxhQUNPQSxhQUFQK0YsRUFBOEIsYUFHdkIvRixVQUFQaUIsUUFBc0IsMEJBR1pBLDJHQUtUekYsR0FBTFIsMEJBQ0tRLEdBQUxSLG1DQUVJVixjQUNTM0UsZUFDSjJFLFFBREkyRyxRQUFXQSxTQUFhdEwsZUFHakNzTCw0QkFHaUIzRyw4QkFHakIsU0FDTzBGLGNBQVAsY0FDT0EsY0FBUCxjQUNPQSxVQUFQaUIsUUFBc0Isc0JBQ3RCLGtCQU1KQSw2REFLSUEsNEhBWUoxSCxtQkFBQUEsMElBVUksdU9Ba0JKdkIsb0RBRUEsNElBZ0JJeUQsVUFBY0EsRUFBbEIsaUNBRUEsUUFDUXpELE9BQU1BLHlDQUVGeUQsSUFBbUJnRCxtQkFBcUIsc0JBQ3ZDQSxRQUFTdUgsMEJBQTZCdEgsd0JBSTNDMUcsV0FBTSxFQUFXLHNDQUdUaU8sWUFBa0JqTyxLQUFNZ08sR0FBS0EsS0FBR0UsR0FBS0EseUJBQ3JDbE8sS0FBS2dPLGVBQWdCRyxjQUFpQm5PLEtBQUdvTyw4RkFnQmpEcE8sb0JBQ0FBLGVBQ0hxTyxPQUFHck8sZ0JBQUEsRUFBQUEsNEtBa0JKLDJDQUNBQSw0QkFDQSwyT0E4QkEsNFJBZ0NKLHlNQWE0QjBHLDhJQWE1QjRILDhGQVdXbEksa2NBK0NGVCwwQkFDQTRDLDhDQUdBNUMsa0JBQ0E0QyxnREFHQTVDLDBCQUNBNEMsOExBeUNUcEYsMldBUktLLEdBQUx3RSwyR0FJSWhJLFFBQVUsZ0JBQ1YsZUFJSnVCLGNBQUFBLE1BRUt2QixnQkFDR0EsNkJBQW9CLFNBQUFBLFFBQUEsY0FBQUEsZ0JBQUEsb0NBQW1GLGdCQUFuRkEsZUFBQSxXQUN4QixjQUNBdUIsMEJBQ2Esb0ZBS1c0Qiw0RUFVNUI1QixJQUFBQSxrQkFDZUEsd0dBT2YsMkNBSWVnTiwwUEFNUHZMLDBCQUdHaEQsdUVBQ2EsRUFBNkIsRUFBR0Esa0JBQUdBLGtCQUFtQixFQUFtQixFQUFFQSxrQkFBR0EsK0JBRzVGd0QsR0FBTDBFLDBSQXlCTGxJLG9DQUNLQSw0SkFlRCxzQkFKQSxTQUNBQSxXQUFTLEVBQUFBLHFDQUNULGVBSUNrRSxHQUFMb0UsMEJBQ0twRSxHQUFMNEUseURBRzZCLDBCQUNaLDhDQUVBLDJGQVNqQjlJLGdGQVFBQSxzRkFLS2tFLEdBQUxvRSwwQkFDS3BFLEdBQUw0RSxrQ0FDa0J0RixHQUFsQixJQUFBeEQsdURBSUE2RCw4QkFRS0wsR0FBTDBFLDRGQU9nQzNHLFlBQXJCdkIsUUFBc0Msa0dBWTlDa0UsT0FFSEEsR0FBQzBFLGVBQ0QxRSxHQUFDa0YsY0FFRGxGLEdBQUMwRSxlQUNEMUUsR0FBQ2tGLGNBRURsRixHQUFDa0YscURBR0RwSiwyQkFDQUEseUJBbGtCa0IrSCxHQ0NieUcsaURBRWEseURBTUpsTSxxR0FXVkEscUJBQ0EsVUFDQXdELG1CQUNBQSxvQkFHVXhELG9CQUVWQSxnQkFDUzNFLHVJQU95QjJFLDJDQUNBQSwyQ0FDQUEsMkNBQ0FBLGlEQVQ5QkEsK0RBcUJNbUUsSUFBS0MsSUFBSzlCLElBQUtqQixPQUd4QkgsZUFBT3lGLGlLQU8wQjFGLG9FQUNILGdCQUFpQyxxQkFBakMwRixpQkFBQSxpQkFBQUEscUJBQUEsbUJBQUFBLFNBQUEsMkJBQ1QxSCxnQkFBVCxtQkFDSkEsWUFBVDBILG9CQUNTMUgsWUFBVDBILHFCQUNTMUgsT0FBVCw2Q0FRQ2lDLHdCQUFxQnlGLGtMQVF0QnhGLFVBQWNBLEVBQWxCLG1EQU9RSSxLQUFNdEMsUUFBU3NDLEtBQU10QyxHQUFGLG9HQXNDdkIseUNBR2VrRixZQUFhQyxtQkFBcUIrSCx5QkFBMkI5USx1QkFBMEJBLFdBQVkrUSxrQ0FDMUYxTyw2RkF5QnhCLFlBRUEsb0dBc0NKQSx3REFHbUIsT0FBQSxtRUEwQkNvRyxVQUFHcEcsWUFBQSx1QkFDQXlHLDZDQUNEQSxrQ0FyQkMsY0FFbEJMLHVCQUFlQSw2QkFFUmpELFlBQWNRLFlBQWdCaUIsbUNBRWxDNUUsMEJBQ1FBLCtFQUlFeUcsc0JBQ0FDLGdQQXVEZC9DLG9GQWtCbUJwQyxZQUFaZ0csOEhBVU1oRyxZQUFadkIsaUJBR0xBLHVLQXNCUTJELGtCQUtSM0QsZ0JBQW9CQSwyR0FjVSxTQUM5QmtFLGVBQUMwRSxjQUNEMUUsZUFBQ2tGLGdCQUNEbEYsR0FBQ2tGLGdCQUNEbEYsR0FBQzBFLHVEQVFEMUUsR0FBQzBFLGNBQ0QxRSxlQUFDMEUsMkVBU0QrRixXQUVBLHNCQUN3QnBOLHNCQUtSQSxpQ0FMTiw4QkFDOEJBLHlCQUN4QkEsK0JBQ1JxTixJQUtQeEosR0FBQXBGLDJDQUtEQSxxR0FhUUEsZ0ZBSXdCMEUsRUFBYW5ELEVBQWIsS0FBWm1ELGVBQ1BuRCxlQUFpQkEsZUFBaUJBLFVBQ3BDQSxLQUFQdkIsWUFBMkJ1QixlQUNwQkEsTUFBUHZCLFlBQTRCdUIsWUFsWlh3RyxHQ0FoQjhHLG9EQUVhLHdEQU9Mdk0sb0JBQ1RBLE9BQUoyRyxVQUF3QzNHLHNCQUNyQkEsOEZBTUxBLHFCQUVEQSw4QkFNUmtCLGVBQU95RixtRUFFUHpGLGVBQU95Riw2Q0FDUHpGLGVBQU95RixzRkFDUHpGLGVBQU95Rix5RkFFUHpGLEdBQUxzTCxhQUdLdEwsR0FBTHdFLDRCQUNLeEUsR0FBTHdFLHlDQUVBLE9BRVUsSUFBTStHLElBQVFDLFFBQWVDLCtCQU0xQixJQUFIaEcsSUFBU2hGLGtCQUdHZ0YsT0FBVWpCLGNBQVAsZUFFZEEsbUJBQVBrSCxFQUFpQyxZQUMxQmxILGFBQVArRyxFQUEyQixZQUNwQi9HLFVBQWdCLEdBQXZCaUIsSUFBc0JpRyxFQUFBLFlBQ2ZsSCxtQkFBMkIsR0FBbENrSCxFQUErQixZQUN4QmxILGFBQVBrSCxFQUEyQixZQUNwQmxILFVBQWdCLEdBQXZCaUIsSUFBc0MsR0FBaEJpRyxFQUFBLG9DQUVPLGlCQUFBRCxFQUFBLG1CQUF5RCxNQUF6RCx3QkFBQWhHLGdCQUFBLGdCQUFBQSxjQUFBLG9DQUE4SyxnQkFBOUsrRixFQUFBLDhHQVU3QnZMLFVBQWNBLE9BRWRBLHFCQUNLQSw0REFXVHpELHdHQVdJLFdBQ0FBLG9LQTRCSixVQUVjcUcscUJBQWVyRyxvQkFBaEJBLFdBQUFBLFNBQURBLDBDQUVKbUQsYUFBZ0JBLCtDQUN5QkEsbURBSTFDLCtDQWFNSyxHQUFMMEUsNEJBT0UxRSxHQUFMMEUsdURBSkRsSSx5SUF3QksyRiwwQkFDQTRDLHVDQUNBQSw0Q0FJQTVDLDBCQUNBNEMsMkNBQ0FBLCtIQW9CVHZJLE9BQTBCa0UsR0FBTDBFLHFCQUNiMUUsS0FBUmxFLE9BQW1Ca0UsR0FBTGtGLDhCQUNUNUYsR0FBTDBFLDhDQUVBbEksdUlBWUFtUCxpREFPQWpMLEdBQUMwRSx1QkFDRDFFLEdBQUNrRix1QkFFRGxGLEdBQUNrRixvQkFDRGxGLEdBQUMwRSxlQUNEMUUsR0FBQ2tGLG9CQUNEbEYsR0FBQzBFLGVBQ0QxRSxHQUFDa0Ysc0NBcE9rQnJCLEdDRGRxSCx3REFFYSwrQ0FNTDlNLDBCQUNNQSwyQkFFTEEsaUNBQ0VBLFFBQXVCQSxxQkFNbENrQixlQUFPeUYsOEZBRVB6RixlQUFPeUYsa0pBQ1B6RixHQUFMMEUsd0JBR0sxRSxlQUFPeUYseUZBR1B6RixlQUFPeUYscUlBQ1pBLElBQTZCekYsR0FBTDBFLDJIQVVwQnpFLFVBQWNBLE9BQ2RBLGdHQWNBLHlIQWVBLDhJQXVCSnpELGdEQUdBeUcsSUFBc0JMLDhDQUVmcEcsK0NBUUZrRSxHQUFMMEUsbUJBQ0sxRSxHQUFMa0YsNkJBRUtsRixHQUFMa0YsNkJBQ0tsRixHQUFMMEUsb0dBbUJBMUUsR0FBQzBFLGNBQ0QxRSxHQUFDa0YsZ0JBQ0RsRixHQUFDa0YsZ0JBQ0RsRixHQUFDMEUsdURBUUQxRSxHQUFDMEUsY0FDRDFFLEdBQUMwRSxtREFNRCtGLHdCQUVrQm5MLEdBQUwwRSw0QkFFYmxJLE9BQTJCd0QsR0FBTDBFLHNCQUNaMUUsR0FBTDBFLDRHQWlCTGhFLEdBQUNrRixvQkFDRGxGLEdBQUMwRSxxQkFFRDFFLEdBQUNrRixvQkFDRGxGLEdBQUMwRSx1QkEzS3NCYixHQ0NsQnNILGlEQUVhLG1DQUlML00sc0JBRVJrQixlQUFPeUYsMkdBSURYLE9BQVBXLElBQW1CLFlBQ1prQixJQUFQLGFBQ09uQyxVQUFQLFdBSUN4RSxHQUFMMEUsOEJBQXdCLEdBQUFvSCxpQ0FBd0NqTSxZQUFBLFNBQzNERyxHQUFMMEUsbUZBUUsxRSxHQUFMMEUsMENBTUsxRSxHQUFMMEUsc0VBT0toRSxHQUFMMEUsNEJBQ0sxRSxHQUFMa0Ysd0JBekNtQnJCLEdDRGR3SCxpREFFYSxxQ0FJTGpOLGtDQUlFQSxzQ0FFSUEsdUNBQ0RBLG9DQUNBQSx3Q0FDRUEsMkJBRVBBLFdBRVJrQixlQUFPeUYseUtBQ1B6RixHQUFMd0UsNEJBRUt4RSxlQUFPeUYsa0pBQ1B6RixHQUFMMEUsMERBR0sxRSxnQkFBT3lGLGlGQUFBLEdBQStHckUscUtBWXZIbkIsVUFBY0EsT0FDZEEsYUFBaUJBLGtGQWFqQix1TUFtQ0V6RCxzQkFBYyxFQUFBLE1BRWRBLHdFQWNGMkQsWUFDT3VFLFlBQVBsSSxxSEFrQkosZ0JBRVlBLGNBQUksMEdBT2lCLG1DQUlHa0UsV0FBZXVGLG9CQUFzQnZGLGdCQUFvQnNMLCtDQUN6RHRMLFdBQWV3RixxQkFBc0J4RixnQkFBb0J1TCw4Q0FDekR2TCxXQUFld0YscUJBQXNCeEYsZ0JBQW9Cd0wsOENBQ3pEeEwsV0FBZXdGLHFCQUFzQnhGLGdCQUFvQnlMLGdCQUluRiwyR0FtQkxuTSxHQUFMMEUsOEVBU0FoRSxHQUFDa0Ysb0JBQ0RsRixHQUFDa0YsdUJBQ0RsRixHQUFDMEUsd0JBQ0QxRSxHQUFDa0Ysd0JBN0ttQnJCLEdDQWY2SCxtREFFYSxzQ0FJSnROLG1DQUNkMkcsK0JBRWEzRywrQ0FPTUEsdUNBQ0RBLG9DQUNBQSw0RUFRbEJmLFFBQUFBLE9BRU8sNkJBQ29DLFNBRS9CLHlCQUF1QjBILGFBQUEsMkJBQTZEQSxhQUFBQSxnQ0FBbUQsaUJBQWhIQSxzQkFBQSxtQkFBQUEsU0FBQSxhQUN2QixHQUFDakIsWUFBVDZILEVBQTZCNUcsYUFBQUEsa0JBQ3JCLEdBQUNNLFVBQVROLHdCQUVrQixFQUFBLHNHQVVsQnhGLFVBQWNBLEVBQWxCLG1EQU1LSSxLQUFNdEMsUUFBU3NDLEtBQU10QyxHQUFGLFNBQWtCLHFFQWV0Qyx1UEFxQ0V2Qix1QkFBZSxFQUFBLEVBQWtCcUIsTUFFcENyQixpREFXSW1FLE1BRVA1QyxXQUFBQSxXQUVrQiwrQkFBeUN2QixZQUFjbUQsRUFBSSwrQkFHL0JRLFlBQUlwQyxFQUFjQSxHQUNuRG9DLFlBQUlwQyxFQUFjQSxNQUl4Qm9DLEdBQUkscUVBZVgsNEJBTXFCNkYsR0FBS2pJLFdBQVEsY0FBc0JrSSxtQkFBaUIsbUJBQTJCK0YsbUNBQy9FaEcsR0FBS2pJLFdBQVEsY0FBc0JtSSxvQkFBaUIsbUJBQTJCK0Ysa0NBQy9FakcsR0FBS2pJLFdBQVEsY0FBc0JtSSxvQkFBaUIsbUJBQTJCZ0csY0FJMUYsd0RBZUh2TCxNQUVQNUMsV0FBQUEsaUNBRTJDdkIsWUFBY3VCLEVBQUksR0FDbkR2QixZQUFjdUIsRUFBSSxNQUNyQm9DLEdBQUksaURBbUJOSCxHQUFMMEUsb0RBT0toRSxHQUFMNkYsK0JBQ0t2RyxHQUFMK0YsMkhBY1c3RSw2Q0FJbUJzRixFQUFTekksSUFBYUEsR0FBbkN5SSxlQUNQekksZUFBaUJBLGVBQWlCQSxPQUNyQyxHQUFDNkgsS0FBSnBKLFlBQXVCdUIsWUFDcEIsR0FBQ3FILE1BQUo1SSxZQUF3QnVCLFlBaE9Od0csR0NBakIrSCx3REFFYSxNQUVyQnhOLFlBQ0FBLDhEQUxzQnlGLEdDQWRnSSxpREFFYSxzRUFRTHpOLDBGQU9Sa0IsZ0JBQU95RixpRkFBQSxHQUErR3JFLDZDQUV0SFYsR0FBTGlGLHVKQW9CQW5KLHlGQVlBQSw2REFPQUEsZ0dBbUJBLG9CQUVJbUQsb0NBSWtDZSxXQUFhdUYsb0JBQXFCdkYsdURBQ2xDQSxXQUFhdUYsb0JBQXFCdkYsZ0JBQWtCOEwsNENBQ3BEOUwsdUJBQWtDQSxnQkFBa0JPLG1EQUNwRFAsdUJBQWtDQSxnQkFBa0JPLGVBSWhGLG9GQWlCVnpFLGdEQUlBQSxpQkEvR2tCK0gsR0NBYmtJLGlEQUVhLGlEQU1KM04sdUNBRWQyRyxpREFLbUIzRyx1Q0FDREEsb0NBQ0FBLGtDQUVKQSxZQUFZLGFBQ2JBLFdBQVcsdURBT1ppQix3RkFFUEMsR0FBTDBFLG1CQUVLMUUsaUJBQU95Riw0T0FVWjFILFlBQUFBLElBQUEsSUFDTTBILE9BQVVpSCxhQUNaM0YsY0FBQSxpQ0FDVSxFQUFHbEYsRUFBSTRELFVBQUc1RCxxTEFRNEUseUJBQTRCLCtHQUFzSDhLLHFFQUk3TmhELFVBQ1IzRCxLQUFLMkQsb0dBSzRELHlCQUE0QixzRkFLdEduRixxQkFBVSxlQUNMLHNIQWNUdkUsVUFBY0EsRUFBbEIsZ0ZBV0swTCxFQUFNQSxHQUFHNU4sUUFBUzROLEVBQU1BLEdBQUc1TixLQUFIaUMsRUFBWWpDLCtCQUtqQzZPLEVBQU1BLEdBQUc3TyxRQUFTNk8sRUFBTUEsR0FBRzdPLEtBQUg4TyxFQUFlOU8sNEJBSXpDaUMsRUFBWSxFQUFSNk0sR0FDRHJRLFNBQUMsSUFBUytDLGlFQWNmLGVBQ0Esd1BBOEJFL0MsdUJBQWUsRUFBQSxFQUFrQitDLE1BRXBDL0MsaURBV0ltRSxNQUVQNUMsV0FBQUEsV0FFb0J2QixZQUFjbUQsR0FDeEJuRCxZQUFjdUIsTUFFakJvQyxHQUFJLG1FQWNYLDRCQUlxQjZGLEdBQUtqSSxtQ0FBd0NrSSxnREFBc0QrRixtQ0FDbkdoRyxHQUFLakksbUNBQXdDbUksaURBQXNEK0Ysa0NBQ25HakcsR0FBS2pJLG1DQUF3Q21JLGlEQUFzRGdHLGNBSTlHLGlFQWNILDBDQU1QeEgsc0RBTUFGLDhDQUNBdUIseUdBYUFsRSxlQUFBQSxhQUdxQlgsVUFBWSxrREFDUWdCLFFBRXBCaEIsVUFBWSxvRkFRakNuRCxlQUFBQSx3QkFFOEJ2QixvREF4UForSCxHQ21CYnVJLEVBRVQsb0NBSW9CLElBQVcsd0JBRWYsUUFFRHBOLE9BQ0hBLDJCQUVZLHFCQUdaQSxJQUFKLGVBQXlCLFFBRWxCQSxHQUFDdEIsT0FBV3NCLEdBQUN0QixrQkFFaEJzQixJQUNKWixPQUFTWSxLQUNUWixRQUFVWSxHQUFDQSxFQUFJQSxhQUlKcU4scUNBRVNELHVCQUlOLDhCQUNFLGdDQUNFLDZCQUNILDJCQUNGLDZCQUNFLDZCQUNBLGdDQUNHLDRCQUNKLDRCQUNBLDRDQUNrQiw2QkFDakIsOENBQ21CLDZCQUNuQiw4QkFDQyxnQ0FDRSx5Q0FDVyw0QkFDZiw0QkFDQSwrQkFNZG5OLEVBQVVBLGVBQWdCRCxHQUFoQkEsRUFBc0JBLE9DbkUvQnNOLDBDQUVhLHdFQVNkbE8sUUFBSnRDLGlCQUErQnNDLGtCQUdyQkEsc0NBRU5BLHFDQUNBLGtDQUNBLHFFQVVZQSx5REFFRkEsTUFBc0JBLGdDQUNwQkEsZ0JBQW1DQSw0QkFFaENBLCtCQUNEQSwwQ0FFQUEsWUFBMkJBLGdEQU16Q0EsSUFBSnRDLGNBQXNDc0MsY0FDbENBLElBQUp0QyxjQUFzQ3NDLGNBQ2xDQSxJQUFKdEMsY0FBc0NzQyxjQUNsQ0EsSUFBSnRDLGNBQXNDc0MsbUZBTXhCbUUsSUFBS0MsSUFBS2hDLGNBQWVULHlGQVlwQjNCLFNBQXdCQSx3RUFHekJBLGNBQW9DQSwyQkFFdENBLHdMQWlCRHRDLCtGQUVLQSw4SUFHUEEsMkdBSUdBLGtMQUdGQSxnTEFJQUEsb0pBQW1CQSxRQUFBLDRCQUFrTCwrQkFBbEw4RixnQkFBQSx1SUFPbkJ4RCxTQUF5QkEsNERBR3RDTSx1REFFcUIsNkJBR3RCNUMsMEVBRUFBLDBDQUVBQSx3RUFLQUEseUhBU0FBLDRHQVlBQSx3S0FhVyxzT0FZZDBFLEVBQUFULEVBQUEwSyxzRkFjbUI4QixFQUFoQkEsRUFBcUJBLDZEQU9Qbk8sU0FBZEEsRUFBMEJBLEtBQTFCQSxFQUFrQ0EsS0FBbENBLEVBQTBDQSxpRUFPbEN0Qyw4REFPUjJGLEVBQUErSyxFQUFBQyxFQUFBM1EsWUFBQUEsZ0xBeUJILGdCQUVDbUQsaURBS21Dc0IsZ0RBQ0FBLCtDQUNMQSxxRUFJcUJBLHVFQUNBQSxxRUFHQUEsd0RBS3pDLDBNQXFDSmhCLFVBQWNBLEVBQWxCLDBGQVFJQSx5QkFBZ0NBLHlCQUN4QkEsMERBWUoyQyxrRUFTWHBHLCtDQUNBQSxpRkFFOEQsK0dBVS9DNEIsa0JBQXlDZ0wsc0dBS3pDNU0sb0xBWUU2TSxvQ0FDa0JBLGlEQUVyQitELGdPQVd3Q2xLLHVCQU90RGtHLFVBQ0FBLG9CQUVHQSxzQkFDQUEsU0FFSDVNLGtFQVFjb0csc0RBSVBsRyxvQkFHQSx3QkFLQUYseUZBUVVvRyx5SkF1QmRwRyxvRkFnQldrRCxTQUVMK0osTUFBRixPQUNFQyxLQUFGbE4seUJBRWNrRCxzQkFFV2lLLFlBQWFqSywyQkFFakMrSixhQUNBQywrQkFLRGhLLHNDQVdIeUQscUJBT0QsY0FDQTFDLEVBQVcsT0FSZixPQUNTMEMsSUFBSSxHQUFHa0ssd0JBQUoxRyxtQ0FFU2xHLGtJQXdCckJqRSxVQUFBQSxxRUFTQUEsWUFBZ0I4USxzR0FVcUJ2UCx3QkFDaEJBLG1FQVlEQSw0Q0FLcEJ2Qiw4RkFjb0J1Qiw4SEFtQkhBLHFCQUNKcUYsR0FBTG1LLDJDQUNvQy9RLFNBQU80RyxHQUFMM0MsRUFBWUEsR0FBZGpFLGlLQW9CeENBLG9CQUVBQSwwQkFFQUEsYUFBYUEsbUJBQ2JBLGFBQVVBLHNCQUlWQSxhQUFhQSxnQkFFYjhGLGtCQUFnQzlGLHVDQUVoQ0EsYUFBNkIsOEJBQzdCQSxRQUEyQixvR0FXM0IsRUFBQUEsNE9BaUJpQix5Q0FNckJnUix3RUFPQSxPQUVXaFIsaUJBQUdBLGlCQUFtQkEsWUFBbkJpUixrQ0FFVkMsRUFBb0JsUixZQUFIQSxRQUVUQSxPQUFHQSxlQUVILGdDQUdNaUUsb0NBSUFBLE9BQVNBLDJOQVkzQmpFLDhEQUVBQSw4QkFDQUEsK0VBVUFBLHlFQUlBQSw0SUFNQTJILHdGQVNhcEcsdUJBQ0FBLGNBT3JCaVAsRUFBSXBULFVBQVUrVCxPQUFRLHVJQzlzQkUifQ==
